"use strict";define(["modules/default/defaultview","lib/twigjs/twig","src/util/debug"],function(a,b,c){function d(){}var e=0,f=6e3,g=293,h=1;return $.extend(!0,d.prototype,a,{init:function(){this.dom=$('<div class="periodic-table">'),this.elements=[],this.template=b.twig({data:this.module.getConfiguration("template")})},blank:{template:function(){this.template=b.twig({data:""}),this.dom.html("")},hltemplate:function(){this.hltemplate=b.twig({data:""}),this.dom.html("")},value:function(){this.dom.html("")}},inDom:function(){this.module.getDomContent().html(this.dom),this.resolveReady(),this.render()},createTemplateFromPref:function(a){var c=a+"templateSource";if(c=this.module.getConfiguration(c),"pref"===c){var d=this.module.getConfiguration(a+"template");this[a+"Template"]=b.twig({data:d})}},createTemplateFromVar:function(a,c){var d=a+"templateSource";d=this.module.getConfiguration(d),"varin"===d&&(this[a+"template"]=b.twig({data:c}))},update:{value:function(a,b){this.createTemplateFromPref("","pref"),this.createTemplateFromPref("hl","pref"),this.elements=JSON.parse(JSON.stringify(a.resurrect())),this.render()},template:function(a){var b=a.get().toString();try{this.createTemplateFromVar("",b),this.render()}catch(a){c.info("Problem with template: "+a)}},hltemplate:function(a,b){var d=String(a.get());try{this.createTemplateFromVar("hl",d),this.render()}catch(a){c.info("Problem with highlight template: "+a)}}},render:function(){function a(a){var b=a.data("idx"),d=c.elements[b];d&&(k.addClass("hidden"),l.removeClass("hidden"),m.removeClass("hidden"),l.empty(),l.append(c.hltemplate.render({element:d})))}var b=this,c=this;this.dom.html("");this.dom.append('<div class="indic-p indic-g"></div>');for(var d=1;19>d;d++)this.dom.append('<div class="indic-g group'+d+'"><p>'+d+"</p></div>");for(var d=1;8>d;d++)this.dom.append('<div class="indic-p period'+d+'"><p>'+d+"</p></div>");for(var d=0;d<this.elements.length;d++){var i=$("<div>"+this.template.render({element:this.elements[d]})+"</div>").data("idx",d);i.addClass("element e"+this.elements[d].Z+" period"+this.elements[d].period+" group"+this.elements[d].group+" block-"+this.elements[d].block+" "+this.elements[d].serie),this.dom.append(i)}var j=$('<div class="legend"></div>');$("div.e1").after(j);var k=$('<div class="default-legend"></div>'),l=$('<div class="element-zoom hidden"></div>'),m=$('<div class="element-datas hidden"><ul><li>data1</li><li>data2</li></ul></div>');j.append(k).append(l).append(m);var n=$('<div class="inner-legend"></div>');k.append(n),n.append('<ul class="color-serie">\n                <li class="alkali">Alkali metals</li>\n                <li class="alkaline">Alkalin earth metals</li>\n                <li class="transition">Transition metals</li>\n                <li class="lanthanoid">Lanthanoids</li>\n                <li class="actinoid">Actinoids</li>\n                <li class="poor">Post-transition metals</li>\n                <li class="metalloid">Metalloids</li>\n                <li class="nonmetal">Nonmetals</li>\n                <li class="halogen">Halogens</li>\n                <li class="noble">Noble gases</li>\n                </ul>'),n.append('<div class="stateOfMatter"><table><tbody>\n                <tr><td class="solid">S</td><td>Solid</td></tr>\n                <tr><td class="liquid">L</td><td>Liquid</td></tr>\n                <tr><td class="gas"">G</td><td>Gas</td></tr>\n                <tr><td class="unknown">U</td><td>Unknown</td></tr>\n                </tbody></table>\n                <dl><dt>Temperature</dt><dd id="periodicTemperature">'+g+" K</dd>\n                <dt>Pressure</dt><dd>101.325 kPa</dd></dl></div>"),k.append('<input id="periodicTemperatureSlider" type="range" min="'+e+'" max="'+f+'" step="'+h+'" value="'+g+'"/>');var o=!1;k.on("input","#periodicTemperatureSlider",function(a){console.log(a.target.value),n.find("#periodicTemperature").html(""+a.target.value+" K"),b.updateElementPhase()});var p=$(".element");p.mouseenter(function(){o||a($(this))}),p.click(function(){o&&$(".el-selected").removeClass("el-selected"),$(this).addClass("el-selected"),a($(this)),o=!0}),p.dblclick(function(){$(this).removeClass("el-selected"),o=!1}),p.mouseleave(function(){o||($(".element-zoom").delay(5e4).empty(),k.removeClass("hidden"),l.addClass("hidden"),m.addClass("hidden"))});var q='<div class="interactive-zone"><div id="slider"></div>',j=$('<div class="legend"></div>');$(".legend").after(q);var r='<div class="indic-f period7"><p>89-103</p></div>',s='<div class="indic-f period6"><p>57-71</p></div>';$("div.e56").after(s),$("div.e88").after(r)},updateElementPhase:function(){for(var a=this.dom.find(".element"),b=this.getTemperature(),c=0;c<a.length;c++){var d=$(a[c]),e=d.data("idx");if(void 0!==e){var f=this.elements[e],g=+f.boiling,h=+f.melting;isNaN(g)&&isNaN(h)?(d.removeClass("solid liquid gas"),d.addClass("unknown")):h>b?(d.removeClass("liquid gas unknown"),d.addClass("solid")):g>b?(d.removeClass("solid gas unknown"),d.addClass("liquid")):(d.removeClass("liquid solid unknown"),d.addClass("gas"))}}},getTemperature:function(){return this.dom.find("#periodicTemperatureSlider")[0].value}}),d});