!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=!!a&&"length"in a&&a.length,c=fa.type(a);return"function"===c||fa.isWindow(a)?!1:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(fa.isFunction(b))return fa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return fa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(pa.test(b))return fa.filter(b,a,c);b=fa.filter(b,a)}return fa.grep(a,function(a){return _.call(b,a)>-1!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b={};return fa.each(a.match(va)||[],function(a,c){b[c]=!0}),b}function g(){X.removeEventListener("DOMContentLoaded",g),a.removeEventListener("load",g),fa.ready()}function h(){this.expando=fa.expando+h.uid++}function i(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(Ca,"-$&").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:Ba.test(c)?fa.parseJSON(c):c}catch(a){}Aa.set(a,b,c)}else c=void 0;return c}function j(a,b,c,d){var e,f=1,g=20,h=d?function(){return d.cur()}:function(){return fa.css(a,b,"")},i=h(),j=c&&c[3]||(fa.cssNumber[b]?"":"px"),k=(fa.cssNumber[b]||"px"!==j&&+i)&&Ea.exec(fa.css(a,b));if(k&&k[3]!==j){j=j||k[3],c=c||[],k=+i||1;do f=f||".5",k/=f,fa.style(a,b,k+j);while(f!==(f=h()/i)&&1!==f&&--g)}return c&&(k=+k||+i||0,e=c[1]?k+(c[1]+1)*c[2]:+c[2],d&&(d.unit=j,d.start=k,d.end=e)),e}function k(a,b){var c="undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName(b||"*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&fa.nodeName(a,b)?fa.merge([a],c):c}function l(a,b){for(var c=0,d=a.length;d>c;c++)za.set(a[c],"globalEval",!b||za.get(b[c],"globalEval"))}function m(a,b,c,d,e){for(var f,g,h,i,j,m,n=b.createDocumentFragment(),o=[],p=0,q=a.length;q>p;p++)if(f=a[p],f||0===f)if("object"===fa.type(f))fa.merge(o,f.nodeType?[f]:f);else if(La.test(f)){for(g=g||n.appendChild(b.createElement("div")),h=(Ia.exec(f)||["",""])[1].toLowerCase(),i=Ka[h]||Ka._default,g.innerHTML=i[1]+fa.htmlPrefilter(f)+i[2],m=i[0];m--;)g=g.lastChild;fa.merge(o,g.childNodes),g=n.firstChild,g.textContent=""}else o.push(b.createTextNode(f));for(n.textContent="",p=0;f=o[p++];)if(d&&fa.inArray(f,d)>-1)e&&e.push(f);else if(j=fa.contains(f.ownerDocument,f),g=k(n.appendChild(f),"script"),j&&l(g),c)for(m=0;f=g[m++];)Ja.test(f.type||"")&&c.push(f);return n}function n(){return!0}function o(){return!1}function p(){try{return X.activeElement}catch(a){}}function q(a,b,c,d,e,f){var g,h;if("object"==typeof b){"string"!=typeof c&&(d=d||c,c=void 0);for(h in b)q(a,h,c,d,b[h],f);return a}if(null==d&&null==e?(e=c,d=c=void 0):null==e&&("string"==typeof c?(e=d,d=void 0):(e=d,d=c,c=void 0)),e===!1)e=o;else if(!e)return a;return 1===f&&(g=e,e=function(a){return fa().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=fa.guid++)),a.each(function(){fa.event.add(this,b,e,d,c)})}function r(a,b){return fa.nodeName(a,"table")&&fa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function s(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function t(a){var b=Sa.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function u(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(za.hasData(a)&&(f=za.access(a),g=za.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)fa.event.add(b,e,j[e][c])}Aa.hasData(a)&&(h=Aa.access(a),i=fa.extend({},h),Aa.set(b,i))}}function v(a,b){var c=b.nodeName.toLowerCase();"input"===c&&Ha.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function w(a,b,c,d){b=Z.apply([],b);var e,f,g,h,i,j,l=0,n=a.length,o=n-1,p=b[0],q=fa.isFunction(p);if(q||n>1&&"string"==typeof p&&!da.checkClone&&Ra.test(p))return a.each(function(e){var f=a.eq(e);q&&(b[0]=p.call(this,e,f.html())),w(f,b,c,d)});if(n&&(e=m(b,a[0].ownerDocument,!1,a,d),f=e.firstChild,1===e.childNodes.length&&(e=f),f||d)){for(g=fa.map(k(e,"script"),s),h=g.length;n>l;l++)i=e,l!==o&&(i=fa.clone(i,!0,!0),h&&fa.merge(g,k(i,"script"))),c.call(a[l],i,l);if(h)for(j=g[g.length-1].ownerDocument,fa.map(g,t),l=0;h>l;l++)i=g[l],Ja.test(i.type||"")&&!za.access(i,"globalEval")&&fa.contains(j,i)&&(i.src?fa._evalUrl&&fa._evalUrl(i.src):fa.globalEval(i.textContent.replace(Ta,"")))}return a}function x(a,b,c){for(var d,e=b?fa.filter(b,a):a,f=0;null!=(d=e[f]);f++)c||1!==d.nodeType||fa.cleanData(k(d)),d.parentNode&&(c&&fa.contains(d.ownerDocument,d)&&l(k(d,"script")),d.parentNode.removeChild(d));return a}function y(a,b){var c=fa(b.createElement(a)).appendTo(b.body),d=fa.css(c[0],"display");return c.detach(),d}function z(a){var b=X,c=Va[a];return c||(c=y(a,b),"none"!==c&&c||(Ua=(Ua||fa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Ua[0].contentDocument,b.write(),b.close(),c=y(a,b),Ua.detach()),Va[a]=c),c}function A(a,b,c){var d,e,f,g,h=a.style;return c=c||Ya(a),g=c?c.getPropertyValue(b)||c[b]:void 0,""!==g&&void 0!==g||fa.contains(a.ownerDocument,a)||(g=fa.style(a,b)),c&&!da.pixelMarginRight()&&Xa.test(g)&&Wa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f),void 0!==g?g+"":g}function B(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function C(a){if(a in db)return a;for(var b=a[0].toUpperCase()+a.slice(1),c=cb.length;c--;)if(a=cb[c]+b,a in db)return a}function D(a,b,c){var d=Ea.exec(b);return d?Math.max(0,d[2]-(c||0))+(d[3]||"px"):b}function E(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=fa.css(a,c+Fa[f],!0,e)),d?("content"===c&&(g-=fa.css(a,"padding"+Fa[f],!0,e)),"margin"!==c&&(g-=fa.css(a,"border"+Fa[f]+"Width",!0,e))):(g+=fa.css(a,"padding"+Fa[f],!0,e),"padding"!==c&&(g+=fa.css(a,"border"+Fa[f]+"Width",!0,e)));return g}function F(b,c,d){var e=!0,f="width"===c?b.offsetWidth:b.offsetHeight,g=Ya(b),h="border-box"===fa.css(b,"boxSizing",!1,g);if(X.msFullscreenElement&&a.top!==a&&b.getClientRects().length&&(f=Math.round(100*b.getBoundingClientRect()[c])),0>=f||null==f){if(f=A(b,c,g),(0>f||null==f)&&(f=b.style[c]),Xa.test(f))return f;e=h&&(da.boxSizingReliable()||f===b.style[c]),f=parseFloat(f)||0}return f+E(b,c,d||(h?"border":"content"),e,g)+"px"}function G(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=za.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&Ga(d)&&(f[g]=za.access(d,"olddisplay",z(d.nodeName)))):(e=Ga(d),"none"===c&&e||za.set(d,"olddisplay",e?c:fa.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function H(a,b,c,d,e){return new H.prototype.init(a,b,c,d,e)}function I(){return a.setTimeout(function(){eb=void 0}),eb=fa.now()}function J(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=Fa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function K(a,b,c){for(var d,e=(N.tweeners[b]||[]).concat(N.tweeners["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function L(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},n=a.style,o=a.nodeType&&Ga(a),p=za.get(a,"fxshow");c.queue||(h=fa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,fa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],j=fa.css(a,"display"),k="none"===j?za.get(a,"olddisplay")||z(a.nodeName):j,"inline"===k&&"none"===fa.css(a,"float")&&(n.display="inline-block")),c.overflow&&(n.overflow="hidden",l.always(function(){n.overflow=c.overflow[0],n.overflowX=c.overflow[1],n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],gb.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(o?"hide":"show")){if("show"!==e||!p||void 0===p[d])continue;o=!0}m[d]=p&&p[d]||fa.style(a,d)}else j=void 0;if(fa.isEmptyObject(m))"inline"===("none"===j?z(a.nodeName):j)&&(n.display=j);else{p?"hidden"in p&&(o=p.hidden):p=za.access(a,"fxshow",{}),f&&(p.hidden=!o),o?fa(a).show():l.done(function(){fa(a).hide()}),l.done(function(){var b;za.remove(a,"fxshow");for(b in m)fa.style(a,b,m[b])});for(d in m)g=K(o?p[d]:0,d,l),d in p||(p[d]=g.start,o&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function M(a,b){var c,d,e,f,g;for(c in a)if(d=fa.camelCase(c),e=b[d],f=a[c],fa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=fa.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function N(a,b,c){var d,e,f=0,g=N.prefilters.length,h=fa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=eb||I(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:fa.extend({},b),opts:fa.extend(!0,{specialEasing:{},easing:fa.easing._default},c),originalProperties:b,originalOptions:c,startTime:eb||I(),duration:c.duration,tweens:[],createTween:function(b,c){var d=fa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?(h.notifyWith(a,[j,1,0]),h.resolveWith(a,[j,b])):h.rejectWith(a,[j,b]),this}}),k=j.props;for(M(k,j.opts.specialEasing);g>f;f++)if(d=N.prefilters[f].call(j,a,k,j.opts))return fa.isFunction(d.stop)&&(fa._queueHooks(j.elem,j.opts.queue).stop=fa.proxy(d.stop,d)),d;return fa.map(k,K,j),fa.isFunction(j.opts.start)&&j.opts.start.call(a,j),fa.fx.timer(fa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function O(a){return a.getAttribute&&a.getAttribute("class")||""}function P(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(va)||[];if(fa.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Q(a,b,c,d){function e(h){var i;return f[h]=!0,fa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===zb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function R(a,b){var c,d,e=fa.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&fa.extend(!0,a,d),a}function S(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function T(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(a){return{state:"parsererror",error:g?a:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function U(a,b,c,d){var e;if(fa.isArray(b))fa.each(b,function(b,e){c||Db.test(a)?d(a,e):U(a+"["+("object"==typeof e&&null!=e?b:"")+"]",e,c,d)});else if(c||"object"!==fa.type(b))d(a,b);else for(e in b)U(a+"["+e+"]",b[e],c,d)}function V(a){return fa.isWindow(a)?a:9===a.nodeType&&a.defaultView}var W=[],X=a.document,Y=W.slice,Z=W.concat,$=W.push,_=W.indexOf,aa={},ba=aa.toString,ca=aa.hasOwnProperty,da={},ea="2.2.1",fa=function(a,b){return new fa.fn.init(a,b)},ga=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ha=/^-ms-/,ia=/-([\da-z])/gi,ja=function(a,b){return b.toUpperCase()};fa.fn=fa.prototype={jquery:ea,constructor:fa,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:Y.call(this)},pushStack:function(a){var b=fa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a){return fa.each(this,a)},map:function(a){return this.pushStack(fa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor()},push:$,sort:W.sort,splice:W.splice},fa.extend=fa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||fa.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(fa.isPlainObject(d)||(e=fa.isArray(d)))?(e?(e=!1,f=c&&fa.isArray(c)?c:[]):f=c&&fa.isPlainObject(c)?c:{},g[b]=fa.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},fa.extend({expando:"jQuery"+(ea+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===fa.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){var b=a&&a.toString();return!fa.isArray(a)&&b-parseFloat(b)+1>=0},isPlainObject:function(a){return"object"!==fa.type(a)||a.nodeType||fa.isWindow(a)?!1:!a.constructor||ca.call(a.constructor.prototype,"isPrototypeOf")},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?aa[ba.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=fa.trim(a),a&&(1===a.indexOf("use strict")?(b=X.createElement("script"),b.text=a,X.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(ha,"ms-").replace(ia,ja)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b){var d,e=0;if(c(a))for(d=a.length;d>e&&b.call(a[e],e,a[e])!==!1;e++);else for(e in a)if(b.call(a[e],e,a[e])===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(ga,"")},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?fa.merge(d,"string"==typeof a?[a]:a):$.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:_.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f,g=0,h=[];if(c(a))for(e=a.length;e>g;g++)f=b(a[g],g,d),null!=f&&h.push(f);else for(g in a)f=b(a[g],g,d),null!=f&&h.push(f);return Z.apply([],h)},guid:1,proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),fa.isFunction(a)?(d=Y.call(arguments,2),e=function(){return a.apply(b||this,d.concat(Y.call(arguments)))},e.guid=a.guid=a.guid||fa.guid++,e):void 0},now:Date.now,support:da}),"function"==typeof Symbol&&(fa.fn[Symbol.iterator]=W[Symbol.iterator]),fa.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(a,b){aa["[object "+b+"]"]=b.toLowerCase()});var ka=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,n,o=b&&b.ownerDocument,p=b?b.nodeType:9;if(c=c||[],"string"!=typeof a||!a||1!==p&&9!==p&&11!==p)return c;if(!d&&((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,I)){if(11!==p&&(j=ra.exec(a)))if(e=j[1]){if(9===p){if(!(g=b.getElementById(e)))return c;if(g.id===e)return c.push(g),c}else if(o&&(g=o.getElementById(e))&&M(b,g)&&g.id===e)return c.push(g),c}else{if(j[2])return $.apply(c,b.getElementsByTagName(a)),c;if((e=j[3])&&v.getElementsByClassName&&b.getElementsByClassName)return $.apply(c,b.getElementsByClassName(e)),c}if(v.qsa&&!T[a+" "]&&(!J||!J.test(a))){if(1!==p)o=b,n=a;else if("object"!==b.nodeName.toLowerCase()){for((h=b.getAttribute("id"))?h=h.replace(ta,"\\$&"):b.setAttribute("id",h=N),l=z(a),f=l.length,i=ma.test(h)?"#"+h:"[id='"+h+"']";f--;)l[f]=i+" "+m(l[f]);n=l.join(","),o=sa.test(a)&&k(b.parentNode)||b}if(n)try{return $.apply(c,o.querySelectorAll(n)),c}catch(a){}finally{h===N&&b.removeAttribute("id")}}}return B(a.replace(ha,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>w.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(a){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=c.length;d--;)w.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||V)-(~a.sourceIndex||V);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}function l(){}function m(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function n(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(j=b[N]||(b[N]={}),i=j[b.uniqueID]||(j[b.uniqueID]={}),(h=i[d])&&h[0]===P&&h[1]===f)return k[2]=h[2];if(i[d]=k,k[2]=a(b,c,g))return!0}}}function o(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function p(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,r=d||p(b||"*",h.nodeType?[h]:h,[]),s=!a||!d&&b?r:q(r,m,a,h,i),t=c?f||(d?a:o||e)?[]:g:s;if(c&&c(s,t,h,i),e)for(j=q(t,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(t[n[k]]=!(s[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=t.length;k--;)(l=t[k])&&j.push(s[k]=l);f(null,t=[],j,i)}for(k=t.length;k--;)(l=t[k])&&(j=f?aa(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else t=q(t===g?t.splice(o,t.length):t),f?f(null,g,t,i):$.apply(g,t)})}function s(a){for(var b,c,d,e=a.length,f=w.relative[a[0].type],g=f||w.relative[" "],h=f?1:0,i=n(function(a){return a===b},g,!0),j=n(function(a){return aa(b,a)>-1},g,!0),k=[function(a,c,d){var e=!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d));return b=null,e}];e>h;h++)if(c=w.relative[a[h].type])k=[n(o(k),c)];else{if(c=w.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!w.relative[a[d].type];d++);return r(h>1&&o(k),h>1&&m(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ha,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&m(a))}k.push(c)}return o(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&w.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g===G||g||j);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0,g||k.ownerDocument===G||(F(k),h=!I);m=a[l++];)if(m(k,g||G,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Y.call(i));r=q(r)}$.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+1*new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V=1<<31,W={}.hasOwnProperty,X=[],Y=X.pop,Z=X.push,$=X.push,_=X.slice,aa=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},ba="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ca="[\\x20\\t\\r\\n\\f]",da="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ea="\\["+ca+"*("+da+")(?:"+ca+"*([*^$|!~]?=)"+ca+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+da+"))|)"+ca+"*\\]",fa=":("+da+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ea+")*)|.*)\\)|)",ga=new RegExp(ca+"+","g"),ha=new RegExp("^"+ca+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ca+"+$","g"),ia=new RegExp("^"+ca+"*,"+ca+"*"),ja=new RegExp("^"+ca+"*([>+~]|"+ca+")"+ca+"*"),ka=new RegExp("="+ca+"*([^\\]'\"]*?)"+ca+"*\\]","g"),la=new RegExp(fa),ma=new RegExp("^"+da+"$"),na={ID:new RegExp("^#("+da+")"),CLASS:new RegExp("^\\.("+da+")"),TAG:new RegExp("^("+da+"|[*])"),ATTR:new RegExp("^"+ea),PSEUDO:new RegExp("^"+fa),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ca+"*(even|odd|(([+-]|)(\\d*)n|)"+ca+"*(?:([+-]|)"+ca+"*(\\d+)|))"+ca+"*\\)|)","i"),bool:new RegExp("^(?:"+ba+")$","i"),needsContext:new RegExp("^"+ca+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ca+"*((?:-\\d)?\\d*)"+ca+"*\\)|)(?=[^-]|$)","i")},oa=/^(?:input|select|textarea|button)$/i,pa=/^h\d$/i,qa=/^[^{]+\{\s*\[native \w/,ra=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,sa=/[+~]/,ta=/'|\\/g,ua=new RegExp("\\\\([\\da-f]{1,6}"+ca+"?|("+ca+")|.)","ig"),va=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},wa=function(){F()};try{$.apply(X=_.call(O.childNodes),O.childNodes),X[O.childNodes.length].nodeType}catch(a){$={apply:X.length?function(a,b){Z.apply(a,_.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}v=b.support={},y=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c,d=a?a.ownerDocument||a:O;return d!==G&&9===d.nodeType&&d.documentElement?(G=d,H=G.documentElement,I=!y(G),(c=G.defaultView)&&c.top!==c&&(c.addEventListener?c.addEventListener("unload",wa,!1):c.attachEvent&&c.attachEvent("onunload",wa)),v.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),v.getElementsByTagName=e(function(a){return a.appendChild(G.createComment("")),!a.getElementsByTagName("*").length}),v.getElementsByClassName=qa.test(G.getElementsByClassName),v.getById=e(function(a){return H.appendChild(a).id=N,!G.getElementsByName||!G.getElementsByName(N).length}),v.getById?(w.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&I){var c=b.getElementById(a);return c?[c]:[]}},w.filter.ID=function(a){var b=a.replace(ua,va);return function(a){return a.getAttribute("id")===b}}):(delete w.find.ID,w.filter.ID=function(a){var b=a.replace(ua,va);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),w.find.TAG=v.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):v.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},w.find.CLASS=v.getElementsByClassName&&function(a,b){return"undefined"!=typeof b.getElementsByClassName&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(v.qsa=qa.test(G.querySelectorAll))&&(e(function(a){H.appendChild(a).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\r\\' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&J.push("[*^$]="+ca+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+ca+"*(?:value|"+ba+")"),a.querySelectorAll("[id~="+N+"-]").length||J.push("~="),a.querySelectorAll(":checked").length||J.push(":checked"),a.querySelectorAll("a#"+N+"+*").length||J.push(".#.+[+~]")}),e(function(a){var b=G.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+ca+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(v.matchesSelector=qa.test(L=H.matches||H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){v.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",fa)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=qa.test(H.compareDocumentPosition),M=b||qa.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var c=!a.compareDocumentPosition-!b.compareDocumentPosition;return c?c:(c=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&c||!v.sortDetached&&b.compareDocumentPosition(a)===c?a===G||a.ownerDocument===O&&M(O,a)?-1:b===G||b.ownerDocument===O&&M(O,b)?1:D?aa(D,a)-aa(D,b):0:4&c?-1:1)}:function(a,b){if(a===b)return E=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===G?-1:b===G?1:e?-1:f?1:D?aa(D,a)-aa(D,b):0;if(e===f)return g(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)i.unshift(c);for(;h[d]===i[d];)d++;return d?g(h[d],i[d]):h[d]===O?-1:i[d]===O?1:0},G):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(ka,"='$1']"),v.matchesSelector&&I&&!T[c+" "]&&(!K||!K.test(c))&&(!J||!J.test(c)))try{var d=L.call(a,c);if(d||v.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(a){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=w.attrHandle[b.toLowerCase()],d=c&&W.call(w.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:v.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!v.detectDuplicates,D=!v.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},x=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=x(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=x(b);return c},w=b.selectors={cacheLength:50,createPseudo:d,match:na,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ua,va),a[3]=(a[3]||a[4]||a[5]||"").replace(ua,va),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return na.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&la.test(c)&&(b=z(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ua,va).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+ca+")"+a+"("+ca+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f.replace(ga," ")+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h,t=!1;if(q){if(f){for(;p;){for(m=b;m=m[p];)if(h?m.nodeName.toLowerCase()===r:1===m.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(m=q,l=m[N]||(m[N]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===P&&j[1],t=n&&j[2],m=n&&q.childNodes[n];m=++n&&m&&m[p]||(t=n=0)||o.pop();)if(1===m.nodeType&&++t&&m===b){k[a]=[P,n,t];break}}else if(s&&(m=b,l=m[N]||(m[N]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),j=k[a]||[],n=j[0]===P&&j[1],t=n),t===!1)for(;(m=++n&&m&&m[p]||(t=n=0)||o.pop())&&((h?m.nodeName.toLowerCase()!==r:1!==m.nodeType)||!++t||(s&&(l=m[N]||(m[N]={}),k=l[m.uniqueID]||(l[m.uniqueID]={}),k[a]=[P,t]),m!==b)););return t-=e,t===d||t%d===0&&t/d>=0}}},PSEUDO:function(a,c){var e,f=w.pseudos[a]||w.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],w.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=aa(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=A(a.replace(ha,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),b[0]=null,!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return a=a.replace(ua,va),function(b){return(b.textContent||b.innerText||x(b)).indexOf(a)>-1}}),lang:d(function(a){return ma.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(ua,va).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!w.pseudos.empty(a)},header:function(a){return pa.test(a.nodeName)},input:function(a){return oa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a;
}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},w.pseudos.nth=w.pseudos.eq;for(u in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[u]=h(u);for(u in{submit:!0,reset:!0})w.pseudos[u]=i(u);return l.prototype=w.filters=w.pseudos,w.setFilters=new l,z=b.tokenize=function(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=w.preFilter;h;){d&&!(e=ia.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ja.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ha," ")}),h=h.slice(d.length));for(g in w.filter)!(e=na[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)},A=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=z(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d)),f.selector=a}return f},B=b.select=function(a,b,c,d){var e,f,g,h,i,j="function"==typeof a&&a,l=!d&&z(a=j.selector||a);if(c=c||[],1===l.length){if(f=l[0]=l[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&v.getById&&9===b.nodeType&&I&&w.relative[f[1].type]){if(b=(w.find.ID(g.matches[0].replace(ua,va),b)||[])[0],!b)return c;j&&(b=b.parentNode),a=a.slice(f.shift().value.length)}for(e=na.needsContext.test(a)?0:f.length;e--&&(g=f[e],!w.relative[h=g.type]);)if((i=w.find[h])&&(d=i(g.matches[0].replace(ua,va),sa.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&m(f),!a)return $.apply(c,d),c;break}}return(j||A(a,l))(d,b,!I,c,!b||sa.test(a)&&k(b.parentNode)||b),c},v.sortStable=N.split("").sort(U).join("")===N,v.detectDuplicates=!!E,F(),v.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),v.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ba,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);fa.find=ka,fa.expr=ka.selectors,fa.expr[":"]=fa.expr.pseudos,fa.uniqueSort=fa.unique=ka.uniqueSort,fa.text=ka.getText,fa.isXMLDoc=ka.isXML,fa.contains=ka.contains;var la=function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&fa(a).is(c))break;d.push(a)}return d},ma=function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c},na=fa.expr.match.needsContext,oa=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,pa=/^.[^:#\[\.,]*$/;fa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?fa.find.matchesSelector(d,a)?[d]:[]:fa.find.matches(a,fa.grep(b,function(a){return 1===a.nodeType}))},fa.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(fa(a).filter(function(){for(b=0;c>b;b++)if(fa.contains(e[b],this))return!0}));for(b=0;c>b;b++)fa.find(a,e[b],d);return d=this.pushStack(c>1?fa.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&na.test(a)?fa(a):a||[],!1).length}});var qa,ra=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,sa=fa.fn.init=function(a,b,c){var d,e;if(!a)return this;if(c=c||qa,"string"==typeof a){if(d="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:ra.exec(a),!d||!d[1]&&b)return!b||b.jquery?(b||c).find(a):this.constructor(b).find(a);if(d[1]){if(b=b instanceof fa?b[0]:b,fa.merge(this,fa.parseHTML(d[1],b&&b.nodeType?b.ownerDocument||b:X,!0)),oa.test(d[1])&&fa.isPlainObject(b))for(d in b)fa.isFunction(this[d])?this[d](b[d]):this.attr(d,b[d]);return this}return e=X.getElementById(d[2]),e&&e.parentNode&&(this.length=1,this[0]=e),this.context=X,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):fa.isFunction(a)?void 0!==c.ready?c.ready(a):a(fa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),fa.makeArray(a,this))};sa.prototype=fa.fn,qa=fa(X);var ta=/^(?:parents|prev(?:Until|All))/,ua={children:!0,contents:!0,next:!0,prev:!0};fa.fn.extend({has:function(a){var b=fa(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(fa.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=na.test(a)||"string"!=typeof a?fa(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&fa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?fa.uniqueSort(f):f)},index:function(a){return a?"string"==typeof a?_.call(fa(a),this[0]):_.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(fa.uniqueSort(fa.merge(this.get(),fa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),fa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return la(a,"parentNode")},parentsUntil:function(a,b,c){return la(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return la(a,"nextSibling")},prevAll:function(a){return la(a,"previousSibling")},nextUntil:function(a,b,c){return la(a,"nextSibling",c)},prevUntil:function(a,b,c){return la(a,"previousSibling",c)},siblings:function(a){return ma((a.parentNode||{}).firstChild,a)},children:function(a){return ma(a.firstChild)},contents:function(a){return a.contentDocument||fa.merge([],a.childNodes)}},function(a,b){fa.fn[a]=function(c,d){var e=fa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=fa.filter(d,e)),this.length>1&&(ua[a]||fa.uniqueSort(e),ta.test(a)&&e.reverse()),this.pushStack(e)}});var va=/\S+/g;fa.Callbacks=function(a){a="string"==typeof a?f(a):fa.extend({},a);var b,c,d,e,g=[],h=[],i=-1,j=function(){for(e=a.once,d=b=!0;h.length;i=-1)for(c=h.shift();++i<g.length;)g[i].apply(c[0],c[1])===!1&&a.stopOnFalse&&(i=g.length,c=!1);a.memory||(c=!1),b=!1,e&&(g=c?[]:"")},k={add:function(){return g&&(c&&!b&&(i=g.length-1,h.push(c)),function b(c){fa.each(c,function(c,d){fa.isFunction(d)?a.unique&&k.has(d)||g.push(d):d&&d.length&&"string"!==fa.type(d)&&b(d)})}(arguments),c&&!b&&j()),this},remove:function(){return fa.each(arguments,function(a,b){for(var c;(c=fa.inArray(b,g,c))>-1;)g.splice(c,1),i>=c&&i--}),this},has:function(a){return a?fa.inArray(a,g)>-1:g.length>0},empty:function(){return g&&(g=[]),this},disable:function(){return e=h=[],g=c="",this},disabled:function(){return!g},lock:function(){return e=h=[],c||(g=c=""),this},locked:function(){return!!e},fireWith:function(a,c){return e||(c=c||[],c=[a,c.slice?c.slice():c],h.push(c),b||j()),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},fa.extend({Deferred:function(a){var b=[["resolve","done",fa.Callbacks("once memory"),"resolved"],["reject","fail",fa.Callbacks("once memory"),"rejected"],["notify","progress",fa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return fa.Deferred(function(c){fa.each(b,function(b,f){var g=fa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&fa.isFunction(a.promise)?a.promise().progress(c.notify).done(c.resolve).fail(c.reject):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?fa.extend(a,d):d}},e={};return d.pipe=d.then,fa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=Y.call(arguments),g=f.length,h=1!==g||a&&fa.isFunction(a.promise)?g:0,i=1===h?a:fa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?Y.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&fa.isFunction(f[e].promise)?f[e].promise().progress(j(e,c,b)).done(j(e,d,f)).fail(i.reject):--h;return h||i.resolveWith(d,f),i.promise()}});var wa;fa.fn.ready=function(a){return fa.ready.promise().done(a),this},fa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?fa.readyWait++:fa.ready(!0)},ready:function(a){(a===!0?--fa.readyWait:fa.isReady)||(fa.isReady=!0,a!==!0&&--fa.readyWait>0||(wa.resolveWith(X,[fa]),fa.fn.triggerHandler&&(fa(X).triggerHandler("ready"),fa(X).off("ready"))))}}),fa.ready.promise=function(b){return wa||(wa=fa.Deferred(),"complete"===X.readyState||"loading"!==X.readyState&&!X.documentElement.doScroll?a.setTimeout(fa.ready):(X.addEventListener("DOMContentLoaded",g),a.addEventListener("load",g))),wa.promise(b)},fa.ready.promise();var xa=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===fa.type(c)){e=!0;for(h in c)xa(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,fa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(fa(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},ya=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};h.uid=1,h.prototype={register:function(a,b){var c=b||{};return a.nodeType?a[this.expando]=c:Object.defineProperty(a,this.expando,{value:c,writable:!0,configurable:!0}),a[this.expando]},cache:function(a){if(!ya(a))return{};var b=a[this.expando];return b||(b={},ya(a)&&(a.nodeType?a[this.expando]=b:Object.defineProperty(a,this.expando,{value:b,configurable:!0}))),b},set:function(a,b,c){var d,e=this.cache(a);if("string"==typeof b)e[b]=c;else for(d in b)e[d]=b[d];return e},get:function(a,b){return void 0===b?this.cache(a):a[this.expando]&&a[this.expando][b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,fa.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=a[this.expando];if(void 0!==f){if(void 0===b)this.register(a);else{fa.isArray(b)?d=b.concat(b.map(fa.camelCase)):(e=fa.camelCase(b),b in f?d=[b,e]:(d=e,d=d in f?[d]:d.match(va)||[])),c=d.length;for(;c--;)delete f[d[c]]}(void 0===b||fa.isEmptyObject(f))&&(a.nodeType?a[this.expando]=void 0:delete a[this.expando])}},hasData:function(a){var b=a[this.expando];return void 0!==b&&!fa.isEmptyObject(b)}};var za=new h,Aa=new h,Ba=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ca=/[A-Z]/g;fa.extend({hasData:function(a){return Aa.hasData(a)||za.hasData(a)},data:function(a,b,c){return Aa.access(a,b,c)},removeData:function(a,b){Aa.remove(a,b)},_data:function(a,b,c){return za.access(a,b,c)},_removeData:function(a,b){za.remove(a,b)}}),fa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=Aa.get(f),1===f.nodeType&&!za.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=fa.camelCase(d.slice(5)),i(f,d,e[d])));za.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){Aa.set(this,a)}):xa(this,function(b){var c,d;if(f&&void 0===b){if(c=Aa.get(f,a)||Aa.get(f,a.replace(Ca,"-$&").toLowerCase()),void 0!==c)return c;if(d=fa.camelCase(a),c=Aa.get(f,d),void 0!==c)return c;if(c=i(f,d,void 0),void 0!==c)return c}else d=fa.camelCase(a),this.each(function(){var c=Aa.get(this,d);Aa.set(this,d,b),a.indexOf("-")>-1&&void 0!==c&&Aa.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){Aa.remove(this,a)})}}),fa.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=za.get(a,b),c&&(!d||fa.isArray(c)?d=za.access(a,b,fa.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=fa.queue(a,b),d=c.length,e=c.shift(),f=fa._queueHooks(a,b),g=function(){fa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return za.get(a,c)||za.access(a,c,{empty:fa.Callbacks("once memory").add(function(){za.remove(a,[b+"queue",c])})})}}),fa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?fa.queue(this[0],a):void 0===b?this:this.each(function(){var c=fa.queue(this,a,b);fa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&fa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){fa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=fa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=za.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Da=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ea=new RegExp("^(?:([+-])=|)("+Da+")([a-z%]*)$","i"),Fa=["Top","Right","Bottom","Left"],Ga=function(a,b){return a=b||a,"none"===fa.css(a,"display")||!fa.contains(a.ownerDocument,a)},Ha=/^(?:checkbox|radio)$/i,Ia=/<([\w:-]+)/,Ja=/^$|\/(?:java|ecma)script/i,Ka={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ka.optgroup=Ka.option,Ka.tbody=Ka.tfoot=Ka.colgroup=Ka.caption=Ka.thead,Ka.th=Ka.td;var La=/<|&#?\w+;/;!function(){var a=X.createDocumentFragment(),b=a.appendChild(X.createElement("div")),c=X.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),da.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",da.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var Ma=/^key/,Na=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Oa=/^([^.]*)(?:\.(.+)|)/;fa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=za.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=fa.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return"undefined"!=typeof fa&&fa.event.triggered!==b.type?fa.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(va)||[""],j=b.length;j--;)h=Oa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=fa.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=fa.event.special[n]||{},k=fa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&fa.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),fa.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=za.hasData(a)&&za.get(a);if(q&&(i=q.events)){for(b=(b||"").match(va)||[""],j=b.length;j--;)if(h=Oa.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=fa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||fa.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)fa.event.remove(a,n+b[j],c,d,!0);fa.isEmptyObject(i)&&za.remove(a,"handle events")}},dispatch:function(a){a=fa.event.fix(a);var b,c,d,e,f,g=[],h=Y.call(arguments),i=(za.get(this,"events")||{})[a.type]||[],j=fa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=fa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(f.namespace)||(a.handleObj=f,a.data=f.data,d=((fa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&("click"!==a.type||isNaN(a.button)||a.button<1))for(;i!==this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||"click"!==a.type)){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?fa(e,this).index(i)>-1:fa.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||X,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[fa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Na.test(e)?this.mouseHooks:Ma.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new fa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=X),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==p()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===p()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&fa.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return fa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}}},fa.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c)},fa.Event=function(a,b){return this instanceof fa.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?n:o):this.type=a,b&&fa.extend(this,b),this.timeStamp=a&&a.timeStamp||fa.now(),void(this[fa.expando]=!0)):new fa.Event(a,b)},fa.Event.prototype={constructor:fa.Event,isDefaultPrevented:o,isPropagationStopped:o,isImmediatePropagationStopped:o,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=n,a&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=n,a&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=n,a&&a.stopImmediatePropagation(),this.stopPropagation()}},fa.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){fa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||fa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),fa.fn.extend({on:function(a,b,c,d){return q(this,a,b,c,d)},one:function(a,b,c,d){return q(this,a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,fa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=o),this.each(function(){fa.event.remove(this,a,c,b)})}});var Pa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,Qa=/<script|<style|<link/i,Ra=/checked\s*(?:[^=]|=\s*.checked.)/i,Sa=/^true\/(.*)/,Ta=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;fa.extend({htmlPrefilter:function(a){return a.replace(Pa,"<$1></$2>")},clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=fa.contains(a.ownerDocument,a);if(!(da.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||fa.isXMLDoc(a)))for(g=k(h),f=k(a),d=0,e=f.length;e>d;d++)v(f[d],g[d]);if(b)if(c)for(f=f||k(a),g=g||k(h),d=0,e=f.length;e>d;d++)u(f[d],g[d]);else u(a,h);return g=k(h,"script"),g.length>0&&l(g,!i&&k(a,"script")),h},cleanData:function(a){for(var b,c,d,e=fa.event.special,f=0;void 0!==(c=a[f]);f++)if(ya(c)){if(b=c[za.expando]){if(b.events)for(d in b.events)e[d]?fa.event.remove(c,d):fa.removeEvent(c,d,b.handle);c[za.expando]=void 0}c[Aa.expando]&&(c[Aa.expando]=void 0)}}}),fa.fn.extend({domManip:w,detach:function(a){return x(this,a,!0)},remove:function(a){return x(this,a)},text:function(a){return xa(this,function(a){return void 0===a?fa.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return w(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=r(this,a);b.appendChild(a)}})},prepend:function(){return w(this,arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=r(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return w(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return w(this,arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(fa.cleanData(k(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return fa.clone(this,a,b)})},html:function(a){return xa(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Qa.test(a)&&!Ka[(Ia.exec(a)||["",""])[1].toLowerCase()]){a=fa.htmlPrefilter(a);try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(fa.cleanData(k(b,!1)),b.innerHTML=a);b=0}catch(a){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=[];return w(this,arguments,function(b){var c=this.parentNode;fa.inArray(this,a)<0&&(fa.cleanData(k(this)),c&&c.replaceChild(b,this))},a)}}),fa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){fa.fn[a]=function(a){for(var c,d=[],e=fa(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),fa(e[g])[b](c),$.apply(d,c.get());return this.pushStack(d)}});var Ua,Va={HTML:"block",BODY:"block"},Wa=/^margin/,Xa=new RegExp("^("+Da+")(?!px)[a-z%]+$","i"),Ya=function(b){var c=b.ownerDocument.defaultView;return c&&c.opener||(c=a),c.getComputedStyle(b)},Za=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e},$a=X.documentElement;!function(){function b(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",h.innerHTML="",$a.appendChild(g);var b=a.getComputedStyle(h);c="1%"!==b.top,f="2px"===b.marginLeft,d="4px"===b.width,h.style.marginRight="50%",e="4px"===b.marginRight,$a.removeChild(g)}var c,d,e,f,g=X.createElement("div"),h=X.createElement("div");h.style&&(h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",da.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",g.appendChild(h),fa.extend(da,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},pixelMarginRight:function(){return null==d&&b(),e},reliableMarginLeft:function(){return null==d&&b(),f},reliableMarginRight:function(){var b,c=h.appendChild(X.createElement("div"));return c.style.cssText=h.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",h.style.width="1px",$a.appendChild(g),b=!parseFloat(a.getComputedStyle(c).marginRight),$a.removeChild(g),h.removeChild(c),b}}))}();var _a=/^(none|table(?!-c[ea]).+)/,ab={position:"absolute",visibility:"hidden",display:"block"},bb={letterSpacing:"0",fontWeight:"400"},cb=["Webkit","O","Moz","ms"],db=X.createElement("div").style;fa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=A(a,"opacity");return""===c?"1":c}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=fa.camelCase(b),i=a.style;return b=fa.cssProps[h]||(fa.cssProps[h]=C(h)||h),g=fa.cssHooks[b]||fa.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ea.exec(c))&&e[1]&&(c=j(a,b,e),f="number"),null!=c&&c===c&&("number"===f&&(c+=e&&e[3]||(fa.cssNumber[h]?"":"px")),da.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=fa.camelCase(b);return b=fa.cssProps[h]||(fa.cssProps[h]=C(h)||h),g=fa.cssHooks[b]||fa.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=A(a,b,d)),"normal"===e&&b in bb&&(e=bb[b]),""===c||c?(f=parseFloat(e),c===!0||isFinite(f)?f||0:e):e}}),fa.each(["height","width"],function(a,b){fa.cssHooks[b]={get:function(a,c,d){return c?_a.test(fa.css(a,"display"))&&0===a.offsetWidth?Za(a,ab,function(){return F(a,b,d)}):F(a,b,d):void 0},set:function(a,c,d){var e,f=d&&Ya(a),g=d&&E(a,b,d,"border-box"===fa.css(a,"boxSizing",!1,f),f);return g&&(e=Ea.exec(c))&&"px"!==(e[3]||"px")&&(a.style[b]=c,c=fa.css(a,b)),D(a,c,g)}}}),fa.cssHooks.marginLeft=B(da.reliableMarginLeft,function(a,b){return b?(parseFloat(A(a,"marginLeft"))||a.getBoundingClientRect().left-Za(a,{marginLeft:0},function(){return a.getBoundingClientRect().left}))+"px":void 0}),fa.cssHooks.marginRight=B(da.reliableMarginRight,function(a,b){return b?Za(a,{display:"inline-block"},A,[a,"marginRight"]):void 0}),fa.each({margin:"",padding:"",border:"Width"},function(a,b){fa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+Fa[d]+b]=f[d]||f[d-2]||f[0];return e}},Wa.test(a)||(fa.cssHooks[a+b].set=D)}),fa.fn.extend({css:function(a,b){return xa(this,function(a,b,c){var d,e,f={},g=0;if(fa.isArray(b)){for(d=Ya(a),e=b.length;e>g;g++)f[b[g]]=fa.css(a,b[g],!1,d);return f}return void 0!==c?fa.style(a,b,c):fa.css(a,b)},a,b,arguments.length>1)},show:function(){return G(this,!0)},hide:function(){return G(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){Ga(this)?fa(this).show():fa(this).hide()})}}),fa.Tween=H,H.prototype={constructor:H,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||fa.easing._default,this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(fa.cssNumber[c]?"":"px")},cur:function(){var a=H.propHooks[this.prop];return a&&a.get?a.get(this):H.propHooks._default.get(this)},run:function(a){var b,c=H.propHooks[this.prop];return this.options.duration?this.pos=b=fa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(a){var b;return 1!==a.elem.nodeType||null!=a.elem[a.prop]&&null==a.elem.style[a.prop]?a.elem[a.prop]:(b=fa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0)},set:function(a){fa.fx.step[a.prop]?fa.fx.step[a.prop](a):1!==a.elem.nodeType||null==a.elem.style[fa.cssProps[a.prop]]&&!fa.cssHooks[a.prop]?a.elem[a.prop]=a.now:fa.style(a.elem,a.prop,a.now+a.unit)}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},fa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2},_default:"swing"},fa.fx=H.prototype.init,fa.fx.step={};var eb,fb,gb=/^(?:toggle|show|hide)$/,hb=/queueHooks$/;fa.Animation=fa.extend(N,{tweeners:{"*":[function(a,b){var c=this.createTween(a,b);return j(c.elem,a,Ea.exec(b),c),c}]},tweener:function(a,b){fa.isFunction(a)?(b=a,a=["*"]):a=a.match(va);for(var c,d=0,e=a.length;e>d;d++)c=a[d],N.tweeners[c]=N.tweeners[c]||[],N.tweeners[c].unshift(b)},prefilters:[L],prefilter:function(a,b){b?N.prefilters.unshift(a):N.prefilters.push(a)}}),fa.speed=function(a,b,c){var d=a&&"object"==typeof a?fa.extend({},a):{complete:c||!c&&b||fa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!fa.isFunction(b)&&b};return d.duration=fa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in fa.fx.speeds?fa.fx.speeds[d.duration]:fa.fx.speeds._default,null!=d.queue&&d.queue!==!0||(d.queue="fx"),d.old=d.complete,d.complete=function(){fa.isFunction(d.old)&&d.old.call(this),d.queue&&fa.dequeue(this,d.queue)},d},fa.fn.extend({fadeTo:function(a,b,c,d){return this.filter(Ga).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=fa.isEmptyObject(a),f=fa.speed(b,c,d),g=function(){var b=N(this,fa.extend({},a),f);(e||za.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=fa.timers,g=za.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&hb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||fa.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=za.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=fa.timers,g=d?d.length:0;for(c.finish=!0,fa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),fa.each(["toggle","show","hide"],function(a,b){var c=fa.fn[b];fa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(J(b,!0),a,d,e)}}),fa.each({slideDown:J("show"),slideUp:J("hide"),slideToggle:J("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){fa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),fa.timers=[],fa.fx.tick=function(){var a,b=0,c=fa.timers;for(eb=fa.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||fa.fx.stop(),eb=void 0;
},fa.fx.timer=function(a){fa.timers.push(a),a()?fa.fx.start():fa.timers.pop()},fa.fx.interval=13,fa.fx.start=function(){fb||(fb=a.setInterval(fa.fx.tick,fa.fx.interval))},fa.fx.stop=function(){a.clearInterval(fb),fb=null},fa.fx.speeds={slow:600,fast:200,_default:400},fa.fn.delay=function(b,c){return b=fa.fx?fa.fx.speeds[b]||b:b,c=c||"fx",this.queue(c,function(c,d){var e=a.setTimeout(c,b);d.stop=function(){a.clearTimeout(e)}})},function(){var a=X.createElement("input"),b=X.createElement("select"),c=b.appendChild(X.createElement("option"));a.type="checkbox",da.checkOn=""!==a.value,da.optSelected=c.selected,b.disabled=!0,da.optDisabled=!c.disabled,a=X.createElement("input"),a.value="t",a.type="radio",da.radioValue="t"===a.value}();var ib,jb=fa.expr.attrHandle;fa.fn.extend({attr:function(a,b){return xa(this,fa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){fa.removeAttr(this,a)})}}),fa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return"undefined"==typeof a.getAttribute?fa.prop(a,b,c):(1===f&&fa.isXMLDoc(a)||(b=b.toLowerCase(),e=fa.attrHooks[b]||(fa.expr.match.bool.test(b)?ib:void 0)),void 0!==c?null===c?void fa.removeAttr(a,b):e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:(a.setAttribute(b,c+""),c):e&&"get"in e&&null!==(d=e.get(a,b))?d:(d=fa.find.attr(a,b),null==d?void 0:d))},attrHooks:{type:{set:function(a,b){if(!da.radioValue&&"radio"===b&&fa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(va);if(f&&1===a.nodeType)for(;c=f[e++];)d=fa.propFix[c]||c,fa.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)}}),ib={set:function(a,b,c){return b===!1?fa.removeAttr(a,c):a.setAttribute(c,c),c}},fa.each(fa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=jb[b]||fa.find.attr;jb[b]=function(a,b,d){var e,f;return d||(f=jb[b],jb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,jb[b]=f),e}});var kb=/^(?:input|select|textarea|button)$/i,lb=/^(?:a|area)$/i;fa.fn.extend({prop:function(a,b){return xa(this,fa.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[fa.propFix[a]||a]})}}),fa.extend({prop:function(a,b,c){var d,e,f=a.nodeType;if(3!==f&&8!==f&&2!==f)return 1===f&&fa.isXMLDoc(a)||(b=fa.propFix[b]||b,e=fa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=fa.find.attr(a,"tabindex");return b?parseInt(b,10):kb.test(a.nodeName)||lb.test(a.nodeName)&&a.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),da.optSelected||(fa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),fa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){fa.propFix[this.toLowerCase()]=this});var mb=/[\t\r\n\f]/g;fa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h,i=0;if(fa.isFunction(a))return this.each(function(b){fa(this).addClass(a.call(this,b,O(this)))});if("string"==typeof a&&a)for(b=a.match(va)||[];c=this[i++];)if(e=O(c),d=1===c.nodeType&&(" "+e+" ").replace(mb," ")){for(g=0;f=b[g++];)d.indexOf(" "+f+" ")<0&&(d+=f+" ");h=fa.trim(d),e!==h&&c.setAttribute("class",h)}return this},removeClass:function(a){var b,c,d,e,f,g,h,i=0;if(fa.isFunction(a))return this.each(function(b){fa(this).removeClass(a.call(this,b,O(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof a&&a)for(b=a.match(va)||[];c=this[i++];)if(e=O(c),d=1===c.nodeType&&(" "+e+" ").replace(mb," ")){for(g=0;f=b[g++];)for(;d.indexOf(" "+f+" ")>-1;)d=d.replace(" "+f+" "," ");h=fa.trim(d),e!==h&&c.setAttribute("class",h)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):fa.isFunction(a)?this.each(function(c){fa(this).toggleClass(a.call(this,c,O(this),b),b)}):this.each(function(){var b,d,e,f;if("string"===c)for(d=0,e=fa(this),f=a.match(va)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else void 0!==a&&"boolean"!==c||(b=O(this),b&&za.set(this,"__className__",b),this.setAttribute&&this.setAttribute("class",b||a===!1?"":za.get(this,"__className__")||""))})},hasClass:function(a){var b,c,d=0;for(b=" "+a+" ";c=this[d++];)if(1===c.nodeType&&(" "+O(c)+" ").replace(mb," ").indexOf(b)>-1)return!0;return!1}});var nb=/\r/g;fa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=fa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,fa(this).val()):a,null==e?e="":"number"==typeof e?e+="":fa.isArray(e)&&(e=fa.map(e,function(a){return null==a?"":a+""})),b=fa.valHooks[this.type]||fa.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=fa.valHooks[e.type]||fa.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(nb,""):null==c?"":c)}}}),fa.extend({valHooks:{option:{get:function(a){return fa.trim(a.value)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],(c.selected||i===e)&&(da.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!fa.nodeName(c.parentNode,"optgroup"))){if(b=fa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=fa.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=fa.inArray(fa.valHooks.option.get(d),f)>-1)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),fa.each(["radio","checkbox"],function(){fa.valHooks[this]={set:function(a,b){return fa.isArray(b)?a.checked=fa.inArray(fa(a).val(),b)>-1:void 0}},da.checkOn||(fa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var ob=/^(?:focusinfocus|focusoutblur)$/;fa.extend(fa.event,{trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||X],n=ca.call(b,"type")?b.type:b,o=ca.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||X,3!==d.nodeType&&8!==d.nodeType&&!ob.test(n+fa.event.triggered)&&(n.indexOf(".")>-1&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[fa.expando]?b:new fa.Event(n,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=o.join("."),b.rnamespace=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:fa.makeArray(c,[b]),l=fa.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!fa.isWindow(d)){for(i=l.delegateType||n,ob.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||X)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(za.get(g,"events")||{})[b.type]&&za.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&ya(g)&&(b.result=k.apply(g,c),b.result===!1&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!ya(d)||j&&fa.isFunction(d[n])&&!fa.isWindow(d)&&(h=d[j],h&&(d[j]=null),fa.event.triggered=n,d[n](),fa.event.triggered=void 0,h&&(d[j]=h)),b.result}},simulate:function(a,b,c){var d=fa.extend(new fa.Event,c,{type:a,isSimulated:!0});fa.event.trigger(d,null,b),d.isDefaultPrevented()&&c.preventDefault()}}),fa.fn.extend({trigger:function(a,b){return this.each(function(){fa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?fa.event.trigger(a,b,c,!0):void 0}}),fa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){fa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),fa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),da.focusin="onfocusin"in a,da.focusin||fa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){fa.event.simulate(b,a.target,fa.event.fix(a))};fa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=za.access(d,b);e||d.addEventListener(a,c,!0),za.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=za.access(d,b)-1;e?za.access(d,b,e):(d.removeEventListener(a,c,!0),za.remove(d,b))}}});var pb=a.location,qb=fa.now(),rb=/\?/;fa.parseJSON=function(a){return JSON.parse(a+"")},fa.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{c=(new a.DOMParser).parseFromString(b,"text/xml")}catch(a){c=void 0}return c&&!c.getElementsByTagName("parsererror").length||fa.error("Invalid XML: "+b),c};var sb=/#.*$/,tb=/([?&])_=[^&]*/,ub=/^(.*?):[ \t]*([^\r\n]*)$/gm,vb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,wb=/^(?:GET|HEAD)$/,xb=/^\/\//,yb={},zb={},Ab="*/".concat("*"),Bb=X.createElement("a");Bb.href=pb.href,fa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pb.href,type:"GET",isLocal:vb.test(pb.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ab,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":fa.parseJSON,"text xml":fa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?R(R(a,fa.ajaxSettings),b):R(fa.ajaxSettings,a)},ajaxPrefilter:P(yb),ajaxTransport:P(zb),ajax:function(b,c){function d(b,c,d,h){var j,l,s,t,v,x=c;2!==u&&(u=2,i&&a.clearTimeout(i),e=void 0,g=h||"",w.readyState=b>0?4:0,j=b>=200&&300>b||304===b,d&&(t=S(m,w,d)),t=T(m,t,w,j),j?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(fa.lastModified[f]=v),v=w.getResponseHeader("etag"),v&&(fa.etag[f]=v)),204===b||"HEAD"===m.type?x="nocontent":304===b?x="notmodified":(x=t.state,l=t.data,s=t.error,j=!s)):(s=x,!b&&x||(x="error",0>b&&(b=0))),w.status=b,w.statusText=(c||x)+"",j?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=void 0,k&&o.trigger(j?"ajaxSuccess":"ajaxError",[w,m,j?l:s]),q.fireWith(n,[w,x]),k&&(o.trigger("ajaxComplete",[w,m]),--fa.active||fa.event.trigger("ajaxStop")))}"object"==typeof b&&(c=b,b=void 0),c=c||{};var e,f,g,h,i,j,k,l,m=fa.ajaxSetup({},c),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?fa(n):fa.event,p=fa.Deferred(),q=fa.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!h)for(h={};b=ub.exec(g);)h[b[1].toLowerCase()]=b[2];b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>u)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return e&&e.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((b||m.url||pb.href)+"").replace(sb,"").replace(xb,pb.protocol+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=fa.trim(m.dataType||"*").toLowerCase().match(va)||[""],null==m.crossDomain){j=X.createElement("a");try{j.href=m.url,j.href=j.href,m.crossDomain=Bb.protocol+"//"+Bb.host!=j.protocol+"//"+j.host}catch(a){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=fa.param(m.data,m.traditional)),Q(yb,m,c,w),2===u)return w;k=fa.event&&m.global,k&&0===fa.active++&&fa.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!wb.test(m.type),f=m.url,m.hasContent||(m.data&&(f=m.url+=(rb.test(f)?"&":"?")+m.data,delete m.data),m.cache===!1&&(m.url=tb.test(f)?f.replace(tb,"$1_="+qb++):f+(rb.test(f)?"&":"?")+"_="+qb++)),m.ifModified&&(fa.lastModified[f]&&w.setRequestHeader("If-Modified-Since",fa.lastModified[f]),fa.etag[f]&&w.setRequestHeader("If-None-Match",fa.etag[f])),(m.data&&m.hasContent&&m.contentType!==!1||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Ab+"; q=0.01":""):m.accepts["*"]);for(l in m.headers)w.setRequestHeader(l,m.headers[l]);if(m.beforeSend&&(m.beforeSend.call(n,w,m)===!1||2===u))return w.abort();v="abort";for(l in{success:1,error:1,complete:1})w[l](m[l]);if(e=Q(zb,m,c,w)){if(w.readyState=1,k&&o.trigger("ajaxSend",[w,m]),2===u)return w;m.async&&m.timeout>0&&(i=a.setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,e.send(s,d)}catch(a){if(!(2>u))throw a;d(-1,a)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return fa.get(a,b,c,"json")},getScript:function(a,b){return fa.get(a,void 0,b,"script")}}),fa.each(["get","post"],function(a,b){fa[b]=function(a,c,d,e){return fa.isFunction(c)&&(e=e||d,d=c,c=void 0),fa.ajax(fa.extend({url:a,type:b,dataType:e,data:c,success:d},fa.isPlainObject(a)&&a))}}),fa._evalUrl=function(a){return fa.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},fa.fn.extend({wrapAll:function(a){var b;return fa.isFunction(a)?this.each(function(b){fa(this).wrapAll(a.call(this,b))}):(this[0]&&(b=fa(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return fa.isFunction(a)?this.each(function(b){fa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=fa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=fa.isFunction(a);return this.each(function(c){fa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){fa.nodeName(this,"body")||fa(this).replaceWith(this.childNodes)}).end()}}),fa.expr.filters.hidden=function(a){return!fa.expr.filters.visible(a)},fa.expr.filters.visible=function(a){return a.offsetWidth>0||a.offsetHeight>0||a.getClientRects().length>0};var Cb=/%20/g,Db=/\[\]$/,Eb=/\r?\n/g,Fb=/^(?:submit|button|image|reset|file)$/i,Gb=/^(?:input|select|textarea|keygen)/i;fa.param=function(a,b){var c,d=[],e=function(a,b){b=fa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=fa.ajaxSettings&&fa.ajaxSettings.traditional),fa.isArray(a)||a.jquery&&!fa.isPlainObject(a))fa.each(a,function(){e(this.name,this.value)});else for(c in a)U(c,a[c],b,e);return d.join("&").replace(Cb,"+")},fa.fn.extend({serialize:function(){return fa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=fa.prop(this,"elements");return a?fa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!fa(this).is(":disabled")&&Gb.test(this.nodeName)&&!Fb.test(a)&&(this.checked||!Ha.test(a))}).map(function(a,b){var c=fa(this).val();return null==c?null:fa.isArray(c)?fa.map(c,function(a){return{name:b.name,value:a.replace(Eb,"\r\n")}}):{name:b.name,value:c.replace(Eb,"\r\n")}}).get()}}),fa.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(a){}};var Hb={0:200,1223:204},Ib=fa.ajaxSettings.xhr();da.cors=!!Ib&&"withCredentials"in Ib,da.ajax=Ib=!!Ib,fa.ajaxTransport(function(b){var c,d;return da.cors||Ib&&!b.crossDomain?{send:function(e,f){var g,h=b.xhr();if(h.open(b.type,b.url,b.async,b.username,b.password),b.xhrFields)for(g in b.xhrFields)h[g]=b.xhrFields[g];b.mimeType&&h.overrideMimeType&&h.overrideMimeType(b.mimeType),b.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest");for(g in e)h.setRequestHeader(g,e[g]);c=function(a){return function(){c&&(c=d=h.onload=h.onerror=h.onabort=h.onreadystatechange=null,"abort"===a?h.abort():"error"===a?"number"!=typeof h.status?f(0,"error"):f(h.status,h.statusText):f(Hb[h.status]||h.status,h.statusText,"text"!==(h.responseType||"text")||"string"!=typeof h.responseText?{binary:h.response}:{text:h.responseText},h.getAllResponseHeaders()))}},h.onload=c(),d=h.onerror=c("error"),void 0!==h.onabort?h.onabort=d:h.onreadystatechange=function(){4===h.readyState&&a.setTimeout(function(){c&&d()})},c=c("abort");try{h.send(b.hasContent&&b.data||null)}catch(a){if(c)throw a}},abort:function(){c&&c()}}:void 0}),fa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(a){return fa.globalEval(a),a}}}),fa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),fa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=fa("<script>").prop({charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),X.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Jb=[],Kb=/(=)\?(?=&|$)|\?\?/;fa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Jb.pop()||fa.expando+"_"+qb++;return this[a]=!0,a}}),fa.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Kb.test(b.url)?"url":"string"==typeof b.data&&0===(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Kb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=fa.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Kb,"$1"+e):b.jsonp!==!1&&(b.url+=(rb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||fa.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){void 0===f?fa(a).removeProp(e):a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Jb.push(e)),g&&fa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),da.createHTMLDocument=function(){var a=X.implementation.createHTMLDocument("").body;return a.innerHTML="<form></form><form></form>",2===a.childNodes.length}(),fa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||(da.createHTMLDocument?X.implementation.createHTMLDocument(""):X);var d=oa.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=m([a],b,e),e&&e.length&&fa(e).remove(),fa.merge([],d.childNodes))};var Lb=fa.fn.load;fa.fn.load=function(a,b,c){if("string"!=typeof a&&Lb)return Lb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>-1&&(d=fa.trim(a.slice(h)),a=a.slice(0,h)),fa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&fa.ajax({url:a,type:e||"GET",dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?fa("<div>").append(fa.parseHTML(a)).find(d):a)}).always(c&&function(a,b){g.each(function(){c.apply(g,f||[a.responseText,b,a])})}),this},fa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){fa.fn[b]=function(a){return this.on(b,a)}}),fa.expr.filters.animated=function(a){return fa.grep(fa.timers,function(b){return a===b.elem}).length},fa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=fa.css(a,"position"),l=fa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=fa.css(a,"top"),i=fa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),fa.isFunction(b)&&(b=b.call(a,c,fa.extend({},h))),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},fa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){fa.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,fa.contains(b,d)?(e=d.getBoundingClientRect(),c=V(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===fa.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),fa.nodeName(a[0],"html")||(d=a.offset()),d.top+=fa.css(a[0],"borderTopWidth",!0),d.left+=fa.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-fa.css(c,"marginTop",!0),left:b.left-d.left-fa.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent;a&&"static"===fa.css(a,"position");)a=a.offsetParent;return a||$a})}}),fa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;fa.fn[a]=function(d){return xa(this,function(a,d,e){var f=V(a);return void 0===e?f?f[b]:a[d]:void(f?f.scrollTo(c?f.pageXOffset:e,c?e:f.pageYOffset):a[d]=e)},a,d,arguments.length)}}),fa.each(["top","left"],function(a,b){fa.cssHooks[b]=B(da.pixelPosition,function(a,c){return c?(c=A(a,b),Xa.test(c)?fa(a).position()[b]+"px":c):void 0})}),fa.each({Height:"height",Width:"width"},function(a,b){fa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){fa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return xa(this,function(b,c,d){var e;return fa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?fa.css(b,c,g):fa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),fa.fn.extend({bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)},size:function(){return this.length}}),fa.fn.andSelf=fa.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return fa});var Mb=a.jQuery,Nb=a.$;return fa.noConflict=function(b){return a.$===fa&&(a.$=Nb),b&&a.jQuery===fa&&(a.jQuery=Mb),fa},b||(a.jQuery=a.$=fa),fa}),!function(a,b){"object"==typeof module&&module.exports&&"function"==typeof require?module.exports=b():"function"==typeof define&&"object"==typeof define.amd?define("loglevel",b):a.log=b()}(this,function(){function a(a){return typeof console===i?!1:void 0!==console[a]?b(console,a):void 0!==console.log?b(console,"log"):h}function b(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(b){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function c(a,b){return function(){typeof console!==i&&(d(b),g[a].apply(g,arguments))}}function d(a){for(var b=0;b<j.length;b++){var c=j[b];g[c]=a>b?h:g.methodFactory(c,a)}}function e(a){var b=(j[a]||"silent").toUpperCase();try{return void(window.localStorage.loglevel=b)}catch(a){}try{window.document.cookie="loglevel="+b+";"}catch(a){}}function f(){var a;try{a=window.localStorage.loglevel}catch(a){}if(typeof a===i)try{a=/loglevel=([^;]+)/.exec(window.document.cookie)[1]}catch(a){}void 0===g.levels[a]&&(a="WARN"),g.setLevel(g.levels[a])}var g={},h=function(){},i="undefined",j=["trace","debug","info","warn","error"];g.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},g.methodFactory=function(b,d){return a(b)||c(b,d)},g.setLevel=function(a){if("string"==typeof a&&void 0!==g.levels[a.toUpperCase()]&&(a=g.levels[a.toUpperCase()]),!("number"==typeof a&&a>=0&&a<=g.levels.SILENT))throw"log.setLevel() called with invalid level: "+a;return e(a),d(a),typeof console===i&&a<g.levels.SILENT?"No console available for logging":void 0},g.enableAll=function(){g.setLevel(g.levels.TRACE)},g.disableAll=function(){g.setLevel(g.levels.SILENT)};var k=typeof window!==i?window.log:void 0;return g.noConflict=function(){return typeof window!==i&&window.log===g&&(window.log=k),g},f(),g}),define("src/util/debug",["loglevel"],function(a){function b(a,b){return b?"ms"===b?a.toFixed(3)+"ms":"s"===b?(a/1e3).toFixed(3)+"s":void 0:a}function c(){this._started=!1,this._paused=!1,this._steps=[],this._laps=[],this._sumElapsed=0,this._sums={}}var d=window.performance?window.performance:Date;a.setLevel("trace");var e={NODEBUG:-1,ERROR:0,WARN:1,INFO:2,DEBUG:3,TRACE:4},f={"-1":"silent",0:"error",1:"warn",2:"info",3:"debug",4:"trace"},g=e.TRACE,h={Levels:e,setDebugLevel:function(b){b=parseInt(b),isNaN(b)||-1>b||(b>4&&(b=4),a.setLevel(f[b]),this.error=a.error,this.warn=a.warn,this.info=a.info,this.debug=a.debug,this.trace=a.trace,g=b)},getDebugLevel:function(){return g},error:a.error,warn:a.warn,info:a.info,debug:a.debug,trace:a.trace,timer:function(){var a=new c;return a.start(),a},Timer:c};return c.prototype={start:function(){this._paused?(this._start=d.now()-this._elapsed,this._paused=!1):this._started||(this._start=d.now(),this._started=!0)},pause:function(){this._started&&!this._paused&&(this._paused=!0,this._elapsed=d.now()-this._start)},time:function(a){return this._started&&!this._paused?b(d.now()-this._start,a):void 0},step:function(a){if(this._started&&!this._paused){var c=d.now(),e=c-this._start;return this._start=c,this._total+=e,this._steps.push(e),b(e,a)}},lap:function(a){if(this._started&&!this._paused){var c=d.now()-this._start;return this._laps.push(c),b(this._total,a)}},log:function(){h.info(this.time())},sum:function(a){var b=d.now()-this._start;a&&(this._sums[a]||(this._sums[a]=0),this._sums[a]+=b-this._sumElapsed),this._sumElapsed=b},getSteps:function(a){return this._steps.map(function(c){return b(c,a)})},getLaps:function(a){return this._laps.map(function(c){return b(c,a)})},getSums:function(a){var c={};for(var d in this._sums)c[d]=b(this._sums[d],a);return c}},h});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/util/color",[],function(){var a={};return a.hex2rgb=function(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]:[0,0,0]},a.rgb2hex=function(a,b,c){if(1===arguments.length){var d=a.match(/rgba?\(([^\(]*)\)/,"i");if(!d)return null;var e=d[1].split(",");e.length>=3&&(a=+e[0],b=+e[1],c=+e[2])}return"#"+((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},a.hue2rgb=function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a},a.hsl2rgb=function(b,c,d){var e,f,g,h,i,j;return c/=100,d/=100,0===c?h=i=j=255*d:(f=.5>=d?d*(c+1):d+c-d*c,e=2*d-f,g=b/360,h=a.hue2rgb(e,f,g+1/3),i=a.hue2rgb(e,f,g),j=a.hue2rgb(e,f,g-1/3)),{r:h,g:i,b:j}},a.getDistinctColors=function(b){for(var c=new Array(b),d=0,e=0;360>e;e+=360/b){d++;var f=a.hsl2rgb(e,100,30+d%4*15);c[d-1]=[Math.round(255*f.r),Math.round(255*f.g),Math.round(255*f.b)]}return c},a.getDistinctColorsAsString=function(b){for(var c=a.getDistinctColors(b),d=new Array(b),e=0;b>e;e++)d[e]=a.getColor(c[e]);return d},a.getNextColorRGB=function(a,b){return this.getDistinctColors(b)[a]},a.getColor=function(a){if(Array.isArray(a)){if(a.length>=3)for(var b=0;3>b;b++)a[b]=Math.round(a[b]);switch(a.length){case 3:return"rgb("+a.join(",")+")";case 4:return"rgba("+a.join(",")+")"}}else if("object"==("undefined"==typeof a?"undefined":_typeof(a)))return"rgb("+Math.round(255*a.r)+", "+Math.round(255*a.g)+", "+Math.round(255*a.b)+")";return a},a.getBrightness=function(a){return(a[0]/255*299+a[1]/255*587+a[2]/255*114)/(a[3]||1)},a}),function(){function a(a,b){return a.set(b[0],b[1]),a}function b(a,b){return a.add(b),a}function c(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function d(a,b,c,d){for(var e=-1,f=a.length;++e<f;){var g=a[e];b(d,g,c(g),a)}return d}function e(a,b){for(var c=-1,d=a.length;++c<d&&!1!==b(a[c],c,a););return a}function f(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function g(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[++e]=g)}return f}function h(a,b){return!!a.length&&-1<r(a,b,0)}function i(a,b,c){for(var d=-1,e=a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function j(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function k(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function l(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function m(a,b,c,d){var e=a.length;for(d&&e&&(c=a[--e]);e--;)c=b(c,a[e],e,a);return c}function n(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function o(a,b,c){for(var d=-1,e=a.length;++d<e;){var f=a[d],g=b(f);if(null!=g&&(h===Q?g===g:c(g,h)))var h=g,i=f}return i}function p(a,b,c,d){var e;return c(a,function(a,c,f){return b(a,c,f)?(e=d?c:a,!1):void 0}),e}function q(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}function r(a,b,c){if(b!==b)return G(a,c);--c;for(var d=a.length;++c<d;)if(a[c]===b)return c;return-1}function s(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function t(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].c;return a}function u(a,b){for(var c,d=-1,e=a.length;++d<e;){var f=b(a[d]);f!==Q&&(c=c===Q?f:c+f)}return c}function v(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function w(a,b){return j(b,function(b){return[b,a[b]]})}function x(a){return function(b){return a(b)}}function y(a,b){return j(b,function(b){return a[b]})}function z(a,b){for(var c=-1,d=a.length;++c<d&&-1<r(b,a[c],0););return c}function A(a,b){for(var c=a.length;c--&&-1<r(b,a[c],0););return c}function B(a){return a&&a.Object===Object?a:null}function C(a,b){if(a!==b){var c=null===a,d=a===Q,e=a===a,f=null===b,g=b===Q,h=b===b;if(a>b&&!f||!e||c&&!g&&h||d&&h)return 1;if(b>a&&!c||!h||f&&!d&&e||g&&e)return-1}return 0}function D(a){return Ha[a]}function E(a){return Ia[a]}function F(a){return"\\"+La[a]}function G(a,b,c){var d=a.length;for(b+=c?0:-1;c?b--:++b<d;){var e=a[b];if(e!==e)return b}return-1}function H(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(a){}return b}function I(a,b){return a="number"==typeof a||ra.test(a)?+a:-1,a>-1&&0==a%1&&(null==b?9007199254740991:b)>a}function J(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function K(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function L(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;)a[c]===b&&(a[c]="__lodash_placeholder__",f[++e]=c);return f}function M(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function N(a){if(!a||!Aa.test(a))return a.length;for(var b=za.lastIndex=0;za.test(a);)b++;return b}function O(a){return Ja[a]}function P(B){function ra(a){if(ud(a)&&!Nf(a)&&!(a instanceof xa)){if(a instanceof wa)return a;if(he.call(a,"__wrapped__"))return Pc(a)}return new wa(a)}function va(){}function wa(a,b){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=Q}function xa(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Ha(){}function Ia(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Ja(a){var b=-1,c=a?a.length:0;for(this.__data__=new Ia;++b<c;)this.push(a[b])}function Ka(a,b){var c=a.__data__;return Hc(b)?(c=c.__data__,"__lodash_hash_undefined__"===("string"==typeof b?c.string:c.hash)[b]):c.has(b)}function La(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Oa(a,b){var c=Qa(a,b);return 0>c?!1:(c==a.length-1?a.pop():ye.call(a,c,1),!0)}function Pa(a,b){var c=Qa(a,b);return 0>c?Q:a[c][1]}function Qa(a,b){for(var c=a.length;c--;)if(kd(a[c][0],b))return c;return-1}function Ra(a,b,c){var d=Qa(a,b);0>d?a.push([b,c]):a[d][1]=c}function Sa(a,b,c,d){return a===Q||kd(a,fe[c])&&!he.call(d,c)?b:a}function Ua(a,b,c){(c!==Q&&!kd(a[b],c)||"number"==typeof b&&c===Q&&!(b in a))&&(a[b]=c);
}function Xa(a,b,c){var d=a[b];(!kd(d,c)||kd(d,fe[b])&&!he.call(a,b)||c===Q&&!(b in a))&&(a[b]=c)}function Ya(a,b,c,d){return We(a,function(a,e,f){b(d,a,c(a),f)}),d}function Za(a,b){return a&&Yb(b,Md(b),a)}function $a(a,b){for(var c=-1,d=null==a,e=b.length,f=Array(e);++c<e;)f[c]=d?Q:Jd(a,b[c]);return f}function _a(a,b,c){return a===a&&(c!==Q&&(a=a>c?c:a),b!==Q&&(a=b>a?b:a)),a}function ab(a,b,c,d,f,g){var h;if(c&&(h=f?c(a,d,f,g):c(a)),h!==Q)return h;if(!td(a))return a;if(d=Nf(a)){if(h=Bc(a),!b)return Xb(a,h)}else{var i=zc(a),j="[object Function]"==i||"[object GeneratorFunction]"==i;if(Of(a))return Tb(a,b);if("[object Object]"!=i&&"[object Arguments]"!=i&&(!j||f))return Ga[i]?Dc(a,i,b):f?a:{};if(H(a))return f?a:{};if(h=Cc(j?{}:a),!b)return $b(a,Za(h,a))}return g||(g=new La),(f=g.get(a))?f:(g.set(a,h),(d?e:ib)(a,function(d,e){Xa(h,e,ab(d,b,c,e,a,g))}),d?h:$b(a,h))}function bb(a){var b=Md(a),c=b.length;return function(d){if(null==d)return!c;for(var e=c;e--;){var f=b[e],g=a[f],h=d[f];if(h===Q&&!(f in Object(d))||!g(h))return!1}return!0}}function cb(a,b,c){if("function"!=typeof a)throw new de("Expected a function");return xe(function(){a.apply(Q,c)},b)}function db(a,b,c,d){var e=-1,f=h,g=!0,k=a.length,l=[],m=b.length;if(!k)return l;c&&(b=j(b,x(c))),d?(f=i,g=!1):b.length>=200&&(f=Ka,g=!1,b=new Ja(b));a:for(;++e<k;){var n=a[e],o=c?c(n):n;if(g&&o===o){for(var p=m;p--;)if(b[p]===o)continue a;l.push(n)}else f(b,o,d)||l.push(n)}return l}function eb(a,b){var c=!0;return We(a,function(a,d,e){return c=!!b(a,d,e)}),c}function fb(a,b){var c=[];return We(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function gb(a,b,c,d){d||(d=[]);for(var e=-1,f=a.length;++e<f;){var g=a[e];od(g)&&(c||Nf(g)||md(g))?b?gb(g,b,c,d):k(d,g):c||(d[d.length]=g)}return d}function hb(a,b){return null==a?a:Ye(a,b,Nd)}function ib(a,b){return a&&Ye(a,b,Md)}function jb(a,b){return a&&Ze(a,b,Md)}function kb(a,b){return g(b,function(b){return qd(a[b])})}function lb(a,b){b=Gc(b,a)?[b+""]:Nb(b);for(var c=0,d=b.length;null!=a&&d>c;)a=a[b[c++]];return c&&c==d?a:Q}function mb(a,b){return he.call(a,b)||"object"==typeof a&&b in a&&null===te(a)}function nb(a,b){return b in Object(a)}function ob(a,b,c){for(var d=c?i:h,e=a.length,f=e,g=Array(e),k=[];f--;){var l=a[f];f&&b&&(l=j(l,x(b))),g[f]=c||!b&&120>l.length?Q:new Ja(f&&l)}var l=a[0],m=-1,n=l.length,o=g[0];a:for(;++m<n;){var p=l[m],q=b?b(p):p;if(o?!Ka(o,q):!d(k,q,c)){for(f=e;--f;){var r=g[f];if(r?!Ka(r,q):!d(a[f],q,c))continue a}o&&o.push(q),k.push(p)}}return k}function pb(a,b,c,d){return ib(a,function(a,e,f){b(d,c(a),e,f)}),d}function qb(a,b,d){return Gc(b,a)||(b=Nb(b),a=Lc(a,b),b=Tc(b)),b=null==a?a:a[b],null==b?Q:c(b,a,d)}function rb(a,b,c,d,e){if(a===b)return!0;if(null==a||null==b||!td(a)&&!ud(b))return a!==a&&b!==b;a:{var f=Nf(a),g=Nf(b),h="[object Array]",i="[object Array]";f||(h=zc(a),"[object Arguments]"==h?h="[object Object]":"[object Object]"!=h&&(f=Bd(a))),g||(i=zc(b),"[object Arguments]"==i?i="[object Object]":"[object Object]"!=i&&Bd(b));var j="[object Object]"==h&&!H(a),g="[object Object]"==i&&!H(b),i=h==i;if(!i||f||j){if(!(2&d)&&(h=j&&he.call(a,"__wrapped__"),g=g&&he.call(b,"__wrapped__"),h||g)){a=rb(h?a.value():a,g?b.value():b,c,d,e);break a}i?(e||(e=new La),a=(f?sc:uc)(a,b,rb,c,d,e)):a=!1}else a=tc(a,b,h,rb,c,d)}return a}function sb(a,b,c,d){var e=c.length,f=e,g=!d;if(null==a)return!f;for(a=Object(a);e--;){var h=c[e];if(g&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<f;){var h=c[e],i=h[0],j=a[i],k=h[1];if(g&&h[2]){if(j===Q&&!(i in a))return!1}else if(h=new La,i=d?d(j,k,i,a,b,h):Q,i===Q?!rb(k,j,d,3,h):!i)return!1}return!0}function tb(a){var b=typeof a;return"function"==b?a:null==a?Vd:"object"==b?Nf(a)?xb(a[0],a[1]):wb(a):Zd(a)}function ub(a){a=null==a?a:Object(a);var b,c=[];for(b in a)c.push(b);return c}function vb(a,b){var c=-1,d=nd(a)?Array(a.length):[];return We(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function wb(a){var b=xc(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(d!==Q||c in Object(a))}}return function(c){return c===a||sb(c,a,b)}}function xb(a,b){return function(c){var d=Jd(c,a);return d===Q&&d===b?Ld(c,a):rb(b,d,Q,3)}}function yb(a,b,c,d,f){if(a!==b){var g=Nf(b)||Bd(b)?Q:Nd(b);e(g||b,function(e,h){if(g&&(h=e,e=b[h]),td(e)){f||(f=new La);var i=h,j=f,k=a[i],l=b[i],m=j.get(l);if(!m){var m=d?d(k,l,i+"",a,b,j):Q,n=m===Q;n&&(m=l,Nf(l)||Bd(l)?Nf(k)?m=c?Xb(k):k:od(k)?m=Xb(k):(n=!1,m=ab(l)):xd(l)||md(l)?md(k)?m=Hd(k):!td(k)||c&&qd(k)?(n=!1,m=ab(l)):m=c?ab(k):k:n=!1),j.set(l,m),n&&yb(m,l,c,d,j)}Ua(a,i,m)}else i=d?d(a[h],e,h+"",a,b,f):Q,i===Q&&(i=e),Ua(a,h,i)})}}function zb(a,b,c){var d=-1,e=wc();return b=j(b.length?b:Array(1),function(a){return e(a)}),a=vb(a,function(a,c,e){return{a:j(b,function(b){return b(a)}),b:++d,c:a}}),t(a,function(a,b){var d;a:{d=-1;for(var e=a.a,f=b.a,g=e.length,h=c.length;++d<g;){var i=C(e[d],f[d]);if(i){if(d>=h){d=i;break a}d=i*("desc"==c[d]?-1:1);break a}}d=a.b-b.b}return d})}function Ab(a,b){return a=Object(a),l(b,function(b,c){return c in a&&(b[c]=a[c]),b},{})}function Bb(a,b){var c={};return hb(a,function(a,d){b(a,d)&&(c[d]=a)}),c}function Cb(a){return function(b){return null==b?Q:b[a]}}function Db(a){return function(b){return lb(b,a)}}function Eb(a,b,c){var d=-1,e=b.length,f=a;for(c&&(f=j(a,function(a){return c(a)}));++d<e;)for(var g=0,h=b[d],h=c?c(h):h;-1<(g=r(f,h,g));)f!==a&&ye.call(f,g,1),ye.call(a,g,1);return a}function Fb(a,b){for(var c=a?b.length:0,d=c-1;c--;){var e=b[c];if(d==c||e!=f){var f=e;if(I(e))ye.call(a,e,1);else if(Gc(e,a))delete a[e];else{var e=Nb(e),g=Lc(a,e);null!=g&&delete g[Tc(e)]}}}return a}function Gb(a,b){return a+Ae(He()*(b-a+1))}function Hb(a,b,c,d){b=Gc(b,a)?[b+""]:Nb(b);for(var e=-1,f=b.length,g=f-1,h=a;null!=h&&++e<f;){var i=b[e];if(td(h)){var j=c;if(e!=g){var k=h[i],j=d?d(k,i,h):Q;j===Q&&(j=null==k?I(b[e+1])?[]:{}:k)}Xa(h,i,j)}h=h[i]}return a}function Ib(a,b,c){var d=-1,e=a.length;for(0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0,c=Array(e);++d<e;)c[d]=a[d+b];return c}function Jb(a,b){var c;return We(a,function(a,d,e){return c=b(a,d,e),!c}),!!c}function Kb(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&2147483647>=e){for(;e>d;){var f=d+e>>>1,g=a[f];(c?b>=g:b>g)&&null!==g?d=f+1:e=f}return e}return Lb(a,b,Vd,c)}function Lb(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=b===Q;f>e;){var j=Ae((e+f)/2),k=c(a[j]),l=k!==Q,m=k===k;(g?m||d:h?m&&l&&(d||null!=k):i?m&&(d||l):null==k?0:d?b>=k:b>k)?e=j+1:f=j}return Fe(f,4294967294)}function Mb(a,b){for(var c=0,d=a.length,e=a[0],f=b?b(e):e,g=f,h=0,i=[e];++c<d;)e=a[c],f=b?b(e):e,kd(f,g)||(g=f,i[++h]=e);return i}function Nb(a){return Nf(a)?a:Mc(a)}function Ob(a,b,c){var d=-1,e=h,f=a.length,g=!0,j=[],k=j;if(c)g=!1,e=i;else if(200>f)k=b?[]:j;else{if(e=b?null:_e(a))return M(e);g=!1,e=Ka,k=new Ja}a:for(;++d<f;){var l=a[d],m=b?b(l):l;if(g&&m===m){for(var n=k.length;n--;)if(k[n]===m)continue a;b&&k.push(m),j.push(l)}else e(k,m,c)||(k!==j&&k.push(m),j.push(l))}return j}function Pb(a,b,c,d){for(var e=a.length,f=d?e:-1;(d?f--:++f<e)&&b(a[f],f,a););return c?Ib(a,d?0:f,d?f+1:e):Ib(a,d?f+1:0,d?e:f)}function Qb(a,b){var c=a;return c instanceof xa&&(c=c.value()),l(b,function(a,b){return b.func.apply(b.thisArg,k([a],b.args))},c)}function Rb(a,b,c){for(var d=-1,e=a.length;++d<e;)var f=f?k(db(f,a[d],b,c),db(a[d],f,b,c)):a[d];return f&&f.length?Ob(f,b,c):[]}function Sb(a,b,c){for(var d=-1,e=a.length,f=b.length,g={};++d<e;)c(g,a[d],f>d?b[d]:Q);return g}function Tb(a,b){if(b)return a.slice();var c=new a.constructor(a.length);return a.copy(c),c}function Ub(a){var b=new a.constructor(a.byteLength);return new qe(b).set(new qe(a)),b}function Vb(a,b,c){for(var d=c.length,e=-1,f=Ee(a.length-d,0),g=-1,h=b.length,i=Array(h+f);++g<h;)i[g]=b[g];for(;++e<d;)i[c[e]]=a[e];for(;f--;)i[g++]=a[e++];return i}function Wb(a,b,c){for(var d=-1,e=c.length,f=-1,g=Ee(a.length-e,0),h=-1,i=b.length,j=Array(g+i);++f<g;)j[f]=a[f];for(g=f;++h<i;)j[g+h]=b[h];for(;++d<e;)j[g+c[d]]=a[f++];return j}function Xb(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function Yb(a,b,c){return Zb(a,b,c)}function Zb(a,b,c,d){c||(c={});for(var e=-1,f=b.length;++e<f;){var g=b[e],h=d?d(c[g],a[g],g,c,a):a[g];Xa(c,g,h)}return c}function $b(a,b){return Yb(a,cf(a),b)}function _b(a,b){return function(c,e){var f=Nf(c)?d:Ya,g=b?b():{};return f(c,a,wc(e),g)}}function ac(a){return jd(function(b,c){var d=-1,e=c.length,f=e>1?c[e-1]:Q,g=e>2?c[2]:Q,f="function"==typeof f?(e--,f):Q;for(g&&Fc(c[0],c[1],g)&&(f=3>e?Q:f,e=1),b=Object(b);++d<e;)(g=c[d])&&a(b,g,d,f);return b})}function bc(a,b){return function(c,d){if(null==c)return c;if(!nd(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=Object(c);(b?f--:++f<e)&&!1!==d(g[f],f,g););return c}}function cc(a){return function(b,c,d){var e=-1,f=Object(b);d=d(b);for(var g=d.length;g--;){var h=d[a?g:++e];if(!1===c(f[h],h,f))break}return b}}function dc(a,b,c){function d(){return(this&&this!==Va&&this instanceof d?f:a).apply(e?c:this,arguments)}var e=1&b,f=gc(a);return d}function ec(a){return function(b){b=Id(b);var c=Aa.test(b)?b.match(za):Q,d=c?c[0]:b.charAt(0);return b=c?c.slice(1).join(""):b.slice(1),d[a]()+b}}function fc(a){return function(b){return l(Td(Rd(b)),a,"")}}function gc(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=Ve(a.prototype),b=a.apply(c,b);return td(b)?b:c}}function hc(a,b,d){function e(){for(var g=arguments.length,h=g,i=Array(g),j=this&&this!==Va&&this instanceof e?f:a,k=ra.placeholder||e.placeholder;h--;)i[h]=arguments[h];return h=3>g&&i[0]!==k&&i[g-1]!==k?[]:L(i,k),g-=h.length,d>g?pc(a,b,jc,k,Q,i,h,Q,Q,d-g):c(j,this,i)}var f=gc(a);return e}function ic(a){return jd(function(b){b=gb(b);var c=b.length,d=c,e=wa.prototype.thru;for(a&&b.reverse();d--;){var f=b[d];if("function"!=typeof f)throw new de("Expected a function");if(e&&!g&&"wrapper"==vc(f))var g=new wa([],!0)}for(d=g?d:c;++d<c;)var f=b[d],e=vc(f),h="wrapper"==e?af(f):Q,g=h&&Ic(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?g[vc(h[0])].apply(g,h[3]):1==f.length&&Ic(f)?g[e]():g.thru(f);return function(){var a=arguments,d=a[0];if(g&&1==a.length&&Nf(d)&&d.length>=200)return g.plant(d).value();for(var e=0,a=c?b[e].apply(this,a):d;++e<c;)a=b[e].call(this,a);return a}})}function jc(a,b,c,d,e,f,g,h,i,j){function k(){for(var s=arguments.length,t=s,u=Array(s);t--;)u[t]=arguments[t];if(d&&(u=Vb(u,d,e)),f&&(u=Wb(u,f,g)),o||p){var t=ra.placeholder||k.placeholder,v=L(u,t),s=s-v.length;if(j>s)return pc(a,b,jc,t,c,u,v,h,i,j-s)}if(s=m?c:this,t=n?s[a]:a,h)for(var v=u.length,w=Fe(h.length,v),x=Xb(u);w--;){var y=h[w];u[w]=I(y,v)?x[y]:Q}else q&&u.length>1&&u.reverse();return l&&u.length>i&&(u.length=i),this&&this!==Va&&this instanceof k&&(t=r||gc(t)),t.apply(s,u)}var l=128&b,m=1&b,n=2&b,o=8&b,p=16&b,q=512&b,r=n?Q:gc(a);return k}function kc(a,b){return function(c,d){return pb(c,a,b(d),{})}}function lc(a){return jd(function(b){return b=j(gb(b),wc()),jd(function(d){var e=this;return a(b,function(a){return c(a,e,d)})})})}function mc(a,b,c){return b=Ed(b),a=N(a),b&&b>a?(b-=a,c=c===Q?" ":c+"",a=Sd(c,ze(b/N(c))),Aa.test(c)?a.match(za).slice(0,b).join(""):a.slice(0,b)):""}function nc(a,b,d,e){function f(){for(var b=-1,i=arguments.length,j=-1,k=e.length,l=Array(k+i),m=this&&this!==Va&&this instanceof f?h:a;++j<k;)l[j]=e[j];for(;i--;)l[j++]=arguments[++b];return c(m,g?d:this,l)}var g=1&b,h=gc(a);return f}function oc(a){return function(b,c,d){d&&"number"!=typeof d&&Fc(b,c,d)&&(c=d=Q),b=Gd(b),b=b===b?b:0,c===Q?(c=b,b=0):c=Gd(c)||0,d=d===Q?c>b?1:-1:Gd(d)||0;var e=-1;c=Ee(ze((c-b)/(d||1)),0);for(var f=Array(c);c--;)f[a?c:++e]=b,b+=d;return f}}function pc(a,b,c,d,e,f,g,h,i,j){var k=8&b;h=h?Xb(h):Q;var l=k?g:Q;g=k?Q:g;var m=k?f:Q;return f=k?Q:f,b=(b|(k?32:64))&~(k?64:32),4&b||(b&=-4),b=[a,b,e,m,l,f,g,h,i,j],c=c.apply(Q,b),Ic(a)&&df(c,b),c.placeholder=d,c}function qc(a){var b=be[a];return function(a,c){if(a=Gd(a),c=Ed(c)){var d=(Id(a)+"e").split("e"),d=b(d[0]+"e"+(+d[1]+c)),d=(Id(d)+"e").split("e");return+(d[0]+"e"+(+d[1]-c))}return b(a)}}function rc(a,b,c,d,e,f,g,h){var i=2&b;if(!i&&"function"!=typeof a)throw new de("Expected a function");var j=d?d.length:0;if(j||(b&=-97,d=e=Q),g=g===Q?g:Ee(Ed(g),0),h=h===Q?h:Ed(h),j-=e?e.length:0,64&b){var k=d,l=e;d=e=Q}var m=i?Q:af(a);return f=[a,b,c,d,e,k,l,f,g,h],m&&(c=f[1],a=m[1],b=c|a,d=128==a&&8==c||128==a&&256==c&&m[8]>=f[7].length||384==a&&m[8]>=m[7].length&&8==c,131>b||d)&&(1&a&&(f[2]=m[2],b|=1&c?0:4),(c=m[3])&&(d=f[3],f[3]=d?Vb(d,c,m[4]):Xb(c),f[4]=d?L(f[3],"__lodash_placeholder__"):Xb(m[4])),(c=m[5])&&(d=f[5],f[5]=d?Wb(d,c,m[6]):Xb(c),f[6]=d?L(f[5],"__lodash_placeholder__"):Xb(m[6])),(c=m[7])&&(f[7]=Xb(c)),128&a&&(f[8]=null==f[8]?m[8]:Fe(f[8],m[8])),null==f[9]&&(f[9]=m[9]),f[0]=m[0],f[1]=b),a=f[0],b=f[1],c=f[2],d=f[3],e=f[4],h=f[9]=null==f[9]?i?0:a.length:Ee(f[9]-j,0),!h&&24&b&&(b&=-25),i=b&&1!=b?8==b||16==b?hc(a,b,h):32!=b&&33!=b||e.length?jc.apply(Q,f):nc(a,b,c,d):dc(a,b,c),(m?$e:df)(i,f)}function sc(a,b,c,d,e,f){var g=-1,h=2&e,i=1&e,j=a.length,k=b.length;if(!(j==k||h&&k>j))return!1;if(k=f.get(a))return k==b;for(k=!0,f.set(a,b);++g<j;){var l=a[g],m=b[g];if(d)var o=h?d(m,l,g,b,a,f):d(l,m,g,a,b,f);if(o!==Q){if(o)continue;k=!1;break}if(i){if(!n(b,function(a){return l===a||c(l,a,d,e,f)})){k=!1;break}}else if(l!==m&&!c(l,m,d,e,f)){k=!1;break}}return f.delete(a),k}function tc(a,b,c,d,e,f){switch(c){case"[object ArrayBuffer]":if(a.byteLength!=b.byteLength||!d(new qe(a),new qe(b)))break;return!0;case"[object Boolean]":case"[object Date]":return+a==+b;case"[object Error]":return a.name==b.name&&a.message==b.message;case"[object Number]":return a!=+a?b!=+b:a==+b;case"[object RegExp]":case"[object String]":return a==b+"";case"[object Map]":var g=K;case"[object Set]":return g||(g=M),(2&f||a.size==b.size)&&d(g(a),g(b),e,1|f);case"[object Symbol]":return!!pe&&Se.call(a)==Se.call(b)}return!1}function uc(a,b,c,d,e,f){var g=2&e,h=Md(a),i=h.length,j=Md(b).length;if(i!=j&&!g)return!1;for(var k=i;k--;){var l=h[k];if(!(g?l in b:mb(b,l)))return!1}if(j=f.get(a))return j==b;j=!0,f.set(a,b);for(var m=g;++k<i;){var l=h[k],n=a[l],o=b[l];if(d)var p=g?d(o,n,l,b,a,f):d(n,o,l,a,b,f);if(p===Q?n!==o&&!c(n,o,d,e,f):!p){j=!1;break}m||(m="constructor"==l)}return j&&!m&&(c=a.constructor,d=b.constructor,c!=d&&"constructor"in a&&"constructor"in b&&!("function"==typeof c&&c instanceof c&&"function"==typeof d&&d instanceof d)&&(j=!1)),f.delete(a),j}function vc(a){for(var b=a.name+"",c=Ue[b],d=he.call(Ue,b)?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function wc(){var a=ra.iteratee||Wd,a=a===Wd?tb:a;return arguments.length?a(arguments[0],arguments[1]):a}function xc(a){a=Od(a);for(var b=a.length;b--;){var c,d=a[b];c=a[b][1],c=c===c&&!td(c),d[2]=c}return a}function yc(a,b){var c=null==a?Q:a[b];return vd(c)?c:Q}function zc(a){return ke.call(a)}function Ac(a,b,c){if(null==a)return!1;var d=c(a,b);return d||Gc(b)||(b=Nb(b),a=Lc(a,b),null!=a&&(b=Tc(b),d=c(a,b))),c=a?a.length:Q,d||!!c&&sd(c)&&I(b,c)&&(Nf(a)||zd(a)||md(a))}function Bc(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&he.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function Cc(a){return Jc(a)?{}:(a=a.constructor,Ve(qd(a)?a.prototype:Q))}function Dc(c,d,e){var f=c.constructor;switch(d){case"[object ArrayBuffer]":return Ub(c);case"[object Boolean]":case"[object Date]":return new f(+c);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return d=c.buffer,new c.constructor(e?Ub(d):d,c.byteOffset,c.length);case"[object Map]":return e=c.constructor,l(K(c),a,new e);case"[object Number]":case"[object String]":return new f(c);case"[object RegExp]":return e=new c.constructor(c.source,la.exec(c)),e.lastIndex=c.lastIndex,e;case"[object Set]":return e=c.constructor,l(M(c),b,new e);case"[object Symbol]":return pe?Object(Se.call(c)):{}}}function Ec(a){var b=a?a.length:Q;return sd(b)&&(Nf(a)||zd(a)||md(a))?v(b,String):null}function Fc(a,b,c){if(!td(c))return!1;var d=typeof b;return("number"==d?nd(c)&&I(b,c.length):"string"==d&&b in c)?kd(c[b],a):!1}function Gc(a,b){return"number"==typeof a?!0:!Nf(a)&&(ca.test(a)||!ba.test(a)||null!=b&&a in Object(b))}function Hc(a){var b=typeof a;return"number"==b||"boolean"==b||"string"==b&&"__proto__"!==a||null==a}function Ic(a){var b=vc(a),c=ra[b];return"function"==typeof c&&b in xa.prototype?a===c?!0:(b=af(c),!!b&&a===b[0]):!1}function Jc(a){var b=a&&a.constructor;return a===("function"==typeof b&&b.prototype||fe)}function Kc(a,b,c,d,e,f){return td(a)&&td(b)&&(f.set(b,a),yb(a,b,Q,Kc,f)),a}function Lc(a,b){return 1==b.length?a:Jd(a,Ib(b,0,-1))}function Mc(a){var b=[];return Id(a).replace(da,function(a,c,d,e){b.push(d?e.replace(ja,"$1"):c||a)}),b}function Nc(a){return od(a)?a:[]}function Oc(a){return"function"==typeof a?a:Vd}function Pc(a){if(a instanceof xa)return a.clone();var b=new wa(a.__wrapped__,a.__chain__);return b.__actions__=Xb(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function Qc(a,b,c){var d=a?a.length:0;return d?(b=c||b===Q?1:Ed(b),Ib(a,0>b?0:b,d)):[]}function Rc(a,b,c){var d=a?a.length:0;return d?(b=c||b===Q?1:Ed(b),b=d-b,Ib(a,0,0>b?0:b)):[]}function Sc(a){return a?a[0]:Q}function Tc(a){var b=a?a.length:0;return b?a[b-1]:Q}function Uc(a,b){return a&&a.length&&b&&b.length?Eb(a,b):a}function Vc(a){return a?Ie.call(a):a}function Wc(a){if(!a||!a.length)return[];var b=0;return a=g(a,function(a){return od(a)?(b=Ee(a.length,b),!0):void 0}),v(b,function(b){return j(a,Cb(b))})}function Xc(a,b){if(!a||!a.length)return[];var d=Wc(a);return null==b?d:j(d,function(a){return c(b,Q,a)})}function Yc(a){return a=ra(a),a.__chain__=!0,a}function Zc(a,b){return b(a)}function $c(){return this}function _c(a,b){return"function"==typeof b&&Nf(a)?e(a,b):We(a,Oc(b))}function ad(a,b){var c;if("function"==typeof b&&Nf(a)){for(c=a.length;c--&&!1!==b(a[c],c,a););c=a}else c=Xe(a,Oc(b));return c}function bd(a,b){return(Nf(a)?j:vb)(a,wc(b,3))}function cd(a,b){var c=-1,d=Dd(a),e=d.length,f=e-1;for(b=_a(Ed(b),0,e);++c<b;){var e=Gb(c,f),g=d[e];d[e]=d[c],d[c]=g}return d.length=b,d}function dd(a,b,c){return b=c?Q:b,b=a&&null==b?a.length:b,rc(a,128,Q,Q,Q,Q,b)}function ed(a,b){var c;if("function"!=typeof b)throw new de("Expected a function");return a=Ed(a),function(){return 0<--a&&(c=b.apply(this,arguments)),1>=a&&(b=Q),c}}function fd(a,b,c){return b=c?Q:b,a=rc(a,8,Q,Q,Q,Q,Q,b),a.placeholder=ra.placeholder||fd.placeholder,a}function gd(a,b,c){return b=c?Q:b,a=rc(a,16,Q,Q,Q,Q,Q,b),a.placeholder=ra.placeholder||gd.placeholder,a}function hd(a,b,c){function d(){n&&re(n),j&&re(j),p=0,i=j=m=n=o=Q}function e(b,c){c&&re(c),j=n=o=Q,b&&(p=Ef(),k=a.apply(m,i),n||j||(i=m=Q))}function f(){var a=b-(Ef()-l);0>=a||a>b?e(o,j):n=xe(f,a)}function g(){e(s,n)}function h(){if(i=arguments,l=Ef(),m=this,o=s&&(n||!q),!1===r)var c=q&&!n;else{p||j||q||(p=l);var d=r-(l-p),e=0>=d||d>r;e?(j&&(j=re(j)),p=l,k=a.apply(m,i)):j||(j=xe(g,d))}return e&&n?n=re(n):n||b===r||(n=xe(f,b)),c&&(e=!0,k=a.apply(m,i)),!e||n||j||(i=m=Q),k}var i,j,k,l,m,n,o,p=0,q=!1,r=!1,s=!0;if("function"!=typeof a)throw new de("Expected a function");return b=Gd(b)||0,td(c)&&(q=!!c.leading,r="maxWait"in c&&Ee(Gd(c.maxWait)||0,b),s="trailing"in c?!!c.trailing:s),h.cancel=d,h.flush=function(){return(n&&o||j&&s)&&(k=a.apply(m,i)),d(),k},h}function id(a,b){if("function"!=typeof a||b&&"function"!=typeof b)throw new de("Expected a function");var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;return f.has(e)?f.get(e):(d=a.apply(this,d),c.cache=f.set(e,d),d)};return c.cache=new id.Cache,c}function jd(a,b){if("function"!=typeof a)throw new de("Expected a function");return b=Ee(b===Q?a.length-1:Ed(b),0),function(){for(var d=arguments,e=-1,f=Ee(d.length-b,0),g=Array(f);++e<f;)g[e]=d[b+e];switch(b){case 0:return a.call(this,g);case 1:return a.call(this,d[0],g);case 2:return a.call(this,d[0],d[1],g)}for(f=Array(b+1),e=-1;++e<b;)f[e]=d[e];return f[b]=g,c(a,this,f)}}function kd(a,b){return a===b||a!==a&&b!==b}function ld(a,b){return a>b}function md(a){return od(a)&&he.call(a,"callee")&&(!we.call(a,"callee")||"[object Arguments]"==ke.call(a))}function nd(a){return null!=a&&!("function"==typeof a&&qd(a))&&sd(bf(a))}function od(a){return ud(a)&&nd(a)}function pd(a){return ud(a)&&"string"==typeof a.message&&"[object Error]"==ke.call(a)}function qd(a){return a=td(a)?ke.call(a):"","[object Function]"==a||"[object GeneratorFunction]"==a}function rd(a){return"number"==typeof a&&a==Ed(a)}function sd(a){return"number"==typeof a&&a>-1&&0==a%1&&9007199254740991>=a}function td(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function ud(a){return!!a&&"object"==typeof a}function vd(a){return null==a?!1:qd(a)?me.test(ge.call(a)):ud(a)&&(H(a)?me:pa).test(a)}function wd(a){return"number"==typeof a||ud(a)&&"[object Number]"==ke.call(a)}function xd(a){if(!ud(a)||"[object Object]"!=ke.call(a)||H(a))return!1;var b=fe;return"function"==typeof a.constructor&&(b=te(a)),null===b?!0:(a=b.constructor,"function"==typeof a&&a instanceof a&&ge.call(a)==je)}function yd(a){return td(a)&&"[object RegExp]"==ke.call(a)}function zd(a){return"string"==typeof a||!Nf(a)&&ud(a)&&"[object String]"==ke.call(a)}function Ad(a){return"symbol"==typeof a||ud(a)&&"[object Symbol]"==ke.call(a)}function Bd(a){return ud(a)&&sd(a.length)&&!!Fa[ke.call(a)]}function Cd(a,b){return b>a}function Dd(a){if(!a)return[];if(nd(a))return zd(a)?a.match(za):Xb(a);if(ve&&a[ve])return J(a[ve]());var b=zc(a);return("[object Map]"==b?K:"[object Set]"==b?M:Pd)(a)}function Ed(a){if(!a)return 0===a?a:0;if(a=Gd(a),a===R||a===-R)return 1.7976931348623157e308*(0>a?-1:1);var b=a%1;return a===a?b?a-b:a:0}function Fd(a){return a?_a(Ed(a),0,4294967295):0}function Gd(a){if(td(a)&&(a=qd(a.valueOf)?a.valueOf():a,a=td(a)?a+"":a),"string"!=typeof a)return 0===a?a:+a;a=a.replace(ga,"");var b=oa.test(a);return b||qa.test(a)?Na(a.slice(2),b?2:8):na.test(a)?S:+a}function Hd(a){return Yb(a,Nd(a))}function Id(a){if("string"==typeof a)return a;if(null==a)return"";if(Ad(a))return pe?Te.call(a):"";var b=a+"";return"0"==b&&1/a==-R?"-0":b}function Jd(a,b,c){return a=null==a?Q:lb(a,b),a===Q?c:a}function Kd(a,b){return Ac(a,b,mb)}function Ld(a,b){return Ac(a,b,nb)}function Md(a){var b=Jc(a);if(!b&&!nd(a))return De(Object(a));var c,d=Ec(a),e=!!d,d=d||[],f=d.length;for(c in a)!mb(a,c)||e&&("length"==c||I(c,f))||b&&"constructor"==c||d.push(c);return d}function Nd(a){for(var b=-1,c=Jc(a),d=ub(a),e=d.length,f=Ec(a),g=!!f,f=f||[],h=f.length;++b<e;){var i=d[b];g&&("length"==i||I(i,h))||"constructor"==i&&(c||!he.call(a,i))||f.push(i)}return f}function Od(a){return w(a,Md(a))}function Pd(a){return a?y(a,Md(a)):[]}function Qd(a){return fg(Id(a).toLowerCase())}function Rd(a){return(a=Id(a))&&a.replace(sa,D).replace(ya,"")}function Sd(a,b){a=Id(a),b=Ed(b);var c="";if(!a||1>b||b>9007199254740991)return c;do b%2&&(c+=a),b=Ae(b/2),a+=a;while(b);return c}function Td(a,b,c){return a=Id(a),b=c?Q:b,b===Q&&(b=Da.test(a)?Ca:Ba),a.match(b)||[]}function Ud(a){return function(){return a}}function Vd(a){return a}function Wd(a){return tb("function"==typeof a?a:ab(a,!0))}function Xd(a,b,c){var d=Md(b),f=kb(b,d);null!=c||td(b)&&(f.length||!d.length)||(c=b,b=a,a=this,f=kb(b,Md(b)));var g=td(c)&&"chain"in c?c.chain:!0,h=qd(a);return e(f,function(c){var d=b[c];a[c]=d,h&&(a.prototype[c]=function(){var b=this.__chain__;if(g||b){var c=a(this.__wrapped__);return(c.__actions__=Xb(this.__actions__)).push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,k([this.value()],arguments))})}),a}function Yd(){}function Zd(a){return Gc(a)?Cb(a):Db(a)}function $d(a){return a&&a.length?u(a,Vd):0}B=B?Wa.defaults({},B,Wa.pick(Va,Ea)):Va;var _d=B.Date,ae=B.Error,be=B.Math,ce=B.RegExp,de=B.TypeError,ee=B.Array.prototype,fe=B.Object.prototype,ge=B.Function.prototype.toString,he=fe.hasOwnProperty,ie=0,je=ge.call(Object),ke=fe.toString,le=Va._,me=ce("^"+ge.call(he).replace(ea,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ne=Ta?B.Buffer:Q,oe=B.Reflect,pe=B.Symbol,qe=B.Uint8Array,re=B.clearTimeout,se=oe?oe.enumerate:Q,te=Object.getPrototypeOf,ue=Object.getOwnPropertySymbols,ve="symbol"==typeof(ve=pe&&pe.iterator)?ve:Q,we=fe.propertyIsEnumerable,xe=B.setTimeout,ye=ee.splice,ze=be.ceil,Ae=be.floor,Be=B.isFinite,Ce=ee.join,De=Object.keys,Ee=be.max,Fe=be.min,Ge=B.parseInt,He=be.random,Ie=ee.reverse,Je=yc(B,"Map"),Ke=yc(B,"Set"),Le=yc(B,"WeakMap"),Me=yc(Object,"create"),Ne=Le&&new Le,Oe=Je?ge.call(Je):"",Pe=Ke?ge.call(Ke):"",Qe=Le?ge.call(Le):"",Re=pe?pe.prototype:Q,Se=pe?Re.valueOf:Q,Te=pe?Re.toString:Q,Ue={};ra.templateSettings={escape:$,evaluate:_,interpolate:aa,variable:"",imports:{_:ra}};var Ve=function(){function a(){}return function(b){if(td(b)){a.prototype=b;var c=new a;a.prototype=Q}return c||{}}}(),We=bc(ib),Xe=bc(jb,!0),Ye=cc(),Ze=cc(!0);se&&!we.call({valueOf:1},"valueOf")&&(ub=function(a){return J(se(a))});var $e=Ne?function(a,b){return Ne.set(a,b),a}:Vd,_e=Ke&&2===new Ke([1,2]).size?function(a){return new Ke(a)}:Yd,af=Ne?function(a){return Ne.get(a)}:Yd,bf=Cb("length"),cf=ue||function(){return[]};(Je&&"[object Map]"!=zc(new Je)||Ke&&"[object Set]"!=zc(new Ke)||Le&&"[object WeakMap]"!=zc(new Le))&&(zc=function(a){var b=ke.call(a);if(a="[object Object]"==b?a.constructor:null,a="function"==typeof a?ge.call(a):"")switch(a){case Oe:return"[object Map]";case Pe:return"[object Set]";case Qe:return"[object WeakMap]"}return b});var df=function(){var a=0,b=0;return function(c,d){var e=Ef(),f=16-(e-b);if(b=e,f>0){if(150<=++a)return c}else a=0;return $e(c,d)}}(),ef=jd(function(a,b){Nf(a)||(a=null==a?[]:[Object(a)]),b=gb(b);for(var c=a,d=b,e=-1,f=c.length,g=-1,h=d.length,i=Array(f+h);++e<f;)i[e]=c[e];for(;++g<h;)i[e++]=d[g];return i}),ff=jd(function(a,b){return od(a)?db(a,gb(b,!1,!0)):[]}),gf=jd(function(a,b){var c=Tc(b);return od(c)&&(c=Q),od(a)?db(a,gb(b,!1,!0),wc(c)):[]}),hf=jd(function(a,b){var c=Tc(b);return od(c)&&(c=Q),od(a)?db(a,gb(b,!1,!0),Q,c):[]}),jf=jd(function(a){var b=j(a,Nc);return b.length&&b[0]===a[0]?ob(b):[]}),kf=jd(function(a){var b=Tc(a),c=j(a,Nc);return b===Tc(c)?b=Q:c.pop(),c.length&&c[0]===a[0]?ob(c,wc(b)):[]}),lf=jd(function(a){var b=Tc(a),c=j(a,Nc);return b===Tc(c)?b=Q:c.pop(),c.length&&c[0]===a[0]?ob(c,Q,b):[]}),mf=jd(Uc),nf=jd(function(a,b){b=j(gb(b),String);var c=$a(a,b);return Fb(a,b.sort(C)),c}),of=jd(function(a){return Ob(gb(a,!1,!0))}),pf=jd(function(a){var b=Tc(a);return od(b)&&(b=Q),Ob(gb(a,!1,!0),wc(b))}),qf=jd(function(a){var b=Tc(a);return od(b)&&(b=Q),Ob(gb(a,!1,!0),Q,b)}),rf=jd(function(a,b){return od(a)?db(a,b):[]}),sf=jd(function(a){return Rb(g(a,od))}),tf=jd(function(a){var b=Tc(a);return od(b)&&(b=Q),Rb(g(a,od),wc(b))}),uf=jd(function(a){var b=Tc(a);return od(b)&&(b=Q),Rb(g(a,od),Q,b)}),vf=jd(Wc),wf=jd(function(a){var b=a.length,b=b>1?a[b-1]:Q,b="function"==typeof b?(a.pop(),b):Q;return Xc(a,b)}),xf=jd(function(a){a=gb(a);var b=a.length,c=b?a[0]:0,d=this.__wrapped__,e=function(b){return $a(b,a)};return 1>=b&&!this.__actions__.length&&d instanceof xa&&I(c)?(d=d.slice(c,+c+(b?1:0)),d.__actions__.push({func:Zc,args:[e],thisArg:Q}),new wa(d,this.__chain__).thru(function(a){return b&&!a.length&&a.push(Q),a})):this.thru(e)}),yf=_b(function(a,b,c){he.call(a,c)?++a[c]:a[c]=1}),zf=_b(function(a,b,c){he.call(a,c)?a[c].push(b):a[c]=[b]}),Af=jd(function(a,b,d){var e=-1,f="function"==typeof b,g=Gc(b),h=nd(a)?Array(a.length):[];return We(a,function(a){var i=f?b:g&&null!=a?a[b]:Q;h[++e]=i?c(i,a,d):qb(a,b,d)}),h}),Bf=_b(function(a,b,c){a[c]=b}),Cf=_b(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),Df=jd(function(a,b){if(null==a)return[];var c=b.length;return c>1&&Fc(a,b[0],b[1])?b=[]:c>2&&Fc(b[0],b[1],b[2])&&(b.length=1),zb(a,gb(b),[])}),Ef=_d.now,Ff=jd(function(a,b,c){var d=1;if(c.length)var e=L(c,ra.placeholder||Ff.placeholder),d=32|d;return rc(a,d,b,c,e)}),Gf=jd(function(a,b,c){var d=3;if(c.length)var e=L(c,ra.placeholder||Gf.placeholder),d=32|d;return rc(b,d,a,c,e)}),Hf=jd(function(a,b){return cb(a,1,b)}),If=jd(function(a,b,c){return cb(a,Gd(b)||0,c)}),Jf=jd(function(a,b){b=j(gb(b),wc());var d=b.length;return jd(function(e){for(var f=-1,g=Fe(e.length,d);++f<g;)e[f]=b[f].call(this,e[f]);return c(a,this,e)})}),Kf=jd(function(a,b){var c=L(b,ra.placeholder||Kf.placeholder);return rc(a,32,Q,b,c)}),Lf=jd(function(a,b){var c=L(b,ra.placeholder||Lf.placeholder);return rc(a,64,Q,b,c)}),Mf=jd(function(a,b){return rc(a,256,Q,Q,Q,gb(b))}),Nf=Array.isArray,Of=ne?function(a){return a instanceof ne}:Ud(!1),Pf=ac(function(a,b){Yb(b,Md(b),a)}),Qf=ac(function(a,b){Yb(b,Nd(b),a)}),Rf=ac(function(a,b,c,d){Zb(b,Nd(b),a,d)}),Sf=ac(function(a,b,c,d){Zb(b,Md(b),a,d)}),Tf=jd(function(a,b){return $a(a,gb(b))}),Uf=jd(function(a){return a.push(Q,Sa),c(Rf,Q,a)}),Vf=jd(function(a){return a.push(Q,Kc),c($f,Q,a)}),Wf=kc(function(a,b,c){a[b]=c},Ud(Vd)),Xf=kc(function(a,b,c){he.call(a,b)?a[b].push(c):a[b]=[c]},wc),Yf=jd(qb),Zf=ac(function(a,b,c){yb(a,b,c)}),$f=ac(function(a,b,c,d){yb(a,b,c,d)}),_f=jd(function(a,b){return null==a?{}:(b=j(gb(b),String),Ab(a,db(Nd(a),b)))}),ag=jd(function(a,b){return null==a?{}:Ab(a,gb(b))}),bg=fc(function(a,b,c){return b=b.toLowerCase(),a+(c?Qd(b):b)}),cg=fc(function(a,b,c){return a+(c?"-":"")+b.toLowerCase()}),dg=fc(function(a,b,c){return a+(c?" ":"")+b.toLowerCase()}),eg=ec("toLowerCase"),fg=ec("toUpperCase"),gg=fc(function(a,b,c){return a+(c?"_":"")+b.toLowerCase()}),hg=fc(function(a,b,c){return a+(c?" ":"")+Qd(b)}),ig=fc(function(a,b,c){return a+(c?" ":"")+b.toUpperCase()}),jg=jd(function(a,b){try{return c(a,Q,b)}catch(a){return td(a)?a:new ae(a)}}),kg=jd(function(a,b){return e(gb(b),function(b){a[b]=Ff(a[b],a)}),a}),lg=ic(),mg=ic(!0),ng=jd(function(a,b){return function(c){return qb(c,a,b)}}),og=jd(function(a,b){return function(c){return qb(a,c,b)}}),pg=lc(j),qg=lc(f),rg=lc(n),sg=oc(),tg=oc(!0),ug=qc("ceil"),vg=qc("floor"),wg=qc("round");return ra.prototype=va.prototype,wa.prototype=Ve(va.prototype),wa.prototype.constructor=wa,xa.prototype=Ve(va.prototype),xa.prototype.constructor=xa,Ha.prototype=Me?Me(null):fe,Ia.prototype.clear=function(){this.__data__={hash:new Ha,map:Je?new Je:[],string:new Ha}},Ia.prototype.delete=function(a){var b=this.__data__;return Hc(a)?(b="string"==typeof a?b.string:b.hash,(Me?b[a]!==Q:he.call(b,a))&&delete b[a]):Je?b.map.delete(a):Oa(b.map,a)},Ia.prototype.get=function(a){var b=this.__data__;return Hc(a)?(b="string"==typeof a?b.string:b.hash,Me?(a=b[a],a="__lodash_hash_undefined__"===a?Q:a):a=he.call(b,a)?b[a]:Q,a):Je?b.map.get(a):Pa(b.map,a)},Ia.prototype.has=function(a){var b=this.__data__;return Hc(a)?(b="string"==typeof a?b.string:b.hash,a=Me?b[a]!==Q:he.call(b,a)):a=Je?b.map.has(a):-1<Qa(b.map,a),a},Ia.prototype.set=function(a,b){var c=this.__data__;return Hc(a)?("string"==typeof a?c.string:c.hash)[a]=Me&&b===Q?"__lodash_hash_undefined__":b:Je?c.map.set(a,b):Ra(c.map,a,b),this},Ja.prototype.push=function(a){var b=this.__data__;Hc(a)?(b=b.__data__,("string"==typeof a?b.string:b.hash)[a]="__lodash_hash_undefined__"):b.set(a,"__lodash_hash_undefined__")},La.prototype.clear=function(){this.__data__={array:[],map:null}},La.prototype.delete=function(a){var b=this.__data__,c=b.array;return c?Oa(c,a):b.map.delete(a)},La.prototype.get=function(a){var b=this.__data__,c=b.array;return c?Pa(c,a):b.map.get(a)},La.prototype.has=function(a){var b=this.__data__,c=b.array;return c?-1<Qa(c,a):b.map.has(a)},La.prototype.set=function(a,b){var c=this.__data__,d=c.array;return d&&(199>d.length?Ra(d,a,b):(c.array=null,c.map=new Ia(d))),(c=c.map)&&c.set(a,b),this},id.Cache=Ia,ra.after=function(a,b){if("function"!=typeof b)throw new de("Expected a function");
return a=Ed(a),function(){return 1>--a?b.apply(this,arguments):void 0}},ra.ary=dd,ra.assign=Pf,ra.assignIn=Qf,ra.assignInWith=Rf,ra.assignWith=Sf,ra.at=Tf,ra.before=ed,ra.bind=Ff,ra.bindAll=kg,ra.bindKey=Gf,ra.chain=Yc,ra.chunk=function(a,b){b=Ee(Ed(b),0);var c=a?a.length:0;if(!c||1>b)return[];for(var d=0,e=-1,f=Array(ze(c/b));c>d;)f[++e]=Ib(a,d,d+=b);return f},ra.compact=function(a){for(var b=-1,c=a?a.length:0,d=-1,e=[];++b<c;){var f=a[b];f&&(e[++d]=f)}return e},ra.concat=ef,ra.cond=function(a){var b=a?a.length:0,d=wc();return a=b?j(a,function(a){if("function"!=typeof a[1])throw new de("Expected a function");return[d(a[0]),a[1]]}):[],jd(function(d){for(var e=-1;++e<b;){var f=a[e];if(c(f[0],this,d))return c(f[1],this,d)}})},ra.conforms=function(a){return bb(ab(a,!0))},ra.constant=Ud,ra.countBy=yf,ra.create=function(a,b){var c=Ve(a);return b?Za(c,b):c},ra.curry=fd,ra.curryRight=gd,ra.debounce=hd,ra.defaults=Uf,ra.defaultsDeep=Vf,ra.defer=Hf,ra.delay=If,ra.difference=ff,ra.differenceBy=gf,ra.differenceWith=hf,ra.drop=Qc,ra.dropRight=Rc,ra.dropRightWhile=function(a,b){return a&&a.length?Pb(a,wc(b,3),!0,!0):[]},ra.dropWhile=function(a,b){return a&&a.length?Pb(a,wc(b,3),!0):[]},ra.fill=function(a,b,c,d){var e=a?a.length:0;if(!e)return[];for(c&&"number"!=typeof c&&Fc(a,b,c)&&(c=0,d=e),e=a.length,c=Ed(c),0>c&&(c=-c>e?0:e+c),d=d===Q||d>e?e:Ed(d),0>d&&(d+=e),d=c>d?0:Fd(d);d>c;)a[c++]=b;return a},ra.filter=function(a,b){return(Nf(a)?g:fb)(a,wc(b,3))},ra.flatMap=function(a,b){return gb(bd(a,b))},ra.flatten=function(a){return a&&a.length?gb(a):[]},ra.flattenDeep=function(a){return a&&a.length?gb(a,!0):[]},ra.flip=function(a){return rc(a,512)},ra.flow=lg,ra.flowRight=mg,ra.fromPairs=function(a){for(var b=-1,c=a?a.length:0,d={};++b<c;){var e=a[b];d[e[0]]=e[1]}return d},ra.functions=function(a){return null==a?[]:kb(a,Md(a))},ra.functionsIn=function(a){return null==a?[]:kb(a,Nd(a))},ra.groupBy=zf,ra.initial=function(a){return Rc(a,1)},ra.intersection=jf,ra.intersectionBy=kf,ra.intersectionWith=lf,ra.invert=Wf,ra.invertBy=Xf,ra.invokeMap=Af,ra.iteratee=Wd,ra.keyBy=Bf,ra.keys=Md,ra.keysIn=Nd,ra.map=bd,ra.mapKeys=function(a,b){var c={};return b=wc(b,3),ib(a,function(a,d,e){c[b(a,d,e)]=a}),c},ra.mapValues=function(a,b){var c={};return b=wc(b,3),ib(a,function(a,d,e){c[d]=b(a,d,e)}),c},ra.matches=function(a){return wb(ab(a,!0))},ra.matchesProperty=function(a,b){return xb(a,ab(b,!0))},ra.memoize=id,ra.merge=Zf,ra.mergeWith=$f,ra.method=ng,ra.methodOf=og,ra.mixin=Xd,ra.negate=function(a){if("function"!=typeof a)throw new de("Expected a function");return function(){return!a.apply(this,arguments)}},ra.nthArg=function(a){return a=Ed(a),function(){return arguments[a]}},ra.omit=_f,ra.omitBy=function(a,b){return b=wc(b,2),Bb(a,function(a,c){return!b(a,c)})},ra.once=function(a){return ed(2,a)},ra.orderBy=function(a,b,c,d){return null==a?[]:(Nf(b)||(b=null==b?[]:[b]),c=d?Q:c,Nf(c)||(c=null==c?[]:[c]),zb(a,b,c))},ra.over=pg,ra.overArgs=Jf,ra.overEvery=qg,ra.overSome=rg,ra.partial=Kf,ra.partialRight=Lf,ra.partition=Cf,ra.pick=ag,ra.pickBy=function(a,b){return null==a?{}:Bb(a,wc(b,2))},ra.property=Zd,ra.propertyOf=function(a){return function(b){return null==a?Q:lb(a,b)}},ra.pull=mf,ra.pullAll=Uc,ra.pullAllBy=function(a,b,c){return a&&a.length&&b&&b.length?Eb(a,b,wc(c)):a},ra.pullAt=nf,ra.range=sg,ra.rangeRight=tg,ra.rearg=Mf,ra.reject=function(a,b){var c=Nf(a)?g:fb;return b=wc(b,3),c(a,function(a,c,d){return!b(a,c,d)})},ra.remove=function(a,b){var c=[];if(!a||!a.length)return c;var d=-1,e=[],f=a.length;for(b=wc(b,3);++d<f;){var g=a[d];b(g,d,a)&&(c.push(g),e.push(d))}return Fb(a,e),c},ra.rest=jd,ra.reverse=Vc,ra.sampleSize=cd,ra.set=function(a,b,c){return null==a?a:Hb(a,b,c)},ra.setWith=function(a,b,c,d){return d="function"==typeof d?d:Q,null==a?a:Hb(a,b,c,d)},ra.shuffle=function(a){return cd(a,4294967295)},ra.slice=function(a,b,c){var d=a?a.length:0;return d?(c&&"number"!=typeof c&&Fc(a,b,c)?(b=0,c=d):(b=null==b?0:Ed(b),c=c===Q?d:Ed(c)),Ib(a,b,c)):[]},ra.sortBy=Df,ra.sortedUniq=function(a){return a&&a.length?Mb(a):[]},ra.sortedUniqBy=function(a,b){return a&&a.length?Mb(a,wc(b)):[]},ra.split=function(a,b,c){return Id(a).split(b,c)},ra.spread=function(a,b){if("function"!=typeof a)throw new de("Expected a function");return b=b===Q?0:Ee(Ed(b),0),jd(function(d){var e=d[b];return d=d.slice(0,b),e&&k(d,e),c(a,this,d)})},ra.tail=function(a){return Qc(a,1)},ra.take=function(a,b,c){return a&&a.length?(b=c||b===Q?1:Ed(b),Ib(a,0,0>b?0:b)):[]},ra.takeRight=function(a,b,c){var d=a?a.length:0;return d?(b=c||b===Q?1:Ed(b),b=d-b,Ib(a,0>b?0:b,d)):[]},ra.takeRightWhile=function(a,b){return a&&a.length?Pb(a,wc(b,3),!1,!0):[]},ra.takeWhile=function(a,b){return a&&a.length?Pb(a,wc(b,3)):[]},ra.tap=function(a,b){return b(a),a},ra.throttle=function(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new de("Expected a function");return td(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e),hd(a,b,{leading:d,maxWait:b,trailing:e})},ra.thru=Zc,ra.toArray=Dd,ra.toPairs=Od,ra.toPairsIn=function(a){return w(a,Nd(a))},ra.toPath=function(a){return Nf(a)?j(a,String):Mc(a)},ra.toPlainObject=Hd,ra.transform=function(a,b,c){var d=Nf(a)||Bd(a);if(b=wc(b,4),null==c)if(d||td(a)){var f=a.constructor;c=d?Nf(a)?new f:[]:Ve(qd(f)?f.prototype:Q)}else c={};return(d?e:ib)(a,function(a,d,e){return b(c,a,d,e)}),c},ra.unary=function(a){return dd(a,1)},ra.union=of,ra.unionBy=pf,ra.unionWith=qf,ra.uniq=function(a){return a&&a.length?Ob(a):[]},ra.uniqBy=function(a,b){return a&&a.length?Ob(a,wc(b)):[]},ra.uniqWith=function(a,b){return a&&a.length?Ob(a,Q,b):[]},ra.unset=function(a,b){var c;if(null==a)c=!0;else{c=a;var d=b,d=Gc(d,c)?[d+""]:Nb(d);c=Lc(c,d),d=Tc(d),c=null!=c&&Kd(c,d)?delete c[d]:!0}return c},ra.unzip=Wc,ra.unzipWith=Xc,ra.values=Pd,ra.valuesIn=function(a){return null==a?y(a,Nd(a)):[]},ra.without=rf,ra.words=Td,ra.wrap=function(a,b){return b=null==b?Vd:b,Kf(b,a)},ra.xor=sf,ra.xorBy=tf,ra.xorWith=uf,ra.zip=vf,ra.zipObject=function(a,b){return Sb(a||[],b||[],Xa)},ra.zipObjectDeep=function(a,b){return Sb(a||[],b||[],Hb)},ra.zipWith=wf,ra.extend=Qf,ra.extendWith=Rf,Xd(ra,ra),ra.add=function(a,b){var c;return a===Q&&b===Q?0:(a!==Q&&(c=a),b!==Q&&(c=c===Q?b:c+b),c)},ra.attempt=jg,ra.camelCase=bg,ra.capitalize=Qd,ra.ceil=ug,ra.clamp=function(a,b,c){return c===Q&&(c=b,b=Q),c!==Q&&(c=Gd(c),c=c===c?c:0),b!==Q&&(b=Gd(b),b=b===b?b:0),_a(Gd(a),b,c)},ra.clone=function(a){return ab(a)},ra.cloneDeep=function(a){return ab(a,!0)},ra.cloneDeepWith=function(a,b){return ab(a,!0,b)},ra.cloneWith=function(a,b){return ab(a,!1,b)},ra.deburr=Rd,ra.endsWith=function(a,b,c){a=Id(a),b="string"==typeof b?b:b+"";var d=a.length;return c=c===Q?d:_a(Ed(c),0,d),c-=b.length,c>=0&&a.indexOf(b,c)==c},ra.eq=kd,ra.escape=function(a){return(a=Id(a))&&Z.test(a)?a.replace(X,E):a},ra.escapeRegExp=function(a){return(a=Id(a))&&fa.test(a)?a.replace(ea,"\\$&"):a},ra.every=function(a,b,c){var d=Nf(a)?f:eb;return c&&Fc(a,b,c)&&(b=Q),d(a,wc(b,3))},ra.find=function(a,b){if(b=wc(b,3),Nf(a)){var c=q(a,b);return c>-1?a[c]:Q}return p(a,b,We)},ra.findIndex=function(a,b){return a&&a.length?q(a,wc(b,3)):-1},ra.findKey=function(a,b){return p(a,wc(b,3),ib,!0)},ra.findLast=function(a,b){if(b=wc(b,3),Nf(a)){var c=q(a,b,!0);return c>-1?a[c]:Q}return p(a,b,Xe)},ra.findLastIndex=function(a,b){return a&&a.length?q(a,wc(b,3),!0):-1},ra.findLastKey=function(a,b){return p(a,wc(b,3),jb,!0)},ra.floor=vg,ra.forEach=_c,ra.forEachRight=ad,ra.forIn=function(a,b){return null==a?a:Ye(a,Oc(b),Nd)},ra.forInRight=function(a,b){return null==a?a:Ze(a,Oc(b),Nd)},ra.forOwn=function(a,b){return a&&ib(a,Oc(b))},ra.forOwnRight=function(a,b){return a&&jb(a,Oc(b))},ra.get=Jd,ra.gt=ld,ra.gte=function(a,b){return a>=b},ra.has=Kd,ra.hasIn=Ld,ra.head=Sc,ra.identity=Vd,ra.includes=function(a,b,c,d){return a=nd(a)?a:Pd(a),c=c&&!d?Ed(c):0,d=a.length,0>c&&(c=Ee(d+c,0)),zd(a)?d>=c&&-1<a.indexOf(b,c):!!d&&-1<r(a,b,c)},ra.indexOf=function(a,b,c){var d=a?a.length:0;return d?(c=Ed(c),0>c&&(c=Ee(d+c,0)),r(a,b,c)):-1},ra.inRange=function(a,b,c){return b=Gd(b)||0,c===Q?(c=b,b=0):c=Gd(c)||0,a=Gd(a),a>=Fe(b,c)&&a<Ee(b,c)},ra.invoke=Yf,ra.isArguments=md,ra.isArray=Nf,ra.isArrayBuffer=function(a){return ud(a)&&"[object ArrayBuffer]"==ke.call(a)},ra.isArrayLike=nd,ra.isArrayLikeObject=od,ra.isBoolean=function(a){return!0===a||!1===a||ud(a)&&"[object Boolean]"==ke.call(a)},ra.isBuffer=Of,ra.isDate=function(a){return ud(a)&&"[object Date]"==ke.call(a)},ra.isElement=function(a){return!!a&&1===a.nodeType&&ud(a)&&!xd(a)},ra.isEmpty=function(a){if(nd(a)&&(Nf(a)||zd(a)||qd(a.splice)||md(a)))return!a.length;for(var b in a)if(he.call(a,b))return!1;return!0},ra.isEqual=function(a,b){return rb(a,b)},ra.isEqualWith=function(a,b,c){var d=(c="function"==typeof c?c:Q)?c(a,b):Q;return d===Q?rb(a,b,c):!!d},ra.isError=pd,ra.isFinite=function(a){return"number"==typeof a&&Be(a)},ra.isFunction=qd,ra.isInteger=rd,ra.isLength=sd,ra.isMap=function(a){return ud(a)&&"[object Map]"==zc(a)},ra.isMatch=function(a,b){return a===b||sb(a,b,xc(b))},ra.isMatchWith=function(a,b,c){return c="function"==typeof c?c:Q,sb(a,b,xc(b),c)},ra.isNaN=function(a){return wd(a)&&a!=+a},ra.isNative=vd,ra.isNil=function(a){return null==a},ra.isNull=function(a){return null===a},ra.isNumber=wd,ra.isObject=td,ra.isObjectLike=ud,ra.isPlainObject=xd,ra.isRegExp=yd,ra.isSafeInteger=function(a){return rd(a)&&a>=-9007199254740991&&9007199254740991>=a},ra.isSet=function(a){return ud(a)&&"[object Set]"==zc(a)},ra.isString=zd,ra.isSymbol=Ad,ra.isTypedArray=Bd,ra.isUndefined=function(a){return a===Q},ra.isWeakMap=function(a){return ud(a)&&"[object WeakMap]"==zc(a)},ra.isWeakSet=function(a){return ud(a)&&"[object WeakSet]"==ke.call(a)},ra.join=function(a,b){return a?Ce.call(a,b):""},ra.kebabCase=cg,ra.last=Tc,ra.lastIndexOf=function(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=d;if(c!==Q&&(e=Ed(c),e=(0>e?Ee(d+e,0):Fe(e,d-1))+1),b!==b)return G(a,e,!0);for(;e--;)if(a[e]===b)return e;return-1},ra.lowerCase=dg,ra.lowerFirst=eg,ra.lt=Cd,ra.lte=function(a,b){return b>=a},ra.max=function(a){return a&&a.length?o(a,Vd,ld):Q},ra.maxBy=function(a,b){return a&&a.length?o(a,wc(b),ld):Q},ra.mean=function(a){return $d(a)/(a?a.length:0)},ra.min=function(a){return a&&a.length?o(a,Vd,Cd):Q},ra.minBy=function(a,b){return a&&a.length?o(a,wc(b),Cd):Q},ra.noConflict=function(){return Va._===this&&(Va._=le),this},ra.noop=Yd,ra.now=Ef,ra.pad=function(a,b,c){a=Id(a),b=Ed(b);var d=N(a);return b&&b>d?(d=(b-d)/2,b=Ae(d),d=ze(d),mc("",b,c)+a+mc("",d,c)):a},ra.padEnd=function(a,b,c){return a=Id(a),a+mc(a,b,c)},ra.padStart=function(a,b,c){return a=Id(a),mc(a,b,c)+a},ra.parseInt=function(a,b,c){return c||null==b?b=0:b&&(b=+b),a=Id(a).replace(ga,""),Ge(a,b||(ma.test(a)?16:10))},ra.random=function(a,b,c){if(c&&"boolean"!=typeof c&&Fc(a,b,c)&&(b=c=Q),c===Q&&("boolean"==typeof b?(c=b,b=Q):"boolean"==typeof a&&(c=a,a=Q)),a===Q&&b===Q?(a=0,b=1):(a=Gd(a)||0,b===Q?(b=a,a=0):b=Gd(b)||0),a>b){var d=a;a=b,b=d}return c||a%1||b%1?(c=He(),Fe(a+c*(b-a+Ma("1e-"+((c+"").length-1))),b)):Gb(a,b)},ra.reduce=function(a,b,c){var d=Nf(a)?l:s,e=3>arguments.length;return d(a,wc(b,4),c,e,We)},ra.reduceRight=function(a,b,c){var d=Nf(a)?m:s,e=3>arguments.length;return d(a,wc(b,4),c,e,Xe)},ra.repeat=Sd,ra.replace=function(){var a=arguments,b=Id(a[0]);return 3>a.length?b:b.replace(a[1],a[2])},ra.result=function(a,b,c){if(Gc(b,a))d=null==a?Q:a[b];else{b=Nb(b);var d=Jd(a,b);a=Lc(a,b)}return d===Q&&(d=c),qd(d)?d.call(a):d},ra.round=wg,ra.runInContext=P,ra.sample=function(a){a=nd(a)?a:Pd(a);var b=a.length;return b>0?a[Gb(0,b-1)]:Q},ra.size=function(a){if(null==a)return 0;if(nd(a)){var b=a.length;return b&&zd(a)?N(a):b}return Md(a).length},ra.snakeCase=gg,ra.some=function(a,b,c){var d=Nf(a)?n:Jb;return c&&Fc(a,b,c)&&(b=Q),d(a,wc(b,3))},ra.sortedIndex=function(a,b){return Kb(a,b)},ra.sortedIndexBy=function(a,b,c){return Lb(a,b,wc(c))},ra.sortedIndexOf=function(a,b){var c=a?a.length:0;if(c){var d=Kb(a,b);if(c>d&&kd(a[d],b))return d}return-1},ra.sortedLastIndex=function(a,b){return Kb(a,b,!0)},ra.sortedLastIndexBy=function(a,b,c){return Lb(a,b,wc(c),!0)},ra.sortedLastIndexOf=function(a,b){if(a&&a.length){var c=Kb(a,b,!0)-1;if(kd(a[c],b))return c}return-1},ra.startCase=hg,ra.startsWith=function(a,b,c){return a=Id(a),c=_a(Ed(c),0,a.length),a.lastIndexOf(b,c)==c},ra.subtract=function(a,b){var c;return a===Q&&b===Q?0:(a!==Q&&(c=a),b!==Q&&(c=c===Q?b:c-b),c)},ra.sum=$d,ra.sumBy=function(a,b){return a&&a.length?u(a,wc(b)):0},ra.template=function(a,b,c){var d=ra.templateSettings;c&&Fc(a,b,c)&&(b=Q),a=Id(a),b=Rf({},b,d,Sa),c=Rf({},b.imports,d.imports,Sa);var e,f,g=Md(c),h=y(c,g),i=0;c=b.interpolate||ta;var j="__p+='";c=ce((b.escape||ta).source+"|"+c.source+"|"+(c===aa?ka:ta).source+"|"+(b.evaluate||ta).source+"|$","g");var k="sourceURL"in b?"//# sourceURL="+b.sourceURL+"\n":"";if(a.replace(c,function(b,c,d,g,h,k){return d||(d=g),j+=a.slice(i,k).replace(ua,F),c&&(e=!0,j+="'+__e("+c+")+'"),h&&(f=!0,j+="';"+h+";\n__p+='"),d&&(j+="'+((__t=("+d+"))==null?'':__t)+'"),i=k+b.length,b}),j+="';",(b=b.variable)||(j="with(obj){"+j+"}"),j=(f?j.replace(T,""):j).replace(U,"$1").replace(V,"$1;"),j="function("+(b||"obj")+"){"+(b?"":"obj||(obj={});")+"var __t,__p=''"+(e?",__e=_.escape":"")+(f?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+j+"return __p}",b=jg(function(){return Function(g,k+"return "+j).apply(Q,h)}),b.source=j,pd(b))throw b;return b},ra.times=function(a,b){if(a=Ed(a),1>a||a>9007199254740991)return[];var c=4294967295,d=Fe(a,4294967295);for(b=Oc(b),a-=4294967295,d=v(d,b);++c<a;)b(c);return d},ra.toInteger=Ed,ra.toLength=Fd,ra.toLower=function(a){return Id(a).toLowerCase()},ra.toNumber=Gd,ra.toSafeInteger=function(a){return _a(Ed(a),-9007199254740991,9007199254740991)},ra.toString=Id,ra.toUpper=function(a){return Id(a).toUpperCase()},ra.trim=function(a,b,c){return(a=Id(a))?c||b===Q?a.replace(ga,""):(b+="")?(a=a.match(za),b=b.match(za),a.slice(z(a,b),A(a,b)+1).join("")):a:a},ra.trimEnd=function(a,b,c){return(a=Id(a))?c||b===Q?a.replace(ia,""):(b+="")?(a=a.match(za),a.slice(0,A(a,b.match(za))+1).join("")):a:a},ra.trimStart=function(a,b,c){return(a=Id(a))?c||b===Q?a.replace(ha,""):(b+="")?(a=a.match(za),a.slice(z(a,b.match(za))).join("")):a:a},ra.truncate=function(a,b){var c=30,d="...";if(td(b))var e="separator"in b?b.separator:e,c="length"in b?Ed(b.length):c,d="omission"in b?Id(b.omission):d;a=Id(a);var f=a.length;if(Aa.test(a))var g=a.match(za),f=g.length;if(c>=f)return a;if(f=c-N(d),1>f)return d;if(c=g?g.slice(0,f).join(""):a.slice(0,f),e===Q)return c+d;if(g&&(f+=c.length-f),yd(e)){if(a.slice(f).search(e)){var h=c;for(e.global||(e=ce(e.source,Id(la.exec(e))+"g")),e.lastIndex=0;g=e.exec(h);)var i=g.index;c=c.slice(0,i===Q?f:i)}}else a.indexOf(e,f)!=f&&(e=c.lastIndexOf(e),e>-1&&(c=c.slice(0,e)));return c+d},ra.unescape=function(a){return(a=Id(a))&&Y.test(a)?a.replace(W,O):a},ra.uniqueId=function(a){var b=++ie;return Id(a)+b},ra.upperCase=ig,ra.upperFirst=fg,ra.each=_c,ra.eachRight=ad,ra.first=Sc,Xd(ra,function(){var a={};return ib(ra,function(b,c){he.call(ra.prototype,c)||(a[c]=b)}),a}(),{chain:!1}),ra.VERSION="4.3.0",e("bind bindKey curry curryRight partial partialRight".split(" "),function(a){ra[a].placeholder=ra}),e(["drop","take"],function(a,b){xa.prototype[a]=function(c){var d=this.__filtered__;if(d&&!b)return new xa(this);c=c===Q?1:Ee(Ed(c),0);var e=this.clone();return d?e.__takeCount__=Fe(c,e.__takeCount__):e.__views__.push({size:Fe(c,4294967295),type:a+(0>e.__dir__?"Right":"")}),e},xa.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),e(["filter","map","takeWhile"],function(a,b){var c=b+1,d=1==c||3==c;xa.prototype[a]=function(a){var b=this.clone();return b.__iteratees__.push({iteratee:wc(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),e(["head","last"],function(a,b){var c="take"+(b?"Right":"");xa.prototype[a]=function(){return this[c](1).value()[0]}}),e(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");xa.prototype[a]=function(){return this.__filtered__?new xa(this):this[c](1)}}),xa.prototype.compact=function(){return this.filter(Vd)},xa.prototype.find=function(a){return this.filter(a).head()},xa.prototype.findLast=function(a){return this.reverse().find(a)},xa.prototype.invokeMap=jd(function(a,b){return"function"==typeof a?new xa(this):this.map(function(c){return qb(c,a,b)})}),xa.prototype.reject=function(a){return a=wc(a,3),this.filter(function(b){return!a(b)})},xa.prototype.slice=function(a,b){a=Ed(a);var c=this;return c.__filtered__&&(a>0||0>b)?new xa(c):(0>a?c=c.takeRight(-a):a&&(c=c.drop(a)),b!==Q&&(b=Ed(b),c=0>b?c.dropRight(-b):c.take(b-a)),c)},xa.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},xa.prototype.toArray=function(){return this.take(4294967295)},ib(xa.prototype,function(a,b){var c=/^(?:filter|find|map|reject)|While$/.test(b),d=/^(?:head|last)$/.test(b),e=ra[d?"take"+("last"==b?"Right":""):b],f=d||/^find/.test(b);e&&(ra.prototype[b]=function(){var b=this.__wrapped__,g=d?[1]:arguments,h=b instanceof xa,i=g[0],j=h||Nf(b),l=function(a){return a=e.apply(ra,k([a],g)),d&&m?a[0]:a};j&&c&&"function"==typeof i&&1!=i.length&&(h=j=!1);var m=this.__chain__,n=!!this.__actions__.length,i=f&&!m,h=h&&!n;return!f&&j?(b=h?b:new xa(this),b=a.apply(b,g),b.__actions__.push({func:Zc,args:[l],thisArg:Q}),new wa(b,m)):i&&h?a.apply(this,g):(b=this.thru(l),i?d?b.value()[0]:b.value():b)})}),e("pop push shift sort splice unshift".split(" "),function(a){var b=ee[a],c=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",d=/^(?:pop|shift)$/.test(a);ra.prototype[a]=function(){var a=arguments;return d&&!this.__chain__?b.apply(this.value(),a):this[c](function(c){return b.apply(c,a)})}}),ib(xa.prototype,function(a,b){var c=ra[b];if(c){var d=c.name+"";(Ue[d]||(Ue[d]=[])).push({name:b,func:c})}}),Ue[jc(Q,2).name]=[{name:"wrapper",func:Q}],xa.prototype.clone=function(){var a=new xa(this.__wrapped__);return a.__actions__=Xb(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Xb(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Xb(this.__views__),a},xa.prototype.reverse=function(){if(this.__filtered__){var a=new xa(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a},xa.prototype.value=function(){var a,b=this.__wrapped__.value(),c=this.__dir__,d=Nf(b),e=0>c,f=d?b.length:0;a=0;for(var g=f,h=this.__views__,i=-1,j=h.length;++i<j;){var k=h[i],l=k.size;switch(k.type){case"drop":a+=l;break;case"dropRight":g-=l;break;case"take":g=Fe(g,a+l);break;case"takeRight":a=Ee(a,g-l)}}if(a={start:a,end:g},g=a.start,h=a.end,a=h-g,e=e?h:g-1,g=this.__iteratees__,h=g.length,i=0,j=Fe(a,this.__takeCount__),!d||200>f||f==a&&j==a)return Qb(b,this.__actions__);d=[];a:for(;a--&&j>i;){for(e+=c,f=-1,k=b[e];++f<h;){var m=g[f],l=m.type,m=(0,m.iteratee)(k);if(2==l)k=m;else if(!m){if(1==l)continue a;break a}}d[i++]=k}return d},ra.prototype.at=xf,ra.prototype.chain=function(){return Yc(this)},ra.prototype.commit=function(){return new wa(this.value(),this.__chain__)},ra.prototype.flatMap=function(a){return this.map(a).flatten()},ra.prototype.next=function(){this.__values__===Q&&(this.__values__=Dd(this.value()));var a=this.__index__>=this.__values__.length,b=a?Q:this.__values__[this.__index__++];return{done:a,value:b}},ra.prototype.plant=function(a){for(var b,c=this;c instanceof va;){var d=Pc(c);d.__index__=0,d.__values__=Q,b?e.__wrapped__=d:b=d;var e=d,c=c.__wrapped__}return e.__wrapped__=a,b},ra.prototype.reverse=function(){var a=this.__wrapped__;return a instanceof xa?(this.__actions__.length&&(a=new xa(this)),a=a.reverse(),a.__actions__.push({func:Zc,args:[Vc],thisArg:Q}),new wa(a,this.__chain__)):this.thru(Vc)},ra.prototype.toJSON=ra.prototype.valueOf=ra.prototype.value=function(){return Qb(this.__wrapped__,this.__actions__)},ve&&(ra.prototype[ve]=$c),ra}var Q,R=1/0,S=NaN,T=/\b__p\+='';/g,U=/\b(__p\+=)''\+/g,V=/(__e\(.*?\)|\b__t\))\+'';/g,W=/&(?:amp|lt|gt|quot|#39|#96);/g,X=/[&<>"'`]/g,Y=RegExp(W.source),Z=RegExp(X.source),$=/<%-([\s\S]+?)%>/g,_=/<%([\s\S]+?)%>/g,aa=/<%=([\s\S]+?)%>/g,ba=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ca=/^\w*$/,da=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,ea=/[\\^$.*+?()[\]{}|]/g,fa=RegExp(ea.source),ga=/^\s+|\s+$/g,ha=/^\s+/,ia=/\s+$/,ja=/\\(\\)?/g,ka=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,la=/\w*$/,ma=/^0x/i,na=/^[-+]0x[0-9a-f]+$/i,oa=/^0b[01]+$/i,pa=/^\[object .+?Constructor\]$/,qa=/^0o[0-7]+$/i,ra=/^(?:0|[1-9]\d*)$/,sa=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,ta=/($^)/,ua=/['\n\r\u2028\u2029\\]/g,va="[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?(?:\\u200d(?:[^\\ud800-\\udfff]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])[\\ufe0e\\ufe0f]?(?:[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|\\ud83c[\\udffb-\\udfff])?)*",wa="(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff])"+va,xa="(?:[^\\ud800-\\udfff][\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]?|[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff])",ya=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]","g"),za=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+xa+va,"g"),Aa=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),Ba=/[a-zA-Z0-9]+/g,Ca=RegExp(["[A-Z\\xc0-\\xd6\\xd8-\\xde]?[a-z\\xdf-\\xf6\\xf8-\\xff]+(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde]|$)|(?:[A-Z\\xc0-\\xd6\\xd8-\\xde]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+(?=[\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000]|[A-Z\\xc0-\\xd6\\xd8-\\xde](?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])|$)|[A-Z\\xc0-\\xd6\\xd8-\\xde]?(?:[a-z\\xdf-\\xf6\\xf8-\\xff]|[^\\ud800-\\udfff\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2018\\u2019\\u201c\\u201d \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000\\d+\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde])+|[A-Z\\xc0-\\xd6\\xd8-\\xde]+|\\d+",wa].join("|"),"g"),Da=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ea="Array Buffer Date Error Float32Array Float64Array Function Int8Array Int16Array Int32Array Map Math Object Reflect RegExp Set String Symbol TypeError Uint8Array Uint8ClampedArray Uint16Array Uint32Array WeakMap _ clearTimeout isFinite parseInt setTimeout".split(" "),Fa={};Fa["[object Float32Array]"]=Fa["[object Float64Array]"]=Fa["[object Int8Array]"]=Fa["[object Int16Array]"]=Fa["[object Int32Array]"]=Fa["[object Uint8Array]"]=Fa["[object Uint8ClampedArray]"]=Fa["[object Uint16Array]"]=Fa["[object Uint32Array]"]=!0,Fa["[object Arguments]"]=Fa["[object Array]"]=Fa["[object ArrayBuffer]"]=Fa["[object Boolean]"]=Fa["[object Date]"]=Fa["[object Error]"]=Fa["[object Function]"]=Fa["[object Map]"]=Fa["[object Number]"]=Fa["[object Object]"]=Fa["[object RegExp]"]=Fa["[object Set]"]=Fa["[object String]"]=Fa["[object WeakMap]"]=!1;var Ga={};Ga["[object Arguments]"]=Ga["[object Array]"]=Ga["[object ArrayBuffer]"]=Ga["[object Boolean]"]=Ga["[object Date]"]=Ga["[object Float32Array]"]=Ga["[object Float64Array]"]=Ga["[object Int8Array]"]=Ga["[object Int16Array]"]=Ga["[object Int32Array]"]=Ga["[object Map]"]=Ga["[object Number]"]=Ga["[object Object]"]=Ga["[object RegExp]"]=Ga["[object Set]"]=Ga["[object String]"]=Ga["[object Symbol]"]=Ga["[object Uint8Array]"]=Ga["[object Uint8ClampedArray]"]=Ga["[object Uint16Array]"]=Ga["[object Uint32Array]"]=!0,Ga["[object Error]"]=Ga["[object Function]"]=Ga["[object WeakMap]"]=!1;var Ha={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Ia={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Ja={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Ka={function:!0,object:!0},La={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ma=parseFloat,Na=parseInt,Oa=Ka[typeof exports]&&exports&&!exports.nodeType?exports:null,Pa=Ka[typeof module]&&module&&!module.nodeType?module:null,Qa=B(Oa&&Pa&&"object"==typeof global&&global),Ra=B(Ka[typeof self]&&self),Sa=B(Ka[typeof window]&&window),Ta=Pa&&Pa.exports===Oa?Oa:null,Ua=B(Ka[typeof this]&&this),Va=Qa||Sa!==(Ua&&Ua.window)&&Sa||Ra||Ua||Function("return this")(),Wa=P();(Sa||Ra||{})._=Wa,"function"==typeof define&&"object"==typeof define.amd&&define.amd?define("lodash",[],function(){return Wa}):Oa&&Pa?(Ta&&((Pa.exports=Wa)._=Wa),Oa._=Wa):Va._=Wa}.call(this),define("src/data/structures",[],function(){var a={mol2d:"string",molfile2D:"string",mol3d:"string",molfile3D:"string",jme:"string",smiles:"string",actelionID:"string",oclID:"string",doi:"string",gif:"string",picture:"string",string:"string",jpg:"string",jpeg:"string",webp:"string",png:"string",svg:"string",number:"number",color:"string",mf:"string",jcamp:"string",date:"string",downloadLink:"string",html:"string",boolean:"boolean",array:"array",regexp:"string",regex:"string",colorBar:{type:"array",elements:{type:"array",elements:["number","string"]}},indicator:{type:"array",elements:{color:"string",bgcolor:"string",text:"string",class:"string",icon:"string",css:"object",tooltip:"string"}},styledValue:{type:"object",elements:{css:"object",value:"object"}},arrayXY:{type:"array",elements:["number","number"]},matrix:{type:"object"},chart:{type:"object"},tree:{type:"object"},fromTo:{type:"object",elements:{from:"number",to:"number"}},loading:{type:"object",elements:{title:"string",series:{type:"array",nbElements:6,elements:{type:"object",elements:{label:"string",data:{type:"array",elements:{type:"object",elements:{a:"number",c:"string",h:"number",info:"object",l:"string",u:"string",n:"string",o:"number",w:"number",x:"number",y:"number"}}}}}}}},gridSelector:{type:"object",elements:{categories:{type:"array",elements:{type:"object",elements:{selectorType:"string",name:"string",label:"string",defaultValue:"number",defaultMaxValue:"number",defaultMinValue:"number",maxValue:"number",minValue:"number"}}},variables:{type:"array",elements:{type:"object",elements:{name:"string",label:"strig"}}}}},chemical:{type:"object",elements:{_entryID:"int",supplierName:"string",_dateCreated:"string",_dateLastModified:"string",iupac:{type:"array",nbElements:2,elements:{type:"object",elements:{value:"string",language:"string"}}},mf:{type:"array",nbElements:2,elements:{type:"object",elements:{value:"mf",mw:"int",exactMass:"int"}}},mol:{type:"array",nbElements:2,elements:{type:"object",elements:{value:"molfile2D",gif:"gif"}}},rn:{type:"array",nbElements:2,elements:{type:"object",elements:{value:"int"}}},batchID:"string",catalogID:"string",entryDetails:"chemicalDetails"}},chemicalDetails:{type:"object",elements:{_entryID:"int",supplierName:"string",_dateCreated:"string",_dateLastModified:"string",iupac:{type:"array",elements:{type:"object",elements:{value:"string",language:"string"}}},mf:{type:"array",elements:{type:"object",elements:{value:"mf",mw:"int",exactMass:"int"}}},mol:{type:"array",elements:{type:"object",elements:{value:"molfile2D",gif:"gif"}}},batchID:"string",catalogID:"string",bp:{type:"array",elements:{type:"object",elements:{pressure:"number",high:"number",low:"number"}}},mp:{type:"array",elements:{type:"object",elements:{pressure:"number",high:"number",low:"number"}}},rn:{type:"array",elements:{type:"object",elements:{value:"number"}}},density:{type:"array",elements:{type:"object",elements:{high:"number",low:"number",temperature:"number"}}},mol3d:{type:"array",elements:"molfile3d"},ir:{type:"array",elements:{type:"object",elements:{conditions:"string",solvent:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},nmr:{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},nmrExperiment:{type:"object",elements:{"1H":{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},"13C":{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},cosy:{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},hsqc:{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},hmbc:{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}},jresolv:{type:"array",elements:{type:"object",elements:{pressure:"string",solvent:"string",experiment:"string",frequency:"number",nucleus:"string",temperature:"string",jcamp:"jcamp",view:{type:"object",elements:{description:"string",value:"string",url:"string",pdf:"string"}}}}}}},mass:{type:"array",elements:{type:"object",elements:{experiment:"string",jcamp:"jcamp"}}},massExperiment:{type:"object",elements:{hplcMS:{type:"array",elements:{type:"object",elements:{experiment:"string",jcamp:"jcamp"}}},gcMS:{type:"array",elements:{type:"object",elements:{experiment:"string",jcamp:"jcamp"}}},ms:{type:"array",elements:{type:"object",elements:{experiment:"string",jcamp:"jcamp"}}}}}}},geojson:"object",pdb:"string",cif:"string",magres:"string",jsmolscript:"string"},b=function(){return Object.keys(this).sort()},c=function(a,b){if(this[a]){var c,d={type:a};if("string"==typeof this[a])switch(this[a]){case"string":c=b;break;case"number":c=parseFloat(b);break;case"boolean":c=!!b;break;default:
c=JSON.parse(b)}else c=JSON.parse(b);return d.value=c,DataObject.check(d,!0)}};return Object.defineProperty(a,"_getList",{value:b}),Object.defineProperty(a,"_parse",{value:c}),a}),!function(a,b){b.true=a,function(){if(document.documentElement.animate){var a=document.documentElement.animate([],0),b=!0;if(a&&(b=!1,"play|currentTime|pause|reverse|playbackRate|cancel|finish|startTime|playState".split("|").forEach(function(c){void 0===a[c]&&(b=!0)})),!b)return}var c={},d={},e={},f=null;!function(a){function b(a){if("number"==typeof a)return a;var b={};for(var c in a)b[c]=a[c];return b}function c(){this._delay=0,this._endDelay=0,this._fill="none",this._iterationStart=0,this._iterations=1,this._duration=0,this._playbackRate=1,this._direction="normal",this._easing="linear"}function d(b,d){var e=new c;return d&&(e.fill="both",e.duration="auto"),"number"!=typeof b||isNaN(b)?void 0!==b&&Object.getOwnPropertyNames(b).forEach(function(c){if("auto"!=b[c]){if(("number"==typeof e[c]||"duration"==c)&&("number"!=typeof b[c]||isNaN(b[c])))return;if("fill"==c&&-1==s.indexOf(b[c]))return;if("direction"==c&&-1==t.indexOf(b[c]))return;if("playbackRate"==c&&1!==b[c]&&a.isDeprecated("AnimationEffectTiming.playbackRate","2014-11-28","Use Animation.playbackRate instead."))return;e[c]=b[c]}}):e.duration=b,e}function e(a){return"number"==typeof a&&(a=isNaN(a)?{duration:0}:{duration:a}),a}function f(b,c){b=a.numericTimingToObject(b);var e=d(b,c);return e._easing=i(e.easing),e}function g(a,b,c,d){return 0>a||a>1||0>c||c>1?B:function(e){function f(a,b,c){return 3*a*(1-c)*(1-c)*c+3*b*(1-c)*c*c+c*c*c}if(0==e||1==e)return e;for(var g=0,h=1;;){var i=(g+h)/2,j=f(a,c,i);if(Math.abs(e-j)<.001)return f(b,d,i);e>j?g=i:h=i}}}function h(a,b){return function(c){if(c>=1)return 1;var d=1/a;return c+=b*d,c-c%d}}function i(a){var b=z.exec(a);if(b)return g.apply(this,b.slice(1).map(Number));var c=A.exec(a);if(c)return h(Number(c[1]),{start:u,middle:v,end:w}[c[2]]);var d=x[a];return d?d:B}function j(a){return Math.abs(k(a)/a.playbackRate)}function k(a){return a.duration*a.iterations}function l(a,b,c){return null==b?C:b<c.delay?D:b>=c.delay+a?E:F}function m(a,b,c,d,e){switch(d){case D:return"backwards"==b||"both"==b?0:null;case F:return c-e;case E:return"forwards"==b||"both"==b?a:null;case C:return null}}function n(a,b,c,d){return(d.playbackRate<0?b-a:b)*d.playbackRate+c}function o(a,b,c,d,e){return 1/0===c||c===-1/0||c-d==b&&e.iterations&&(e.iterations+e.iterationStart)%1==0?a:c%a}function p(a,b,c,d){return 0===c?0:b==a?d.iterationStart+d.iterations-1:Math.floor(c/a)}function q(a,b,c,d){var e=a%2>=1,f="normal"==d.direction||d.direction==(e?"alternate-reverse":"alternate"),g=f?c:b-c,h=g/b;return b*d.easing(h)}function r(a,b,c){var d=l(a,b,c),e=m(a,c.fill,b,d,c.delay);if(null===e)return null;if(0===a)return d===D?0:1;var f=c.iterationStart*c.duration,g=n(a,e,f,c),h=o(c.duration,k(c),g,f,c),i=p(c.duration,h,g,c);return q(i,c.duration,h,c)/c.duration}var s="backwards|forwards|both|none".split("|"),t="reverse|alternate|alternate-reverse".split("|");c.prototype={_setMember:function(b,c){this["_"+b]=c,this._effect&&(this._effect._timingInput[b]=c,this._effect._timing=a.normalizeTimingInput(a.normalizeTimingInput(this._effect._timingInput)),this._effect.activeDuration=a.calculateActiveDuration(this._effect._timing),this._effect._animation&&this._effect._animation._rebuildUnderlyingAnimation())},get playbackRate(){return this._playbackRate},set delay(a){this._setMember("delay",a)},get delay(){return this._delay},set endDelay(a){this._setMember("endDelay",a)},get endDelay(){return this._endDelay},set fill(a){this._setMember("fill",a)},get fill(){return this._fill},set iterationStart(a){this._setMember("iterationStart",a)},get iterationStart(){return this._iterationStart},set duration(a){this._setMember("duration",a)},get duration(){return this._duration},set direction(a){this._setMember("direction",a)},get direction(){return this._direction},set easing(a){this._setMember("easing",a)},get easing(){return this._easing},set iterations(a){this._setMember("iterations",a)},get iterations(){return this._iterations}};var u=1,v=.5,w=0,x={ease:g(.25,.1,.25,1),"ease-in":g(.42,0,1,1),"ease-out":g(0,0,.58,1),"ease-in-out":g(.42,0,.58,1),"step-start":h(1,u),"step-middle":h(1,v),"step-end":h(1,w)},y="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",z=new RegExp("cubic-bezier\\("+y+","+y+","+y+","+y+"\\)"),A=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/,B=function(a){return a},C=0,D=1,E=2,F=3;a.cloneTimingInput=b,a.makeTiming=d,a.numericTimingToObject=e,a.normalizeTimingInput=f,a.calculateActiveDuration=j,a.calculateTimeFraction=r,a.calculatePhase=l,a.toTimingFunction=i}(c,f),function(a){function b(a,b){return a in h?h[a][b]||b:b}function c(a,c,d){var g=e[a];if(g){f.style[a]=c;for(var h in g){var i=g[h],j=f.style[i];d[i]=b(i,j)}}else d[a]=b(a,c)}function d(b){function d(){var a=e.length;null==e[a-1].offset&&(e[a-1].offset=1),a>1&&null==e[0].offset&&(e[0].offset=0);for(var b=0,c=e[0].offset,d=1;a>d;d++){var f=e[d].offset;if(null!=f){for(var g=1;d-b>g;g++)e[b+g].offset=c+(f-c)*g/(d-b);b=d,c=f}}}if(!Array.isArray(b)&&null!==b)throw new TypeError("Keyframes must be null or an array of keyframes");if(null==b)return[];for(var e=b.map(function(b){var d={};for(var e in b){var f=b[e];if("offset"==e){if(null!=f&&(f=Number(f),!isFinite(f)))throw new TypeError("keyframe offsets must be numbers.")}else{if("composite"==e)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"add compositing is not supported"};f="easing"==e?a.toTimingFunction(f):""+f}c(e,f,d)}return void 0==d.offset&&(d.offset=null),void 0==d.easing&&(d.easing=a.toTimingFunction("linear")),d}),f=!0,g=-1/0,h=0;h<e.length;h++){var i=e[h].offset;if(null!=i){if(g>i)throw{code:DOMException.INVALID_MODIFICATION_ERR,name:"InvalidModificationError",message:"Keyframes are not loosely sorted by offset. Sort or specify offsets."};g=i}else f=!1}return e=e.filter(function(a){return a.offset>=0&&a.offset<=1}),f||d(),e}var e={background:["backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","backgroundAttachment","backgroundOrigin","backgroundClip","backgroundColor"],border:["borderTopColor","borderTopStyle","borderTopWidth","borderRightColor","borderRightStyle","borderRightWidth","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeftColor","borderLeftStyle","borderLeftWidth"],borderBottom:["borderBottomWidth","borderBottomStyle","borderBottomColor"],borderColor:["borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],borderLeft:["borderLeftWidth","borderLeftStyle","borderLeftColor"],borderRadius:["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],borderRight:["borderRightWidth","borderRightStyle","borderRightColor"],borderTop:["borderTopWidth","borderTopStyle","borderTopColor"],borderWidth:["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],flex:["flexGrow","flexShrink","flexBasis"],font:["fontFamily","fontSize","fontStyle","fontVariant","fontWeight","lineHeight"],margin:["marginTop","marginRight","marginBottom","marginLeft"],outline:["outlineColor","outlineStyle","outlineWidth"],padding:["paddingTop","paddingRight","paddingBottom","paddingLeft"]},f=document.createElementNS("http://www.w3.org/1999/xhtml","div"),g={thin:"1px",medium:"3px",thick:"5px"},h={borderBottomWidth:g,borderLeftWidth:g,borderRightWidth:g,borderTopWidth:g,fontSize:{"xx-small":"60%","x-small":"75%",small:"89%",medium:"100%",large:"120%","x-large":"150%","xx-large":"200%"},fontWeight:{normal:"400",bold:"700"},outlineWidth:g,textShadow:{none:"0px 0px 0px transparent"},boxShadow:{none:"0px 0px 0px 0px transparent"}};a.normalizeKeyframes=d}(c,f),function(a){var b={};a.isDeprecated=function(a,c,d,e){var f=e?"are":"is",g=new Date,h=new Date(c);return h.setMonth(h.getMonth()+3),h>g?(a in b||console.warn("Web Animations: "+a+" "+f+" deprecated and will stop working on "+h.toDateString()+". "+d),b[a]=!0,!1):!0},a.deprecated=function(b,c,d,e){var f=e?"are":"is";if(a.isDeprecated(b,c,d,e))throw new Error(b+" "+f+" no longer supported. "+d)}}(c),function(a,b){function c(a){for(var b={},c=0;c<a.length;c++)for(var d in a[c])if("offset"!=d&&"easing"!=d&&"composite"!=d){var e={offset:a[c].offset,easing:a[c].easing,value:a[c][d]};b[d]=b[d]||[],b[d].push(e)}for(var f in b){var g=b[f];if(0!=g[0].offset||1!=g[g.length-1].offset)throw{type:DOMException.NOT_SUPPORTED_ERR,name:"NotSupportedError",message:"Partial keyframes are not supported"}}return b}function d(a){var c=[];for(var d in a)for(var e=a[d],f=0;f<e.length-1;f++){var g=e[f].offset,h=e[f+1].offset,i=e[f].value,j=e[f+1].value;g==h&&(1==h?i=j:j=i),c.push({startTime:g,endTime:h,easing:e[f].easing,property:d,interpolation:b.propertyInterpolation(d,i,j)})}return c.sort(function(a,b){return a.startTime-b.startTime}),c}b.convertEffectInput=function(e){var f=a.normalizeKeyframes(e),g=c(f),h=d(g);return function(a,c){if(null!=c)h.filter(function(a){return 0>=c&&0==a.startTime||c>=1&&1==a.endTime||c>=a.startTime&&c<=a.endTime}).forEach(function(d){var e=c-d.startTime,f=d.endTime-d.startTime,g=0==f?0:d.easing(e/f);b.apply(a,d.property,d.interpolation(g))});else for(var d in g)"offset"!=d&&"easing"!=d&&"composite"!=d&&b.clear(a,d)}}}(c,d,f),function(a){function b(a,b,c){e[c]=e[c]||[],e[c].push([a,b])}function c(a,c,d){for(var e=0;e<d.length;e++){var f=d[e];b(a,c,f),/-/.test(f)&&b(a,c,f.replace(/-(.)/g,function(a,b){return b.toUpperCase()}))}}function d(b,c,d){if("initial"==c||"initial"==d){var g=b.replace(/-(.)/g,function(a,b){return b.toUpperCase()});"initial"==c&&(c=f[g]),"initial"==d&&(d=f[g])}for(var h=c==d?[]:e[b],i=0;h&&i<h.length;i++){var j=h[i][0](c),k=h[i][0](d);if(void 0!==j&&void 0!==k){var l=h[i][1](j,k);if(l){var m=a.Interpolation.apply(null,l);return function(a){return 0==a?c:1==a?d:m(a)}}}}return a.Interpolation(!1,!0,function(a){return a?d:c})}var e={};a.addPropertiesHandler=c;var f={backgroundColor:"transparent",backgroundPosition:"0% 0%",borderBottomColor:"currentColor",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomWidth:"3px",borderLeftColor:"currentColor",borderLeftWidth:"3px",borderRightColor:"currentColor",borderRightWidth:"3px",borderSpacing:"2px",borderTopColor:"currentColor",borderTopLeftRadius:"0px",borderTopRightRadius:"0px",borderTopWidth:"3px",bottom:"auto",clip:"rect(0px, 0px, 0px, 0px)",color:"black",fontSize:"100%",fontWeight:"400",height:"auto",left:"auto",letterSpacing:"normal",lineHeight:"120%",marginBottom:"0px",marginLeft:"0px",marginRight:"0px",marginTop:"0px",maxHeight:"none",maxWidth:"none",minHeight:"0px",minWidth:"0px",opacity:"1.0",outlineColor:"invert",outlineOffset:"0px",outlineWidth:"3px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",paddingTop:"0px",right:"auto",textIndent:"0px",textShadow:"0px 0px 0px transparent",top:"auto",transform:"",verticalAlign:"0px",visibility:"visible",width:"auto",wordSpacing:"normal",zIndex:"auto"};a.propertyInterpolation=d}(d,f),function(a,b){function c(b){var c=a.calculateActiveDuration(b),d=function(d){return a.calculateTimeFraction(c,d,b)};return d._totalDuration=b.delay+c+b.endDelay,d._isCurrent=function(d){var e=a.calculatePhase(c,d,b);return e===PhaseActive||e===PhaseBefore},d}b.KeyframeEffect=function(d,e,f){var g,h=c(a.normalizeTimingInput(f)),i=b.convertEffectInput(e),j=function(){i(d,g)};return j._update=function(a){return g=h(a),null!==g},j._clear=function(){i(d,null)},j._hasSameTarget=function(a){return d===a},j._isCurrent=h._isCurrent,j._totalDuration=h._totalDuration,j},b.NullEffect=function(a){var b=function(){a&&(a(),a=null)};return b._update=function(){return null},b._totalDuration=0,b._isCurrent=function(){return!1},b._hasSameTarget=function(){return!1},b}}(c,d,f),function(a){function b(a,b,c){c.enumerable=!0,c.configurable=!0,Object.defineProperty(a,b,c)}function c(a){this._surrogateStyle=document.createElementNS("http://www.w3.org/1999/xhtml","div").style,this._style=a.style,this._length=0,this._isAnimatedProperty={};for(var b=0;b<this._style.length;b++){var c=this._style[b];this._surrogateStyle[c]=this._style[c]}this._updateIndices()}function d(a){if(!a._webAnimationsPatchedStyle){var d=new c(a);try{b(a,"style",{get:function(){return d}})}catch(b){a.style._set=function(b,c){a.style[b]=c},a.style._clear=function(b){a.style[b]=""}}a._webAnimationsPatchedStyle=a.style}}var e={cssText:1,length:1,parentRule:1},f={getPropertyCSSValue:1,getPropertyPriority:1,getPropertyValue:1,item:1,removeProperty:1,setProperty:1},g={removeProperty:1,setProperty:1};c.prototype={get cssText(){return this._surrogateStyle.cssText},set cssText(a){for(var b={},c=0;c<this._surrogateStyle.length;c++)b[this._surrogateStyle[c]]=!0;this._surrogateStyle.cssText=a,this._updateIndices();for(var c=0;c<this._surrogateStyle.length;c++)b[this._surrogateStyle[c]]=!0;for(var d in b)this._isAnimatedProperty[d]||this._style.setProperty(d,this._surrogateStyle.getPropertyValue(d))},get length(){return this._surrogateStyle.length},get parentRule(){return this._style.parentRule},_updateIndices:function(){for(;this._length<this._surrogateStyle.length;)Object.defineProperty(this,this._length,{configurable:!0,enumerable:!1,get:function(a){return function(){return this._surrogateStyle[a]}}(this._length)}),this._length++;for(;this._length>this._surrogateStyle.length;)this._length--,Object.defineProperty(this,this._length,{configurable:!0,enumerable:!1,value:void 0})},_set:function(a,b){this._style[a]=b,this._isAnimatedProperty[a]=!0},_clear:function(a){this._style[a]=this._surrogateStyle[a],delete this._isAnimatedProperty[a]}};for(var h in f)c.prototype[h]=function(a,b){return function(){var c=this._surrogateStyle[a].apply(this._surrogateStyle,arguments);return b&&(this._isAnimatedProperty[arguments[0]]||this._style[a].apply(this._style,arguments),this._updateIndices()),c}}(h,h in g);for(var i in document.documentElement.style)i in e||i in f||!function(a){b(c.prototype,a,{get:function(){return this._surrogateStyle[a]},set:function(b){this._surrogateStyle[a]=b,this._updateIndices(),this._isAnimatedProperty[a]||(this._style[a]=b)}})}(i);a.apply=function(b,c,e){d(b),b.style._set(a.propertyName(c),e)},a.clear=function(b,c){b._webAnimationsPatchedStyle&&b.style._clear(a.propertyName(c))}}(d,f),function(a){window.Element.prototype.animate=function(b,c){return a.timeline._play(a.KeyframeEffect(this,b,c))}}(d),function(a){function b(a,c,d){if("number"==typeof a&&"number"==typeof c)return a*(1-d)+c*d;if("boolean"==typeof a&&"boolean"==typeof c)return.5>d?a:c;if(a.length==c.length){for(var e=[],f=0;f<a.length;f++)e.push(b(a[f],c[f],d));return e}throw"Mismatched interpolation arguments "+a+":"+c}a.Interpolation=function(a,c,d){return function(e){return d(b(a,c,e))}}}(d,f),function(a){function b(a,b,c){return Math.max(Math.min(a,c),b)}function c(c,d,e){var f=a.dot(c,d);f=b(f,-1,1);var g=[];if(1===f)g=c;else for(var h=Math.acos(f),i=1*Math.sin(e*h)/Math.sqrt(1-f*f),j=0;4>j;j++)g.push(c[j]*(Math.cos(e*h)-f*i)+d[j]*i);return g}var d=function(){function a(a,b){for(var c=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],d=0;4>d;d++)for(var e=0;4>e;e++)for(var f=0;4>f;f++)c[d][e]+=b[d][f]*a[f][e];return c}function b(a){return 0==a[0][2]&&0==a[0][3]&&0==a[1][2]&&0==a[1][3]&&0==a[2][0]&&0==a[2][1]&&1==a[2][2]&&0==a[2][3]&&0==a[3][2]&&1==a[3][3]}function c(c,d,e,f,g){for(var h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],i=0;4>i;i++)h[i][3]=g[i];for(var i=0;3>i;i++)for(var j=0;3>j;j++)h[3][i]+=c[j]*h[j][i];var k=f[0],l=f[1],m=f[2],n=f[3],o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];o[0][0]=1-2*(l*l+m*m),o[0][1]=2*(k*l-m*n),o[0][2]=2*(k*m+l*n),o[1][0]=2*(k*l+m*n),o[1][1]=1-2*(k*k+m*m),o[1][2]=2*(l*m-k*n),o[2][0]=2*(k*m-l*n),o[2][1]=2*(l*m+k*n),o[2][2]=1-2*(k*k+l*l),h=a(h,o);var p=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];e[2]&&(p[2][1]=e[2],h=a(h,p)),e[1]&&(p[2][1]=0,p[2][0]=e[0],h=a(h,p)),e[0]&&(p[2][0]=0,p[1][0]=e[0],h=a(h,p));for(var i=0;3>i;i++)for(var j=0;3>j;j++)h[i][j]*=d[i];return b(h)?[h[0][0],h[0][1],h[1][0],h[1][1],h[3][0],h[3][1]]:h[0].concat(h[1],h[2],h[3])}return c}();a.composeMatrix=d,a.quat=c}(d,f),function(a,b){a.sequenceNumber=0;var c=function(a,b,c){this.target=a,this.currentTime=b,this.timelineTime=c,this.type="finish",this.bubbles=!1,this.cancelable=!1,this.currentTarget=a,this.defaultPrevented=!1,this.eventPhase=Event.AT_TARGET,this.timeStamp=Date.now()};b.Animation=function(b){this._sequenceNumber=a.sequenceNumber++,this._currentTime=0,this._startTime=null,this._paused=!1,this._playbackRate=1,this._inTimeline=!0,this._finishedFlag=!1,this.onfinish=null,this._finishHandlers=[],this._effect=b,this._inEffect=this._effect._update(0),this._idle=!0,this._currentTimePending=!1},b.Animation.prototype={_ensureAlive:function(){this._inEffect=this._effect._update(this.playbackRate<0&&0===this.currentTime?-1:this.currentTime),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,b.timeline._animations.push(this))},_tickCurrentTime:function(a,b){a!=this._currentTime&&(this._currentTime=a,this._isFinished&&!b&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this._ensureAlive())},get currentTime(){return this._idle||this._currentTimePending?null:this._currentTime},set currentTime(a){a=+a,isNaN(a)||(b.restart(),this._paused||null==this._startTime||(this._startTime=this._timeline.currentTime-a/this._playbackRate),this._currentTimePending=!1,this._currentTime!=a&&(this._tickCurrentTime(a,!0),b.invalidateEffects()))},get startTime(){return this._startTime},set startTime(a){a=+a,isNaN(a)||this._paused||this._idle||(this._startTime=a,this._tickCurrentTime((this._timeline.currentTime-this._startTime)*this.playbackRate),b.invalidateEffects())},get playbackRate(){return this._playbackRate},set playbackRate(a){if(a!=this._playbackRate){var b=this.currentTime;this._playbackRate=a,this._startTime=null,"paused"!=this.playState&&"idle"!=this.playState&&this.play(),null!=b&&(this.currentTime=b)}},get _isFinished(){return!this._idle&&(this._playbackRate>0&&this._currentTime>=this._totalDuration||this._playbackRate<0&&this._currentTime<=0)},get _totalDuration(){return this._effect._totalDuration},get playState(){return this._idle?"idle":null==this._startTime&&!this._paused&&0!=this.playbackRate||this._currentTimePending?"pending":this._paused?"paused":this._isFinished?"finished":"running"},play:function(){this._paused=!1,(this._isFinished||this._idle)&&(this._currentTime=this._playbackRate>0?0:this._totalDuration,this._startTime=null,b.invalidateEffects()),this._finishedFlag=!1,b.restart(),this._idle=!1,this._ensureAlive()},pause:function(){this._isFinished||this._paused||this._idle||(this._currentTimePending=!0),this._startTime=null,this._paused=!0},finish:function(){this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this._currentTimePending=!1)},cancel:function(){this._inEffect&&(this._inEffect=!1,this._idle=!0,this.currentTime=0,this._startTime=null,this._effect._update(null),b.invalidateEffects(),b.restart())},reverse:function(){this.playbackRate*=-1,this.play()},addEventListener:function(a,b){"function"==typeof b&&"finish"==a&&this._finishHandlers.push(b)},removeEventListener:function(a,b){if("finish"==a){var c=this._finishHandlers.indexOf(b);c>=0&&this._finishHandlers.splice(c,1)}},_fireEvents:function(a){var b=this._isFinished;if((b||this._idle)&&!this._finishedFlag){var d=new c(this,this._currentTime,a),e=this._finishHandlers.concat(this.onfinish?[this.onfinish]:[]);setTimeout(function(){e.forEach(function(a){a.call(d.target,d)})},0)}this._finishedFlag=b},_tick:function(a){return this._idle||this._paused||(null==this._startTime?this.startTime=a-this._currentTime/this.playbackRate:this._isFinished||this._tickCurrentTime((a-this._startTime)*this.playbackRate)),this._currentTimePending=!1,this._fireEvents(a),!this._idle&&(this._inEffect||!this._finishedFlag)}}}(c,d,f),function(a,b){function c(a){var b=i;i=[],a<s.currentTime&&(a=s.currentTime),g(a),b.forEach(function(b){b[1](a)}),o&&g(a),f(),l=void 0}function d(a,b){return a._sequenceNumber-b._sequenceNumber}function e(){this._animations=[],this.currentTime=window.performance&&performance.now?performance.now():0}function f(){p.forEach(function(a){a()}),p.length=0}function g(a){n=!1;var c=b.timeline;c.currentTime=a,c._animations.sort(d),m=!1;var e=c._animations;c._animations=[];var f=[],g=[];e=e.filter(function(b){return b._inTimeline=b._tick(a),b._inEffect?g.push(b._effect):f.push(b._effect),b._isFinished||b._paused||b._idle||(m=!0),b._inTimeline}),p.push.apply(p,f),p.push.apply(p,g),c._animations.push.apply(c._animations,e),o=!1,m&&requestAnimationFrame(function(){})}var h=window.requestAnimationFrame,i=[],j=0;window.requestAnimationFrame=function(a){var b=j++;return 0==i.length&&h(c),i.push([b,a]),b},window.cancelAnimationFrame=function(a){i.forEach(function(b){b[0]==a&&(b[1]=function(){})})},e.prototype={_play:function(c){c._timing=a.normalizeTimingInput(c.timing);var d=new b.Animation(c);return d._idle=!1,d._timeline=this,this._animations.push(d),b.restart(),b.invalidateEffects(),d}};var k,l=void 0,k=function(){return void 0==l&&(l=performance.now()),l},m=!1,n=!1;b.restart=function(){return m||(m=!0,requestAnimationFrame(function(){}),n=!0),n};var o=!1;b.invalidateEffects=function(){o=!0};var p=[],q=1e3/60,r=window.getComputedStyle;Object.defineProperty(window,"getComputedStyle",{configurable:!0,enumerable:!0,value:function(){if(o){var a=k();a-s.currentTime>0&&(s.currentTime+=q*(Math.floor((a-s.currentTime)/q)+1)),g(s.currentTime)}return f(),r.apply(this,arguments)}});var s=new e;b.timeline=s}(c,d,f),function(a){function b(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d]*b[d];return c}function c(a,b){return[a[0]*b[0]+a[4]*b[1]+a[8]*b[2]+a[12]*b[3],a[1]*b[0]+a[5]*b[1]+a[9]*b[2]+a[13]*b[3],a[2]*b[0]+a[6]*b[1]+a[10]*b[2]+a[14]*b[3],a[3]*b[0]+a[7]*b[1]+a[11]*b[2]+a[15]*b[3],a[0]*b[4]+a[4]*b[5]+a[8]*b[6]+a[12]*b[7],a[1]*b[4]+a[5]*b[5]+a[9]*b[6]+a[13]*b[7],a[2]*b[4]+a[6]*b[5]+a[10]*b[6]+a[14]*b[7],a[3]*b[4]+a[7]*b[5]+a[11]*b[6]+a[15]*b[7],a[0]*b[8]+a[4]*b[9]+a[8]*b[10]+a[12]*b[11],a[1]*b[8]+a[5]*b[9]+a[9]*b[10]+a[13]*b[11],a[2]*b[8]+a[6]*b[9]+a[10]*b[10]+a[14]*b[11],a[3]*b[8]+a[7]*b[9]+a[11]*b[10]+a[15]*b[11],a[0]*b[12]+a[4]*b[13]+a[8]*b[14]+a[12]*b[15],a[1]*b[12]+a[5]*b[13]+a[9]*b[14]+a[13]*b[15],a[2]*b[12]+a[6]*b[13]+a[10]*b[14]+a[14]*b[15],a[3]*b[12]+a[7]*b[13]+a[11]*b[14]+a[15]*b[15]]}function d(a){switch(a.t){case"rotatex":var b=a.d[0].rad||0,c=a.d[0].deg||0,d=c*Math.PI/180+b;return[1,0,0,0,0,Math.cos(d),Math.sin(d),0,0,-Math.sin(d),Math.cos(d),0,0,0,0,1];case"rotatey":var b=a.d[0].rad||0,c=a.d[0].deg||0,d=c*Math.PI/180+b;return[Math.cos(d),0,-Math.sin(d),0,0,1,0,0,Math.sin(d),0,Math.cos(d),0,0,0,0,1];case"rotate":case"rotatez":var b=a.d[0].rad||0,c=a.d[0].deg||0,d=c*Math.PI/180+b;return[Math.cos(d),Math.sin(d),0,0,-Math.sin(d),Math.cos(d),0,0,0,0,1,0,0,0,0,1];case"rotate3d":var e=a.d[0],f=a.d[1],g=a.d[2],b=a.d[3].rad||0,c=a.d[3].deg||0,d=c*Math.PI/180+b,h=e*e+f*f+g*g;if(0===h)e=1,f=0,g=0;else if(1!==h){var i=Math.sqrt(h);e/=i,f/=i,g/=i}var j=Math.sin(d/2),k=j*Math.cos(d/2),l=j*j;return[1-2*(f*f+g*g)*l,2*(e*f*l+g*k),2*(e*g*l-f*k),0,2*(e*f*l-g*k),1-2*(e*e+g*g)*l,2*(f*g*l+e*k),0,2*(e*g*l+f*k),2*(f*g*l-e*k),1-2*(e*e+f*f)*l,0,0,0,0,1];case"scale":return[a.d[0],0,0,0,0,a.d[1],0,0,0,0,1,0,0,0,0,1];case"scalex":return[a.d[0],0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,a.d[0],0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,a.d[0],0,0,0,0,1];case"scale3d":return[a.d[0],0,0,0,0,a.d[1],0,0,0,0,a.d[2],0,0,0,0,1];case"skew":var m=a.d[0].deg||0,n=a.d[0].rad||0,o=a.d[1].deg||0,p=a.d[1].rad||0,q=m*Math.PI/180+n,r=o*Math.PI/180+p;return[1,Math.tan(r),0,0,Math.tan(q),1,0,0,0,0,1,0,0,0,0,1];case"skewx":var b=a.d[0].rad||0,c=a.d[0].deg||0,d=c*Math.PI/180+b;return[1,0,0,0,Math.tan(d),1,0,0,0,0,1,0,0,0,0,1];case"skewy":var b=a.d[0].rad||0,c=a.d[0].deg||0,d=c*Math.PI/180+b;return[1,Math.tan(d),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":var e=a.d[0].px||0,f=a.d[1].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,e,f,0,1];case"translatex":var e=a.d[0].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1];case"translatey":var f=a.d[0].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,0,f,0,1];case"translatez":var g=a.d[0].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,g,1];case"translate3d":var e=a.d[0].px||0,f=a.d[1].px||0,g=a.d[2].px||0;return[1,0,0,0,0,1,0,0,0,0,1,0,e,f,g,1];case"perspective":var s=a.d[0].px?-1/a.d[0].px:0;return[1,0,0,0,0,1,0,0,0,0,1,s,0,0,0,1];case"matrix":return[a.d[0],a.d[1],0,0,a.d[2],a.d[3],0,0,0,0,1,0,a.d[4],a.d[5],0,1];case"matrix3d":return a.d}}function e(a){return 0===a.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:a.map(d).reduce(c)}function f(a){return[g(e(a))]}var g=function(){function a(a){return a[0][0]*a[1][1]*a[2][2]+a[1][0]*a[2][1]*a[0][2]+a[2][0]*a[0][1]*a[1][2]-a[0][2]*a[1][1]*a[2][0]-a[1][2]*a[2][1]*a[0][0]-a[2][2]*a[0][1]*a[1][0]}function c(b){for(var c=1/a(b),d=b[0][0],e=b[0][1],f=b[0][2],g=b[1][0],h=b[1][1],i=b[1][2],j=b[2][0],k=b[2][1],l=b[2][2],m=[[(h*l-i*k)*c,(f*k-e*l)*c,(e*i-f*h)*c,0],[(i*j-g*l)*c,(d*l-f*j)*c,(f*g-d*i)*c,0],[(g*k-h*j)*c,(j*e-d*k)*c,(d*h-e*g)*c,0]],n=[],o=0;3>o;o++){for(var p=0,q=0;3>q;q++)p+=b[3][q]*m[q][o];n.push(p)}return n.push(1),m.push(n),m}function d(a){return[[a[0][0],a[1][0],a[2][0],a[3][0]],[a[0][1],a[1][1],a[2][1],a[3][1]],[a[0][2],a[1][2],a[2][2],a[3][2]],[a[0][3],a[1][3],a[2][3],a[3][3]]]}function e(a,b){for(var c=[],d=0;4>d;d++){for(var e=0,f=0;4>f;f++)e+=a[f]*b[f][d];c.push(e)}return c}function f(a){var b=g(a);return[a[0]/b,a[1]/b,a[2]/b]}function g(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])}function h(a,b,c,d){return[c*a[0]+d*b[0],c*a[1]+d*b[1],c*a[2]+d*b[2]]}function i(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function j(j){var k=[j.slice(0,4),j.slice(4,8),j.slice(8,12),j.slice(12,16)];if(1!==k[3][3])return null;for(var l=[],m=0;4>m;m++)l.push(k[m].slice());for(var m=0;3>m;m++)l[m][3]=0;if(0===a(l))return!1;var n,o=[];if(k[0][3]||k[1][3]||k[2][3]){o.push(k[0][3]),o.push(k[1][3]),o.push(k[2][3]),o.push(k[3][3]);var p=c(l),q=d(p);n=e(o,q)}else n=[0,0,0,1];var r=k[3].slice(0,3),s=[];s.push(k[0].slice(0,3));var t=[];t.push(g(s[0])),s[0]=f(s[0]);var u=[];s.push(k[1].slice(0,3)),u.push(b(s[0],s[1])),s[1]=h(s[1],s[0],1,-u[0]),t.push(g(s[1])),s[1]=f(s[1]),u[0]/=t[1],s.push(k[2].slice(0,3)),u.push(b(s[0],s[2])),s[2]=h(s[2],s[0],1,-u[1]),u.push(b(s[1],s[2])),s[2]=h(s[2],s[1],1,-u[2]),t.push(g(s[2])),s[2]=f(s[2]),u[1]/=t[2],u[2]/=t[2];var v=i(s[1],s[2]);if(b(s[0],v)<0)for(var m=0;3>m;m++)t[m]*=-1,s[m][0]*=-1,s[m][1]*=-1,s[m][2]*=-1;var w,x,y=s[0][0]+s[1][1]+s[2][2]+1;return y>1e-4?(w=.5/Math.sqrt(y),x=[(s[2][1]-s[1][2])*w,(s[0][2]-s[2][0])*w,(s[1][0]-s[0][1])*w,.25/w]):s[0][0]>s[1][1]&&s[0][0]>s[2][2]?(w=2*Math.sqrt(1+s[0][0]-s[1][1]-s[2][2]),x=[.25*w,(s[0][1]+s[1][0])/w,(s[0][2]+s[2][0])/w,(s[2][1]-s[1][2])/w]):s[1][1]>s[2][2]?(w=2*Math.sqrt(1+s[1][1]-s[0][0]-s[2][2]),x=[(s[0][1]+s[1][0])/w,.25*w,(s[1][2]+s[2][1])/w,(s[0][2]-s[2][0])/w]):(w=2*Math.sqrt(1+s[2][2]-s[0][0]-s[1][1]),x=[(s[0][2]+s[2][0])/w,(s[1][2]+s[2][1])/w,.25*w,(s[1][0]-s[0][1])/w]),[r,t,u,x,n]}return j}();a.dot=b,a.makeMatrixDecomposition=f}(d,f),function(a){function b(a,b){var c=a.exec(b);return c?(c=a.ignoreCase?c[0].toLowerCase():c[0],[c,b.substr(c.length)]):void 0}function c(a,b){b=b.replace(/^\s*/,"");var c=a(b);return c?[c[0],c[1].replace(/^\s*/,"")]:void 0}function d(a,d,e){a=c.bind(null,a);for(var f=[];;){var g=a(e);if(!g)return[f,e];if(f.push(g[0]),e=g[1],g=b(d,e),!g||""==g[1])return[f,e];e=g[1]}}function e(a,b){for(var c=0,d=0;d<b.length&&(!/\s|,/.test(b[d])||0!=c);d++)if("("==b[d])c++;else if(")"==b[d]&&(c--,0==c&&d++,0>=c))break;var e=a(b.substr(0,d));return void 0==e?void 0:[e,b.substr(d)]}function f(a,b){for(var c=a,d=b;c&&d;)c>d?c%=d:d%=c;return c=a*b/(c+d)}function g(a){return function(b){var c=a(b);return c&&(c[0]=void 0),c}}function h(a,b){return function(c){var d=a(c);return d?d:[b,c]}}function i(b,c){for(var d=[],e=0;e<b.length;e++){var f=a.consumeTrimmed(b[e],c);if(!f||""==f[0])return;void 0!==f[0]&&d.push(f[0]),c=f[1]}return""==c?d:void 0}function j(a,b,c,d,e){for(var g=[],h=[],i=[],j=f(d.length,e.length),k=0;j>k;k++){var l=b(d[k%d.length],e[k%e.length]);if(!l)return;g.push(l[0]),h.push(l[1]),i.push(l[2])}return[g,h,function(b){var d=b.map(function(a,b){return i[b](a)}).join(c);return a?a(d):d}]}function k(a,b,c){for(var d=[],e=[],f=[],g=0,h=0;h<c.length;h++)if("function"==typeof c[h]){var i=c[h](a[g],b[g++]);d.push(i[0]),e.push(i[1]),f.push(i[2])}else!function(a){d.push(!1),e.push(!1),f.push(function(){return c[a]})}(h);return[d,e,function(a){for(var b="",c=0;c<a.length;c++)b+=f[c](a[c]);return b}]}a.consumeToken=b,a.consumeTrimmed=c,a.consumeRepeated=d,a.consumeParenthesised=e,a.ignore=g,a.optional=h,a.consumeList=i,a.mergeNestedRepeated=j.bind(null,null),a.mergeWrappedNestedRepeated=j,a.mergeList=k}(d),function(a){function b(b){function c(b){var c=a.consumeToken(/^inset/i,b);if(c)return d.inset=!0,c;var c=a.consumeLengthOrPercent(b);if(c)return d.lengths.push(c[0]),c;var c=a.consumeColor(b);return c?(d.color=c[0],c):void 0}var d={inset:!1,lengths:[],color:null},e=a.consumeRepeated(c,/^/,b);return e&&e[0].length?[d,e[1]]:void 0}function c(c){var d=a.consumeRepeated(b,/^,/,c);return d&&""==d[1]?d[0]:void 0}function d(b,c){for(;b.lengths.length<Math.max(b.lengths.length,c.lengths.length);)b.lengths.push({px:0});for(;c.lengths.length<Math.max(b.lengths.length,c.lengths.length);)c.lengths.push({px:0});if(b.inset==c.inset&&!!b.color==!!c.color){for(var d,e=[],f=[[],0],g=[[],0],h=0;h<b.lengths.length;h++){var i=a.mergeDimensions(b.lengths[h],c.lengths[h],2==h);f[0].push(i[0]),g[0].push(i[1]),e.push(i[2])}if(b.color&&c.color){var j=a.mergeColors(b.color,c.color);f[1]=j[0],g[1]=j[1],d=j[2]}return[f,g,function(a){for(var c=b.inset?"inset ":" ",f=0;f<e.length;f++)c+=e[f](a[0][f])+" ";return d&&(c+=d(a[1])),c}]}}function e(b,c,d,e){function f(a){return{inset:a,color:[0,0,0,0],lengths:[{px:0},{px:0},{px:0},{px:0}]}}for(var g=[],h=[],i=0;i<d.length||i<e.length;i++){var j=d[i]||f(e[i].inset),k=e[i]||f(d[i].inset);g.push(j),h.push(k)}return a.mergeNestedRepeated(b,c,g,h)}var f=e.bind(null,d,", ");a.addPropertiesHandler(c,f,["box-shadow","text-shadow"])}(d),function(a){function b(a){return a.toFixed(3).replace(".000","")}function c(a,b,c){return Math.min(b,Math.max(a,c))}function d(a){return/^\s*[-+]?(\d*\.)?\d+\s*$/.test(a)?Number(a):void 0}function e(a,c){return[a,c,b]}function f(a,b){return 0!=a?h(0,1/0)(a,b):void 0}function g(a,b){return[a,b,function(a){return Math.round(c(1,1/0,a))}]}function h(a,d){return function(e,f){return[e,f,function(e){return b(c(a,d,e))}]}}function i(a,b){return[a,b,Math.round]}a.clamp=c,a.addPropertiesHandler(d,h(0,1/0),["border-image-width","line-height"]),a.addPropertiesHandler(d,h(0,1),["opacity","shape-image-threshold"]),a.addPropertiesHandler(d,f,["flex-grow","flex-shrink"]),a.addPropertiesHandler(d,g,["orphans","widows"]),a.addPropertiesHandler(d,i,["z-index"]),a.parseNumber=d,a.mergeNumbers=e,a.numberToString=b}(d,f),function(a){function b(a,b){return"visible"==a||"visible"==b?[0,1,function(c){return 0>=c?a:c>=1?b:"visible"}]:void 0}a.addPropertiesHandler(String,b,["visibility"])}(d),function(a){function b(a){a=a.trim(),e.fillStyle="#000",e.fillStyle=a;var b=e.fillStyle;if(e.fillStyle="#fff",e.fillStyle=a,b==e.fillStyle){e.fillRect(0,0,1,1);var c=e.getImageData(0,0,1,1).data;e.clearRect(0,0,1,1);var d=c[3]/255;return[c[0]*d,c[1]*d,c[2]*d,d]}}function c(b,c){return[b,c,function(b){function c(a){return Math.max(0,Math.min(255,a))}if(b[3])for(var d=0;3>d;d++)b[d]=Math.round(c(b[d]/b[3]));return b[3]=a.numberToString(a.clamp(0,1,b[3])),"rgba("+b.join(",")+")"}]}var d=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");d.width=d.height=1;var e=d.getContext("2d");a.addPropertiesHandler(b,c,["background-color","border-bottom-color","border-left-color","border-right-color","border-top-color","color","outline-color","text-decoration-color"]),
a.consumeColor=a.consumeParenthesised.bind(null,b),a.mergeColors=c}(d,f),function(a,b){function c(a,b){if(b=b.trim().toLowerCase(),"0"==b&&"px".search(a)>=0)return{px:0};if(/^[^(]*$|^calc/.test(b)){b=b.replace(/calc\(/g,"(");var c={};b=b.replace(a,function(a){return c[a]=null,"U"+a});for(var d="U("+a.source+")",e=b.replace(/[-+]?(\d*\.)?\d+/g,"N").replace(new RegExp("N"+d,"g"),"D").replace(/\s[+-]\s/g,"O").replace(/\s/g,""),f=[/N\*(D)/g,/(N|D)[*\/]N/g,/(N|D)O\1/g,/\((N|D)\)/g],g=0;g<f.length;)f[g].test(e)?(e=e.replace(f[g],"$1"),g=0):g++;if("D"==e){for(var h in c){var i=eval(b.replace(new RegExp("U"+h,"g"),"").replace(new RegExp(d,"g"),"*0"));if(!isFinite(i))return;c[h]=i}return c}}}function d(a,b){return e(a,b,!0)}function e(b,c,d){var e,f=[];for(e in b)f.push(e);for(e in c)f.indexOf(e)<0&&f.push(e);return b=f.map(function(a){return b[a]||0}),c=f.map(function(a){return c[a]||0}),[b,c,function(b){var c=b.map(function(c,e){return 1==b.length&&d&&(c=Math.max(c,0)),a.numberToString(c)+f[e]}).join(" + ");return b.length>1?"calc("+c+")":c}]}var f="px|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc",g=c.bind(null,new RegExp(f,"g")),h=c.bind(null,new RegExp(f+"|%","g")),i=c.bind(null,/deg|rad|grad|turn/g);a.parseLength=g,a.parseLengthOrPercent=h,a.consumeLengthOrPercent=a.consumeParenthesised.bind(null,h),a.parseAngle=i,a.mergeDimensions=e;var j=a.consumeParenthesised.bind(null,g),k=a.consumeRepeated.bind(void 0,j,/^/),l=a.consumeRepeated.bind(void 0,k,/^,/);a.consumeSizePairList=l;var m=function(a){var b=l(a);return b&&""==b[1]?b[0]:void 0},n=a.mergeNestedRepeated.bind(void 0,d," "),o=a.mergeNestedRepeated.bind(void 0,n,",");a.mergeNonNegativeSizePair=n,a.addPropertiesHandler(m,o,["background-size"]),a.addPropertiesHandler(h,d,["border-bottom-width","border-image-width","border-left-width","border-right-width","border-top-width","flex-basis","font-size","height","line-height","max-height","max-width","outline-width","width"]),a.addPropertiesHandler(h,e,["border-bottom-left-radius","border-bottom-right-radius","border-top-left-radius","border-top-right-radius","bottom","left","letter-spacing","margin-bottom","margin-left","margin-right","margin-top","min-height","min-width","outline-offset","padding-bottom","padding-left","padding-right","padding-top","perspective","right","shape-margin","text-indent","top","vertical-align","word-spacing"])}(d,f),function(a){function b(b){return a.consumeLengthOrPercent(b)||a.consumeToken(/^auto/,b)}function c(c){var d=a.consumeList([a.ignore(a.consumeToken.bind(null,/^rect/)),a.ignore(a.consumeToken.bind(null,/^\(/)),a.consumeRepeated.bind(null,b,/^,/),a.ignore(a.consumeToken.bind(null,/^\)/))],c);return d&&4==d[0].length?d[0]:void 0}function d(b,c){return"auto"==b||"auto"==c?[!0,!1,function(d){var e=d?b:c;if("auto"==e)return"auto";var f=a.mergeDimensions(e,e);return f[2](f[0])}]:a.mergeDimensions(b,c)}function e(a){return"rect("+a+")"}var f=a.mergeWrappedNestedRepeated.bind(null,e,d,", ");a.parseBox=c,a.mergeBoxes=f,a.addPropertiesHandler(c,f,["clip"])}(d,f),function(a){function b(a){return function(b){var c=0;return a.map(function(a){return a===j?b[c++]:a})}}function c(a){return a}function d(b){if(b=b.toLowerCase().trim(),"none"==b)return[];for(var c,d=/\s*(\w+)\(([^)]*)\)/g,e=[],f=0;c=d.exec(b);){if(c.index!=f)return;f=c.index+c[0].length;var g=c[1],h=m[g];if(!h)return;var i=c[2].split(","),j=h[0];if(j.length<i.length)return;for(var n=[],o=0;o<j.length;o++){var p,q=i[o],r=j[o];if(p=q?{A:function(b){return"0"==b.trim()?l:a.parseAngle(b)},N:a.parseNumber,T:a.parseLengthOrPercent,L:a.parseLength}[r.toUpperCase()](q):{a:l,n:n[0],t:k}[r],void 0===p)return;n.push(p)}if(e.push({t:g,d:n}),d.lastIndex==b.length)return e}}function e(a){return a.toFixed(6).replace(".000000","")}function f(b,c){if(b.decompositionPair!==c){b.decompositionPair=c;var d=a.makeMatrixDecomposition(b)}if(c.decompositionPair!==b){c.decompositionPair=b;var f=a.makeMatrixDecomposition(c)}return null==d[0]||null==f[0]?[[!1],[!0],function(a){return a?c[0].d:b[0].d}]:(d[0].push(0),f[0].push(1),[d,f,function(b){var c=a.quat(d[0][3],f[0][3],b[5]),g=a.composeMatrix(b[0],b[1],b[2],c,b[4]),h=g.map(e).join(",");return h}])}function g(a){return a.replace(/[xy]/,"")}function h(a){return a.replace(/(x|y|z|3d)?$/,"3d")}function i(b,c){var d=a.makeMatrixDecomposition&&!0,e=!1;if(!b.length||!c.length){b.length||(e=!0,b=c,c=[]);for(var i=0;i<b.length;i++){var j=b[i].t,k=b[i].d,l="scale"==j.substr(0,5)?1:0;c.push({t:j,d:k.map(function(a){if("number"==typeof a)return l;var b={};for(var c in a)b[c]=l;return b})})}}var n=function(a,b){return"perspective"==a&&"perspective"==b||("matrix"==a||"matrix3d"==a)&&("matrix"==b||"matrix3d"==b)},o=[],p=[],q=[];if(b.length!=c.length){if(!d)return;var r=f(b,c);o=[r[0]],p=[r[1]],q=[["matrix",[r[2]]]]}else for(var i=0;i<b.length;i++){var j,s=b[i].t,t=c[i].t,u=b[i].d,v=c[i].d,w=m[s],x=m[t];if(n(s,t)){if(!d)return;var r=f([b[i]],[c[i]]);o.push(r[0]),p.push(r[1]),q.push(["matrix",[r[2]]])}else{if(s==t)j=s;else if(w[2]&&x[2]&&g(s)==g(t))j=g(s),u=w[2](u),v=x[2](v);else{if(!w[1]||!x[1]||h(s)!=h(t)){if(!d)return;var r=f(b,c);o=[r[0]],p=[r[1]],q=[["matrix",[r[2]]]];break}j=h(s),u=w[1](u),v=x[1](v)}for(var y=[],z=[],A=[],B=0;B<u.length;B++){var C="number"==typeof u[B]?a.mergeNumbers:a.mergeDimensions,r=C(u[B],v[B]);y[B]=r[0],z[B]=r[1],A.push(r[2])}o.push(y),p.push(z),q.push([j,A])}}if(e){var D=o;o=p,p=D}return[o,p,function(a){return a.map(function(a,b){var c=a.map(function(a,c){return q[b][1][c](a)}).join(",");return"matrix"==q[b][0]&&16==c.split(",").length&&(q[b][0]="matrix3d"),q[b][0]+"("+c+")"}).join(" ")}]}var j=null,k={px:0},l={deg:0},m={matrix:["NNNNNN",[j,j,0,0,j,j,0,0,0,0,1,0,j,j,0,1],c],matrix3d:["NNNNNNNNNNNNNNNN",c],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",b([j,j,1]),c],scalex:["N",b([j,1,1]),b([j,1])],scaley:["N",b([1,j,1]),b([1,j])],scalez:["N",b([1,1,j])],scale3d:["NNN",c],skew:["Aa",null,c],skewx:["A",null,b([j,l])],skewy:["A",null,b([l,j])],translate:["Tt",b([j,j,k]),c],translatex:["T",b([j,k,k]),b([j,k])],translatey:["T",b([k,j,k]),b([k,j])],translatez:["L",b([k,k,j])],translate3d:["TTL",c]};a.addPropertiesHandler(d,i,["transform"])}(d,f),function(a){function b(a){var b=Number(a);return isNaN(b)||100>b||b>900||b%100!==0?void 0:b}function c(b){return b=100*Math.round(b/100),b=a.clamp(100,900,b),400===b?"normal":700===b?"bold":String(b)}function d(a,b){return[a,b,c]}a.addPropertiesHandler(b,d,["font-weight"])}(d),function(a){function b(a){var b={};for(var c in a)b[c]=-a[c];return b}function c(b){return a.consumeToken(/^(left|center|right|top|bottom)\b/i,b)||a.consumeLengthOrPercent(b)}function d(b,d){var e=a.consumeRepeated(c,/^/,d);if(e&&""==e[1]){var f=e[0];if(f[0]=f[0]||"center",f[1]=f[1]||"center",3==b&&(f[2]=f[2]||{px:0}),f.length==b){if(/top|bottom/.test(f[0])||/left|right/.test(f[1])){var h=f[0];f[0]=f[1],f[1]=h}if(/left|right|center|Object/.test(f[0])&&/top|bottom|center|Object/.test(f[1]))return f.map(function(a){return"object"==typeof a?a:g[a]})}}}function e(d){var e=a.consumeRepeated(c,/^/,d);if(e){for(var f=e[0],h=[{"%":50},{"%":50}],i=0,j=!1,k=0;k<f.length;k++){var l=f[k];"string"==typeof l?(j=/bottom|right/.test(l),i={left:0,right:0,center:i,top:1,bottom:1}[l],h[i]=g[l],"center"==l&&i++):(j&&(l=b(l),l["%"]=(l["%"]||0)+100),h[i]=l,i++,j=!1)}return[h,e[1]]}}function f(b){var c=a.consumeRepeated(e,/^,/,b);return c&&""==c[1]?c[0]:void 0}var g={left:{"%":0},center:{"%":50},right:{"%":100},top:{"%":0},bottom:{"%":100}},h=a.mergeNestedRepeated.bind(null,a.mergeDimensions," ");a.addPropertiesHandler(d.bind(null,3),h,["transform-origin"]),a.addPropertiesHandler(d.bind(null,2),h,["perspective-origin"]),a.consumePosition=e,a.mergeOffsetList=h;var i=a.mergeNestedRepeated.bind(null,h,", ");a.addPropertiesHandler(f,i,["background-position","object-position"])}(d),function(a){function b(b){var c=a.consumeToken(/^circle/,b);if(c&&c[0])return["circle"].concat(a.consumeList([a.ignore(a.consumeToken.bind(void 0,/^\(/)),d,a.ignore(a.consumeToken.bind(void 0,/^at/)),a.consumePosition,a.ignore(a.consumeToken.bind(void 0,/^\)/))],c[1]));var f=a.consumeToken(/^ellipse/,b);if(f&&f[0])return["ellipse"].concat(a.consumeList([a.ignore(a.consumeToken.bind(void 0,/^\(/)),e,a.ignore(a.consumeToken.bind(void 0,/^at/)),a.consumePosition,a.ignore(a.consumeToken.bind(void 0,/^\)/))],f[1]));var g=a.consumeToken(/^polygon/,b);return g&&g[0]?["polygon"].concat(a.consumeList([a.ignore(a.consumeToken.bind(void 0,/^\(/)),a.optional(a.consumeToken.bind(void 0,/^nonzero\s*,|^evenodd\s*,/),"nonzero,"),a.consumeSizePairList,a.ignore(a.consumeToken.bind(void 0,/^\)/))],g[1])):void 0}function c(b,c){return b[0]===c[0]?"circle"==b[0]?a.mergeList(b.slice(1),c.slice(1),["circle(",a.mergeDimensions," at ",a.mergeOffsetList,")"]):"ellipse"==b[0]?a.mergeList(b.slice(1),c.slice(1),["ellipse(",a.mergeNonNegativeSizePair," at ",a.mergeOffsetList,")"]):"polygon"==b[0]&&b[1]==c[1]?a.mergeList(b.slice(2),c.slice(2),["polygon(",b[1],g,")"]):void 0:void 0}var d=a.consumeParenthesised.bind(null,a.parseLengthOrPercent),e=a.consumeRepeated.bind(void 0,d,/^/),f=a.mergeNestedRepeated.bind(void 0,a.mergeDimensions," "),g=a.mergeNestedRepeated.bind(void 0,f,",");a.addPropertiesHandler(b,c,["shape-outside"])}(d),function(a){function b(a,b){b.concat([a]).forEach(function(b){b in document.documentElement.style&&(c[a]=b)})}var c={};b("transform",["webkitTransform","msTransform"]),b("transformOrigin",["webkitTransformOrigin"]),b("perspective",["webkitPerspective"]),b("perspectiveOrigin",["webkitPerspectiveOrigin"]),a.propertyName=function(a){return c[a]||a}}(d,f)}()}({},function(){return this}()),define("components/web-animations-js/web-animations.min",function(){}),define("src/util/util",["src/util/debug","src/util/color","lodash","src/data/structures","components/web-animations-js/web-animations.min"],function(Debug,Color,_,structures){function noop(){}function makejPathFunction(jpath){if(!jpath)return noop;for(var jpaths2=jpath.replace(regJpath,""),splitted=jpaths2.split("."),l=splitted.length-1,ifArray=[],ifString,ifElement="el",i=0;l>i;i++)ifElement+='["'+splitted[i].replace(regQuote,'\\"')+'"]',ifArray.push(ifElement+" != undefined");ifString=ifArray.join(" && "),ifString||(ifString="true");var functionEvaled=noop;return eval("functionEvaled = function( el ) { if (el && "+ifString+") return "+ifElement+'["'+splitted[l].replace(regQuote,'\\"')+'"]; };'),functionEvaled}function getCSS(a,b){if(a=a.toLowerCase(),document.styleSheets){for(var c,d,e,f=0;f<document.styleSheets.length;f++){c=document.styleSheets[f],d=0,e=!1;do if(e=c.cssRules?c.cssRules[d]:c.rules?c.rules[d]:null,e&&e.selectorText){if(e.selectorText.toLowerCase()==a)return b?(c.cssRules?c.deleteRule(d):c.removeRule(d),!0):e;d++}else d++;while(e)}return!1}}var months=["January","February","March","April","Mai","June","July","August","September","October","November","December"],days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],regQuote=/"/g,regJpath=/^element\./,units=["B","KiB","MiB","GiB","TiB"],exports={getCurrentLang:function(){return"en"},maskIframes:function(){$("iframe").each(function(){var a=$(this),b=a.position(),c=a.width(),d=a.height();a.before($("<div />").css({position:"absolute",width:c,height:d,top:b.top,left:b.left,background:"white",opacity:.5}).addClass("iframemask"))})},unmaskIframes:function(){$(".iframemask").remove()},formatSize:function(a){for(var b=0;a>1024;)a/=1024,b++;return Math.round(100*a)/100+" "+units[b]},pad:function(a){return 10>a?"0"+a:a},getMonth:function(a){return months[a]},getDay:function(a){return days[a]},loadCss:function(a){var b=this;return new Promise(function(c,d){if(a=require.toUrl(a),b.loadedCss=b.loadedCss||{},b.loadedCss[a])return b.loadedCss[a].disabled=!1,c(b.loadedCss[a]);var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=a,e.onload=function(){b.loadedCss[a]=e,c(e)};try{document.getElementsByTagName("head")[0].appendChild(e)}catch(a){d(a)}})},unloadCss:function(a){var b=this;a=require.toUrl(a),b.loadedCss[a]&&(b.loadedCss[a].disabled=!0)},getCssVendorPrefix:function(){var a=window.getComputedStyle(document.documentElement,""),b=(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1];return"-"+b+"-"},makejPathFunction:makejPathFunction,addjPathFunction:function(a,b){a[b]=makejPathFunction(b)},jpathToArray:function(a){if(a){var b=a.split(".");return b.shift(),b}return[]},jpathToString:function(a){return a=a||[],a=a.slice(),a.unshift("element"),a.join(".")},getWebsafeFonts:function(){return[{title:"Arial",key:"Arial"},{title:"Arial Black",key:"Arial Black"},{title:"Comic Sans MS",key:"Comic Sans MS"},{title:"Courier",key:"Courier"},{title:"Courier new",key:"Courier New"},{title:"Georgia",key:"Georgia"},{title:"Helvetica",key:"Helvetica"},{title:"Impact",key:"Impact"},{title:"Palatino",key:"Palatino"},{title:"Times new roman",key:"Times New Roman"},{title:"Trebuchet MS",key:"Trebuchet MS"},{title:"Verdana",key:"Verdana"}]},getCSS:getCSS,removeCSS:function(a){return getCSS(a,!0)},addCSS:function(a){if(document.styleSheets){var b;return(b=getCSS(a))?b:(document.styleSheets[0].addRule?document.styleSheets[0].addRule(a,null,0):document.styleSheets[0].insertRule(a+" { }",0),getCSS(a))}},formatMoney:function(a,b,c,d){b=isNaN(b=Math.abs(b))?2:b,d=void 0==d?".":d,c=void 0==c?",":c;var e=0>a?"-":"",f=parseInt(a=Math.abs(+a||0).toFixed(b))+"",g=f.length;return g=g>3?g%3:0,e+(g?f.substr(0,g)+c:"")+f.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+c)+(b?d+Math.abs(a-f).toFixed(b).slice(2):"")},safeAccess:function(){for(var a=arguments[0],b=1;b<arguments.length;b++)if(!(a=a[arguments[b]]))return!1;return a}};exports.noop=function(){};var uniqueid=0;exports.getNextUniqueId=function(a){return a?"id_"+Date.now()+Math.round(1e5*Math.random()):"uniqid_"+ ++uniqueid},exports.deprecate=function(a,b){var c=!1;return function(){return c||(Debug.warn("Method "+a.name+" is deprecated. "+(b||"")),c=!0),a.apply(this,arguments)}};var warnOnceMap,warnOnceCheck;"undefined"==typeof Set?(warnOnceMap={},warnOnceCheck=function(a){return warnOnceMap[a]?!0:(warnOnceMap[a]=!0,!1)}):(warnOnceMap=new Set,warnOnceCheck=function(a){return warnOnceMap.has(a)?!0:(warnOnceMap.add(a),!1)}),exports.warnOnce=function(a,b){warnOnceCheck(a)||Debug.warn(b)},exports.inherits=function(a,b,c){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),c&&_.assign(a.prototype,c)},exports.getLoadingAnimation=function(a,b){void 0===a&&(a=32),void 0===b&&(b="black");var c=$('        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="32" height="32" fill="black">            <rect x="0" y="12" width="4" height="8"></rect>            <rect x="7" y="12" width="4" height="8"></rect>            <rect x="14" y="12" width="4" height="8"></rect>            <rect x="21" y="12" width="4" height="8"></rect>            <rect x="28" y="12" width="4" height="8"></rect>        </svg>').attr({width:a,height:a,fill:b}),d=0,e=1e3;return c.find("rect").each(function(){this.animate([{transform:"scale(1,1)"},{transform:"matrix(1,0,0,2,0,-16)"},{transform:"scale(1,1)"},{transform:"scale(1,1)"},{transform:"scale(1,1)"}],{duration:e,iterations:1/0,delay:d}),d+=e/6}),c},exports.moduleIdFromUrl=function(a){var b=/([^\/]+)(\/)?$/,c=a.match(b);return c[1]},exports.requireNeedsExtension=function(a){return/^https?:\/\/|^\.|^\/|^\/\//.test(a)};var utilReqPaths={};exports.rewriteRequirePath=function(a){var b=require.toUrl(a);if(!this.requireNeedsExtension(a))return a;var c=exports.getNextUniqueId(!0);if(utilReqPaths[b])return utilReqPaths[a];utilReqPaths[b]=c;var d={};return d[c]=b,require.config({paths:d}),c};var objToString=Object.prototype.toString;exports.objectToString=function(a){return objToString.call(a).slice(8,-1)},exports.isArray=function(a){return"Array"===exports.objectToString(a).slice("-5")},exports.getDistinctColors=exports.deprecate(Color.getDistinctColors,"use Color.getDistinctColors"),exports.getNextColorRGB=exports.deprecate(Color.getNextColorRGB,"use Color.getNextColorRGB"),exports.hsl2rgb=exports.deprecate(Color.hsl2rgb,"use Color.hsl2rgb"),exports.hueToRgb=exports.deprecate(Color.hue2rgb,"use Color.hue2rgb"),exports.hexToRgb=exports.deprecate(Color.hex2rgb,"use Color.hex2rgb"),exports.rgbToHex=exports.deprecate(Color.rgb2hex,"use Color.rgb2hex"),exports.getColor=exports.deprecate(Color.getColor,"use Color.getColor"),exports.evalOptions=function(options){var result;if(options){options.match(/^\s*\{/)||(options="{"+options+"}");try{return eval("result = "+options),result}catch(a){return void Debug.warn("could not eval options")}}};var isEmail=/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i;return exports.isEmail=function(a){return isEmail.test(a)},exports.b64toBlob=function(a,b,c){b=b||"",c=c||512;for(var d=atob(a),e=[],f=0;f<d.length;f+=c){for(var g=d.slice(f,f+c),h=new Array(g.length),i=0;i<g.length;i++)h[i]=g.charCodeAt(i);var j=new Uint8Array(h);e.push(j)}var k=new Blob(e,{type:b});return k},exports.getStructuresComboOptions=function(){var a=[];a.push({key:"",title:"none"});for(var b=structures._getList(),c=b.length,d=0;c>d;d++)a.push({key:b[d],title:b[d]});return a},exports.contentTypeToType=function(a){switch(a){case"image/gif":return"gif";case"image/tif":case"image/tiff":return"tiff";case"image/jpg":case"image/jpeg":return"jpg";case"image/png":return"png";case"image/svg":return"svg";case"chemical/x-jcamp-dx":return"jcamp";case"chemical/x-mdl-sdfile":return"sdf";case"chemical/x-mdl-molfile":return"mol2d";case"text/html":return"html";case"text/plain":return"string";default:return null}},exports}),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("components/superagent-dist/superagent",[],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.superagent=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a){return a?e(a):void 0}function e(a){for(var b in d.prototype)a[b]=d.prototype[b];return a}b.exports=d,d.prototype.on=d.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},d.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},d.prototype.off=d.prototype.removeListener=d.prototype.removeAllListeners=d.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},d.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;e>d;++d)c[d].apply(this,b)}return this},d.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},d.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],2:[function(a,b,c){b.exports=function(a,b,c){for(var d=0,e=a.length,f=3==arguments.length?c:a[d++];e>d;)f=b.call(null,f,a[d],++d,a);return f}},{}],superagent:[function(a,b,c){function d(){}function e(a){var b={}.toString.call(a);switch(b){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function f(a){return a===Object(a)}function g(a){if(!f(a))return a;var b=[];for(var c in a)null!=a[c]&&h(b,c,a[c]);return b.join("&")}function h(a,b,c){return Array.isArray(c)?c.forEach(function(c){h(a,b,c)}):void a.push(encodeURIComponent(b)+"="+encodeURIComponent(c))}function i(a){for(var b,c,d={},e=a.split("&"),f=0,g=e.length;g>f;++f)c=e[f],b=c.split("="),d[decodeURIComponent(b[0])]=decodeURIComponent(b[1]);return d}function j(a){var b,c,d,e,f=a.split(/\r?\n/),g={};f.pop();for(var h=0,i=f.length;i>h;++h)c=f[h],b=c.indexOf(":"),d=c.slice(0,b).toLowerCase(),e=u(c.slice(b+1)),g[d]=e;return g}function k(a){return/[\/+]json\b/.test(a)}function l(a){return a.split(/ *; */).shift()}function m(a){return t(a.split(/ *; */),function(a,b){var c=b.split(/ *= */),d=c.shift(),e=c.shift();return d&&e&&(a[d]=e),a},{})}function n(a,b){b=b||{},this.req=a,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=j(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function o(a,b){var c=this;s.call(this),this._query=this._query||[],this.method=a,this.url=b,this.header={},this._header={},this.on("end",function(){var a=null,b=null;try{b=new n(c)}catch(b){return a=new Error("Parser is unable to parse the response"),a.parse=!0,a.original=b,a.rawResponse=c.xhr&&c.xhr.responseText?c.xhr.responseText:null,c.callback(a)}if(c.emit("response",b),a)return c.callback(a,b);if(b.status>=200&&b.status<300)return c.callback(a,b);var d=new Error(b.statusText||"Unsuccessful HTTP response");d.original=a,d.response=b,d.status=b.status,c.callback(d,b)})}function p(a,b){return"function"==typeof b?new o("GET",a).end(b):1==arguments.length?new o("GET",a):new o(a,b)}function q(a,b){var c=p("DELETE",a);return b&&c.end(b),c}var r,s=a("emitter"),t=a("reduce");r="undefined"!=typeof window?window:"undefined"!=typeof self?self:this,p.getXHR=function(){if(!(!r.XMLHttpRequest||r.location&&"file:"==r.location.protocol&&r.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}return!1};var u="".trim?function(a){return a.trim()}:function(a){return a.replace(/(^\s*|\s*$)/g,"")};p.serializeObject=g,p.parseString=i,p.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},p.serialize={"application/x-www-form-urlencoded":g,"application/json":JSON.stringify},p.parse={"application/x-www-form-urlencoded":i,"application/json":JSON.parse},n.prototype.get=function(a){return this.header[a.toLowerCase()]},n.prototype.setHeaderProperties=function(a){var b=this.header["content-type"]||"";this.type=l(b);var c=m(b);for(var d in c)this[d]=c[d]},n.prototype.parseBody=function(a){var b=p.parse[this.type];return b&&a&&(a.length||a instanceof Object)?b(a):null},n.prototype.setStatusProperties=function(a){1223===a&&(a=204);var b=a/100|0;this.status=this.statusCode=a,this.statusType=b,this.info=1==b,this.ok=2==b,this.clientError=4==b,this.serverError=5==b,this.error=4==b||5==b?this.toError():!1,this.accepted=202==a,this.noContent=204==a,this.badRequest=400==a,this.unauthorized=401==a,this.notAcceptable=406==a,this.notFound=404==a,this.forbidden=403==a},n.prototype.toError=function(){var a=this.req,b=a.method,c=a.url,d="cannot "+b+" "+c+" ("+this.status+")",e=new Error(d);return e.status=this.status,e.method=b,e.url=c,e},p.Response=n,s(o.prototype),o.prototype.use=function(a){return a(this),this},o.prototype.timeout=function(a){return this._timeout=a,this},o.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},o.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},o.prototype.set=function(a,b){if(f(a)){for(var c in a)this.set(c,a[c]);return this}return this._header[a.toLowerCase()]=b,this.header[a]=b,this},o.prototype.unset=function(a){return delete this._header[a.toLowerCase()],delete this.header[a],this},o.prototype.getHeader=function(a){return this._header[a.toLowerCase()]},o.prototype.type=function(a){return this.set("Content-Type",p.types[a]||a),this},o.prototype.parse=function(a){return this._parser=a,this},o.prototype.accept=function(a){return this.set("Accept",p.types[a]||a),this},o.prototype.auth=function(a,b){var c=btoa(a+":"+b);return this.set("Authorization","Basic "+c),this},o.prototype.query=function(a){return"string"!=typeof a&&(a=g(a)),a&&this._query.push(a),this},o.prototype.field=function(a,b){return this._formData||(this._formData=new r.FormData),this._formData.append(a,b),this},o.prototype.attach=function(a,b,c){return this._formData||(this._formData=new r.FormData),this._formData.append(a,b,c),this},o.prototype.send=function(a){var b=f(a),c=this.getHeader("Content-Type");if(b&&f(this._data))for(var d in a)this._data[d]=a[d];else"string"==typeof a?(c||this.type("form"),c=this.getHeader("Content-Type"),"application/x-www-form-urlencoded"==c?this._data=this._data?this._data+"&"+a:a:this._data=(this._data||"")+a):this._data=a;return!b||e(a)?this:(c||this.type("json"),this)},o.prototype.callback=function(a,b){var c=this._callback;this.clearTimeout(),c(a,b)},o.prototype.crossDomainError=function(){var a=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");a.crossDomain=!0,a.status=this.status,a.method=this.method,a.url=this.url,this.callback(a)},o.prototype.timeoutError=function(){var a=this._timeout,b=new Error("timeout of "+a+"ms exceeded");b.timeout=a,this.callback(b)},o.prototype.withCredentials=function(){return this._withCredentials=!0,this},o.prototype.end=function(a){var b=this,c=this.xhr=p.getXHR(),f=this._query.join("&"),g=this._timeout,h=this._formData||this._data;this._callback=a||d,c.onreadystatechange=function(){if(4==c.readyState){var a;try{a=c.status}catch(b){a=0}if(0==a){if(b.timedout)return b.timeoutError();if(b.aborted)return;return b.crossDomainError()}b.emit("end")}};var i=function(a){a.total>0&&(a.percent=a.loaded/a.total*100),b.emit("progress",a)};this.hasListeners("progress")&&(c.onprogress=i);try{c.upload&&this.hasListeners("progress")&&(c.upload.onprogress=i)}catch(a){}if(g&&!this._timer&&(this._timer=setTimeout(function(){b.timedout=!0,b.abort()},g)),f&&(f=p.serializeObject(f),this.url+=~this.url.indexOf("?")?"&"+f:"?"+f),c.open(this.method,this.url,!0),this._withCredentials&&(c.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof h&&!e(h)){var j=this.getHeader("Content-Type"),l=this._parser||p.serialize[j?j.split(";")[0]:""];!l&&k(j)&&(l=p.serialize["application/json"]),l&&(h=l(h))}for(var m in this.header)null!=this.header[m]&&c.setRequestHeader(m,this.header[m]);return this.emit("request",this),c.send("undefined"!=typeof h?h:null),this},o.prototype.then=function(a,b){return this.end(function(c,d){c?b(c):a(d)})},p.Request=o,p.get=function(a,b,c){var d=p("GET",a);return"function"==typeof b&&(c=b,b=null),b&&d.query(b),c&&d.end(c),d},p.head=function(a,b,c){var d=p("HEAD",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},p.del=q,p.delete=q,p.patch=function(a,b,c){var d=p("PATCH",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},p.post=function(a,b,c){var d=p("POST",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},p.put=function(a,b,c){var d=p("PUT",a);return"function"==typeof b&&(c=b,b=null),b&&d.send(b),c&&d.end(c),d},b.exports=p},{emitter:1,reduce:2}]},{},[])("superagent")}),define("superagent",["components/superagent-dist/superagent"],function(a){function b(a,b){function c(){a.Request.apply(this,arguments)}c.prototype=Object.create(a.Request.prototype),c.prototype.end=function(c){var d=a.Request.prototype.end,e=this;return new b(function(a,b){d.call(e,function(d,e){c&&c(d,e),d?b(d):a(e)})})},c.prototype.then=function(c,d){var e=a.Request.prototype.end,f=this;return new b(function(a,b){e.call(f,function(c,d){c?b(c):a(d)})}).then(c,d)};var d=function(a,b){return new c(a,b)};return d.options=function(a){return d("OPTIONS",a)},d.head=function(a,b){var c=d("HEAD",a);return b&&c.send(b),c},d.get=function(a,b){var c=d("GET",a);return b&&c.query(b),c},d.post=function(a,b){var c=d("POST",a);return b&&c.send(b),c},d.put=function(a,b){var c=d("PUT",a);return b&&c.send(b),c},d.patch=function(a,b){var c=d("PATCH",a);return b&&c.send(b),c},d.del=function(a){return d("DELETE",a)},d}return b(a,Promise)}),define("src/util/lru",["jquery","src/util/debug"],function(a,b){function c(a,b){var c,d;return p[a]&&p[a][b]?(d=q[a],c=p[a][b],c.prev=d,c.next=d.next,d.next.prev=c,d.next=c,q[a]=c,c.data):void 0}function d(a,b,d){var e,f,g;return p[a]&&r[a]&&s[a]?(g=q[a],p[a][b]?c(a,b):(e={data:{data:d,timeout:Date.now()}},"undefined"==typeof g?(e.prev=e,e.next=e):(e.prev=g.prev,e.next=g.next,g.next.prev=e,g.next=e),q[a]=e,p[a][b]=e,r[a]++,r[a]>s[a]&&g&&(f=g.next,g.next.next.prev=g,g.next=g.next.next,f.next.next=void 0,f.next.prev=void 0,r[a]--),d)):void 0}function e(a,b){b=b||50,p[a]||(p[a]={},r[a]=0),s[a]=b}function f(c,d){d=d||500;var e=c,f=a.Deferred();return a.when(h()).then(function(){var a=o.transaction(["lru"],"readwrite").objectStore("lru"),b=a.get("__lrudata"+e);b.onsuccess=function(b){var c=b.target.result;c||a.put({index:"__lrudata"+e,data:{},store:e,key:"__lrudata",_count:0,_limit:d})},f.resolve()},function(){b.warn("IDB opening failure"),f.reject()}),f}function g(a){r[a]=0,p[a]={},q[a]=void 0}function h(){var c=a.Deferred();if(!t)return c.reject("No database to use");if(o)return c.resolve(o);if(l=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,m=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,n=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange,!l)return c.reject(),c;var d=l.open(t,1);return d.onsuccess=function(a){o=a.target.result,c.resolve()},d.onerror=function(a){b.info(a),c.reject()},d.onupgradeneeded=function(a){if(o=a.target.result,!o.objectStoreNames.contains("lru")){var b=o.createObjectStore("lru",{keyPath:"index"});b.createIndex("key","key",{unique:!0}),b.createIndex("store","store",{unique:!1}),b.onsuccess=function(){}}},c}function i(c,e){var f=a.Deferred();return a.when(h()).then(function(){var b=o.transaction("lru","readwrite").objectStore("lru"),g=b.get(c+e),h=a.Deferred(),i=a.Deferred();g.onsuccess=function(a){a.target.result?h.resolve(a.target.result.data):h.reject()},g=b.get("__lrudata"+c),g.onsuccess=function(a){var c=a.target.result;if(!c)return h.reject();c.data[e]=Date.now();var d=b.put(c);d.onsuccess=function(a){i.resolve()}},a.when(h,i).then(function(a){d(c,e,a),f.resolve(a)},function(){f.reject()})},function(){b.warn("IDB opening failure"),f.reject()}),f}function j(c,d,e){var f=c,g=a.Deferred();return a.when(h()).then(function(){var a=o.transaction(["lru"],"readwrite").objectStore("lru"),b=(a.put({data:{data:e,timeout:Date.now()},index:f+d,key:d,store:f}),a.get("__lrudata"+f));b.onsuccess=function(b){var c=b.target.result;
if(c||(c={}),c.data||(c.data={}),c.data[d]||(c._count=c._count+1),c.data[d]=Date.now(),c._count>c._limit){var e,g=Date.now();for(var h in c.data)c.data[h]<g&&(g=c.data[h],e=h);delete c.data[e],c._count--;a.delete(f+e)}a.put({index:"__lrudata"+f,data:c.data,store:f,key:"__lrudata",_count:c._count,_limit:c._limit})},g.resolve(e)},function(){b.warn("IDB opening failure"),g.reject()}),g}function k(a){o.transaction(["lru"],"readwrite").objectStore("lru").delete(a)}var l,m,n,o,p={},q={},r={},s={},t="cilru";return{useDb:function(a){t=a},create:function(a,b,c){e(a,b),f(a,c)},get:function(a,b){var d;return void 0!=(d=c(a,b))?d:void 0!=(d=i(a,b))?d:void 0},store:function(a,b,c){return d(a,b,c),j(a,b,c),c},empty:function(a,b,c){b&&g(a),c&&k(a)},exists:function(a){return p[a]}}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/util/urldata",["superagent","src/util/lru","src/util/debug"],function(a,b,c){function d(e,f){var i,j;try{i=new URL(e).host}catch(a){i=window.location.host}j=h[i],c.debug("DataURL: Looking for "+e+" by AJAX");var k=a.get(e).timeout(12e4).set(f||{});return j&&k.withCredentials(),k.end().then(function(a){if(delete g[e],200!=a.status)throw c.info("DataURL: Failing in retrieving "+e+" by AJAX."),new Error("Expected status !== 200, got "+a.status);var d=a.body||a.text;return c.info("DataURL: Found "+e+" by AJAX"),b.exists("urlData")||b.create("urlData",20,500),b.store("urlData",e,d),d},function(a){if(401===a.status&&void 0===h[i])return h[i]=!0,d(e,f);throw a})}function e(a,b,e,g){return c.debug("DataURL: Looking in LRU for "+a+" with timeout of "+e+" seconds"),f(a).then(function(b){return c.debug("DataURL: Found "+a+" in local DB. Timeout: "+b.timeout),void 0!==e&&Date.now()-b.timeout>1e3*e?(c.debug("DataURL: URL is over timeout threshold. Looking by AJAX"),d(a,g).catch(function(){return c.debug("DataURL: Failed in retrieving URL by AJAX. Fallback to cached version"),b.data})):(c.info("DataURL: URL is under timeout threshold. Return cached version"),b.data||b)},function(){return c.debug("DataURL: URL "+a+" not found in LRU. Look for AJAX"),d(a,g)})}function f(a){return c.debug("DataURL: Looking into LRU for "+a),Promise.resolve(b.get("urlData",a))}var g={},h={};return{get:function(a,b,h,i){return g[a]?g[a]:("number"==typeof b?(i=h,h=b,b=!1):"object"===("undefined"==typeof b?"undefined":_typeof(b))?(i=b,h=0,b=!1):"object"===("undefined"==typeof h?"undefined":_typeof(h))&&(i=h,h=0),c.debug("DataURL: getting "+a+" with force set to "+b+" and timeout to "+h),b||0>h||"undefined"==typeof h?d(a,i).catch(function(){return f(a).then(function(a){return a.data})}):e(a,b,h,i))},post:function(b,c,d){return d=d||"form",new Promise(function(e,f){a.post(b).type(d).send(c).end(function(a,b){a||200!=b.status?f(a||b.status):e(b.body||b.text)})})},emptyMemory:function(){b.empty("urlData",!0,!1)},emptyDB:function(){b.empty("urlData",!1,!0)},emptyAll:function(){b.empty("urlData",!0,!0)}}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/main/datas",["src/util/util","src/util/debug","src/util/urldata"],function(a,b,c){function d(a){if(a){for(var b in a)a.hasOwnProperty(b)&&(a[b]=d.check(a[b]));return d.check(a),a}}function e(a){var b="undefined"==typeof a?"undefined":_typeof(a);if("number"===b||"string"===b||"boolean"===b||null===a)return a;if("undefined"!==b&&"function"!==b){var c,f,g;if(m(a))return o(a);if(Array.isArray(a))for(g=a.length,c=new Array(g),a instanceof i&&(c=i(c)),f=0;g>f;f++)c[f]=e(a[f]);else{var h=Object.keys(a);for(g=h.length,c=a instanceof d?new d:{},f=0;g>f;f++)c[h[f]]=e(a[h[f]])}return c}}function f(a){Object.defineProperty(this,"s_",{value:String(a),writable:!0})}function g(a){Object.defineProperty(this,"s_",{value:Number(a),writable:!0})}function h(a){Object.defineProperty(this,"s_",{value:Boolean(a),writable:!0})}function i(a,b,c){var e=[];if(a){if(!Array.isArray(a))throw"DataArray can only be constructed from arrays";for(var f=0,g=a.length;g>f;f++)b?e[f]=d.check(a[f],b,c):e[f]=a[f]}return e.__proto__=i.prototype,e}function j(a,b){return l(a[b])||(a[b]=d.check(a[b],!0)),a[b]}function k(a,b){for(var c in b){var e=b[c];"object"===("undefined"==typeof e?"undefined":_typeof(e))?Array.isArray(e)?a.set(c,e,!0):null!==e&&(a.get(c)||a.set(c,new d,!0),k(a.get(c),e)):a.set(c,e,!0)}}function l(a){return a instanceof d||a instanceof i||m(a)}function m(a){return a instanceof f||a instanceof g||a instanceof h}function n(a){return a.hasOwnProperty("type")&&(a.hasOwnProperty("value")||a.hasOwnProperty("url"))}function o(a){var b;switch(m(a)?(b=a.getType(),a=a.get()):b="undefined"==typeof a?"undefined":_typeof(a),b){case"string":return new f(a);case"number":return new g(a);case"boolean":return new h(a)}}d.check=function(a,b){var c,e;if(l(a))return a;if(Array.isArray(a)){for(c=a;;){if(e=c.__proto__,null===e||e.constructor&&"Array"===e.constructor.name){c.__proto__=i.prototype;break}c=e}return a}if(null===a)return null;var f="undefined"==typeof a?"undefined":_typeof(a);if("object"===f){for(c=a;;){if(e=c.__proto__,null===e||e.constructor&&"Object"===e.constructor.name){c.__proto__=d.prototype;break}c=e}return a}return b?o(a):a},d.resurrect=function(a){return l(a)?a.resurrect():a},d.recursiveTransform=function(a,b){a=d.check(a,b);var c,e;if(Array.isArray(a))for(c=0,e=a.length;e>c;c++)a[c]=d.check(a[c],b),d.recursiveTransform(a[c],b);else if(a instanceof Object)for(c in a)a[c]=d.check(a[c],b),d.recursiveTransform(a[c],b);return a};var p={value:function(){return e(this)}};f.cast=function(a){return String(a)};for(var q=["charAt","charCodeAt","codePointAt","concat","includes","endsWith","indexOf","lastIndexOf","localeCompare","match","normalize","repeat","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim"],r=0,s=q.length;s>r;r++)!function(a){f.prototype[q[a]]=function(){return String.prototype[q[a]].apply(this.s_,arguments)}}(r);f.prototype.getType=function(){return"string"},f.prototype.nativeConstructor=String,g.cast=function(a){return Number(a)},g.prototype.getType=function(){return"number"},g.prototype.nativeConstructor=Number,h.cast=function(a){return a instanceof h?a.s_:Boolean(a)},h.prototype.getType=function(){return"boolean"},h.prototype.nativeConstructor=Boolean,window.DataString=f,window.DataNumber=g,window.DataBoolean=h,i.prototype=Object.create(Array.prototype),Object.defineProperty(i.prototype,"constructor",{value:i}),window.DataObject=d,window.DataArray=i;var t={value:function(){var a={};for(var b in this)l(this[b])?a[b]=this[b].resurrect():a[b]=this[b];return a}},u={value:function(){for(var a=[],b=0,c=this.length;c>b;b++)l(this[b])?a[b]=this[b].resurrect():a[b]=this[b];return a}},v={value:function(a,b,c){function e(b){return"object"!==("undefined"==typeof b?"undefined":_typeof(b))||null===b?b:"undefined"!=typeof b[a]?(j(b,a),b[a]instanceof d?b[a].fetch(!0):b[a]):c?(b[a]=new c,b[a]):void 0}if("string"==typeof a||"number"==typeof a){if(b)return this.get(!0).then(e);var f=this.get();return"object"!==("undefined"==typeof f?"undefined":_typeof(f))||null===f?f:"undefined"!=typeof f[a]?j(f,a):c?(f[a]=new c,f[a]):f[a]}return a===!0?this.hasOwnProperty("type")&&this.hasOwnProperty("value")?Promise.resolve(j(this,"value")):this.hasOwnProperty("type")&&this.hasOwnProperty("url")?this.fetch(!0).then(function(a){return a.get()}):Promise.resolve(this):this.hasOwnProperty("value")&&this.hasOwnProperty("type")?j(this,"value"):this}},w={value:function(a,b,c){var e=d.check(b,!0),f=this.get(),g=f[a];if(e){var h=e.getType();f[a]=d.check(f[a],!0);var i=void 0!=f[a]&&f[a].getType?f[a].getType():void 0;if(i!==h)f[a]=e;else if(m(f[a])||n(f[a])){var j=f[a]._dataChange;f[a]=e,f[a].linkToParent(this,a),f[a]._dataChange=j,c||(f[a].triggerChange(),c=!0)}else e!==f[a]&&(f[a]=e)}else f[a]=e;return c||this.triggerChange(!1,[]),g&&(delete g.__parent,delete g.__name,delete g._dataChange),f[a]}},x={value:function(a){if("string"==typeof a&&(a=a.split("."),a.shift()),!a||0===a.length)return Promise.resolve(this);a=a.slice();var b=a.shift();return this.get(b,!0).then(function(b){return b=d.check(b,!0),b&&0!==a.length?b.getChild(a):b})}},y={value:function(a){if(a&&a.split&&(a=a.split("."),a.shift()),!a||0===a.length)return Promise.resolve(this);a=a.slice();var b=a.shift(),c=this,e=this.get(b,!0);return e.then(function(e){return"undefined"!=typeof e?(c.get()[b]=d.check(e,!0),e&&e.linkToParent&&e.linkToParent(c,b),e&&0!==a.length?e.trace(a):e):e})}},z={value:function(a){return this.getChildSync(a,!0)}},A={value:function(a,b){if("string"==typeof a&&(a=a.split("."),a.shift()),a){a=a.slice();var c=a.shift(),d=this.get(c);if(null!=d)return b&&d.linkToParent(this,c),0===a.length?d:d.getChildSync(a,b)}}},B={value:function(a,b){this.__parent||(Object.defineProperty(this,"__parent",{value:a,writable:!1,configurable:!0,enumerable:!1}),Object.defineProperty(this,"__name",{value:b,writable:!1,configurable:!0,enumerable:!1}))}},C={value:function(a,b,c,e){var f=this;"string"==typeof a&&(a=a.split("."),a.shift()),a=a.slice();var g=a.length;if(0===g)throw new Error("setChild cannot be called with an empty jPath");var h=a.shift();if(1===g){var j=f.set(h,b,!0);return j&&j.linkToParent?(j.linkToParent(f,h),j.triggerChange(!1,c)):f.triggerChange(!1,c,h,j),Promise.resolve()}var k=0===a.length?e:"number"==typeof a[0]?i:d,l=h,m=[a,b,c,e];return this.get(h,!0,k).then(function(a){f.set(l,a,!0),a.linkToParent(f,l),a.setChild.apply(a,m)})}},D={value:function(a,b,c,e){var f=this;"string"==typeof a&&(a=a.split("."),a.shift()),a=a.slice();var g=a.length;if(0===g)throw new Error("setChild cannot be called with an empty jPath");var h=a.shift();if(1===g){var j=f.set(h,b,!0);return void(j&&j.linkToParent?(j.linkToParent(f,h),j.triggerChange(!1,c)):f.triggerChange(!1,c))}var k=0===a.length?e:"number"==typeof a[0]?i:d,l=h,m=[a,b,c,e],n=this.get(h,!1,k);this.set(l,n,!0),n.linkToParent(f,l),n.setChildSync.apply(n,m)}},E={value:function(a){if(this._dataChange)for(var b in this._dataChange)this._dataChange[b].apply(this,a);this.type&&this.url&&this.hasOwnProperty("value")&&(delete this.url,Object.defineProperty(this,"value",{enumerable:!0})),this.__parent&&(a[0].jpath.unshift(this.__name),this.__parent._triggerBubble.call(this.__parent,a))}},F={value:function(a,b,c,d){if(Array.isArray(b)||(b=void 0==b?[]:[b]),c?b.unshift({target:d,jpath:[c]}):b.unshift({target:this,jpath:[]}),this._dataChange)for(var e in this._dataChange)this._dataChange[e].apply(this,b);this.type&&this.url&&this.hasOwnProperty("value")&&(delete this.url,Object.defineProperty(this,"value",{enumerable:!0})),a||this.__parent&&(b[0].jpath.unshift(this.__name),this.__parent._triggerBubble.call(this.__parent,b))}},G={value:function(b){this._dataChange||Object.defineProperty(this,"_dataChange",{value:{},enumerable:!1,writable:!0,configurable:!0});var c=a.getNextUniqueId(!0);return this._dataChange[c]=b,b.id=c,c}},H={value:function(a){return this._dataChange?(a.id&&(a=a.id),void delete this._dataChange[a]):(b.info("Could not unbind event. No listener for this object"),!1)}},I={value:function(){var b=a.objectToString(this).toLowerCase();return"object"!==b?b:Array.isArray(this)?"array":n(this)?this.type:b}};d.getType=function(b){return l(b)?b.getType():a.objectToString(b).toLowerCase()};var J={value:function(a){var e=this;if(!this.url||!this.type||this.hasOwnProperty("value"))return Promise.resolve(this);if(this._fetching)return this._fetching;var f;return a&&(f={Accept:"application/json"}),this._fetching=c.get(this.url,!1,this.timeout,f).then(function(a){return delete e._fetching,a=d.check(a,!0),Object.defineProperty(e,"value",{enumerable:e._keep||!1,writable:!0,configurable:!0,value:a}),e},function(a){throw delete e._fetching,b.debug("Could not fetch "+e.url+" ("+a+")"),a}),this._fetching}},K={value:function(a,b,c){"object"!==("undefined"==typeof a?"undefined":_typeof(a))||Array.isArray(a)||null==a||(k(this,a),this.triggerChange(c,[b]))}},L={value:function(a,c,d){return this.triggerChange(d,[c]),b.warn("mergeWith method not yet implemented for DataArray")}},M={value:function(a,c){this.hasOwnProperty("type")&&this.hasOwnProperty("value")?(this.value instanceof f||this.value instanceof g||this.value instanceof h?this.value.setValue(a,!0):this.value=a,c||this.triggerChange(!1,[])):b.warn("Cannot set value of untyped DataObject")}},N={set:w,get:v,setChild:C,setChildSync:D,getChild:x,getChildSync:A,trace:y,duplicate:p,traceSync:z,onChange:G,unbindChange:H,triggerChange:F,_triggerBubble:E,linkToParent:B,getType:I,setValue:M};Object.defineProperties(d.prototype,N),Object.defineProperties(i.prototype,N),Object.defineProperty(d.prototype,"fetch",J),Object.defineProperty(d.prototype,"resurrect",t),Object.defineProperty(d.prototype,"mergeWith",K),Object.defineProperty(i.prototype,"resurrect",u),Object.defineProperty(i.prototype,"mergeWith",L);var O={value:function(){return this.s_}},P={value:function(a){return a&&0!==a.length?Promise.resolve():Promise.resolve(this)}},Q={value:function(a){return a&&0!==a.length?void 0:this}},R={value:function(a,b){this.s_=this.nativeConstructor(a),b||this.triggerChange(!1,[])}},S={value:function(){return String(this.s_)}},T={trace:y,onChange:G,unbindChange:H,triggerChange:F,linkToParent:B,toJSON:O,get:O,resurrect:O,getChild:P,getChildSync:Q,valueOf:O,setValue:R,toString:S};return Object.defineProperties(f.prototype,T),Object.defineProperties(g.prototype,T),Object.defineProperties(h.prototype,T),{DataObject:d,DataArray:i,DataString:f,DataBoolean:h,DataNumber:g,isSpecialObject:l,isSpecialNativeObject:m,resurrect:d.resurrect,check:d.check}}),define("src/util/cache",[],function(){var a={},b={};return b.get=function(b){return a[b]},b.set=function(b,c){return a[b]=c},b.clear=function(){a={}},b}),define("src/util/localdb",["jquery"],function(a){var b,c;return{open:function(){"indexedDB"in window||(window.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.oIndexedDB||window.msIndexedDB),window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;var d=a.Deferred();if(!indexedDB)return d.reject();if(b)return d.resolve();var e=indexedDB.open("ci",26);return e.onsuccess=function(a){c=!1,b=a.target.result,d.resolve()},e.onupgradeneeded=function(e){c=!1,b=e.target.result;a.Deferred(),a.Deferred();b.objectStoreNames.contains("localview")&&b.deleteObjectStore("localview"),b.objectStoreNames.contains("localdata")&&b.deleteObjectStore("localdata");var f=a.Deferred(),g=a.Deferred(),h=b.createObjectStore("localdata",{keyPath:"readURL"}),i=b.createObjectStore("localview",{keyPath:"readURL"});h.onsuccess=function(){f.resolve()},i.onsuccess=function(){g.resolve()},a.when(f,g).then(function(){d.resolve()})},e.onerror=function(a){d.reject()},d},getAll:function(c,d,e){var f=a.Deferred(),g=this;c="data"==c||"localdata"==c?"localdata":"localview";var h=b.transaction([c],"readwrite"),i=h.objectStore(c),j={};if(e)var k=i.get(d+";"+e);else var k=i.openCursor();return k.onsuccess=function(a){e?void 0==a.target.result?g.create(c,d,e).pipe(function(a){f.resolve(a)}):f.resolve(a.target.result):(a.target.result&&a.target.result.key.indexOf(d)>-1&&(j[a.target.result.value.branch]=a.target.result.value),a.target.result?a.target.result.continue():f.resolve(j))},k.onerror=function(){},f},create:function(c,d,e){var f={readURL:d+";"+e,url:d,branch:e,list:[],head:"{}"},g=a.Deferred();c="data"==c||"localdata"==c?"localdata":"localview";var h=b.transaction(c,"readwrite"),i=h.objectStore(c),j=i.put(f);return j.onsuccess=function(a){g.resolve(f)},g},storeToHead:function(c,d,e,f){var g=a.Deferred(),h=this;c="data"==c||"localdata"==c?"localdata":"localview";var i=b.transaction(c,"readwrite"),j=i.objectStore(c),k=j.get(d+";"+e);return k.onsuccess=function(a){if(a.target.result){var b=a.target.result;b.head=JSON.stringify(f);var i=j.put(b);i.onsuccess=function(a){g.resolve(f)}}else h.create(c,d,e).done(function(){h.storeToHead(c,d,e,f).done(function(){g.resolve(f)})})},g},store:function c(d,e,f,g){var h=a.Deferred();d="data"==d||"localdata"==d?"localdata":"localview";var i=b.transaction(d,"readwrite"),c=i.objectStore(d),j=c.get(e+";"+f),g=JSON.stringify(g);return j.onsuccess=function(a){if(null==a.target.result)b.create(d,e,f).done(function(a){var c=b.transaction(d,"readwrite"),e=c.objectStore(d);a.head=g;var f=e.put(a);f.onsuccess=function(a){h.resolve(g)}});else{var i=a.target.result;i.list.push(g);var j=c.put(i);j.onsuccess=function(a){h.resolve(g)}}},h},getHead:function(a,b,c){var d=this;return this.open().pipe(function(){return d.getAll(a,b,c).pipe(function(a){return a.head})})},getList:function(a,c,d){return b.getAll(a,c,d).pipe(function(a){return a.list})}}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/util/versionhandler",["src/util/util","src/util/localdb"],function(a,b){var c=function(a,b,c){this.currentPath=[],this._allData={},this.dom=$("<div />"),this.versionChangeDeferred=$.Deferred(),this._data={},this.structure={server:{title:"Server",children:{head:{title:"Head"},stored:{title:"Stored",children:!0}}},local:{title:"Local DB",children:{head:{title:"Head"},stored:{title:"Stored",children:!0}}}}};return c.prototype={setType:function(a){this.type=a},set reviver(a){this._reviver=a},getData:function(){var a=this;return"server"==this.currentPath[1]?this._getServer().pipe(function(b){return"view"==a.type?a._data.server=new DataObject(b,!0):"data"==a.type?a._data.server=new DataObject(b,!0):void 0},function(){return!1}):this._getLocal().pipe(function(b){return"object"!==("undefined"==typeof b?"undefined":_typeof(b))&&(b=JSON.parse(b)),"view"==a.type?a._data.local=new DataObject(b,!0):"data"==a.type?a._data.local=new DataObject(b,!0):void 0},function(){return!1})},getBranches:function(){var a=this;return $.when(this.getData()).pipe(function(b){var c={};for(var d in b)c[d]=d+" ("+(b[d].list.length+("local"==a.currentPath[1]?1:0))+")";return c})},getElements:function(a){var b=this,c=this.currentPath[2];return $.when(this.getData()).pipe(function(a){var d=a[c].list,e={};"local"==b.currentPath[1]&&a[c].head&&(e.head=b.makeFilename(a[c].head));for(var f=d.length-1;f>=0;f--)e[d[f]._time]=b.makeFilename(d[f]);return e})},makeFilename:function(b,c){if(!b._time)return"Head";var d=new Date(b._time),e=d.getDate()+"/"+d.getMonth()+"/"+d.getFullYear()+" ";return e+=a.pad(d.getHours())+":"+a.pad(d.getMinutes())},_getLocal:function(){var a=this;return b.open().pipe(function(){return b.getAll(a.type,a._dirUrl).pipe(function(a){return a})})},_getServer:function(){var a=$.Deferred();return $.ajax({url:this.getUrl(),type:"get",dataType:"json",data:{action:"Dir"},success:function(b){for(var c in b){b[c].list=[];for(var d in b[c].revisions)b[c].list.push({_time:b[c].revisions[d]})}a.resolve(b)},error:function(){a.reject()}}),a},makeMenu:function(a){var b=this.structure,c=this;return 1==a?b={server:"Server",local:"Local Database"}:2==a?b=this.getBranches():3==a&&(b=this.getElements()),$.when(b).pipe(function(b){return Array.isArray(b)?c.arrayToMenu(b,a,c.currentPath[a-1]||null,c.currentPath[a-2]||null):c.objectToMenu(b,a,c.currentPath[a-1]||null,c.currentPath[a-2]||null)})},arrayToMenu:function(a,b,c,d){for(var e="",f=0,g=a.length;g>f;f++)e+='<li draggable="false" data-parent-parent="'+d+'" data-parent="'+c+'" data-el="'+a[f][1]+'"><a>'+a[f][0]+(3>b?'<ul draggable="false" class="ci-dataview-menu" data-level="'+(b+1)+'"><li><a>Fetching data...</a></li></ul>':"")+"</a></li>";return e},objectToMenu:function(a,b,c,d){var e="";for(var f in a)e+='<li draggable="false" data-parent-parent="'+d+'" data-el="'+f+'" data-parent="'+c+'"><a>'+a[f]+(3>b?'<ul draggable="false" class="ci-dataview-menu" data-level="'+(b+1)+'"><li><a>Fetching data...</a></li></ul>':"")+"</a></li>";return e},bindEventsMenu:function(a){var b=this;a.on("mouseenter","li",function(a){var c=$(this);if(!(c.find(".ci-fetched").length>0)){var d=c.parent(),e=d.data("level");if(b.currentPath[e]=c.data("el"),3!=e)return b.makeMenu(e+1).then(function(a){a=$(a),c.find("ul").html(a).addClass("ci-fetched"),e+1==3&&"head"==b.currentPath[2]&&a.find("ul").remove(),b._menu.menu("refresh")},function(){c.find("ul").html("<li><a>No element here</a></li>").addClass("ci-fetched"),b._menu.menu("refresh")}),!1}}),a.on("mouseup","li",function(){var a=$(this),c=a.parent(),d=c.data("level");b.currentPath[d]=a.data("el"),a.find("ul").length>0||b.clickLeaf(a)})},buildDom:function(a){var b='<ul draggable="false" class="ci-dataview">';return b+=this._buildDomEl(1,this.currentPath[1]),b+=this._buildDomEl(2,this.currentPath[2]),b+=this._buildDomEl(3,this.makeFilename(a)),b+'<li class="ci-spacer"></li></ul>'},_buildDomEl:function(a,b){var c,d;return 1==a?"server"==b?(c="On Server",d="server"):(c="Local DB",d="local"):2==a?(c=b,d=b):(c=b,d=b),'<li draggable="false" class="ci-dataview-lvl ci-dataview-lvl-'+a+'" data-level="'+a+'" data-value="'+escape(d)+'">'+c+"</li>"+(3>a?'<li class="inter">></li>':"")},bindEventsDom:function(a){var b=this;a.on("mousedown","li",function(a){var c=$(this),d=c.position();b.makeMenu(c.data("level")).done(function(a){a=$('<ul draggable="false" class="ci-dataview-menu" data-level="'+c.data("level")+'"></ul>').append(a).menu(),b._menu=a,b.bindEventsMenu(a),a.appendTo("#visualizer-dataviews").css({position:"absolute",left:d.left,top:d.top+c.outerHeight(!0)})})}),$(document).on("mouseup",function(){$(".ci-dataview-menu").remove()})},getDom:function(){return this.dom},doUpdateButtons:function(){this.updateButtons&&this.updateButtons(this.type,this.currentPath[3],this.currentPath[1])},make:function(a,b,c){this.currentElement=a,this.doUpdateButtons();var d=$(this.buildDom(a));this.bindEventsDom(d),this.dom.empty().html(d),this.versionChange().notify(a),this._html=d},versionChange:function(){return this.versionChangeDeferred},clickLeaf:function(a){var b=this,c=a.data("el"),d=a.data("parent"),e=a.data("parent-parent");if("server"==e){var f={branch:d};"head"!==c&&(f.revision=c),this.getFromServer(f).done(function(a){b.currentPath[1]="server",b.currentPath[2]=d,b.currentPath[3]=c,b.make(a,d,c),b._savedServer=JSON.stringify(a),b.onReload(a)})}else $.when(this.getData()).done(function(a){if(a=a[d],"head"==c)a=a.head;else for(var e=0,f=a.list.length;f>e;e++)if(a.list[e]._time==c){a=a.list[e];break}b.currentPath[1]="local",b.currentPath[2]=d,b.currentPath[3]=c,b.make(a,d,c),b._savedLocal=JSON.stringify(a),b.onReload(a)})},loadReadonly:function(a,b){function c(b){b=d._reviver(JSON.parse(b)),d.make(b),d._onLoaded(b),a.resolve()}var d=this,e=this._defaultUrl,f=!0;b&&b.withCredentials&&(f=!1),$.ajax({url:e,timeout:2e5,dataType:"text",success:c,error:function(b){f?$.ajax({url:e,timeout:2e5,dataType:"text",success:c,error:function(b){a.reject(b)}}):a.reject(b)},xhrFields:{withCredentials:!0}})},load:function(a,b,c,d){function e(a,b,c){g.currentPath[1]="local",g.currentPath[2]=b,g.currentPath[3]=c,g._savedLocal=JSON.stringify(a),g.make(a,g.currentPath[2],g.currentPath[3]),h.resolve(a),g._onLoaded(a)}function f(a,b,c){g.currentPath[1]="server",g.currentPath[2]=b,g.currentPath[3]=c,g.make(a,g.currentPath[2],g.currentPath[3]),g._savedServer=JSON.stringify(a),h.resolve(a),g._onLoaded(a)}this._dirUrl=a,this._defaultUrl=c,this.defaultBranch=b;var g=this,h=$.Deferred();if(!this._dirUrl&&this._defaultUrl)return this.loadReadonly(h,d),h;var i=this.defaultBranch||"Master",j=this.getFromServer({branch:i,action:"Load"});g._getLocalHead(i);return $.when(j).then(function(a){var b=a._name||g.defaultBranch,c=a._time||"head",d=(a._saved||0,g._getLocalHead(b));$.when(d).then(function(d){if(d._saved){d._saved||0;d._name=b,f(a,b,c)}else g.serverCopy(a,b,"head").done(function(){e(a,a._name,"head")})},function(){f(a,b,c)})},function(a){$.when(g._getLocalHead(i)).then(function(a){e(a,i,a._time||"head")})}),h},getUrl:function(){return this._dirUrl},getMonth:function(b){return a.getMonth(b)},getDay:function(b){return a.getDay(b)},_getLocalHead:function(a){return a=a||"Master",b.getHead(this.type,this._dirUrl,a).pipe(function(a){return"object"!==("undefined"==typeof a?"undefined":_typeof(a))&&(a=JSON.parse(a)),a})},_localSave:function(a,c,d){var e=this;return a._local=!0,a._time="head"==c?!1:Date.now(),a._saved=Date.now(),b.open().pipe(function(){return b["head"==c?"storeToHead":"store"](e.type,e._dirUrl,d,a).pipe(function(b){return e.currentPath[1]="local",e.currentPath[2]=d,e.currentPath[3]=a._time||"head",b})})},localSave:function(a){this._localSave(a,a._time,a._name)},localSnapshot:function(a){a&&this._localSave(a,"stored",a._name||"Master").pipe(function(a){return a._time=!1,a})},localAutosave:function(a,b,c){var d=this;this._autosaveLocal&&window.clearInterval(this._autosaveLocal),a&&(this._autosaveLocal=window.setInterval(function(){var a=b();d._localSave(a,"head",a._name||"Master").done(function(){c&&c()})},1e4))},localBranch:function(a,b){a._name=b,a._time=!1;var c=this;return this._localSave(a,"head",b).pipe(function(a){c.make(a,c.currentPath[2],c.currentPath[3])})},localRevert:function(a){var b=this;a._time=!1,this._localSave(a,"head",a._name||"Master").done(function(a){b.make(a,b.currentPath[2],b.currentPath[3])})},autosaveServer:function(a,b,c){var d=this;this._autosaveServer&&window.clearInterval(this._autosaveServer),a&&(this._autosaveServer=window.setInterval(function(){d._saveToServer(b()).done(function(){c&&c()})},1e4))},_saveToServer:function(a){return a._local=!1,a._saved=Date.now(),a._time=Date.now(),this._savedServer=JSON.stringify(a),$.ajax({type:"post",url:this.getUrl(),data:{content:this._savedServer,branch:a._name,revision:a._saved,action:"Save"}})},getFromServer:function(a){var b=this,c=$.Deferred(),d=this.getUrl()||this._defaultUrl;return d?(a.action="Load",$.ajax({dataType:"text",type:"get",url:d,cache:!1,data:a||{},success:function(a){b._savedServer=a,a=b._reviver(JSON.parse(a)),c.resolve(a)},error:function(){c.reject()}}),c):c.resolve({})},serverCopy:function(a,b,c){var d=this;return a._name=a._name||b||"Master",a._time=!1,a._saved=Date.now(),this._localSave(a,"head",a._name).pipe(function(b){return d.make(b,a._name,"head")})},serverPush:function(a){return this._saveToServer(a)},_onLoaded:function(a){var b;b=DataObject.check(a,1),this.onLoaded(b)}},c}),define("src/main/variables",["jquery","src/util/util","src/main/datas","src/util/debug"],function(a,b,c,d){function e(a){var b=a.getId();for(var c in k)k[c].unlisten(b)}function f(a){return k[a]?k[a]:g(a)}function g(a){return k[a]=new m(a),k[a]}function h(a,b,c,d){var e=f(a),g=!1;return e.killFilter&&e.killFilter(),e.killFilter=!1,d&&(g=function(a,b,c){require([d],function(d){return d.kill&&(e.killFilter=d.kill),d.filter?d.filter(a,b,c):void c("No filter function defined")})}),b?e.setjPath(b,g):e.createData([a],c,g)}function i(){return Object.keys(k).sort()}function j(a,b){if(0!==a.jpath.length){var c,d,e,f,g,h=a.jpath,i=h.length;a:for(e in k)if(c=k[e],d=c.getjPath()){for(g=Math.min(d.length,i),f=0;g>f;f++)if(h[f]!==d[f])continue a;c.triggerChange(null,b)}}}var k={},l=new DataObject;l.onChange(j);var m=function(a){var b={writable:!0,enumerable:!1};Object.defineProperties(this,{_name:b,_jpath:b,_value:b,listenedBy:b,listeners:b}),this.defined=!1,this.setName(a),this.listenedBy={},this.listeners=[]};return a.extend(!0,m.prototype,{setName:function(a){this._name=a},getName:function(){return this._name},isDefined:function(){return this.defined},setjPath:function(a,b){return this._jpath=a,"string"==typeof this._jpath&&(this._jpath=this._jpath.split("."),this._jpath.shift()),this.triggerChange(b)},getjPath:function(){return this._jpath},createData:function(a,b,c){b=DataObject.resurrect(b);var d=l.setChild(a,b);return this.setjPath(a,c),d.then(function(){return b})},getData:function(){return this._value},setData:function(a){l.setChild(this.getjPath(),a),this._setValue(a),a.triggerChange()},_setValue:function(a){this._value=a,this.defined=!0},getValue:function(){return this._value},listen:function(a,b){var c=a.getId();this.listenedBy[c]||(this.listenedBy[c]=!0,this.listeners.push({callback:b,id:c}))},unlisten:function(a){if(this.listenedBy[a]){delete this.listenedBy[a];for(var b=0,c=this.listeners.length;c>b;b++)if(this.listeners[b].id===a){this.listeners.splice(b,1);break}}},triggerChange:function(a,b){var c=this;this.rejectCurrentPromise&&(this.rejectCurrentPromise("latency"),this.rejectCurrentPromise=!1),this.currentPromise=new Promise(function(b,e){c.rejectCurrentPromise=e;var f=b,g=e;l.trace(c._jpath).then(function(b){a?new Promise(function(c,d){a(b,c,d)}).then(function(a){a=DataObject.check(a,!0),c._setValue(a),f(a)},function(a){d.warn("Error during variable filtering : ",a),g("filter")}):(c._setValue(b),f(b))},function(a){g(a)})});for(var e=this.currentPromise.catch(function(a){"filter"!==a&&"latency"!==a&&d.error("Error in getting the variable through variable.js",a.stack||a)}),f=0,g=c.listeners.length;g>f;f++)c.listeners[f].id!==b&&c.listeners[f].callback.call(c,c);return e},onReady:function(){return this.currentPromise}}),{getVariable:f,setVariable:h,getNames:i,getData:function(){return l},exist:function(a){return k.hasOwnProperty(a)},unlisten:e,eraseAll:function(){k={}}}}),function(a){function b(a,b){var c=b?S[ha]:S[ea];return c.test(a)?new e(a,b):null}function c(a,c){var d=b(a,c);return d?d.version:null}function d(a,c){var d=b(a.trim().replace(/^[=v]+/,""),c);return d?d.version:null}function e(a,b){if(a instanceof e){if(a.loose===b)return a;a=a.version}else if("string"!=typeof a)throw new TypeError("Invalid Version: "+a);if(!(this instanceof e))return new e(a,b);this.loose=b;var c=a.trim().match(b?S[ha]:S[ea]);if(!c)throw new TypeError("Invalid Version: "+a);this.raw=a,this.major=+c[1],this.minor=+c[2],this.patch=+c[3],c[4]?this.prerelease=c[4].split(".").map(function(a){return/^[0-9]+$/.test(a)?+a:a}):this.prerelease=[],this.build=c[5]?c[5].split("."):[],this.format()}function f(a,b,c,d){"string"==typeof c&&(d=c,c=void 0);try{return new e(a,c).inc(b,d).version}catch(a){return null}}function g(a,c){if(t(a,c))return null;var d=b(a),e=b(c);if(d.prerelease.length||e.prerelease.length){for(var f in d)if(("major"===f||"minor"===f||"patch"===f)&&d[f]!==e[f])return"pre"+f;return"prerelease"}for(var f in d)if(("major"===f||"minor"===f||"patch"===f)&&d[f]!==e[f])return f}function h(a,b){var c=Ha.test(a),d=Ha.test(b);return c&&d&&(a=+a,b=+b),c&&!d?-1:d&&!c?1:b>a?-1:a>b?1:0}function i(a,b){return h(b,a)}function j(a,b){return new e(a,b).major}function k(a,b){return new e(a,b).minor}function l(a,b){return new e(a,b).patch}function m(a,b,c){return new e(a,c).compare(b)}function n(a,b){return m(a,b,!0)}function o(a,b,c){return m(b,a,c)}function p(b,c){return b.sort(function(b,d){return a.compare(b,d,c)})}function q(b,c){return b.sort(function(b,d){return a.rcompare(b,d,c)})}function r(a,b,c){return m(a,b,c)>0}function s(a,b,c){return m(a,b,c)<0}function t(a,b,c){return 0===m(a,b,c)}function u(a,b,c){return 0!==m(a,b,c)}function v(a,b,c){return m(a,b,c)>=0}function w(a,b,c){return m(a,b,c)<=0}function x(a,b,c,d){var e;switch(b){case"===":"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),e=a===c;break;case"!==":"object"==typeof a&&(a=a.version),"object"==typeof c&&(c=c.version),e=a!==c;break;case"":case"=":case"==":e=t(a,c,d);break;case"!=":e=u(a,c,d);break;case">":e=r(a,c,d);break;case">=":e=v(a,c,d);break;case"<":e=s(a,c,d);break;case"<=":e=w(a,c,d);break;default:throw new TypeError("Invalid operator: "+b)}return e}function y(a,b){if(a instanceof y){
if(a.loose===b)return a;a=a.value}return this instanceof y?(this.loose=b,this.parse(a),void(this.semver===Ia?this.value="":this.value=this.operator+this.semver.version)):new y(a,b)}function z(a,b){if(a instanceof z&&a.loose===b)return a;if(!(this instanceof z))return new z(a,b);if(this.loose=b,this.raw=a,this.set=a.split(/\s*\|\|\s*/).map(function(a){return this.parseRange(a.trim())},this).filter(function(a){return a.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+a);this.format()}function A(a,b){return new z(a,b).set.map(function(a){return a.map(function(a){return a.value}).join(" ").trim().split(" ")})}function B(a,b){return a=F(a,b),a=D(a,b),a=H(a,b),a=J(a,b)}function C(a){return!a||"x"===a.toLowerCase()||"*"===a}function D(a,b){return a.trim().split(/\s+/).map(function(a){return E(a,b)}).join(" ")}function E(a,b){var c=b?S[ta]:S[sa];return a.replace(c,function(a,b,c,d,e){var f;return C(b)?f="":C(c)?f=">="+b+".0.0 <"+(+b+1)+".0.0":C(d)?f=">="+b+"."+c+".0 <"+b+"."+(+c+1)+".0":e?("-"!==e.charAt(0)&&(e="-"+e),f=">="+b+"."+c+"."+d+e+" <"+b+"."+(+c+1)+".0"):f=">="+b+"."+c+"."+d+" <"+b+"."+(+c+1)+".0",f})}function F(a,b){return a.trim().split(/\s+/).map(function(a){return G(a,b)}).join(" ")}function G(a,b){var c=b?S[ya]:S[xa];return a.replace(c,function(a,b,c,d,e){var f;return C(b)?f="":C(c)?f=">="+b+".0.0 <"+(+b+1)+".0.0":C(d)?f="0"===b?">="+b+"."+c+".0 <"+b+"."+(+c+1)+".0":">="+b+"."+c+".0 <"+(+b+1)+".0.0":e?("-"!==e.charAt(0)&&(e="-"+e),f="0"===b?"0"===c?">="+b+"."+c+"."+d+e+" <"+b+"."+c+"."+(+d+1):">="+b+"."+c+"."+d+e+" <"+b+"."+(+c+1)+".0":">="+b+"."+c+"."+d+e+" <"+(+b+1)+".0.0"):f="0"===b?"0"===c?">="+b+"."+c+"."+d+" <"+b+"."+c+"."+(+d+1):">="+b+"."+c+"."+d+" <"+b+"."+(+c+1)+".0":">="+b+"."+c+"."+d+" <"+(+b+1)+".0.0",f})}function H(a,b){return a.split(/\s+/).map(function(a){return I(a,b)}).join(" ")}function I(a,b){a=a.trim();var c=b?S[oa]:S[na];return a.replace(c,function(a,b,c,d,e,f){var g=C(c),h=g||C(d),i=h||C(e),j=i;return"="===b&&j&&(b=""),g?a=">"===b||"<"===b?"<0.0.0":"*":b&&j?(h&&(d=0),i&&(e=0),">"===b?(b=">=",h?(c=+c+1,d=0,e=0):i&&(d=+d+1,e=0)):"<="===b&&(b="<",h?c=+c+1:d=+d+1),a=b+c+"."+d+"."+e):h?a=">="+c+".0.0 <"+(+c+1)+".0.0":i&&(a=">="+c+"."+d+".0 <"+c+"."+(+d+1)+".0"),a})}function J(a,b){return a.trim().replace(S[Fa],"")}function K(a,b,c,d,e,f,g,h,i,j,k,l,m){return b=C(c)?"":C(d)?">="+c+".0.0":C(e)?">="+c+"."+d+".0":">="+b,h=C(i)?"":C(j)?"<"+(+i+1)+".0.0":C(k)?"<"+i+"."+(+j+1)+".0":l?"<="+i+"."+j+"."+k+"-"+l:"<="+h,(b+" "+h).trim()}function L(a,b){for(var c=0;c<a.length;c++)if(!a[c].test(b))return!1;if(b.prerelease.length){for(var c=0;c<a.length;c++){if(a[c].semver===Ia)return!0;if(a[c].semver.prerelease.length>0){var d=a[c].semver;if(d.major===b.major&&d.minor===b.minor&&d.patch===b.patch)return!0}}return!1}return!0}function M(a,b,c){try{b=new z(b,c)}catch(a){return!1}return b.test(a)}function N(a,b,c){return a.filter(function(a){return M(a,b,c)}).sort(function(a,b){return o(a,b,c)})[0]||null}function O(a,b){try{return new z(a,b).range||"*"}catch(a){return null}}function P(a,b,c){return R(a,b,"<",c)}function Q(a,b,c){return R(a,b,">",c)}function R(a,b,c,d){a=new e(a,d),b=new z(b,d);var f,g,h,i,j;switch(c){case">":f=r,g=w,h=s,i=">",j=">=";break;case"<":f=s,g=v,h=r,i="<",j="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(M(a,b,d))return!1;for(var k=0;k<b.set.length;++k){var l=b.set[k],m=null,n=null;if(l.forEach(function(a){m=m||a,n=n||a,f(a.semver,m.semver,d)?m=a:h(a.semver,n.semver,d)&&(n=a)}),m.operator===i||m.operator===j)return!1;if((!n.operator||n.operator===i)&&g(a,n.semver))return!1;if(n.operator===j&&h(a,n.semver))return!1}return!0}"object"==typeof module&&module.exports===a&&(a=module.exports=e),a.SEMVER_SPEC_VERSION="2.0.0";var S=a.re=[],T=a.src=[],U=0,V=U++;T[V]="0|[1-9]\\d*";var W=U++;T[W]="[0-9]+";var X=U++;T[X]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var Y=U++;T[Y]="("+T[V]+")\\.("+T[V]+")\\.("+T[V]+")";var Z=U++;T[Z]="("+T[W]+")\\.("+T[W]+")\\.("+T[W]+")";var $=U++;T[$]="(?:"+T[V]+"|"+T[X]+")";var _=U++;T[_]="(?:"+T[W]+"|"+T[X]+")";var aa=U++;T[aa]="(?:-("+T[$]+"(?:\\."+T[$]+")*))";var ba=U++;T[ba]="(?:-?("+T[_]+"(?:\\."+T[_]+")*))";var ca=U++;T[ca]="[0-9A-Za-z-]+";var da=U++;T[da]="(?:\\+("+T[ca]+"(?:\\."+T[ca]+")*))";var ea=U++,fa="v?"+T[Y]+T[aa]+"?"+T[da]+"?";T[ea]="^"+fa+"$";var ga="[v=\\s]*"+T[Z]+T[ba]+"?"+T[da]+"?",ha=U++;T[ha]="^"+ga+"$";var ia=U++;T[ia]="((?:<|>)?=?)";var ja=U++;T[ja]=T[W]+"|x|X|\\*";var ka=U++;T[ka]=T[V]+"|x|X|\\*";var la=U++;T[la]="[v=\\s]*("+T[ka]+")(?:\\.("+T[ka]+")(?:\\.("+T[ka]+")(?:"+T[aa]+")?"+T[da]+"?)?)?";var ma=U++;T[ma]="[v=\\s]*("+T[ja]+")(?:\\.("+T[ja]+")(?:\\.("+T[ja]+")(?:"+T[ba]+")?"+T[da]+"?)?)?";var na=U++;T[na]="^"+T[ia]+"\\s*"+T[la]+"$";var oa=U++;T[oa]="^"+T[ia]+"\\s*"+T[ma]+"$";var pa=U++;T[pa]="(?:~>?)";var qa=U++;T[qa]="(\\s*)"+T[pa]+"\\s+",S[qa]=new RegExp(T[qa],"g");var ra="$1~",sa=U++;T[sa]="^"+T[pa]+T[la]+"$";var ta=U++;T[ta]="^"+T[pa]+T[ma]+"$";var ua=U++;T[ua]="(?:\\^)";var va=U++;T[va]="(\\s*)"+T[ua]+"\\s+",S[va]=new RegExp(T[va],"g");var wa="$1^",xa=U++;T[xa]="^"+T[ua]+T[la]+"$";var ya=U++;T[ya]="^"+T[ua]+T[ma]+"$";var za=U++;T[za]="^"+T[ia]+"\\s*("+ga+")$|^$";var Aa=U++;T[Aa]="^"+T[ia]+"\\s*("+fa+")$|^$";var Ba=U++;T[Ba]="(\\s*)"+T[ia]+"\\s*("+ga+"|"+T[la]+")",S[Ba]=new RegExp(T[Ba],"g");var Ca="$1$2$3",Da=U++;T[Da]="^\\s*("+T[la]+")\\s+-\\s+("+T[la]+")\\s*$";var Ea=U++;T[Ea]="^\\s*("+T[ma]+")\\s+-\\s+("+T[ma]+")\\s*$";var Fa=U++;T[Fa]="(<|>)?=?\\s*\\*";for(var Ga=0;U>Ga;Ga++)S[Ga]||(S[Ga]=new RegExp(T[Ga]));a.parse=b,a.valid=c,a.clean=d,a.SemVer=e,e.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},e.prototype.inspect=function(){return'<SemVer "'+this+'">'},e.prototype.toString=function(){return this.version},e.prototype.compare=function(a){return a instanceof e||(a=new e(a,this.loose)),this.compareMain(a)||this.comparePre(a)},e.prototype.compareMain=function(a){return a instanceof e||(a=new e(a,this.loose)),h(this.major,a.major)||h(this.minor,a.minor)||h(this.patch,a.patch)},e.prototype.comparePre=function(a){if(a instanceof e||(a=new e(a,this.loose)),this.prerelease.length&&!a.prerelease.length)return-1;if(!this.prerelease.length&&a.prerelease.length)return 1;if(!this.prerelease.length&&!a.prerelease.length)return 0;var b=0;do{var c=this.prerelease[b],d=a.prerelease[b];if(void 0===c&&void 0===d)return 0;if(void 0===d)return 1;if(void 0===c)return-1;if(c!==d)return h(c,d)}while(++b)},e.prototype.inc=function(a,b){switch(a){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",b);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",b);break;case"prepatch":this.prerelease.length=0,this.inc("patch",b),this.inc("pre",b);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",b),this.inc("pre",b);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var c=this.prerelease.length;--c>=0;)"number"==typeof this.prerelease[c]&&(this.prerelease[c]++,c=-2);-1===c&&this.prerelease.push(0)}b&&(this.prerelease[0]===b?isNaN(this.prerelease[1])&&(this.prerelease=[b,0]):this.prerelease=[b,0]);break;default:throw new Error("invalid increment argument: "+a)}return this.format(),this},a.inc=f,a.diff=g,a.compareIdentifiers=h;var Ha=/^[0-9]+$/;a.rcompareIdentifiers=i,a.major=j,a.minor=k,a.patch=l,a.compare=m,a.compareLoose=n,a.rcompare=o,a.sort=p,a.rsort=q,a.gt=r,a.lt=s,a.eq=t,a.neq=u,a.gte=v,a.lte=w,a.cmp=x,a.Comparator=y;var Ia={};y.prototype.parse=function(a){var b=this.loose?S[za]:S[Aa],c=a.match(b);if(!c)throw new TypeError("Invalid comparator: "+a);this.operator=c[1],"="===this.operator&&(this.operator=""),c[2]?this.semver=new e(c[2],this.loose):this.semver=Ia},y.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},y.prototype.toString=function(){return this.value},y.prototype.test=function(a){return this.semver===Ia?!0:("string"==typeof a&&(a=new e(a,this.loose)),x(a,this.operator,this.semver,this.loose))},a.Range=z,z.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},z.prototype.format=function(){return this.range=this.set.map(function(a){return a.join(" ").trim()}).join("||").trim(),this.range},z.prototype.toString=function(){return this.range},z.prototype.parseRange=function(a){var b=this.loose;a=a.trim();var c=b?S[Ea]:S[Da];a=a.replace(c,K),a=a.replace(S[Ba],Ca),a=a.replace(S[qa],ra),a=a.replace(S[va],wa),a=a.split(/\s+/).join(" ");var d=b?S[za]:S[Aa],e=a.split(" ").map(function(a){return B(a,b)}).join(" ").split(/\s+/);return this.loose&&(e=e.filter(function(a){return!!a.match(d)})),e=e.map(function(a){return new y(a,b)})},a.toComparators=A,z.prototype.test=function(a){if(!a)return!1;"string"==typeof a&&(a=new e(a,this.loose));for(var b=0;b<this.set.length;b++)if(L(this.set[b],a))return!0;return!1},a.satisfies=M,a.maxSatisfying=N,a.validRange=O,a.ltr=P,a.gtr=Q,a.outside=R,"function"==typeof define&&define.amd&&define("lib/semver/semver",a)}("object"==typeof exports?exports:"function"==typeof define&&define.amd?{}:semver={}),define("version",["lib/semver/semver"],function(a){var b=2,c=51,d=0,e=!1,f=!0,g=1461565608343,h=["configured_search","smart_array_filter","feature_viewer","sequence","plot_function","hex","canvas_matrix","som","scatter3D","pie_chart","pie_chart_jit","radar_chart","stack_chart","leaflet","dendrogram","parallel_coordinates","phylogram","loading_plot","wordcloud","button_action","code_editor","code_executor","dragdrop","paste_text","xnavigator","xyzoomnavigator","single_value","fancytree","iframe","panzoom","progress","postit","jqgrid","fasttable","template-twig","2d_list_fast","2d_list","dualview","filter_editor","object_editor","onde","rich_text","form_simple","slick_grid","svg_editor","form","filter","grid_selector","filelistupload","var_editor","jsme","jsmol","ocl_editor","periodic_table","gcms","ivstability","spectra_displayer","1dnmr","2dnmr","webservice_nmr_spin","webservice_cron","webservice_search"],i=b+"."+c+"."+d;e!==!1&&(i+="-"+e);var j=a.parse(i);if(!j)throw new Error("Version number is invalid: "+i);var k=null;if(g){var l=new Date(g);k=window.Intl?new window.Intl.DateTimeFormat("en-GB",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}).format(l):l.toLocaleDateString()}return{major:b,minor:c,patch:d,prerelease:e,isRelease:f,includedModuleCss:h,version:i,buildTime:k,isBuild:null!=k}}),define("src/util/versioning",["./cache","./versionhandler","./debug","src/main/variables","version"],function(a,b,c,d,e){function f(a,b,c){c=c||{};var d=Promise.resolve();return a.data&&(r.data.url!==a.data.url||r.data.urls!==a.data.urls&&r.data.branch!==a.data.branch)&&(c.doNotLoad||(d=h(a.data.urls,a.data.branch,a.data.url,c)),r.data=a.data),a.view&&(r.view.url!==a.view.url||r.view.urls!==a.view.urls&&r.view.branch!==a.view.branch)&&(d=d.then(function(){return r.view=a.view,c.doNotLoad?void 0:g(a.view.urls,a.view.branch,a.view.url,c)})),b&&require(["uri/URI.fragmentQuery"],function(b){var c=new b(window.location.href);a.data&&(c["remove"+s](["dataURL","dataBranch","results"]),a.data.urls?(c["add"+s]("results",a.data.urls),a.data.branch&&c["add"+s]("dataBranch",a.data.branch)):a.data.url&&c["add"+s]("dataURL",a.data.url)),a.view&&(c["remove"+s](["viewURL","viewBranch","views"]),a.view.urls?(c["add"+s]("views",a.view.urls),a.view.branch&&c["add"+s]("viewBranch",a.view.branch)):a.view.url&&c["add"+s]("viewURL",a.view.url)),window.history.pushState({type:"viewchange",value:a},"",c.href())}),d}function g(a,b,c,d){return o.load(a,b,c,d)}function h(a,b,c,d){return n.load(a,b,c,d)}function i(b){b&&b.version&&(l=b.version);var c;for(c in p)delete p[c];d.eraseAll(),a.clear();for(c in b)p[c]=DataObject.recursiveTransform(b[c])}function j(a){var b,c;for(b in q)delete q[b];for(b in a)c=DataObject.check(a[b],!0),c&&(q[b]=c,c.linkToParent(q,b));q.triggerChange()}var k=e.version,l="none",m=!1,n=new b,o=new b,p=new DataObject,q=d.getData(),r={view:{},data:{}},s="Search";return o.version=k,n.setType("data"),o.setType("view"),n.reviver=function(a){return DataObject.check(a,1,!1)},o.reviver=function(a){return DataObject.check(a,1,!1)},window.onpopstate=function(a){a.state&&"viewchange"===a.state.type&&f(a.state.value,!1)},{get version(){return String(k)},get originalVersion(){return String(l)},setView:g,setData:h,getView:function(){return p},getViewJSON:function(a){return JSON.stringify(p,null,a)},getData:function(){return q},getDataJSON:function(a){return JSON.stringify(q,null,a)},getViewHandler:function(){return o},getDataHandler:function(){return n},setViewLoadCallback:function(a){this.viewCallback=a;var b=this;o.onLoaded=function(c){i(c),a.call(b,p)},o.onReload=function(c){i(c),a.call(b,p,!0)}},setDataLoadCallback:function(a){this.dataCallback=a;var b=this;n.onLoaded=function(c){j(c),a.call(b,q)},n.onReload=function(c){j(c),a.call(b,q,!0)}},setViewJSON:function(a){i(a),this.viewCallback(p,!0),o.versionChange().notify(p)},setDataJSON:function(a){j(a),this.dataCallback(q,!0)},blankView:function(){this.setViewJSON({})},switchView:f,setURLType:function(a){s=a},viewLock:function(){m=!0},isViewLocked:function(){return m},lastLoaded:r}}),define("src/header/header",["require","jquery","src/util/versioning"],function(a,b,c){var d=[];return{init:function(a){var d=this;a.elements&&this.loadHeaderElements(a.elements),this.dom=b('<div id="header"><div id="title"><div></div></div></div>'),b("#ci-visualizer").prepend(this.dom),this.setHeight(a.height||"30px"),this._titleDiv=b("#title").children("div"),this._titleDiv.attr("contenteditable","true").bind("keypress",function(a){a.stopPropagation(),13===a.keyCode&&(a.preventDefault(),b(this).trigger("blur"))}).bind("blur",function(){c.getView().configuration.set("title",b(this).text().replace(/[\r\n]/g,""))}),c.getViewHandler().versionChange().progress(function(a){d.setTitle(a)})},setHeight:function(a){this.dom.css("height",a),b("#modules-grid").css("margin-top",a)},setTitle:function(a){this._titleDiv.text(a.configuration?a.configuration.title:"Untitled")},loadHeaderElements:function(a){if(b.isArray(a)){for(var c=this,e=0,f=a.length;f>e;e++)this.addHeaderElement(e,this.createElement(a[e]));Promise.all(d).then(c.buildHeaderElements.bind(c))}},addHeaderElement:function(a,b){d[a]=b},createElement:function(b){return new Promise(function(c,d){var e;e=b.type.indexOf("/")>-1?b.type:"./components/"+b.type,a([e],function(a){var d=new a;d.init(b),c(d)})})},buildHeaderElements:function(a){this.ul&&this.ul.empty(),this.ul=this.ul||b('<ul class="noselect" />').appendTo(this.dom);for(var c=0,d=a.length;d>c;c++)this.ul.append(a[c].getDom())}}}),define("src/util/event",[],function(){function a(){}var b=Array.prototype.slice;return a.prototype.on=function(a,c){return this.topics=this.topics||[],this.topics[a]=this.topics[a]||$.Callbacks(),this.topics[a].add.apply(this.topics[a],b.call(arguments,1)),this},a.prototype.off=function(a){return this.topics&&this.topics[a]&&this.topics[a].remove.apply(this.topics[a],b.call(arguments,1)),this},a.prototype.trigger=function(a){this.topics&&this.topics[a]&&this.topics[a].fireWith(this,b.call(arguments,1))},a}),define("src/util/repository",["jquery","src/util/event"],function(a,b){var c=-1,d=function a(b,c,d,e){for(var f=0,g=c.length;g>f;f++)if(Array.isArray(c[f]))a(b,c[f],d,e);else if(b._keys[c[f]]=b._keys[c[f]]||[],e)b._keys[c[f]].push(d);else{var h=b._keys[c[f]].indexOf(d);if(-1==h)continue;b._keys[c[f]].splice(h,1)}},e=function(a,b){for(var c=b.slice(0),d={},e=0,g=a.length;g>e;e++)d[a[e]]=!0;return f(d,c,!0)},f=function a(b,c,d){var e,f,g,h=[];for(e=0,f=c.length;f>e;e++){if(g=c[e],Array.isArray(g)&&(g=a(b,g,!d)),!b[g]&&!d)return null;b[g]&&h.push(g)}return h},g=function(a){this._killers={},this._value=[],this.options=a||{doNotSave:!1};var b;this.on("change",function(a,c,d){var f={};for(this._keys=this._keys||[],a=Array.isArray(a)?a:[a],b=0;b<a.length;b++)if(void 0!=this._keys[a[b]])for(var g=0;g<this._keys[a[b]].length;g++)f[this._keys[a[b]][g]]=!0;a:for(b in f){var h=this._callbacks[b];if(h){var i=e(h[0],a);if(i.length>0||(!i||0==i.length)&&h[2]){for(var j in this._killers)if(this._killers[j].indexOf(+b)>-1){h[1](c,i,j,d);continue a}h[1](c,i,null)}}}})};return a.extend(g.prototype,b.prototype),g.prototype.get=function(a){return this.options.doNotSave!==!0?this._value[a]:void 0},g.prototype.set=function(a,b,c,d){Array.isArray(a)?a.length||(a=[]):a=[a],this._value=this._value||[],this.options.doNotSave!==!0&&(this._value[a]=[a,b]),c||this.trigger("change",a,b,d)},g.prototype.listen=function(a,b,e,f){if(this._keys=this._keys||{},this._callbacks=this._callbacks||[],Array.isArray(a)||(a=[a]),a&&void 0!=a.length&&0!=a.length){var g=++c;return this._callbacks[g]=[a,b,e],f&&(this._killers[f]=this._killers[f]||[],this._killers[f].push(g)),d(this,a,g,!0),c}},g.prototype.kill=function(a){if(this._killers[a]){for(var b=this._killers[a],c=0,e=b.length;e>c;c++)d(this,this._callbacks[b[c]][0],b[c],!1),delete this._callbacks[b[c]];this._killers[a]=[]}},g.prototype.resetVariables=function(){this._keys={},this._value=[]},g.prototype.resetCallbacks=function(){this._killers={},this._callbacks=[]},g.prototype.unListen=function(a,b){this._keys=this._keys||{},this._callbacks=this._callbacks||[],this._callbacks[b]=void 0,d(this,a,b,!1)},g.prototype.resendAll=function(){if(this.options.doNotSave!==!0)for(var a in this._value)this.set(this._value[a][0],this._value[a][1])},g.prototype.getKeys=function(){var a=this._value,b=[];for(var c in a)b.push(c);return b},g}),!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define("moment",b):a.moment=b()}(this,function(){"use strict";function a(){return Hc.apply(null,arguments)}function b(a){Hc=a}function c(a){return"[object Array]"===Object.prototype.toString.call(a)}function d(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function e(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function f(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function g(a,b){for(var c in b)f(b,c)&&(a[c]=b[c]);return f(b,"toString")&&(a.toString=b.toString),f(b,"valueOf")&&(a.valueOf=b.valueOf),a}function h(a,b,c,d){return Ca(a,b,c,d,!0).utc()}function i(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function j(a){return null==a._pf&&(a._pf=i()),a._pf}function k(a){if(null==a._isValid){var b=j(a);a._isValid=!(isNaN(a._d.getTime())||!(b.overflow<0)||b.empty||b.invalidMonth||b.invalidWeekday||b.nullInput||b.invalidFormat||b.userInvalidated),a._strict&&(a._isValid=a._isValid&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour)}return a._isValid}function l(a){var b=h(NaN);return null!=a?g(j(b),a):j(b).userInvalidated=!0,b}function m(a,b){var c,d,e;if("undefined"!=typeof b._isAMomentObject&&(a._isAMomentObject=b._isAMomentObject),"undefined"!=typeof b._i&&(a._i=b._i),"undefined"!=typeof b._f&&(a._f=b._f),"undefined"!=typeof b._l&&(a._l=b._l),"undefined"!=typeof b._strict&&(a._strict=b._strict),"undefined"!=typeof b._tzm&&(a._tzm=b._tzm),"undefined"!=typeof b._isUTC&&(a._isUTC=b._isUTC),"undefined"!=typeof b._offset&&(a._offset=b._offset),"undefined"!=typeof b._pf&&(a._pf=j(b)),"undefined"!=typeof b._locale&&(a._locale=b._locale),Jc.length>0)for(c in Jc)d=Jc[c],e=b[d],"undefined"!=typeof e&&(a[d]=e);return a}function n(b){m(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),Kc===!1&&(Kc=!0,a.updateOffset(this),Kc=!1)}function o(a){return a instanceof n||null!=a&&null!=a._isAMomentObject}function p(a){return 0>a?Math.ceil(a):Math.floor(a)}function q(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=p(b)),c}function r(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&q(a[d])!==q(b[d]))&&g++;return g+f}function s(){}function t(a){return a?a.toLowerCase().replace("_","-"):a}function u(a){for(var b,c,d,e,f=0;f<a.length;){for(e=t(a[f]).split("-"),b=e.length,c=t(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=v(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&r(e,c,!0)>=b-1)break;b--}f++}return null}function v(a){var b=null;if(!Lc[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=Ic._abbr,require("./locale/"+a),w(b)}catch(a){}return Lc[a]}function w(a,b){var c;return a&&(c="undefined"==typeof b?y(a):x(a,b),c&&(Ic=c)),Ic._abbr}function x(a,b){return null!==b?(b.abbr=a,Lc[a]=Lc[a]||new s,Lc[a].set(b),w(a),Lc[a]):(delete Lc[a],null)}function y(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return Ic;if(!c(a)){if(b=v(a))return b;a=[a]}return u(a)}function z(a,b){var c=a.toLowerCase();Mc[c]=Mc[c+"s"]=Mc[b]=a}function A(a){return"string"==typeof a?Mc[a]||Mc[a.toLowerCase()]:void 0}function B(a){var b,c,d={};for(c in a)f(a,c)&&(b=A(c),b&&(d[b]=a[c]));return d}function C(b,c){return function(d){return null!=d?(E(this,b,d),a.updateOffset(this,c),this):D(this,b)}}function D(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function E(a,b,c){return a._d["set"+(a._isUTC?"UTC":"")+b](c)}function F(a,b){var c;if("object"==typeof a)for(c in a)this.set(c,a[c]);else if(a=A(a),"function"==typeof this[a])return this[a](b);return this}function G(a,b,c){var d=""+Math.abs(a),e=b-d.length,f=a>=0;return(f?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function H(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Qc[a]=e),b&&(Qc[b[0]]=function(){return G(e.apply(this,arguments),b[1],b[2])}),c&&(Qc[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function I(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function J(a){var b,c,d=a.match(Nc);for(b=0,c=d.length;c>b;b++)Qc[d[b]]?d[b]=Qc[d[b]]:d[b]=I(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function K(a,b){return a.isValid()?(b=L(b,a.localeData()),Pc[b]=Pc[b]||J(b),Pc[b](a)):a.localeData().invalidDate()}function L(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Oc.lastIndex=0;d>=0&&Oc.test(a);)a=a.replace(Oc,c),Oc.lastIndex=0,d-=1;return a}function M(a){return"function"==typeof a&&"[object Function]"===Object.prototype.toString.call(a)}function N(a,b,c){dd[a]=M(b)?b:function(a){return a&&c?c:b}}function O(a,b){return f(dd,a)?dd[a](b._strict,b._locale):new RegExp(P(a))}function P(a){return a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Q(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),"number"==typeof b&&(d=function(a,c){c[b]=q(a)}),c=0;c<a.length;c++)ed[a[c]]=d}function R(a,b){Q(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function S(a,b,c){null!=b&&f(ed,a)&&ed[a](b,c._a,c,a)}function T(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function U(a){return this._months[a.month()]}function V(a){return this._monthsShort[a.month()]}function W(a,b,c){var d,e,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;12>d;d++){if(e=h([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function X(a,b){var c;return"string"==typeof b&&(b=a.localeData().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),T(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function Y(b){return null!=b?(X(this,b),a.updateOffset(this,!0),this):D(this,"Month")}function Z(){return T(this.year(),this.month())}function $(a){var b,c=a._a;return c&&-2===j(a).overflow&&(b=c[gd]<0||c[gd]>11?gd:c[hd]<1||c[hd]>T(c[fd],c[gd])?hd:c[id]<0||c[id]>24||24===c[id]&&(0!==c[jd]||0!==c[kd]||0!==c[ld])?id:c[jd]<0||c[jd]>59?jd:c[kd]<0||c[kd]>59?kd:c[ld]<0||c[ld]>999?ld:-1,j(a)._overflowDayOfYear&&(fd>b||b>hd)&&(b=hd),j(a).overflow=b),a}function _(b){a.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function aa(a,b){var c=!0;return g(function(){return c&&(_(a+"\n"+(new Error).stack),c=!1),b.apply(this,arguments)},b)}function ba(a,b){od[a]||(_(b),od[a]=!0)}function ca(a){var b,c,d=a._i,e=pd.exec(d);if(e){for(j(a).iso=!0,b=0,c=qd.length;c>b;b++)if(qd[b][1].exec(d)){a._f=qd[b][0];break}for(b=0,c=rd.length;c>b;b++)if(rd[b][1].exec(d)){a._f+=(e[6]||" ")+rd[b][0];break}d.match(ad)&&(a._f+="Z"),va(a)}else a._isValid=!1}function da(b){var c=sd.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(ca(b),void(b._isValid===!1&&(delete b._isValid,a.createFromInputFallback(b))))}function ea(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function fa(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function ga(a){return ha(a)?366:365}function ha(a){return a%4===0&&a%100!==0||a%400===0}function ia(){return ha(this.year())}function ja(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=Da(a).add(f,"d"),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function ka(a){return ja(a,this._week.dow,this._week.doy).week}function la(){return this._week.dow}function ma(){return this._week.doy}function na(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function oa(a){var b=ja(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function pa(a,b,c,d,e){var f,g=6+e-d,h=fa(a,0,1+g),i=h.getUTCDay();return e>i&&(i+=7),c=null!=c?1*c:e,f=1+g+7*(b-1)-i+c,{year:f>0?a:a-1,dayOfYear:f>0?f:ga(a-1)+f}}function qa(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function ra(a,b,c){return null!=a?a:null!=b?b:c}function sa(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function ta(a){var b,c,d,e,f=[];if(!a._d){for(d=sa(a),a._w&&null==a._a[hd]&&null==a._a[gd]&&ua(a),a._dayOfYear&&(e=ra(a._a[fd],d[fd]),a._dayOfYear>ga(e)&&(j(a)._overflowDayOfYear=!0),c=fa(e,0,a._dayOfYear),a._a[gd]=c.getUTCMonth(),a._a[hd]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;7>b;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[id]&&0===a._a[jd]&&0===a._a[kd]&&0===a._a[ld]&&(a._nextDay=!0,a._a[id]=0),a._d=(a._useUTC?fa:ea).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[id]=24)}}function ua(a){var b,c,d,e,f,g,h;b=a._w,null!=b.GG||null!=b.W||null!=b.E?(f=1,g=4,c=ra(b.GG,a._a[fd],ja(Da(),1,4).year),d=ra(b.W,1),e=ra(b.E,1)):(f=a._locale._week.dow,g=a._locale._week.doy,c=ra(b.gg,a._a[fd],ja(Da(),f,g).year),d=ra(b.w,1),null!=b.d?(e=b.d,f>e&&++d):e=null!=b.e?b.e+f:f),h=pa(c,d,e,g,f),a._a[fd]=h.year,a._dayOfYear=h.dayOfYear}function va(b){if(b._f===a.ISO_8601)return void ca(b);b._a=[],j(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,k=0;for(e=L(b._f,b._locale).match(Nc)||[],c=0;c<e.length;c++)f=e[c],d=(h.match(O(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&j(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),k+=d.length),Qc[f]?(d?j(b).empty=!1:j(b).unusedTokens.push(f),S(f,d,b)):b._strict&&!d&&j(b).unusedTokens.push(f);j(b).charsLeftOver=i-k,h.length>0&&j(b).unusedInput.push(h),j(b).bigHour===!0&&b._a[id]<=12&&b._a[id]>0&&(j(b).bigHour=void 0),b._a[id]=wa(b._locale,b._a[id],b._meridiem),ta(b),$(b)}function wa(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&12>b&&(b+=12),d||12!==b||(b=0),b):b}function xa(a){var b,c,d,e,f;if(0===a._f.length)return j(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=m({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],va(b),k(b)&&(f+=j(b).charsLeftOver,f+=10*j(b).unusedTokens.length,j(b).score=f,(null==d||d>f)&&(d=f,c=b));g(a,c||b)}function ya(a){if(!a._d){var b=B(a._i);a._a=[b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],ta(a)}}function za(a){var b=new n($(Aa(a)));return b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b}function Aa(a){var b=a._i,e=a._f;return a._locale=a._locale||y(a._l),null===b||void 0===e&&""===b?l({nullInput:!0}):("string"==typeof b&&(a._i=b=a._locale.preparse(b)),o(b)?new n($(b)):(c(e)?xa(a):e?va(a):d(b)?a._d=b:Ba(a),a))}function Ba(b){var f=b._i;void 0===f?b._d=new Date:d(f)?b._d=new Date(+f):"string"==typeof f?da(b):c(f)?(b._a=e(f.slice(0),function(a){return parseInt(a,10)}),ta(b)):"object"==typeof f?ya(b):"number"==typeof f?b._d=new Date(f):a.createFromInputFallback(b)}function Ca(a,b,c,d,e){var f={};return"boolean"==typeof c&&(d=c,c=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=e,f._l=c,f._i=a,f._f=b,f._strict=d,za(f)}function Da(a,b,c,d){return Ca(a,b,c,d,!1)}function Ea(a,b){var d,e;if(1===b.length&&c(b[0])&&(b=b[0]),!b.length)return Da();for(d=b[0],e=1;e<b.length;++e)(!b[e].isValid()||b[e][a](d))&&(d=b[e]);return d}function Fa(){var a=[].slice.call(arguments,0);return Ea("isBefore",a)}function Ga(){var a=[].slice.call(arguments,0);return Ea("isAfter",a)}function Ha(a){var b=B(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+36e5*h,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=y(),this._bubble()}function Ia(a){return a instanceof Ha}function Ja(a,b){H(a,0,0,function(){var a=this.utcOffset(),c="+";return 0>a&&(a=-a,c="-"),c+G(~~(a/60),2)+b+G(~~a%60,2)})}function Ka(a){var b=(a||"").match(ad)||[],c=b[b.length-1]||[],d=(c+"").match(xd)||["-",0,0],e=+(60*d[1])+q(d[2]);return"+"===d[0]?e:-e}function La(b,c){var e,f;return c._isUTC?(e=c.clone(),f=(o(b)||d(b)?+b:+Da(b))-+e,e._d.setTime(+e._d+f),a.updateOffset(e,!1),e):Da(b).local()}function Ma(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Na(b,c){var d,e=this._offset||0;return null!=b?("string"==typeof b&&(b=Ka(b)),Math.abs(b)<16&&(b=60*b),!this._isUTC&&c&&(d=Ma(this)),this._offset=b,this._isUTC=!0,null!=d&&this.add(d,"m"),e!==b&&(!c||this._changeInProgress?bb(this,Ya(b-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?e:Ma(this)}function Oa(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Pa(a){return this.utcOffset(0,a)}function Qa(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(Ma(this),"m")),this}function Ra(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ka(this._i)),this}function Sa(a){return a=a?Da(a).utcOffset():0,(this.utcOffset()-a)%60===0}function Ta(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ua(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var a={};if(m(a,this),a=Aa(a),a._a){var b=a._isUTC?h(a._a):Da(a._a);this._isDSTShifted=this.isValid()&&r(a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Va(){return!this._isUTC}function Wa(){return this._isUTC}function Xa(){return this._isUTC&&0===this._offset;
}function Ya(a,b){var c,d,e,g=a,h=null;return Ia(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=yd.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:q(h[hd])*c,h:q(h[id])*c,m:q(h[jd])*c,s:q(h[kd])*c,ms:q(h[ld])*c}):(h=zd.exec(a))?(c="-"===h[1]?-1:1,g={y:Za(h[2],c),M:Za(h[3],c),d:Za(h[4],c),h:Za(h[5],c),m:Za(h[6],c),s:Za(h[7],c),w:Za(h[8],c)}):null==g?g={}:"object"==typeof g&&("from"in g||"to"in g)&&(e=_a(Da(g.from),Da(g.to)),g={},g.ms=e.milliseconds,g.M=e.months),d=new Ha(g),Ia(a)&&f(a,"_locale")&&(d._locale=a._locale),d}function Za(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function $a(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function _a(a,b){var c;return b=La(b,a),a.isBefore(b)?c=$a(a,b):(c=$a(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function ab(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(ba(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Ya(c,d),bb(this,e,a),this}}function bb(b,c,d,e){var f=c._milliseconds,g=c._days,h=c._months;e=null==e?!0:e,f&&b._d.setTime(+b._d+f*d),g&&E(b,"Date",D(b,"Date")+g*d),h&&X(b,D(b,"Month")+h*d),e&&a.updateOffset(b,g||h)}function cb(a,b){var c=a||Da(),d=La(c,this).startOf("day"),e=this.diff(d,"days",!0),f=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(b&&b[f]||this.localeData().calendar(f,this,Da(c)))}function db(){return new n(this)}function eb(a,b){var c;return b=A("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+this>+a):(c=o(a)?+a:+Da(a),c<+this.clone().startOf(b))}function fb(a,b){var c;return b=A("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+a>+this):(c=o(a)?+a:+Da(a),+this.clone().endOf(b)<c)}function gb(a,b,c){return this.isAfter(a,c)&&this.isBefore(b,c)}function hb(a,b){var c;return b=A(b||"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+this===+a):(c=+Da(a),+this.clone().startOf(b)<=c&&c<=+this.clone().endOf(b))}function ib(a,b,c){var d,e,f=La(a,this),g=6e4*(f.utcOffset()-this.utcOffset());return b=A(b),"year"===b||"month"===b||"quarter"===b?(e=jb(this,f),"quarter"===b?e/=3:"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:p(e)}function jb(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return 0>b-f?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)}function kb(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function lb(){var a=this.clone().utc();return 0<a.year()&&a.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():K(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):K(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function mb(b){var c=K(this,b||a.defaultFormat);return this.localeData().postformat(c)}function nb(a,b){return this.isValid()?Ya({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function ob(a){return this.from(Da(),a)}function pb(a,b){return this.isValid()?Ya({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function qb(a){return this.to(Da(),a)}function rb(a){var b;return void 0===a?this._locale._abbr:(b=y(a),null!=b&&(this._locale=b),this)}function sb(){return this._locale}function tb(a){switch(a=A(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function ub(a){return a=A(a),void 0===a||"millisecond"===a?this:this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")}function vb(){return+this._d-6e4*(this._offset||0)}function wb(){return Math.floor(+this/1e3)}function xb(){return this._offset?new Date(+this):this._d}function yb(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function zb(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function Ab(){return k(this)}function Bb(){return g({},j(this))}function Cb(){return j(this).overflow}function Db(a,b){H(0,[a,a.length],0,b)}function Eb(a,b,c){return ja(Da([a,11,31+b-c]),b,c).week}function Fb(a){var b=ja(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")}function Gb(a){var b=ja(this,1,4).year;return null==a?b:this.add(a-b,"y")}function Hb(){return Eb(this.year(),1,4)}function Ib(){var a=this.localeData()._week;return Eb(this.year(),a.dow,a.doy)}function Jb(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Kb(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Lb(a){return this._weekdays[a.day()]}function Mb(a){return this._weekdaysShort[a.day()]}function Nb(a){return this._weekdaysMin[a.day()]}function Ob(a){var b,c,d;for(this._weekdaysParse=this._weekdaysParse||[],b=0;7>b;b++)if(this._weekdaysParse[b]||(c=Da([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b}function Pb(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Kb(a,this.localeData()),this.add(a-b,"d")):b}function Qb(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Rb(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)}function Sb(a,b){H(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Tb(a,b){return b._meridiemParse}function Ub(a){return"p"===(a+"").toLowerCase().charAt(0)}function Vb(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Wb(a,b){b[ld]=q(1e3*("0."+a))}function Xb(){return this._isUTC?"UTC":""}function Yb(){return this._isUTC?"Coordinated Universal Time":""}function Zb(a){return Da(1e3*a)}function $b(){return Da.apply(null,arguments).parseZone()}function _b(a,b,c){var d=this._calendar[a];return"function"==typeof d?d.call(b,c):d}function ac(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function bc(){return this._invalidDate}function cc(a){return this._ordinal.replace("%d",a)}function dc(a){return a}function ec(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)}function fc(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)}function gc(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function hc(a,b,c,d){var e=y(),f=h().set(d,b);return e[c](f,a)}function ic(a,b,c,d,e){if("number"==typeof a&&(b=a,a=void 0),a=a||"",null!=b)return hc(a,b,c,e);var f,g=[];for(f=0;d>f;f++)g[f]=hc(a,f,c,e);return g}function jc(a,b){return ic(a,b,"months",12,"month")}function kc(a,b){return ic(a,b,"monthsShort",12,"month")}function lc(a,b){return ic(a,b,"weekdays",7,"day")}function mc(a,b){return ic(a,b,"weekdaysShort",7,"day")}function nc(a,b){return ic(a,b,"weekdaysMin",7,"day")}function oc(){var a=this._data;return this._milliseconds=Wd(this._milliseconds),this._days=Wd(this._days),this._months=Wd(this._months),a.milliseconds=Wd(a.milliseconds),a.seconds=Wd(a.seconds),a.minutes=Wd(a.minutes),a.hours=Wd(a.hours),a.months=Wd(a.months),a.years=Wd(a.years),this}function pc(a,b,c,d){var e=Ya(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function qc(a,b){return pc(this,a,b,1)}function rc(a,b){return pc(this,a,b,-1)}function sc(a){return 0>a?Math.floor(a):Math.ceil(a)}function tc(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0&&g>=0&&h>=0||0>=f&&0>=g&&0>=h||(f+=864e5*sc(vc(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=p(f/1e3),i.seconds=a%60,b=p(a/60),i.minutes=b%60,c=p(b/60),i.hours=c%24,g+=p(c/24),e=p(uc(g)),h+=e,g-=sc(vc(e)),d=p(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function uc(a){return 4800*a/146097}function vc(a){return 146097*a/4800}function wc(a){var b,c,d=this._milliseconds;if(a=A(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+uc(b),"month"===a?c:c/12;switch(b=this._days+Math.round(vc(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function xc(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*q(this._months/12)}function yc(a){return function(){return this.as(a)}}function zc(a){return a=A(a),this[a+"s"]()}function Ac(a){return function(){return this._data[a]}}function Bc(){return p(this.days()/7)}function Cc(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function Dc(a,b,c){var d=Ya(a).abs(),e=ke(d.as("s")),f=ke(d.as("m")),g=ke(d.as("h")),h=ke(d.as("d")),i=ke(d.as("M")),j=ke(d.as("y")),k=e<le.s&&["s",e]||1===f&&["m"]||f<le.m&&["mm",f]||1===g&&["h"]||g<le.h&&["hh",g]||1===h&&["d"]||h<le.d&&["dd",h]||1===i&&["M"]||i<le.M&&["MM",i]||1===j&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,Cc.apply(null,k)}function Ec(a,b){return void 0===le[a]?!1:void 0===b?le[a]:(le[a]=b,!0)}function Fc(a){var b=this.localeData(),c=Dc(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function Gc(){var a,b,c,d=me(this._milliseconds)/1e3,e=me(this._days),f=me(this._months);a=p(d/60),b=p(a/60),d%=60,a%=60,c=p(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(0>m?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}var Hc,Ic,Jc=a.momentProperties=[],Kc=!1,Lc={},Mc={},Nc=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Oc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Pc={},Qc={},Rc=/\d/,Sc=/\d\d/,Tc=/\d{3}/,Uc=/\d{4}/,Vc=/[+-]?\d{6}/,Wc=/\d\d?/,Xc=/\d{1,3}/,Yc=/\d{1,4}/,Zc=/[+-]?\d{1,6}/,$c=/\d+/,_c=/[+-]?\d+/,ad=/Z|[+-]\d\d:?\d\d/gi,bd=/[+-]?\d+(\.\d{1,3})?/,cd=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,dd={},ed={},fd=0,gd=1,hd=2,id=3,jd=4,kd=5,ld=6;H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),H("MMMM",0,0,function(a){return this.localeData().months(this,a)}),z("month","M"),N("M",Wc),N("MM",Wc,Sc),N("MMM",cd),N("MMMM",cd),Q(["M","MM"],function(a,b){b[gd]=q(a)-1}),Q(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[gd]=e:j(c).invalidMonth=a});var md="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),nd="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),od={};a.suppressDeprecationWarnings=!1;var pd=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,qd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],rd=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],sd=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=aa("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),z("year","y"),N("Y",_c),N("YY",Wc,Sc),N("YYYY",Yc,Uc),N("YYYYY",Zc,Vc),N("YYYYYY",Zc,Vc),Q(["YYYYY","YYYYYY"],fd),Q("YYYY",function(b,c){c[fd]=2===b.length?a.parseTwoDigitYear(b):q(b)}),Q("YY",function(b,c){c[fd]=a.parseTwoDigitYear(b)}),a.parseTwoDigitYear=function(a){return q(a)+(q(a)>68?1900:2e3)};var td=C("FullYear",!1);H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),z("week","w"),z("isoWeek","W"),N("w",Wc),N("ww",Wc,Sc),N("W",Wc),N("WW",Wc,Sc),R(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=q(a)});var ud={dow:0,doy:6};H("DDD",["DDDD",3],"DDDo","dayOfYear"),z("dayOfYear","DDD"),N("DDD",Xc),N("DDDD",Tc),Q(["DDD","DDDD"],function(a,b,c){c._dayOfYear=q(a)}),a.ISO_8601=function(){};var vd=aa("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=Da.apply(null,arguments);return this>a?this:a}),wd=aa("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var a=Da.apply(null,arguments);return a>this?this:a});Ja("Z",":"),Ja("ZZ",""),N("Z",ad),N("ZZ",ad),Q(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Ka(a)});var xd=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var yd=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,zd=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Ya.fn=Ha.prototype;var Ad=ab(1,"add"),Bd=ab(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Cd=aa("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Db("gggg","weekYear"),Db("ggggg","weekYear"),Db("GGGG","isoWeekYear"),Db("GGGGG","isoWeekYear"),z("weekYear","gg"),z("isoWeekYear","GG"),N("G",_c),N("g",_c),N("GG",Wc,Sc),N("gg",Wc,Sc),N("GGGG",Yc,Uc),N("gggg",Yc,Uc),N("GGGGG",Zc,Vc),N("ggggg",Zc,Vc),R(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=q(a)}),R(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),H("Q",0,0,"quarter"),z("quarter","Q"),N("Q",Rc),Q("Q",function(a,b){b[gd]=3*(q(a)-1)}),H("D",["DD",2],"Do","date"),z("date","D"),N("D",Wc),N("DD",Wc,Sc),N("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient}),Q(["D","DD"],hd),Q("Do",function(a,b){b[hd]=q(a.match(Wc)[0],10)});var Dd=C("Date",!0);H("d",0,"do","day"),H("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),H("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),H("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),z("day","d"),z("weekday","e"),z("isoWeekday","E"),N("d",Wc),N("e",Wc),N("E",Wc),N("dd",cd),N("ddd",cd),N("dddd",cd),R(["dd","ddd","dddd"],function(a,b,c){var d=c._locale.weekdaysParse(a);null!=d?b.d=d:j(c).invalidWeekday=a}),R(["d","e","E"],function(a,b,c,d){b[d]=q(a)});var Ed="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Fd="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Gd="Su_Mo_Tu_We_Th_Fr_Sa".split("_");H("H",["HH",2],0,"hour"),H("h",["hh",2],0,function(){return this.hours()%12||12}),Sb("a",!0),Sb("A",!1),z("hour","h"),N("a",Tb),N("A",Tb),N("H",Wc),N("h",Wc),N("HH",Wc,Sc),N("hh",Wc,Sc),Q(["H","HH"],id),Q(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),Q(["h","hh"],function(a,b,c){b[id]=q(a),j(c).bigHour=!0});var Hd=/[ap]\.?m?\.?/i,Id=C("Hours",!0);H("m",["mm",2],0,"minute"),z("minute","m"),N("m",Wc),N("mm",Wc,Sc),Q(["m","mm"],jd);var Jd=C("Minutes",!1);H("s",["ss",2],0,"second"),z("second","s"),N("s",Wc),N("ss",Wc,Sc),Q(["s","ss"],kd);var Kd=C("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),z("millisecond","ms"),N("S",Xc,Rc),N("SS",Xc,Sc),N("SSS",Xc,Tc);var Ld;for(Ld="SSSS";Ld.length<=9;Ld+="S")N(Ld,$c);for(Ld="S";Ld.length<=9;Ld+="S")Q(Ld,Wb);var Md=C("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var Nd=n.prototype;Nd.add=Ad,Nd.calendar=cb,Nd.clone=db,Nd.diff=ib,Nd.endOf=ub,Nd.format=mb,Nd.from=nb,Nd.fromNow=ob,Nd.to=pb,Nd.toNow=qb,Nd.get=F,Nd.invalidAt=Cb,Nd.isAfter=eb,Nd.isBefore=fb,Nd.isBetween=gb,Nd.isSame=hb,Nd.isValid=Ab,Nd.lang=Cd,Nd.locale=rb,Nd.localeData=sb,Nd.max=wd,Nd.min=vd,Nd.parsingFlags=Bb,Nd.set=F,Nd.startOf=tb,Nd.subtract=Bd,Nd.toArray=yb,Nd.toObject=zb,Nd.toDate=xb,Nd.toISOString=lb,Nd.toJSON=lb,Nd.toString=kb,Nd.unix=wb,Nd.valueOf=vb,Nd.year=td,Nd.isLeapYear=ia,Nd.weekYear=Fb,Nd.isoWeekYear=Gb,Nd.quarter=Nd.quarters=Jb,Nd.month=Y,Nd.daysInMonth=Z,Nd.week=Nd.weeks=na,Nd.isoWeek=Nd.isoWeeks=oa,Nd.weeksInYear=Ib,Nd.isoWeeksInYear=Hb,Nd.date=Dd,Nd.day=Nd.days=Pb,Nd.weekday=Qb,Nd.isoWeekday=Rb,Nd.dayOfYear=qa,Nd.hour=Nd.hours=Id,Nd.minute=Nd.minutes=Jd,Nd.second=Nd.seconds=Kd,Nd.millisecond=Nd.milliseconds=Md,Nd.utcOffset=Na,Nd.utc=Pa,Nd.local=Qa,Nd.parseZone=Ra,Nd.hasAlignedHourOffset=Sa,Nd.isDST=Ta,Nd.isDSTShifted=Ua,Nd.isLocal=Va,Nd.isUtcOffset=Wa,Nd.isUtc=Xa,Nd.isUTC=Xa,Nd.zoneAbbr=Xb,Nd.zoneName=Yb,Nd.dates=aa("dates accessor is deprecated. Use date instead.",Dd),Nd.months=aa("months accessor is deprecated. Use month instead",Y),Nd.years=aa("years accessor is deprecated. Use year instead",td),Nd.zone=aa("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Oa);var Od=Nd,Pd={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Qd={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Rd="Invalid date",Sd="%d",Td=/\d{1,2}/,Ud={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Vd=s.prototype;Vd._calendar=Pd,Vd.calendar=_b,Vd._longDateFormat=Qd,Vd.longDateFormat=ac,Vd._invalidDate=Rd,Vd.invalidDate=bc,Vd._ordinal=Sd,Vd.ordinal=cc,Vd._ordinalParse=Td,Vd.preparse=dc,Vd.postformat=dc,Vd._relativeTime=Ud,Vd.relativeTime=ec,Vd.pastFuture=fc,Vd.set=gc,Vd.months=U,Vd._months=md,Vd.monthsShort=V,Vd._monthsShort=nd,Vd.monthsParse=W,Vd.week=ka,Vd._week=ud,Vd.firstDayOfYear=ma,Vd.firstDayOfWeek=la,Vd.weekdays=Lb,Vd._weekdays=Ed,Vd.weekdaysMin=Nb,Vd._weekdaysMin=Gd,Vd.weekdaysShort=Mb,Vd._weekdaysShort=Fd,Vd.weekdaysParse=Ob,Vd.isPM=Ub,Vd._meridiemParse=Hd,Vd.meridiem=Vb,w("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===q(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=aa("moment.lang is deprecated. Use moment.locale instead.",w),a.langData=aa("moment.langData is deprecated. Use moment.localeData instead.",y);var Wd=Math.abs,Xd=yc("ms"),Yd=yc("s"),Zd=yc("m"),$d=yc("h"),_d=yc("d"),ae=yc("w"),be=yc("M"),ce=yc("y"),de=Ac("milliseconds"),ee=Ac("seconds"),fe=Ac("minutes"),ge=Ac("hours"),he=Ac("days"),ie=Ac("months"),je=Ac("years"),ke=Math.round,le={s:45,m:45,h:22,d:26,M:11},me=Math.abs,ne=Ha.prototype;ne.abs=oc,ne.add=qc,ne.subtract=rc,ne.as=wc,ne.asMilliseconds=Xd,ne.asSeconds=Yd,ne.asMinutes=Zd,ne.asHours=$d,ne.asDays=_d,ne.asWeeks=ae,ne.asMonths=be,ne.asYears=ce,ne.valueOf=xc,ne._bubble=tc,ne.get=zc,ne.milliseconds=de,ne.seconds=ee,ne.minutes=fe,ne.hours=ge,ne.days=he,ne.weeks=Bc,ne.months=ie,ne.years=je,ne.humanize=Fc,ne.toISOString=Gc,ne.toString=Gc,ne.toJSON=Gc,ne.locale=rb,ne.localeData=sb,ne.toIsoString=aa("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gc),ne.lang=Cd,H("X",0,0,"unix"),H("x",0,0,"valueOf"),N("x",_c),N("X",bd),Q("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),Q("x",function(a,b,c){c._d=new Date(q(a))}),a.version="2.10.6",b(Da),a.fn=Od,a.min=Fa,a.max=Ga,a.utc=h,a.unix=Zb,a.months=jc,a.isDate=d,a.locale=w,a.invalid=l,a.duration=Ya,a.isMoment=o,a.weekdays=lc,a.parseZone=$b,a.localeData=y,a.isDuration=Ia,a.monthsShort=kc,a.weekdaysMin=nc,a.defineLocale=x,a.weekdaysShort=mc,a.normalizeUnits=A,a.relativeTimeThreshold=Ec;var oe=a;return oe}),function(){function a(a){this._value=a}function b(a,b,c,d){var e,f,g=Math.pow(10,b);return f=(c(a*g)/g).toFixed(b),d&&(e=new RegExp("0{1,"+d+"}$"),f=f.replace(e,"")),f}function c(a,b,c){var d;return d=b.indexOf("$")>-1?e(a,b,c):b.indexOf("%")>-1?f(a,b,c):b.indexOf(":")>-1?g(a,b):i(a._value,b,c)}function d(a,b){var c,d,e,f,g,i=b,j=["KB","MB","GB","TB","PB","EB","ZB","YB"],k=!1;if(b.indexOf(":")>-1)a._value=h(b);else if(b===q)a._value=0;else{for("."!==o[p].delimiters.decimal&&(b=b.replace(/\./g,"").replace(o[p].delimiters.decimal,".")),c=new RegExp("[^a-zA-Z]"+o[p].abbreviations.thousand+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),d=new RegExp("[^a-zA-Z]"+o[p].abbreviations.million+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+o[p].abbreviations.billion+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+o[p].abbreviations.trillion+"(?:\\)|(\\"+o[p].currency.symbol+")?(?:\\))?)?$"),g=0;g<=j.length&&!(k=b.indexOf(j[g])>-1?Math.pow(1024,g+1):!1);g++);a._value=(k?k:1)*(i.match(c)?Math.pow(10,3):1)*(i.match(d)?Math.pow(10,6):1)*(i.match(e)?Math.pow(10,9):1)*(i.match(f)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(b.replace(/[^0-9\.]+/g,"")),a._value=k?Math.ceil(a._value):a._value}return a._value}function e(a,b,c){var d,e,f=b.indexOf("$"),g=b.indexOf("("),h=b.indexOf("-"),j="";return b.indexOf(" $")>-1?(j=" ",b=b.replace(" $","")):b.indexOf("$ ")>-1?(j=" ",b=b.replace("$ ","")):b=b.replace("$",""),e=i(a._value,b,c),1>=f?e.indexOf("(")>-1||e.indexOf("-")>-1?(e=e.split(""),d=1,(g>f||h>f)&&(d=0),e.splice(d,0,o[p].currency.symbol+j),e=e.join("")):e=o[p].currency.symbol+j+e:e.indexOf(")")>-1?(e=e.split(""),e.splice(-1,0,j+o[p].currency.symbol),e=e.join("")):e=e+j+o[p].currency.symbol,e}function f(a,b,c){var d,e="",f=100*a._value;return b.indexOf(" %")>-1?(e=" ",b=b.replace(" %","")):b=b.replace("%",""),d=i(f,b,c),d.indexOf(")")>-1?(d=d.split(""),d.splice(-1,0,e+"%"),d=d.join("")):d=d+e+"%",d}function g(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)}function h(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function i(a,c,d){var e,f,g,h,i,j,k=!1,l=!1,m=!1,n="",r=!1,s=!1,t=!1,u=!1,v=!1,w="",x="",y=Math.abs(a),z=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],A="",B=!1;if(0===a&&null!==q)return q;if(c.indexOf("(")>-1?(k=!0,c=c.slice(1,-1)):c.indexOf("+")>-1&&(l=!0,c=c.replace(/\+/g,"")),c.indexOf("a")>-1&&(r=c.indexOf("aK")>=0,s=c.indexOf("aM")>=0,t=c.indexOf("aB")>=0,u=c.indexOf("aT")>=0,v=r||s||t||u,c.indexOf(" a")>-1?(n=" ",c=c.replace(" a","")):c=c.replace("a",""),y>=Math.pow(10,12)&&!v||u?(n+=o[p].abbreviations.trillion,a/=Math.pow(10,12)):y<Math.pow(10,12)&&y>=Math.pow(10,9)&&!v||t?(n+=o[p].abbreviations.billion,a/=Math.pow(10,9)):y<Math.pow(10,9)&&y>=Math.pow(10,6)&&!v||s?(n+=o[p].abbreviations.million,a/=Math.pow(10,6)):(y<Math.pow(10,6)&&y>=Math.pow(10,3)&&!v||r)&&(n+=o[p].abbreviations.thousand,a/=Math.pow(10,3))),c.indexOf("b")>-1)for(c.indexOf(" b")>-1?(w=" ",c=c.replace(" b","")):c=c.replace("b",""),g=0;g<=z.length;g++)if(e=Math.pow(1024,g),f=Math.pow(1024,g+1),a>=e&&f>a){w+=z[g],e>0&&(a/=e);break}return c.indexOf("o")>-1&&(c.indexOf(" o")>-1?(x=" ",c=c.replace(" o","")):c=c.replace("o",""),x+=o[p].ordinal(a)),c.indexOf("[.]")>-1&&(m=!0,c=c.replace("[.]",".")),h=a.toString().split(".")[0],i=c.split(".")[1],j=c.indexOf(","),i?(i.indexOf("[")>-1?(i=i.replace("]",""),i=i.split("["),A=b(a,i[0].length+i[1].length,d,i[1].length)):A=b(a,i.length,d),h=A.split(".")[0],A=A.split(".")[1].length?o[p].delimiters.decimal+A.split(".")[1]:"",m&&0===Number(A.slice(1))&&(A="")):h=b(a,null,d),h.indexOf("-")>-1&&(h=h.slice(1),B=!0),j>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+o[p].delimiters.thousands)),0===c.indexOf(".")&&(h=""),(k&&B?"(":"")+(!k&&B?"-":"")+(!B&&l?"+":"")+h+A+(x?x:"")+(n?n:"")+(w?w:"")+(k&&B?")":"")}function j(a,b){o[a]=b}function k(a){var b=a.toString().split(".");return b.length<2?1:Math.pow(10,b[1].length)}function l(){var a=Array.prototype.slice.call(arguments);return a.reduce(function(a,b){var c=k(a),d=k(b);return c>d?c:d},-1/0)}var m,n="1.5.3",o={},p="en",q=null,r="0,0",s="undefined"!=typeof module&&module.exports;m=function(b){return m.isNumeral(b)?b=b.value():0===b||"undefined"==typeof b?b=0:Number(b)||(b=m.fn.unformat(b)),new a(Number(b))},m.version=n,m.isNumeral=function(b){return b instanceof a},m.language=function(a,b){if(!a)return p;if(a&&!b){if(!o[a])throw new Error("Unknown language : "+a);p=a}return(b||!o[a])&&j(a,b),m},m.languageData=function(a){if(!a)return o[p];if(!o[a])throw new Error("Unknown language : "+a);return o[a]},m.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),m.zeroFormat=function(a){q="string"==typeof a?a:null},m.defaultFormat=function(a){r="string"==typeof a?a:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(a,b){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var c,d,e=this.length>>>0,f=!1;for(1<arguments.length&&(d=b,f=!0),c=0;e>c;++c)this.hasOwnProperty(c)&&(f?d=a(d,this[c],c,this):(d=this[c],f=!0));if(!f)throw new TypeError("Reduce of empty array with no initial value");return d}),m.fn=a.prototype={clone:function(){return m(this)},format:function(a,b){return c(this,a?a:r,void 0!==b?b:Math.round)},unformat:function(a){return"[object Number]"===Object.prototype.toString.call(a)?a:d(this,a?a:r)},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){function b(a,b){return a+c*b}var c=l.call(null,this._value,a);return this._value=[this._value,a].reduce(b,0)/c,this},subtract:function(a){function b(a,b){return a-c*b}var c=l.call(null,this._value,a);return this._value=[a].reduce(b,this._value*c)/c,this},multiply:function(a){function b(a,b){var c=l(a,b);return a*c*b*c/(c*c)}return this._value=[this._value,a].reduce(b,1),this},divide:function(a){function b(a,b){var c=l(a,b);return a*c/(b*c)}return this._value=[this._value,a].reduce(b),this},difference:function(a){return Math.abs(m(this._value).subtract(a).value())}},s&&(module.exports=m),"undefined"==typeof ender&&(this.numeral=m),"function"==typeof define&&define.amd&&define("numeral",[],function(){return m})}.call(this),!function(a){function b(){var a=arguments[0],c=b.cache;return c[a]&&c.hasOwnProperty(a)||(c[a]=b.parse(a)),b.format.call(null,c[a],arguments)}function c(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}function d(a,b){return Array(b+1).join(a)}var e={not_string:/[^s]/,number:/[diefg]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};b.format=function(a,f){var g,h,i,j,k,l,m,n=1,o=a.length,p="",q=[],r=!0,s="";for(h=0;o>h;h++)if(p=c(a[h]),"string"===p)q[q.length]=a[h];else if("array"===p){if(j=a[h],j[2])for(g=f[n],i=0;i<j[2].length;i++){if(!g.hasOwnProperty(j[2][i]))throw new Error(b("[sprintf] property '%s' does not exist",j[2][i]));g=g[j[2][i]]}else g=j[1]?f[j[1]]:f[n++];if("function"==c(g)&&(g=g()),e.not_string.test(j[8])&&e.not_json.test(j[8])&&"number"!=c(g)&&isNaN(g))throw new TypeError(b("[sprintf] expecting number but found %s",c(g)));switch(e.number.test(j[8])&&(r=g>=0),j[8]){case"b":g=g.toString(2);break;case"c":g=String.fromCharCode(g);break;case"d":case"i":g=parseInt(g,10);break;case"j":g=JSON.stringify(g,null,j[6]?parseInt(j[6]):0);break;case"e":g=j[7]?g.toExponential(j[7]):g.toExponential();break;case"f":g=j[7]?parseFloat(g).toFixed(j[7]):parseFloat(g);break;case"g":g=j[7]?parseFloat(g).toPrecision(j[7]):parseFloat(g);break;case"o":g=g.toString(8);break;case"s":g=(g=String(g))&&j[7]?g.substring(0,j[7]):g;break;case"u":g>>>=0;break;case"x":g=g.toString(16);break;case"X":g=g.toString(16).toUpperCase()}e.json.test(j[8])?q[q.length]=g:(!e.number.test(j[8])||r&&!j[3]?s="":(s=r?"+":"-",g=g.toString().replace(e.sign,"")),l=j[4]?"0"===j[4]?"0":j[4].charAt(1):" ",m=j[6]-(s+g).length,k=j[6]&&m>0?d(l,m):"",q[q.length]=j[5]?s+g+k:"0"===l?s+k+g:k+s+g)}return q.join("")},b.cache={},b.parse=function(a){for(var b=a,c=[],d=[],f=0;b;){if(null!==(c=e.text.exec(b)))d[d.length]=c[0];else if(null!==(c=e.modulo.exec(b)))d[d.length]="%";else{if(null===(c=e.placeholder.exec(b)))throw new SyntaxError("[sprintf] unexpected placeholder");if(c[2]){f|=1;var g=[],h=c[2],i=[];if(null===(i=e.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(g[g.length]=i[1];""!==(h=h.substring(i[0].length));)if(null!==(i=e.key_access.exec(h)))g[g.length]=i[1];else{if(null===(i=e.index_access.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");g[g.length]=i[1]}c[2]=g}else f|=2;if(3===f)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");d[d.length]=c}b=b.substring(c[0].length)}return d};var f=function(a,c,d){return d=(c||[]).slice(0),d.splice(0,0,a),b.apply(null,d)};"undefined"!=typeof exports?(exports.sprintf=b,exports.vsprintf=f):(a.sprintf=b,a.vsprintf=f,"function"==typeof define&&define.amd&&define("sprintf",[],function(){return{sprintf:b,vsprintf:f}}))}("undefined"==typeof window?this:window);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/util/datatraversing",["jquery","src/data/structures","src/util/debug"],function(a,b,c){function d(b,c){var e=h(b),f=c.shift();return f?e&&(e=e[f])!==!1?i(e).pipe(function(a){return d(a,c)}):a.Deferred().reject():a.Deferred().resolve(b)}function e(a,b,c,d,f){var g,j=h(a);if("object"!=("undefined"==typeof j?"undefined":_typeof(j))&&b.length>0&&(j={}),1==b.length)return j[b[0]]=c;var k=b.shift();return k?((g=j[k])||(g={},j[k]=g),i(g).pipe(function(a){return e(a,b,c)}).done(function(){f||l(j,d)})):void 0}function f(a){return a&&a._options?a._options:{}}function g(a){return a&&a._highlight?a._highlight:[]}function h(a){return"undefined"!=typeof a?"object"==("undefined"==typeof a?"undefined":_typeof(a))&&a.url?i(a).pipe(function(a){
return a.value}):a.value&&a.type?a.value:a:void 0}function i(b){var d=a.Deferred();if("undefined"==typeof b||null==b)return d.reject();var e=j(b);return b.url&&b.type?(require(["src/util/urldata"],function(a){a.get(b.url,!1,b.timeout).then(function(a){a={type:e,value:a},d.resolve(a)},function(a){c.error("Fetching error",a)})}),d):d.resolve(b)}function j(a){if(void 0!=a){if(a.getType)return a.getType();var d="undefined"==typeof a?"undefined":_typeof(a);return"object"==d?Array.isArray(a)?"array":b[a.type]&&(a.value||a.url)?a.type:"undefined"!=typeof a.type&&a.value?void c.error("Type "+a.type+" could not be found"):"object":d}}function k(a,b,c){a.__onDataChanged||(a.__onDataChanged=[]),a.__onDataChanged.push([b,c])}function l(a,b){if(a.__onDataChanged)for(var c=0,d=a.__onDataChanged.length;d>c;c++)(void 0!==b&&a.__onDataChanged[c][1]!==b||void 0===b)&&a.__onDataChanged[c][0].call(a,a)}return{getType:j,getValueIfNeeded:h,fetchElementIfNeeded:i,getValueFromJPath:function(b,c){if(!c)return a.Deferred().resolve(b);c.split||(c="");var e=c.split(".");return e.shift(),d(b,e)},setValueFromJPath:function(a,b,c,d,f){b.split||(b="");var g=b.split(".");return g.shift(),d!==!0&&d!==!1||(f=d,d=void 0),e(a,g,c,d,f)},getJPathsFromStructure:function(a,c,d,e){if(a){var f,g,h=[];if(a.elements)switch(e?e+="."+c:e=c="element",d.push({title:c,children:h,key:e}),a.type){case"object":for(g in a.elements)this.getJPathsFromStructure(a.elements[g],g+"",h,e);break;case"array":for(Array.isArray(a.elements)||(a.elements=[a.elements]),f=Math.min(5,a.elements.length||0),a.nbElements&&(f=a.nbElements),g=0;f>g;g++)this.getJPathsFromStructure(a.elements[g]||a.elements[0],g+"",h,e)}else"string"==typeof a&&"object"==_typeof(b[a])?this.getJPathsFromStructure(b[a],c,d,e):(e&&null!=e?e+="."+c:e=c="element",d.push({title:c,children:h,key:e}))}},getStructureFromElement:function(a,c,d){if(c=c||{},d=d||0,!(c.recursionLimit&&d>=c.recursionLimit)){var e={};if(a){a.getType||(a=DataObject.check(a,!0));var f=a.getType();if(a=DataObject.check(a.get()),"array"==f){e.type="array",e.elements=[];for(var g=Math.min(5,a.length),h=0;g>h;h++)e.elements[h]=this.getStructureFromElement(a.get(h,!1),c,d+1)}else if("object"==f){e.type="object",e.elements={};for(var h in a)"_"!==h[0]&&(e.elements[h]=this.getStructureFromElement(a.get(h,!1),c,d+1))}else e=f&&b[f]&&(a.value||a.url)?b[f]:f;return e}}},getJPathsFromElement:function(a,c){if(c||(c=[]),void 0!==a&&null!=a){if(a._structure)this.getJPathsFromStructure(a._structure,null,c);else if(a.type&&b[a.type]&&(a.value||a.url))this.getJPathsFromStructure(b[a.type],null,c);else{var d=this.getStructureFromElement(a,{recursionLimit:7});this.getJPathsFromStructure(d,null,c)}return c}},get:function(a){if(a){if("function"==typeof a.get)return a.get();if(a.type&&a.value)return a.value}return a},getHighlights:g,getOptions:f,triggerDataChange:l,listenDataChange:k}}),define("src/util/actionmanager",["require"],function(require){function doScripts(){var data=getActionScripts();if(data&&!evaluatedScripts){for(var evaled={},i=0,l=data.length;l>i;i++)eval("evaled[ [ data[ i ].groups.action[ 0 ].name[ 0 ] ] ] = function(value) { "+data[i].groups.action[0].script[0]+" }");evaluatedScripts=evaled}}function getActionScripts(){return Versioning.getView().actionscripts||[]}function setActionScripts(a){evaluatedScripts=void 0,Versioning.getView().actionscripts=a,doScripts(a)}function setActionFiles(a){Versioning.getView().actionfiles=a,doFiles()}function doFiles(){var a=Versioning.getView().actionfiles;if(actionsFiles={},a)for(var b=0,c=a[0].groups.action[0].length;c>b;b++)actionsFiles[a[0].groups.action[0][b].name]=actionsFiles[a[0].groups.action[0][b].name]||[],actionsFiles[a[0].groups.action[0][b].name].push({file:a[0].groups.action[0][b].file,mode:a[0].groups.action[0][b].mode})}function executeActionFile(a,b){switch(a.mode){case"amd":require([a.file],function(a){a(b)});break;case"worker":var c=new Worker(a.file);c.postMessage({method:"actionValue",value:b}),c.onmessage=function(a){if(a.data.method)switch(a.data.method){case"getVar":if(!Array.isArray(a.data.variables))return;for(var b={},d=0,e=a.data.variables.length;e>d;d++)b[a.data.variables[d]]=API.getVar(a.data.variables[d]);c.postMessage({method:"getVar",variables:b});break;case"setVar":if(!a.data.variables)return;for(var d in a.data.variables)API.setVar(d,a.data.variables[d]);break;case"terminate":c.terminate();break;case"sendAction":if(!a.data.actionName)return;API.doAction(a.data.actionName,a.data.actionValue);break;case"highlight":if(!a.data.highlightId)return;API.highlightId(a.data.highlightId,a.data.highlightValue||!1)}}}}var Versioning;require(["src/util/versioning"],function(a){Versioning=a});var API;require(["src/util/api"],function(a){API=a});var evaluatedScripts,actionsFiles;return{setScriptsFromForm:function(a){setActionScripts(a)},setFilesFromForm:function(a){setActionFiles(a)},viewHasChanged:function(a){setActionScripts(a.actionscripts),doFiles()},getScriptsForm:function(){return Versioning.getView().actionscripts||[]},getFilesForm:function(){return Versioning.getView().actionfiles||[]},execute:function(a,b){if(evaluatedScripts[a]&&setImmediate(function(){evaluatedScripts[a](b)}),actionsFiles[a])for(var c=0,d=actionsFiles[a].length;d>c;c++)executeActionFile(actionsFiles[a][c],b)}}}),define("src/util/config",["./versioning"],function(a){var b,c=["undefined","all","global-configuration","configuration","copy","paste","duplicate","add","layers","utils","remove","export","print","refresh","tofront","toback","move","custom","fullscreen"];return{getConfig:function(){return b},setConfig:function(a){b=a},contextMenu:function(){return b&&b.contextMenu?b.contextMenu:a.isViewLocked()?[]:c}}}),define("src/util/api",["./cache","./datatraversing","./actionmanager","./util","./versioning","./config","src/main/variables","src/main/datas","lodash","src/main/grid"],function(a,b,c,d,e,f,g,h,i){function j(a,b,c,d){b&&b.__parent&&(b=b.resurrect()),b=DataObject.check(b,!0),b&&b.trace?b.trace(c).then(function(b){g.setVariable(a,!1,b,d)}):g.setVariable(a,!1,b,d)}function k(a,b,c){this.repositoryHighlights.set(a,b,null,c)}var l,m=d.getLoadingAnimation(64,"slateblue"),n=$("<div>",{id:"ci-loading"}).append(m).append($("<div>",{id:"ci-loading-message",class:"ci-loading-subtitle"})),o={},p=0,q={getRepositoryData:function(){return this.repositoryData},setRepositoryData:function(a){this.repositoryData=a},getRepositoryHighlights:function(){return this.repositoryHighlights},setRepositoryHighlights:function(a){this.repositoryHighlights=a},getRepositoryActions:function(){return this.repositoryActions},setRepositoryActions:function(a){this.repositoryActions=a},createDataJpath:j,listenHighlight:function(){arguments[0]&&"undefined"!=typeof arguments[0]._highlight&&(arguments[0]=arguments[0]._highlight,this.repositoryHighlights.listen.apply(this.repositoryHighlights,arguments))},killHighlight:function(){this.repositoryHighlights.kill.apply(this.repositoryHighlights,arguments)},highlightId:k,getAllFilters:function(){return l},setAllFilters:function(a){l=i([a,l]).flatten().filter(function(a){return a&&a.name&&a.file}).uniq(function(a){return a.file}).unshift({file:"",name:"No filter"}).value()},isViewLocked:function(){return e.isViewLocked()},viewLock:function(){return e.viewLock()},getContextMenu:function(){return f.contextMenu()},dev_fctCalled:function(a){},dev_fctUncalled:function(a){},dev_assert:function(a,b,c){}};return q.existVariable=function(a){return g.exist(a)},q.existVar=q.existVariable,q.setVariable=function(a,b,c,d){Array.isArray(b)&&(d=c,c=b,b=null),c=c||[];var e=b?b.getjPath().concat(c):c;return g.setVariable(a,e,!1,d)},q.setVar=q.setVariable,q.createData=function(a,b,c){return g.setVariable(a,!1,b,c)},q.getVariable=function(a){return g.getVariable(a)},q.getVar=q.getVariable,q.getData=function(a){return q.getVariable(a).getData()},q.setHighlight=function(a,b){a&&(Array.isArray(a)&&(a={_highlight:a}),"undefined"!=typeof a._highlight&&this.repositoryHighlights.set(a._highlight,b))},q.highlight=q.setHighlight,q.loading=function(a,b){b||(b=a),0==p&&$("#ci-visualizer").append(n),o[a]?o[a].html(b):(o[a]=$("<div>"+b+"</div>"),p++,$("#ci-loading-message").append(o[a]))},q.stopLoading=function(a){o[a]&&(p--,o[a].detach(),o[a]=null,0==p&&n.detach())},q.doAction=function(a,b){h.isSpecialObject(b)&&(b=b.get()),this.repositoryActions.set(a,b),c.execute(a,b)},q.executeAction=d.deprecate(function(a,b){c.execute(a,b)},"API.doAction is the recommended method."),q.cache=function(b,c){return 1===arguments.length?a.get(b):void a.set(b,c)},q.cache.clear=function(){return a.clear()},q.getLayerNames=function(){return require("src/main/grid").getLayerNames()},q.switchToLayer=function(a){return require("src/main/grid").switchToLayer(a)},q.getActiveLayerName=function(){return require("src/main/grid").getActiveLayerName()},q}),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)}("undefined"!=typeof window?window:this,function(a){"use strict";var b=function(b){var c=[];return c["./jquery"]=b,c["./graph.position"]=function(){function a(a){return a&&a.indexOf&&a.indexOf("px")>-1?parseInt(a.replace("px","")):!1}var b=function(a,b,c,d){!(a instanceof Number)&&a instanceof Object?(this.x=a.x,this.y=a.y,this.dx=a.dx,this.dy=a.dy):(this.x=a,this.y=b,this.dx=c,this.dy=d)};return b.prototype.compute=function(a,b,c,d){return a&&b&&c&&a.hasXAxis&&a.hasYAxis||this.graph.throw(),a.hasXAxis(b)||a.throw("Graph does not contain the x axis that was used as a parameter"),a.hasYAxis(c)||a.throw("Graph does not contain the x axis that was used as a parameter"),this._compute(a,b,c,d)},b.prototype._compute=function(b,c,d,e){var f=this._relativeTo;if(f)var g=f._compute(b,c,d,e);var h,i={x:!1,y:!1};c||(c=b.getXAxis()),d||(d=b.getYAxis());for(var j in i){var k="x"==j?c:d,l=this[j],m=this["d"+j];if(void 0===l&&(void 0!==m&&void 0===f||void 0===f)){if("x"==j){if(void 0===m)continue;i[j]=f?f[j]:k.getPos(0)}else if(this.x&&e)if(a(this.x)!==!1)console.warn("You have defined x in px and not y. Makes no sense. Returning 0 for y"),i[j]=0;else{var n=e.searchClosestValue(this.x);n?i[j]=e.getY(n.yMin):(console.warn("Could not find y position for x = "+this.x+' on serie "'+e.getName()+'". Returning 0 for y.'),i[j]=0)}}else void 0!==l&&(i[j]=this.getPx(l,k));if(void 0!==m){var o=void 0!==l||void 0==g||void 0==g[j]?i[j]:g[j];if("y"==j&&g&&void 0!==g.x&&void 0==g.y){if(!e)throw"Error. No serie exists. Cannot find y value";var n=e.searchClosestValue(f.x);n&&(o=e.getY(n.yMin))}(h=a(m))!==!1?i[j]=o+h:(h=this._parsePercent(m))?i[j]=o+this._getPositionPx(h,!0,k,b):k&&(i[j]=o+k.getRelPx(m))}}return i},b.prototype._getPositionPx=function(b,c,d,e){var f;return(f=a(b))!==!1?f:(f=this._parsePercent(b))!==!1?f/100*(c?e.getDrawingWidth():e.getDrawingHeight()):d?d.getPos(b):void 0},b.prototype._parsePercent=function(a){return a&&a.indexOf&&a.indexOf("%")>-1?a:!1},b.getDeltaPx=function(b,c){var d;return(d=a(b))!==!1?d+"px":c.getRelPx(b)+"px"},b.prototype.deltaPosition=function(b,c,d){b="y"==b?"y":"x";var e,f,g=this[b],h=this["d"+b];if(void 0!==g)(e=a(g))!==!1?(f=a(c))!==!1?this[b]=e+f+"px":this[b]=e+d.getRelPx(c)+"px":(g=this.getValPosition(g,d),(f=a(c))!==!1?this[b]=g+d.getRelVal(f):this[b]=g+c);else if(void 0!==h){if("y"==b&&void 0===g&&!this._relativeTo)return;(e=a(h))!==!1?(f=a(c))!==!1?this["d"+b]=e+f+"px":this["d"+b]=e+d.getRelPx(c)+"px":(h=this.getValPosition(h,d),(f=a(c))!==!1?this["d"+b]=h+d.getRelVal(f):this["d"+b]=h+c)}},b.prototype.getValPosition=function(a,b){return"max"==a?b.getMaxValue():"min"==a?b.getMinValue():a},b.prototype.getPx=function(b,c,d){var e;return(e=a(b))!==!1?e:(e=this._parsePercent(b))?e:c?"min"==b?c.getMinPx():"max"==b?c.getMaxPx():d?c.getRelPx(b):c.getPos(b):void 0},b.prototype.getPxRel=function(a,b){return this.getPx(a,b,!0)},b.prototype.relativeTo=function(a){return this._relativeTo=b.check(a),this},b.check=function(a,c){if(a instanceof b)return a;var d=new b(a);if(a&&a.relativeTo){var e;(e=c(a.relativeTo))&&d.relativeTo(e)}return d},b}(),c["./graph.util"]=function(){var a={};return a.setAttributeTo=function(a,b,c){var d;if(c)for(d in b)a.setAttributeNS(c,d,b[d]);else for(d in b)a.setAttribute(d,b[d])},a.mapEventEmission=function(a,b){b||(b=this);var c;for(var d in a)0==d.indexOf("on")&&"function"==typeof a[d]&&(c=d.substring(2),c=c.substring(0,1).toLowerCase()+c.substring(1),b.on&&!function(d){b.on(c,function(){a[d].apply(b,arguments)})}(d))},a.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},a.throwError=function(a){console.error(a)},a.isNumeric=function(a){return!Array.isArray(a)&&a-parseFloat(a)+1>=0},a.hue2rgb=function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a},a.hslToRgb=function(b,c,d){var e,f,g;if(0==c)e=f=g=d;else{var h=.5>d?d*(1+c):d+c-d*c,i=2*d-h;e=a.hue2rgb(i,h,b+1/3),f=a.hue2rgb(i,h,b),g=a.hue2rgb(i,h,b-1/3)}return[Math.round(255*e),Math.round(255*f),Math.round(255*g)]},a.saveDomAttributes=function(b,c,d){if(b){b._savedAttributesIds=b._savedAttributesIds||[],b._savedAttributesIds.indexOf(d)>-1&&a.restoreDomAttributes(b,d),b._savedAttributes=b._savedAttributes||{},b._attributes=b._attributes||{},b._attributes[d]=c,b._savedAttributesIds.push(d);for(var e in c)b._savedAttributes[e]||(b._savedAttributes[e]=b.getAttribute(e)),b.setAttribute(e,c[e])}},a.restoreDomAttributes=function(a,b){if(a&&a._savedAttributesIds){a._savedAttributesIds.splice(a._savedAttributesIds.indexOf(b),1),delete a._attributes[b];var c={};for(var d in a._savedAttributes)c[d]=a._savedAttributes[d];for(var d=0,e=a._savedAttributesIds.length;e>d;d++)for(var f in a._attributes[a._savedAttributesIds[d]])c[f]=a._attributes[a._savedAttributesIds[d]][f];for(var f in c)a.setAttribute(f,c[f])}},a.extend=function(){var b,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"!=typeof h&&"function"!=typeof h&&(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(f=arguments[i]))for(e in f)b=h[e],d=f[e],h!==d&&(k&&d&&(a.isPlainObject(d)||(c=Array.isArray(d)))?(c?(c=!1,g=b&&Array.isArray(b)?b:[]):g=b&&a.isPlainObject(b)?b:{},h[e]=a.extend(k,g,d)):void 0!==d&&(h[e]=d));return h},a.isPlainObject=function(a){return"object"!=typeof a||a.nodeType||a===a.window?!1:!a.constructor||!a.constructor.prototype.hasOwnProperty("isPrototypeOf")},a.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},a}(),c["./dependencies/eventEmitter/EventEmitter"]=function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype;return d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a}(),c["./graph.core"]=function(b,c,d,e){function f(a,b,c,e){var f=a.getConstructor("graph.serie."+e);if(!f)return d.throwError('No constructor exists for serie type "'+e+'"');var g=new f;return g.init(a,b,c),a.appendSerieToDom(g),g}function g(a,b){for(var c=0,d=b.length;d>c;c++){for(var e=!0,f=0,g=b[c].length;g>f;f++)a[0]<b[c][f][0]&&a[1]<b[c][f][0]||a[0]>b[c][f][1]&&a[1]>b[c][f][1]||(e=!1);if(e)return b[c].push(a),c}return b.push([a]),b.length-1}function h(a){var b={top:[],bottom:[],left:[],right:[]},c={top:[],bottom:[],left:[],right:[]};a._painted=!0,a._applyToAxes(function(a,d){if(!a.disabled&&!a.floating){var e=g(a.getSpan(),c[d]);a.setLevel(e),b[d][e]=Math.max(a.getAxisPosition(),b[d][e]||0)}},!1,!0,!1);var d=b.top.reduce(function(a,b){return a+b},0),e=b.bottom.reduce(function(a,b){return a+b},0);[b.top,b.bottom].map(function(a){a.reduce(function(b,c,d){return a[d]=b+c,b+c},0)}),a._applyToAxes(function(a,c){a.disabled||a.floating||a.setShift(b[c][a.getLevel()])},!1,!0,!1),a._applyToAxes(function(f,h){if(!f.disabled&&(f.setMinPx(d),f.setMaxPx(a.getDrawingHeight(!0)-e),!f.floating)){var i=f.draw(),j=g(f.getSpan(),c[h]);f.setLevel(j),b[h][j]=Math.max(i+f.getAxisPosition(),b[h][j]||0)}},!1,!1,!0);var f=b.left.reduce(function(a,b){return a+b},0),h=b.right.reduce(function(a,b){return a+b},0);[b.left,b.right].map(function(a){a.reduce(function(b,c,d){return a[d]=b+c,b+c},0)}),a._applyToAxes(function(a,c){a.disabled||a.floating||a.setShift(b[c][a.getLevel()])},!1,!1,!0),a._applyToAxes(function(b,c){b.disabled||(b.setMinPx(f),b.setMaxPx(a.getDrawingWidth(!0)-h),b.floating||b.draw())},!1,!0,!1),a._applyToAxes(function(a){if(a.floating){var b=a.getFloatingAxis(),c=a.getFloatingValue(),d=b.getPx(c);a.setShift(d),a.draw()}},!1,!0,!0),q(a,"right",a.getDrawingWidth(!0),a.getDrawingWidth(!0),d,a.getDrawingHeight(!0)-e),q(a,"left",0,0,d,a.getDrawingHeight(!0)-e),q(a,"top",f,a.getDrawingWidth(!0)-h,0,0),q(a,"bottom",f,a.getDrawingWidth(!0)-h,a.getDrawingHeight(!0)-e,a.getDrawingHeight(!0)-e),a.clipRect.setAttribute("y",d),a.clipRect.setAttribute("x",f),a.clipRect.setAttribute("width",a.getDrawingWidth()-f-h),a.clipRect.setAttribute("height",a.getDrawingHeight()-d-e),a.rectEvent.setAttribute("y",d+a.getPaddingTop()),a.rectEvent.setAttribute("x",f+a.getPaddingLeft()),a.rectEvent.setAttribute("width",a.getDrawingWidth()-f-h),a.rectEvent.setAttribute("height",a.getDrawingHeight()-d-e),a.shift=b,a.redrawShapes()}function i(a){var b=a;a._dom.addEventListener("keydown",function(a){8==a.keyCode&&b.selectedShapes&&(a.preventDefault(),a.stopPropagation(),b.selectedShapes.map(function(a){a.kill()}))}),a.groupEvent.addEventListener("mousemove",function(a){var c=b._getXY(a);k(b,c.x,c.y,a)}),a.dom.addEventListener("mouseleave",function(a){s(b)}),a.dom.addEventListener("mousedown",function(a){if(b.focus(),3!=a.which&&!a.ctrlKey){var c=b._getXY(a);j(b,c.x,c.y,a)}}),a.dom.addEventListener("mouseup",function(c){a.emit("mouseUp",c);var d=b._getXY(c);n(b,d.x,d.y,c)}),a.dom.addEventListener("dblclick",function(c){a.emit("dblClick",c);var d=b._getXY(c);m(b,d.x,d.y,c)}),a.dom.addEventListener("click",function(a){if(3!=a.which&&!a.ctrlKey){var c=b._getXY(a);b.prevent(!1)||o(b,c.x,c.y,a)}}),a.groupEvent.addEventListener("mousewheel",function(c){if(a.options.wheel.type){c.preventDefault(),c.stopPropagation();var d=c.wheelDeltaY||c.wheelDelta||-c.deltaY;return r(b,d,c),!1}}),a.groupEvent.addEventListener("wheel",function(c){if(a.options.wheel.type){c.stopPropagation(),c.preventDefault();var d=c.wheelDeltaY||c.wheelDelta||-c.deltaY;return r(b,d,c),!1}})}function j(a,b,c,d){var e,f=a.options.pluginAction;if(a.forcedPlugin)return a.activePlugin=a.forcedPlugin,void a._pluginExecute(a.activePlugin,"onMouseDown",[a,b,c,d]);for(e in f)if(a.isPluginAllowed(d,f[e]))return a.activePlugin=e,void a._pluginExecute(e,"onMouseDown",[a,b,c,d])}function k(a,b,c,d){if(a.bypassHandleMouse)return void a.bypassHandleMouse.handleMouseMove(d);if(!a.activePlugin||!a._pluginExecute(a.activePlugin,"onMouseMove",[a,b,c,d])){if(a._applyToAxes("handleMouseMove",[b-a.options.paddingLeft,d],!0,!1),a._applyToAxes("handleMouseMove",[c-a.options.paddingTop,d],!1,!0),!a.activePlugin){var e,f={};if(a.options.trackingLine&&a.options.trackingLine.snapToSerie&&"common"==a.options.trackingLine.mode){var g=a.options.trackingLine.snapToSerie;if(e=g.handleMouseMove(!1,!0)){a.trackingLine.show();var h=e.xIndexClosest;a.trackingLine.getPosition(0).x=g.getData()[0][2*h],a.trackingLine.getPosition(1).x=g.getData()[0][2*h],a.trackingLine.redraw();var b=g.getXAxis().getPx(a.trackingLine.getPosition(0).x)+a.options.paddingLeft}else a.trackingLine.hide();var i=a.options.trackingLine.series;a.options.trackingLine.series||(i=a.getSeries().map(function(a){return{serie:a,withinPx:20,withinVal:-1}})),a._trackingLegend=w(a,i,b,c,a._trackingLegend,a.options.trackingLine.textMethod,a.trackingLine.getPosition(1).x)}}if(a.options.onMouseMoveData){for(var j=0;j<a.series.length;j++)f[a.series[j].getName()]=a.series[j].handleMouseMove(!1,!0);a.options.onMouseMoveData.call(a,d,f)}}}function l(a){var b=document.createElement("div");return b.setAttribute("class","trackingLegend"),b.style.position="absolute",b.style.borderRadius="4px",b.style.boxShadow="1px 1px 3px 0px rgba(100,100,100,0.6)",b.style.border="2px solid #333333",b.style.backgroundColor="rgba(255, 255, 255, 0.5 )",b.style.pointerEvents="none",b.style.paddingTop="5px",b.style.paddingBottom="5px",b.style.paddingLeft="10px",b.style.paddingRight="10px",a.getWrapper().insertBefore(b,a.getDom()),b}function m(a,b,c,d){var e=a.options.dblclick;if(e&&e.type)switch(e.type){case"plugin":var f;(f=a.plugins[e.plugin])&&f.onDblClick(a,b,c,e.options,d)}}function n(a,b,c,d){return a.bypassHandleMouse?(a.bypassHandleMouse.handleMouseUp(d),void(a.activePlugin=!1)):(a._pluginExecute(a.activePlugin,"onMouseUp",[a,b,c,d]),void(a.activePlugin=!1))}function o(a,b,c,d){a.emit("click",[a,b,c,d]),d.target.jsGraphIsShape||a.prevent(!1)||!a.options.shapesUnselectOnClick||a.unselectShapes()}function p(a,b,c,d){var e,c=c||{},f={def:{x:a.getConstructor("graph.axis.x"),y:a.getConstructor("graph.axis.y")},broken:{x:a.getConstructor("graph.axis.x.broken"),y:a.getConstructor("graph.axis.y.broken")},time:{x:a.getConstructor("graph.axis.x.time")}};switch(c.type){case"time":var g=f.time;break;case"broken":var g=f.broken;break;default:var g=f.def}switch(d){case"top":case"bottom":e=g.x;break;case"left":case"right":e=g.y}return b=b||0,"object"==typeof b&&(c=b,b=0),a.axis[d][b]=a.axis[d][b]||new e(a,d,c)}function q(a,b,c,d,e,f){if(a.options.close!==!1){var g=0;a.axis[b].map(function(a){a.isDisplayed()&&!a.floating&&g++}),a.options.close!==!0&&!a.options.close[b]||0!=g?a.closingLines[b].setAttribute("display","none"):(a.closingLines[b].setAttribute("display","block"),a.closingLines[b].setAttribute("x1",c),a.closingLines[b].setAttribute("x2",d),a.closingLines[b].setAttribute("y1",e),a.closingLines[b].setAttribute("y2",f))}}function r(a,b,c){switch(c.preventDefault(),c.stopPropagation(),a.options.wheel.type){case"plugin":var d;(d=a.plugins[a.options.wheel.plugin])&&d.onMouseWheel(b,c,a.options.wheel.options);break;case"toSeries":for(var e=0,f=a.series.length;f>e;e++)a.series[e].onMouseWheel(b,c)}}function s(a){a.options.handleMouseLeave&&a.options.handleMouseLeave.call(this)}function t(a){var b=a._axesHaveChanged;return a._axesHaveChanged=!1,b}var u=function(a,c,e){if(this._creation=d.guid(),"string"==typeof a&&(a=document.getElementById(a)),!a)throw"The wrapper DOM element was not found.";if(a instanceof b&&(a=a.get(0)),!a.appendChild)throw"The wrapper appears to be an invalid HTMLElement";a.style["-webkit-user-select"]="none",a.style["-moz-user-select"]="none",a.style["-o-user-select"]="none",a.style["-ms-user-select"]="none",a.style["user-select"]="none",this.options=b.extend({},v,c),this.prevented=!1,this.axis={left:[],top:[],bottom:[],right:[]},this.shapes=[],this.shapesLocked=!1,this.plugins={},this.selectedShapes=[],this.ns="http://www.w3.org/2000/svg",this.nsxlink="http://www.w3.org/1999/xlink",this.series=[],this._dom=a,this._axesHaveChanged=!0,this.options.hasOwnProperty("padding")&&d.isNumeric(this.options.padding)&&(this.options.paddingTop=this.options.paddingBottom=this.options.paddingLeft=this.options.paddingRight=this.options.padding);var f,g;if(f=a.style.width&&-1==a.style.width.indexOf("%")?parseInt(a.style.width.replace("px","")):b(a).width(),g=a.style.height&&-1==a.style.height.indexOf("%")?parseInt(a.style.height.replace("px","")):b(a).height(),this._doDom(),this.setSize(f,g),this._resize(),i(this),this.pluginsReady=b.Deferred(),this.seriesReady=b.Deferred(),this.currentAction=!1,e)for(var h in e)for(var j=0,k=e[h].length;k>j;j++)switch(h){case"top":this.getTopAxis(j,e[h][j]);break;case"bottom":this.getBottomAxis(j,e[h][j]);break;case"left":this.getLeftAxis(j,e[h][j]);break;case"right":this.getRightAxis(j,e[h][j])}this._pluginsInit()},v={title:"",paddingTop:30,paddingBottom:5,paddingLeft:20,paddingRight:20,close:{left:!0,right:!0,top:!0,bottom:!0},fontSize:12,fontFamily:"Myriad Pro, Helvetica, Arial",plugins:{},pluginAction:{},wheel:{},dblclick:{},shapesUnselectOnClick:!0,shapesUniqueSelection:!0};u.prototype=new e,u.prototype=b.extend(u.prototype,{getDom:function(){return this.dom},getWrapper:function(){return this._dom},setOption:function(a,b){return this.options[a]=b,this},setTitle:function(a){this.options.title=a,this.domTitle.textContent=a},displayTitle:function(){this.domTitle.setAttribute("display","inline")},hideTitle:function(){this.domTitle.setAttribute("display","none")},redraw:function(a){return this.width&&this.height?this.sizeSet?!a||t(this)?(h(this),!0):!1:(this._resize(),!0):void 0},draw:function(){this.drawSeries(this.redraw(!0))},setWidth:function(a,b){this.width=a,b||this._resize()},setHeight:function(a,b){this.height=a,b||this._resize()},resize:function(a,b){return a&&b&&this.setSize(a,b),this._resize(),this},setSize:function(a,b){this.setWidth(a,!0),this.setHeight(b,!0),this.getDrawingHeight(),this.getDrawingWidth()},getWidth:function(){return this.width},getHeight:function(){return this.height},getPaddingTop:function(){return this.options.paddingTop},getPaddingLeft:function(){return this.options.paddingLeft},getPaddingBottom:function(){return this.options.paddingBottom},getPaddingRight:function(){return this.options.paddingRight},getDrawingHeight:function(a){return a&&this.innerHeight?this.innerHeight:this.innerHeight=this.height-this.options.paddingTop-this.options.paddingBottom},getDrawingWidth:function(a){return a&&this.innerWidth?this.innerWidth:this.innerWidth=this.width-this.options.paddingLeft-this.options.paddingRight},cacheOffset:function(){this.offsetCached=b(this._dom).offset()},uncacheOffset:function(){this.offsetCached=!1},getXAxis:function(a,b){return this.axis.top.length>0&&0==this.axis.bottom.length?this.getTopAxis(a,b):this.getBottomAxis(a,b)},getYAxis:function(a,b){return this.axis.right.length>0&&0==this.axis.left.length?this.getRightAxis(a,b):this.getLeftAxis(a,b)},getTopAxis:function(a,b){return p(this,a,b,"top")},getBottomAxis:function(a,b){return p(this,a,b,"bottom")},getLeftAxis:function(a,b){return p(this,a,b,"left")},getRightAxis:function(a,b){return p(this,a,b,"right")},setXAxis:function(a,b){this.setBottomAxis(a,b)},setYAxis:function(a,b){this.setLeftAxis(a,b)},setLeftAxis:function(a,b){b=b||0,this.axis.left[b]=a},setRightAxis:function(a,b){b=b||0,this.axis.right[b]=a},setTopAxis:function(a,b){b=b||0,this.axis.top[b]=a},setBottomAxis:function(a,b){b=b||0,this.axis.bottom[b]=a},hasXAxis:function(a){return this.hasTopAxis(a)||this.hasBottomAxis(a)},hasYAxis:function(a){return this.hasLeftAxis(a)||this.hasRightAxis(a)},hasTopAxis:function(a){return this.hasAxis(a,this.axis.top)},hasBottomAxis:function(a){return this.hasAxis(a,this.axis.bottom)},hasLeftAxis:function(a){return this.hasAxis(a,this.axis.left)},hasRightAxis:function(a){return this.hasAxis(a,this.axis.right)},hasAxis:function(a,b){return b.indexOf(a)>-1},autoscaleAxes:function(){this._applyToAxes("setMinMaxToFitSeries",null,!0,!0)},_applyToAxis:{string:function(a,b,c){for(var d=0;d<this.axis[a].length;d++)this.axis[a][d][b].apply(this.axis[a][d],c)},function:function(a,b,c){for(var d=0;d<this.axis[a].length;d++)b.call(this,this.axis[a][d],a,c)}},getBoundaryAxis:function(a,b){var c=this.getBoundaryAxisFromSeries(a,b);return c},getBoundaryAxisFromSeries:function(a,b){var c,d,e,f,g,h,i="min"==b,j=a.isX()?["getMinX","getMaxX"]:["getMinY","getMaxY"],k=j[i?0:1],l=i?+(1/0):-(1/0);for(c=i?Number.MAX_VALUE:Number.MIN_VALUE,e=this.getSeriesFromAxis(a,!0),g=0,h=e.length;h>g;g++)d=e[g],d.isShown()&&(f=d[k](),c=Math[b](isNaN(c)?l:c,isNaN(f)?l:f));return c},getSeriesFromAxis:function(a){for(var b=[],c=this.series.length-1;c>=0;c--)this.series[c].getXAxis()!=a&&this.series[c].getYAxis()!=a||b.push(this.series[c]);return b},updateDataMinMaxAxes:function(){var a,b,c,d,e,f=["bottom","top","left","right"];for(b=0,c=f.length;c>b;b++)for(d=this.axis[f[b]].length-1;d>=0;d--)a=this.axis[f[b]][d],e=2>b?"x":"y",a.disabled||(a.setMinValueData(this.getBoundaryAxis(this.axis[f[b]][d],"min")),a.setMaxValueData(this.getBoundaryAxis(this.axis[f[b]][d],"max")))},_applyToAxes:function(a,b,c,d){var e,f=[],g=0;for((c||void 0==c)&&(f.push("top"),f.push("bottom")),(d||void 0==d)&&(f.push("left"),f.push("right")),e=f.length;e>g;g++)this._applyToAxis[typeof a].call(this,f[g],a,b)},findAxesLinkedTo:function(a){var b=[];return this._applyToAxes(function(c){c.linkedToAxis&&c.linkedToAxis.axis==a&&b.push(c)},{},a instanceof this.getConstructor("graph.axis.x"),a instanceof this.getConstructor("graph.axis.y")),b},_axisHasChanged:function(a){this._axesHaveChanged=!0},newSerie:function(a,b,c){var d=this;"function"==typeof c&&(c="line",callback=c),c||(c="line");var e;return(e=this.getSerie(a))?e:(e=f(this,a,b,c),e.type=c,d.series.push(e),d.legend&&d.legend.update(),d.emit("newSerie",e),e)},getSerie:function(a){if("number"==typeof a)return this.series[a]||!1;for(var b=0,c=this.series.length;c>b;b++)if(this.series[b].getName()==a)return this.series[b];return!1},getSeries:function(){return this.series},drawSerie:function(a,b){if(!a.draw)throw"Serie has no method draw";a.draw(b)},drawSeries:function(a){if(this.width&&this.height)for(var b=this.series.length-1;b>=0;b--)this.series[b].isShown()&&this.drawSerie(this.series[b],a)},resetSeries:function(){this.removeSeries()},killSeries:function(){this.resetSeries()},removeSeries:function(){for(;this.series[0];)this.series[0].kill(!0);this.series=[]},selectSerie:function(a,b){this.selectedSerie!=a&&(this.selectedSerie&&this.unselectSerie(a),this.selectedSerie=a,this.triggerEvent("onSelectSerie",a),
a.select("selected"))},getSelectedSerie:function(){return this.selectedSerie},unselectSerie:function(a){a.unselect(),this.selectedSerie=!1,this.triggerEvent("onUnselectSerie",a)},getShapesOfSerie:function(a){for(var b=[],c=this.shapes.length-1;c>=0;c--)this.shapes[c].getSerie()==a&&b.push(this.shapes[c]);return b},makeToolbar:function(a){var b=this.getConstructor("graph.toolbar");return b?this.toolbar=new b(this,a):d.throwError("No constructor exists for toolbar")},getShapes:function(){return this.shapes||[]},newShape:function(a,b,e){if(!e&&(this.emit("beforeNewShape",b),this.prevent(!1)))return!1;"object"==typeof a&&(e=b,b=a,a=b.type),b=b||{},b._id=d.guid();var f;if(f="function"==typeof a?a:this.getConstructor("graph.shape."+a),!f)return d.throwError("No constructor for this shape");var g=new f(this,b);if(!g)return d.throwError("Failed to construct shape.");if(g.type=a,g.graph=this,g._data=b,g.init(this),b.position)for(var h=0,i=b.position.length;i>h;h++)g.setPosition(new c(b.position[h]),h);if(void 0!==b.properties&&g.setProperties(b.properties),void 0!==b.fillColor&&g.setFillColor(b.fillColor),void 0!==b.fillOpacity&&g.setFillOpacity(b.fillOpacity),void 0!==b.strokeColor&&g.setStrokeColor(b.strokeColor),void 0!==b.strokeWidth&&g.setStrokeWidth(b.strokeWidth),void 0!==b.layer&&g.setLayer(b.layer),void 0!==b.locked&&g.lock(),void 0!==b.movable&&g.movable(),void 0!==b.selectable&&g.selectable(),void 0!==b.resizable&&g.resizable(),void 0!==b.attributes&&g.setProp("attributes",b.attributes),void 0!==b.handles&&g.setProp("handles",b.handles),void 0!==b.selectOnMouseDown&&g.setProp("selectOnMouseDown",!0),void 0!==b.selectOnClick&&g.setProp("selectOnClick",!0),void 0!==b.highlightOnMouseOver&&g.setProp("highlightOnMouseOver",!0),b.labels&&!b.label&&(b.label=b.labels),void 0!==b.label){Array.isArray(b.label)||(b.label=[b.label]);for(var h=0,i=b.label.length;i>h;h++)g.showLabel(h),g.setLabelText(b.label[h].text,h),g.setLabelPosition(b.label[h].position,h),g.setLabelColor(b.label[h].color||"black",h),g.setLabelSize(b.label[h].size,h),g.setLabelAngle(b.label[h].angle||0,h),g.setLabelBaseline(b.label[h].baseline||"no-change",h),g.setLabelAnchor(b.label[h].anchor||"start",h)}return g.createHandles(),this.shapes.push(g),e||this.emit("newShape",g,b),g},newPosition:function(a){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(c,arguments))},redrawShapes:function(){for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a].redraw()},removeShapes:function(){for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a]&&this.shapes[a].kill&&this.shapes[a].kill(!0);this.shapes=[]},selectShape:function(a,b){if(a){if(this.selectedShapes.indexOf(a)>-1)return!1;if(!a.isSelectable())return!1;b||this.emit("beforeShapeSelect",a),this.prevent(!1)||(this.selectedShapes.length>0&&this.options.shapesUniqueSelection&&this.unselectShapes(b),a._select(b),this.selectedShapes.push(a),b||this.emit("shapeSelect",a))}},unselectShape:function(a,b){if(-1!=this.selectedShapes.indexOf(a)){if(b||this.emit("beforeShapeUnselect",a),this.cancelUnselectShape)return void(this.cancelUnselectShape=!1);a._unselect(),this.selectedShapes.splice(this.selectedShapes.indexOf(a),1),b||this.emit("shapeUnselect",a)}},unselectShapes:function(a){for(;this.selectedShapes[0];)this.unselectShape(this.selectedShapes[0],a);return this},_removeShape:function(a){this.shapes.splice(this.shapes.indexOf(a),1)},appendShapeToDom:function(a){this.getLayer(a.getLayer(),"shape").appendChild(a.group)},removeShapeFromDom:function(a){this.getLayer(a.getLayer(),"shape").removeChild(a.group)},appendSerieToDom:function(a){this.getLayer(a.getLayer(),"serie").appendChild(a.groupMain)},removeSerieFromDom:function(a){this.getLayer(a.getLayer(),"serie").removeChild(a.groupMain)},getLayer:function(a,b){if(!this.layers[a]){this.layers[a]=[],this.layers[a][0]=document.createElementNS(this.ns,"g"),this.layers[a][0].setAttribute("data-layer",a),this.layers[a][1]=document.createElementNS(this.ns,"g"),this.layers[a][2]=document.createElementNS(this.ns,"g"),this.layers[a][0].appendChild(this.layers[a][1]),this.layers[a][0].appendChild(this.layers[a][2]);for(var c,d=1;!(c=this.layers[a-d])&&a-d>=0;)d++;c?c.nextSibling?this.plotGroup.insertBefore(this.layers[a][0],c.nextSibling):this.plotGroup.appendChild(this.layers[a][0]):this.plotGroup.insertBefore(this.layers[a][0],this.plotGroup.firstChild)}return this.layers[a]["shape"==b?2:1]},focus:function(){this._dom.focus()},elementMoving:function(a){this.bypassHandleMouse=a},stopElementMoving:function(a){a&&a==this.bypassHandleMouse?this.bypassHandleMouse=!1:a||(this.bypassHandleMouse=!1)},_makeClosingLines:function(){this.closingLines={};for(var a,b=["top","bottom","left","right"],c=0,d=4;d>c;c++){var a=document.createElementNS(this.ns,"line");a.setAttribute("stroke","black"),a.setAttribute("shape-rendering","crispEdges"),a.setAttribute("stroke-linecap","square"),a.setAttribute("display","none"),this.closingLines[b[c]]=a,this.graphingZone.appendChild(a)}},isPluginAllowed:function(a,b){if(this.forcedPlugin==b)return!0;var c=this.options.pluginAction[b]||b;return void 0===c.shift&&(c.shift=!1),void 0===c.ctrl&&(c.ctrl=!1),void 0===c.meta&&(c.meta=!1),void 0===c.alt&&(c.alt=!1),a.shiftKey==c.shift&&a.ctrlKey==c.ctrl&&a.metaKey==c.meta&&a.altKey==c.alt},forcePlugin:function(a){this.forcedPlugin=a},unforcePlugin:function(){this.forcedPlugin=!1},_pluginsExecute:function(a,b){for(var c in this.plugins)this.plugins[c]&&this.plugins[c][a]&&this.plugins[c][a].apply(this.plugins[c],b)},_pluginExecute:function(a,b,c){a&&this.plugins[a]&&this.plugins[a][b]&&this.plugins[a][b].apply(this.plugins[a],c)},_pluginsInit:function(){var a,c,e;for(var f in this.options.plugins)c=f,e=this.options.plugins[f],a=this.getConstructor("graph.plugin."+c),a?(this.plugins[c]=new a,this.plugins[c].options=b.extend(!0,{},a.prototype.defaults||{},e),d.mapEventEmission(this.plugins[c].options,this.plugins[c]),this.plugins[c].init(this,e)):d.throwError('Plugin "'+c+'" has not been registered')},getPlugin:function(a){var b=this.plugins[a];return b?b:d.throwError('Plugin "'+a+'" has not been loaded or properly registered')},triggerEvent:function(){var a=arguments[0];Array.prototype.splice.apply(arguments,[0,1]);return"function"==typeof this.options[a]?this.options[a].apply(this,arguments):void 0},makeLegend:function(a){if(this.legend)return this.legend;var b=this.getConstructor("graph.legend");return b?(this.legend=new b(this,a),this.legend.update(),this.legend):d.throwError("Graph legend is not available as it has not been registered")},updateLegend:function(){this.legend&&this.legend.update()},getLegend:function(){return this.legend?this.legend:void 0},kill:function(){this._dom.removeChild(this.dom)},_removeSerie:function(a){this.series.splice(this.series.indexOf(a),1)},contextListen:function(a,b,c){return this.options.onContextMenuListen?this.options.onContextMenuListen(a,b,c):void 0},lockShapes:function(){this.shapesLocked=!0;for(var a=0,b=this.shapes.length;b>a;a++)this.shapes[a].moving=!1,this.shapes[a].resizing=!1},unlockShapes:function(){this.shapesLocked=!1},prevent:function(a){var b=this.prevented;return-1!=a&&(this.prevented=void 0==a||a),b},_getXY:function(a){var c=a.pageX,d=a.pageY,e=this.offsetCached||b(this._dom).offset();return c-=e.left,d-=e.top,{x:c,y:d}},_resize:function(){this.width&&this.height&&(this.getDrawingWidth(),this.getDrawingHeight(),this.sizeSet=!0,this.dom.setAttribute("width",this.width),this.dom.setAttribute("height",this.height),this.domTitle.setAttribute("x",this.width/2),h(this),this.legend&&this.legend.update())},_doDom:function(){this.dom=document.createElementNS(this.ns,"svg"),this.dom.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),d.setAttributeTo(this.dom,{xmlns:this.ns,"font-family":this.options.fontFamily,"font-size":this.options.fontSize}),this._dom.appendChild(this.dom),this._dom.setAttribute("tabindex",1),this._dom.style.outline="none",this.defs=document.createElementNS(this.ns,"defs"),this.dom.appendChild(this.defs),this.groupEvent=document.createElementNS(this.ns,"g"),this.rectEvent=document.createElementNS(this.ns,"rect"),d.setAttributeTo(this.rectEvent,{"pointer-events":"fill",fill:"transparent"}),this.groupEvent.appendChild(this.rectEvent),this.dom.appendChild(this.groupEvent),this.domTitle=document.createElementNS(this.ns,"text"),this.setTitle(this.options.title),d.setAttributeTo(this.domTitle,{"text-anchor":"middle",y:20}),this.groupEvent.appendChild(this.domTitle),this.graphingZone=document.createElementNS(this.ns,"g"),this.updateGraphingZone(),this.groupEvent.appendChild(this.graphingZone),this.axisGroup=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.axisGroup),this.groupGrids=document.createElementNS(this.ns,"g"),this.groupGrids.setAttribute("clip-path","url(#_clipplot"+this._creation+")"),this.groupPrimaryGrids=document.createElementNS(this.ns,"g"),this.groupSecondaryGrids=document.createElementNS(this.ns,"g"),this.axisGroup.appendChild(this.groupGrids),this.groupGrids.appendChild(this.groupSecondaryGrids),this.groupGrids.appendChild(this.groupPrimaryGrids),this.plotGroup=document.createElementNS(this.ns,"g"),this.graphingZone.appendChild(this.plotGroup),this.layers=[],this._makeClosingLines(),this.clip=document.createElementNS(this.ns,"clipPath"),this.clip.setAttribute("id","_clipplot"+this._creation),this.defs.appendChild(this.clip),this.clipRect=document.createElementNS(this.ns,"rect"),this.clip.appendChild(this.clipRect),this.clip.setAttribute("clipPathUnits","userSpaceOnUse"),this.markerArrow=document.createElementNS(this.ns,"marker"),this.markerArrow.setAttribute("viewBox","0 0 10 10"),this.markerArrow.setAttribute("id","arrow"+this._creation),this.markerArrow.setAttribute("refX","6"),this.markerArrow.setAttribute("refY","5"),this.markerArrow.setAttribute("markerUnits","strokeWidth"),this.markerArrow.setAttribute("markerWidth","8"),this.markerArrow.setAttribute("markerHeight","6"),this.markerArrow.setAttribute("orient","auto");var a=document.createElementNS(this.ns,"path");a.setAttribute("d","M 0 0 L 10 5 L 0 10 z"),this.markerArrow.appendChild(a),this.defs.appendChild(this.markerArrow),this.vertLineArrow=document.createElementNS(this.ns,"marker"),this.vertLineArrow.setAttribute("viewBox","0 0 10 10"),this.vertLineArrow.setAttribute("id","verticalline"+this._creation),this.vertLineArrow.setAttribute("refX","0"),this.vertLineArrow.setAttribute("refY","5"),this.vertLineArrow.setAttribute("markerUnits","strokeWidth"),this.vertLineArrow.setAttribute("markerWidth","20"),this.vertLineArrow.setAttribute("markerHeight","10"),this.vertLineArrow.setAttribute("orient","auto"),this.vertLineArrow.setAttribute("stroke-width","1px");var b=document.createElementNS(this.ns,"path");b.setAttribute("d","M 0 -10 L 0 10"),b.setAttribute("stroke","black"),this.vertLineArrow.appendChild(b),this.defs.appendChild(this.vertLineArrow),this.plotGroup.setAttribute("clip-path","url(#_clipplot"+this._creation+")"),this.bypassHandleMouse=!1},updateGraphingZone:function(){d.setAttributeTo(this.graphingZone,{transform:"translate("+this.options.paddingLeft+", "+this.options.paddingTop+")"})},trackingLine:function(a){var b=this;return a&&(this.options.trackingLine=a),"individual"==a.mode?a.series.map(function(a){a.serie.enableTracking(function(c,d,e,f){if(d){b.trackingLine.show();d.xIndexClosest;b.trackingLine.getPosition(0).x=c.getData()[0][2*d.closestIndex],b.trackingLine.getPosition(1).x=c.getData()[0][2*d.closestIndex],b.trackingLine.redraw(),c._trackingLegend=w(b,{serie:c},e,f,c._trackingLegend,a.textMethod?a.textMethod:function(a){for(var b in a)return a[b].serie.serie.getName()},b.trackingLine.getPosition(0).x),c._trackingLegend.style.display="block"}},function(a){b.trackingLine.hide(),a.trackingShape&&a.trackingShape.hide(),a._trackingLegend.style.display="none",a._trackingLegend=w(b,{serie:a},!1,!1,a._trackingLegend,!1,!1)})}):a.series.map(function(a){a.serie.disableTracking()}),this.trackingLine=this.newShape("line",d.extend(!0,{position:[{y:"min"},{y:"max"}],stroke:"black",layer:-1},a.trackingLineShapeOptions)),this.trackingLine.draw(),this.trackingLine}});var w=function(a,b,c,d,e,f,g){var h=!1;Array.isArray(b)||(b=[b]);var i=[];return e||(h=!0,e=l(a)),b.map(function(b){var d=b.serie.handleMouseMove(g,!1);return d&&f?void(b.withinPx>0&&Math.abs(c-a.options.paddingLeft-b.serie.getXAxis().getPx(b.serie.getData()[0][2*d.xIndexClosest]))-b.withinPx>1e-14||b.withinVal>0&&Math.abs(b.serie.getXAxis().getVal(c-a.options.paddingLeft)-b.serie.getData()[0][2*d.xIndexClosest])-b.withinVal>b.serie.getXAxis().getVal(c-a.options.paddingLeft)/1e5?b.serie.trackingShape&&b.serie.trackingShape.hide():(i[b.serie.getName()]={xIndex:d.xIndexClosest,yValue:b.serie.getData()[0][2*d.xIndexClosest+1],xValue:b.serie.getData()[0][2*d.xIndexClosest],serie:b,index:d},b.serie.trackingShape||(b.serie.trackingShape=a.newShape("ellipse",{fillColor:b.serie.getLineColor(),strokeColor:"White",strokeWidth:b.serie.getLineWidth()}).setSerie(b.serie).setProp("rx",3*b.serie.getLineWidth()).setProp("ry",3*b.serie.getLineWidth()).forceParentDom(b.serie.groupMain).draw()),b.serie.trackingShape.show(),b.serie.trackingShape.getPosition(0).x=b.serie.getData()[0][2*d.xIndexClosest],b.serie.trackingShape.redraw())):(b.serie.trackingShape&&b.serie.trackingShape.hide(),e)}),0!=Object.keys(i).length&&f?("none"==e.style.display||h?x(a,e,c,d,!0):y(a,e,c,d),e.style.display="block",e.innerHTML=f(i,g,c,d)):e.style.display="none",e},x=function(b,c,d,e,f){function g(){var b=(Date.now()-h)/200;b>1&&(b=1),c.style.marginLeft=(d-j)*b+j+"px",c.style.marginTop=(e-k)*b+k+"px",1>b&&a.requestAnimationFrame(g)}var h=Date.now(),i=c.offsetHeight,j=parseInt(c.style.marginLeft.replace("px","")||0),k=parseInt(c.style.marginTop.replace("px","")||0);return d=d>b.getWidth()/2?d-d%10-20-c.offsetWidth:d-d%10+30,e=e-e%10+i/2,f?(c.style.marginLeft=d+"px",void(c.style.marginTop=e+"px")):void a.requestAnimationFrame(g)},y=d.debounce(x,50);return u.registerConstructor=function(a,b){return u._constructors[a]?d.throwError("Constructor "+b+" already exists."):void(u._constructors[a]=b)},u.getConstructor=function(a){var b=u._constructors[a];return b?b:d.throwError('Constructor "'+a+"\" doesn't exist")},u.prototype.getConstructor=u.getConstructor,u._constructors={},u}(c["./jquery"],c["./graph.position"],c["./graph.util"],c["./dependencies/eventEmitter/EventEmitter"]),c["./graph.axis"]=function(a,b,c){var d=function(){};return d.prototype=new b,d.prototype.defaults={lineAt0:!1,display:!0,flipped:!1,axisDataSpacing:{min:.1,max:.1},unitModification:!1,primaryGrid:!0,secondaryGrid:!0,primaryGridColor:"#f0f0f0",secondaryGridColor:"#f0f0f0",primaryGridWidth:1,secondaryGridWidth:1,shiftToZero:!1,tickPosition:1,nbTicksPrimary:3,nbTicksSecondary:10,ticklabelratio:1,exponentialFactor:0,exponentialLabelFactor:0,logScale:!1,forcedMin:!1,forcedMax:!1,span:[0,1],scientificScale:!1,scientificScaleExponent:!1,engineeringScale:!1,unit:!1},d.prototype.init=function(b,c,e){this.unitModificationTimeTicks=[[1,[1,2,5,10,20,30]],[60,[1,2,5,10,20,30]],[3600,[1,2,6,12]],[86400,[1,2,3,4,5,10,20,40]]];var f=this;this.graph=b,this.options=a.extend(!0,{},d.prototype.defaults,e,c),this.group=document.createElementNS(this.graph.ns,"g"),this.hasChanged=!0,this.rectEvent=document.createElementNS(this.graph.ns,"rect"),this.rectEvent.setAttribute("pointer-events","fill"),this.rectEvent.setAttribute("fill","transparent"),this.group.appendChild(this.rectEvent),this.graph.axisGroup.appendChild(this.group),this.line=document.createElementNS(this.graph.ns,"line"),this.line.setAttribute("stroke","black"),this.line.setAttribute("shape-rendering","crispEdges"),this.line.setAttribute("stroke-linecap","square"),this.groupTicks=document.createElementNS(this.graph.ns,"g"),this.groupTickLabels=document.createElementNS(this.graph.ns,"g"),this.group.appendChild(this.groupTicks),this.group.appendChild(this.groupTickLabels),this.group.appendChild(this.line),this.labelValue,this.label=document.createElementNS(this.graph.ns,"text"),this.labelTspan=document.createElementNS(this.graph.ns,"tspan"),this.preunitTspan=document.createElementNS(this.graph.ns,"tspan"),this.unitTspan=document.createElementNS(this.graph.ns,"tspan"),this.expTspan=document.createElementNS(this.graph.ns,"tspan"),this.expTspanExp=document.createElementNS(this.graph.ns,"tspan"),this.label.appendChild(this.labelTspan),this.label.appendChild(this.preunitTspan),this.label.appendChild(this.unitTspan),this.label.appendChild(this.expTspan),this.label.appendChild(this.expTspanExp),this.preunitTspan.setAttribute("dx",6),this.expTspan.setAttribute("dx",6),this.expTspanExp.setAttribute("dy",-5),this.expTspanExp.setAttribute("font-size","0.8em"),this.label.setAttribute("text-anchor","middle"),this.gridLinePath={primary:"",secondary:""},this.gridPrimary=document.createElementNS(this.graph.ns,"path"),this.gridSecondary=document.createElementNS(this.graph.ns,"path"),this.graph.groupPrimaryGrids.appendChild(this.gridPrimary),this.graph.groupSecondaryGrids.appendChild(this.gridSecondary),this.setGridLinesStyle(),this.group.appendChild(this.label),this.groupSeries=document.createElementNS(this.graph.ns,"g"),this.group.appendChild(this.groupSeries),this.widthHeightTick=0,this.ticks={},this.ticksLabels=[],this.tickScaling={1:3,2:2,3:1,4:.5},this.currentTick={},this.lastCurrentTick={},this.series=[],this.totalDelta=0,this.currentAction=!1,this.group.addEventListener("mousemove",function(a){a.preventDefault();var b=f.graph._getXY(a);f.handleMouseMoveLocal(b.x,b.y,a);for(var c=0,d=f.series.length;d>c;c++)f.series[c].handleMouseMove(!1,!0)}),this.labels=[],this.group.addEventListener("click",function(a){a.preventDefault();var b=f.graph._getXY(a);f.addLabel(f.getVal(b.x-f.graph.getPaddingLeft()))}),this.axisRand=Math.random(),this.clip=document.createElementNS(this.graph.ns,"clipPath"),this.clip.setAttribute("id","_clip"+this.axisRand),this.graph.defs.appendChild(this.clip),this.clipRect=document.createElementNS(this.graph.ns,"rect"),this.clip.appendChild(this.clipRect),this.clip.setAttribute("clipPathUnits","userSpaceOnUse")},d.prototype.handleMouseMoveLocal=function(){},d.prototype.hide=function(){return this.options.display=!1,this},d.prototype.show=function(){return this.options.display=!0,this},d.prototype.setDisplay=function(a){return this.options.display=!!a,this},d.prototype.isDisplayed=function(){return this.options.display},d.prototype.setLineAt0=function(a){this.options.lineAt0=!!a},d.prototype.adaptTo=function(a,b,c,d){return a?(this.options.adaptTo={axis:a,thisValue:b,foreignValue:c,preference:d},this.adapt(),this):(this.options.adaptTo=!1,this)},d.prototype.adapt=function(){if(this.options.adaptTo){if(!a);var a=this.options.adaptTo.axis,b=this.options.adaptTo.thisValue,c=this.options.adaptTo.foreignValue;if(void 0!==a.currentAxisMin&&void 0!==a.currentAxisMax||a.setMinMaxToFitSeries(),this.options.forcedMin!==!1&&0==this.options.forcedMax||"max"!==this.options.adaptTo.preference){this.options.forcedMin!==!1?this.currentAxisMin=this.options.forcedMin:this.currentAxisMin=this._zoomed?this.getCurrentMin():this.getMinValue()-(b-this.getMinValue())*(this.options.axisDataSpacing.min*(a.getCurrentMax()-a.getCurrentMin())/(c-a.getCurrentMin())),this.currentAxisMin==b&&(this.currentAxisMin-=this.options.axisDataSpacing.min*this.getInterval());var d=this.options.forcedMin!==!1?this.options.forcedMin:this.currentAxisMin;this.currentAxisMax=(b-d)*(a.getCurrentMax()-a.getCurrentMin())/(c-a.getCurrentMin())+d}else{this.options.forcedMax!==!1?this.currentAxisMax=this.options.forcedMax:this.currentAxisMax=this._zoomed?this.getCurrentMax():this.getMaxValue()+(this.getMaxValue()-b)*(this.options.axisDataSpacing.max*(a.getCurrentMax()-a.getCurrentMin())/(a.getCurrentMax()-c)),this.currentAxisMax==b&&(this.currentAxisMax+=this.options.axisDataSpacing.max*this.getInterval());var d=this.options.forcedMax!==!1?this.options.forcedMax:this.currentAxisMax;this.currentAxisMin=(b-d)*(a.getCurrentMin()-a.getCurrentMax())/(c-a.getCurrentMax())+d}this.graph._axisHasChanged(this)}},d.prototype.setFloating=function(a,b){return this.floating=!0,this.floatingAxis=a,this.floatingValue=b,this},d.prototype.getFloatingAxis=function(){return this.floatingAxis},d.prototype.getFloatingValue=function(){return this.floatingValue},d.prototype.setAxisDataSpacing=function(a,b){return this.options.axisDataSpacing.min=a,this.options.axisDataSpacing.max=b||a,this},d.prototype.setAxisDataSpacingMin=function(a){this.options.axisDataSpacing.min=a},d.prototype.setAxisDataSpacingMax=function(a){this.options.axisDataSpacing.max=a},d.prototype.setMinPx=function(a){this.minPx=a,this.setMinMaxFlipped()},d.prototype.setMaxPx=function(a){this.maxPx=a,this.setMinMaxFlipped()},d.prototype.getMinPx=function(){return this.minPxFlipped},d.prototype.getMaxPx=function(a){return this.maxPxFlipped},d.prototype.getMathMaxPx=function(){return this.maxPx},d.prototype.getMathMinPx=function(){return this.minPx},d.prototype.getMinValue=function(){return this.options.forcedMin!==!1?this.options.forcedMin:this.dataMin},d.prototype.getMaxValue=function(){return this.options.forcedMax!==!1?this.options.forcedMax:this.dataMax},d.prototype.setMinValueData=function(a){this.dataMin=a},d.prototype.setMaxValueData=function(a){this.dataMax=a},d.prototype.forceMin=function(a,b){return this.options.forcedMin=a,this.setCurrentMin(b?this.getCurrentMin():void 0),this.graph._axisHasChanged(this),this},d.prototype.forceMax=function(a,b){return this.options.forcedMax=a,this.setCurrentMax(b?this.getCurrentMax():void 0),this.graph._axisHasChanged(this),this},d.prototype.getForcedMin=function(){return this.options.forcedMin},d.prototype.getForcedMax=function(){return this.options.forcedMax},d.prototype.forceToAxis=function(a){return a.getMaxValue&&a.getMinValue&&(this.options.forcedMin=a.getMinValue(),this.options.forcedMax=a.getMaxValue()),this},d.prototype.getNbTicksPrimary=function(){return this.options.nbTicksPrimary},d.prototype.getNbTicksSecondary=function(){return this.options.nbTicksSecondary},d.prototype.handleMouseMove=function(a,b){this.mouseVal=this.getVal(a)},d.prototype.handleMouseWheel=function(a,b,c){a=Math.min(.2,Math.max(-.2,a)),"min"==c?c=this.getMinValue():"max"==c?c=this.getMaxValue():c||(c=0),this._doZoomVal((this.getCurrentMax()-c)*(1+a)+c,(this.getCurrentMin()-c)*(1+a)+c),this.graph.draw()},d.prototype.zoom=function(a,b){return this._doZoomVal(a,b,!0)},d.prototype._doZoomVal=function(a,b,c){return this._doZoom(this.getPx(a),this.getPx(b),a,b,c)},d.prototype._doZoom=function(a,b,c,d,e){var c=void 0!==c?c:this.getVal(a),d=void 0!==d?d:this.getVal(b);return this.setCurrentMin(Math.min(c,d)),this.setCurrentMax(Math.max(c,d)),this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval(),this._zoomed=!0,this.adapt(),this._hasChanged=!0,e||this.emit("zoom",[this.currentAxisMin,this.currentAxisMax,this]),this},d.prototype.getSerieShift=function(){return this._serieShift},d.prototype.getSerieScale=function(){return this._serieScale},d.prototype.getMouseVal=function(){return this.mouseVal},d.prototype.getUnitPerTick=function(a,b,c){var d,e=a/r;b=b?Math.min(b,a/10):a/10;var f=c/b;switch(this.options.unitModification){case"time":case"time:min.sec":var g=this.getModifiedValue(this.getMaxValue());d=3600>g?0:86400>g?1:2;for(var h=!1,i=0,j=this.unitModificationTimeTicks.length;j>i;i++){for(var k=0,l=this.unitModificationTimeTicks[i][1].length;l>k;k++)if(f<this.unitModificationTimeTicks[i][0]*this.unitModificationTimeTicks[i][1][k]){h=!0;break}if(h)break}q=i!==this.unitModificationTimeTicks.length?this.unitModificationTimeTicks[i][0]*this.unitModificationTimeTicks[i][1][k]:1;break;default:var m=Math.floor(Math.log(f)/Math.log(10)),n=f*Math.pow(10,-m);this.decimals=-m;for(var o=[1,2,5,10],p=!1,i=o.length-1;i>=0;i--)(!p||Math.abs(o[i]-n)<Math.abs(p-n))&&(p=o[i]);var q=p*Math.pow(10,m)}var r=c/q,e=a/b;return[q,r,e]},d.prototype.setMinMaxToFitSeries=function(a){var b=this.getInterval();return this.options.logScale?(this.currentAxisMin=Math.max(1e-50,.9*this.getMinValue()),this.currentAxisMax=Math.max(1e-50,1.1*this.getMaxValue())):(this.currentAxisMin=this.getMinValue(),this.currentAxisMax=this.getMaxValue(),this.getForcedMin()===!1&&(this.currentAxisMin-=this.options.axisDataSpacing.min*b),this.getForcedMax()===!1&&(this.currentAxisMax+=this.options.axisDataSpacing.max*b)),(isNaN(this.currentAxisMin)||isNaN(this.currentAxisMax))&&(this.currentAxisMax=void 0,this.currentAxisMin=void 0),this.cacheCurrentMin(),this.cacheCurrentMax(),this.cacheInterval(),this._zoomed=!1,this.adapt(),a||this.graph._axisHasChanged(this),this},d.prototype.getInterval=function(){return this.getMaxValue()-this.getMinValue()},d.prototype.getCurrentInterval=function(){return this.cachedInterval},d.prototype.getCurrentMin=function(){return this.cachedCurrentMin},d.prototype.getCurrentMax=function(){return this.cachedCurrentMax},d.prototype.cacheCurrentMin=function(){this.cachedCurrentMin=this.currentAxisMin==this.currentAxisMax?this.options.logScale?this.currentAxisMin/10:this.currentAxisMin-1:this.currentAxisMin},d.prototype.cacheCurrentMax=function(){this.cachedCurrentMax=this.currentAxisMax==this.currentAxisMin?this.options.logScale?10*this.currentAxisMax:this.currentAxisMax+1:this.currentAxisMax},d.prototype.cacheInterval=function(){this.cachedInterval=this.cachedCurrentMax-this.cachedCurrentMin},d.prototype.setCurrentMin=function(a){return(void 0===a||this.getForcedMin()!==!1&&a<this.getForcedMin())&&(a=this.getMinValue()),this.currentAxisMin=a,this.options.logScale&&(this.currentAxisMin=Math.max(1e-50,a)),this.graph._axisHasChanged(this),this},d.prototype.setCurrentMax=function(a){(void 0===a||this.getForcedMax()!==!1&&a>this.getForcedMax())&&(a=this.getMaxValue()),this.currentAxisMax=a,this.options.logScale&&(this.currentAxisMax=Math.max(1e-50,a)),this.graph._axisHasChanged(this)},d.prototype.flip=function(a){return this.options.flipped=a,this.setMinMaxFlipped(),this},d.prototype.isFlipped=function(){return this.options.flipped},d.prototype._draw=function(a){var b=this;this.drawInit(),this.cacheCurrentMax(),this.cacheCurrentMin(),this.cacheInterval(),void 0!=this.currentAxisMin&&void 0!=this.currentAxisMax||this.setMinMaxToFitSeries(!0);var c=Math.abs(this.getMaxPx()-this.getMinPx()),d=this.getCurrentInterval();if(!this.options.display)return this.line.setAttribute("display","none"),0;this.line.setAttribute("display","block"),1==this.options.scientificScale?this.options.scientificScaleExponent?this.scientificExponent=this.options.scientificScaleExponent:this.scientificExponent=Math.floor(Math.log(Math.max(Math.abs(this.getCurrentMax()),Math.abs(this.getCurrentMin())))/Math.log(10)):this.scientificExponent=0,this.gridLinePath.primary="",this.gridLinePath.secondary="";var e;if(e=this.getLabel()){this.labelTspan.textContent=e,this.options.unit?(this.unitTspan.setAttribute("display","visible"),this.expTspan.setAttribute("display","none"),this.expTspanExp.setAttribute("display","none"),this.unitTspan.innerHTML=this.options.unit.replace(/\^([-+0-9]*)/g,"<tspan dy='-5' font-size='0.7em'>$1</tspan>")):this.unitTspan.setAttribute("display","none");var f;this.options.unitDecade&&this.options.unit&&0!==this.scientificExponent&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent))&&(f=this.getExponentGreekLetter(this.scientificExponent))?(this.preunitTspan.innerHTML=f,this.preunitTspan.setAttribute("display","visible"),this.unitTspan.setAttribute("dx",0)):0===this.scientificExponent||isNaN(this.scientificExponent)?(this.unitTspan.setAttribute("display","none"),this.preunitTspan.setAttribute("display","none"),this.expTspan.setAttribute("display","none"),this.expTspanExp.setAttribute("display","none")):(this.options.engineeringScale&&(this.scientificExponent=this.getEngineeringExponent(this.scientificExponent)),this.preunitTspan.textContent="",this.preunitTspan.setAttribute("display","none"),this.options.unit&&this.unitTspan.setAttribute("dx",5),this.expTspan.setAttribute("display","visible"),this.expTspanExp.setAttribute("display","visible"),this.expTspan.textContent="x10",this.expTspanExp.textContent=this.scientificExponent)}if(this.options.hideTicks)var g=0;else if(this.resetTicksLength(),this.linkedToAxis){this.linkedToAxis.deltaPx=10;var g=this.drawLinkedToAxisTicksWrapper(c,d)}else if(this.options.logScale)var g=this.drawLogTicks();else var g=this.drawLinearTicksWrapper(c,d);this.removeUselessTicks(),this.removeUselessTickLabels(),this.gridPrimary.setAttribute("d",this.gridLinePath.primary),this.gridSecondary.setAttribute("d",this.gridLinePath.secondary);var h=this.graph.findAxesLinkedTo(this);return h.map(function(a){a.setMinPx(b.getMinPx()),a.setMaxPx(b.getMaxPx()),a.draw(!0)}),this.drawSpecifics(),this.options.lineAt0&&this.getCurrentMin()<0&&this.getCurrentMax()>0&&this._draw0Line(this.getPx(0)),g+(e?20:0)},d.prototype.getExponentGreekLetter=function(a){switch(a){case 3:return"k";case 6:return"M";case 9:return"G";case 12:return"T";case 15:return"E";case-3:return"m";case-6:return"&mu;";case-9:return"n";case-12:return"p";case-15:return"f"}},d.prototype.drawInit=function(){switch(this.options.tickPosition){case 3:this.tickPx1=-2,this.tickPx2=0;break;case 2:this.tickPx1=-1,this.tickPx2=1;break;case 1:this.tickPx1=0,this.tickPx2=2}},d.prototype.drawLinearTicksWrapper=function(a,b){var c=this.getUnitPerTick(a,this.getNbTicksPrimary(),b)[0];return this.options.maxPrimaryTickUnit&&this.options.maxPrimaryTickUnit<c?c=this.options.maxPrimaryTickUnit:this.options.minPrimaryTickUnit&&this.options.minPrimaryTickUnit>c&&(c=this.options.minPrimaryTickUnit),this.drawTicks(c,this.secondaryTicks())},d.prototype.forcePrimaryTickUnitMax=function(a){this.options.maxPrimaryTickUnit=a},d.prototype.forcePrimaryTickUnitMin=function(a){this.options.minPrimaryTickUnit=a},d.prototype.setTickLabelRatio=function(a){this.options.ticklabelratio=a},d.prototype.draw=function(a){if(a&&this.linkedToAxis||!a&&!this.linkedToAxis){this._widthLabels=0;var b=this._draw();return this._widthLabels+=b,b}return 0},d.prototype.drawTicks=function(a,b){var c,d,e,f=a,g=this.getCurrentMin(),h=this.getCurrentMax(),i=0;for(b&&(c=f/b),d=this.options.shiftToZero?this.dataMin-Math.ceil((this.dataMin-g)/f)*f:Math.floor(g/f)*f,this.incrTick=a;h>d&&(i++,!(i>200));){if(b){e=d+c;for(var j=0;d+f>e&&(j++,!(j>100));)g>e||e>h?e+=c:(this.drawTickWrapper(e,!1,Math.abs(e-d-f/2)<1e-4?2:3),e+=c)}g>d||d>h?d+=a:(this.drawTickWrapper(d,!0,1),d+=a)}return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick},d.prototype.nextTick=function(a,b){if(this.ticks[a]=this.ticks[a]||[],this.lastCurrentTick[a]=this.lastCurrentTick[a]||0,this.currentTick[a]=this.currentTick[a]||0,this.currentTick[a]>=this.ticks[a].length){var c=document.createElementNS(this.graph.ns,"line");this.groupTicks.appendChild(c),this.ticks[a].push(c),b(c)}var c=this.ticks[a][this.currentTick[a]];return this.currentTick[a]>=this.lastCurrentTick[a]&&c.setAttribute("display","visible"),this.currentTick[a]++,c},d.prototype.nextTickLabel=function(a){if(this.ticksLabels=this.ticksLabels||[],this.lastCurrentTickLabel=this.lastCurrentTickLabel||0,this.currentTickLabel=this.currentTickLabel||0,this.currentTickLabel>=this.ticksLabels.length){var b=document.createElementNS(this.graph.ns,"text");this.groupTickLabels.appendChild(b),this.ticksLabels.push(b),a(b)}var b=this.ticksLabels[this.currentTickLabel];return this.currentTickLabel>=this.lastCurrentTickLabel&&b.setAttribute("display","visible"),this.currentTickLabel++,b},d.prototype.removeUselessTicks=function(){for(var a in this.currentTick){for(var b=this.currentTick[a];b<this.ticks[a].length;b++)this.ticks[a][b].setAttribute("display","none");this.lastCurrentTick[a]=this.currentTick[a],this.currentTick[a]=0}},d.prototype.removeUselessTickLabels=function(){
for(var a=this.currentTickLabel;a<this.ticksLabels.length;a++)this.ticksLabels[a].setAttribute("display","none");this.lastCurrentTickLabel=this.currentTickLabel,this.currentTickLabel=0},d.prototype.nextGridLine=function(a,b,c,d,e){(a&&this.options.primaryGrid||!a&&this.options.secondaryGrid)&&(this.gridLinePath[a?"primary":"secondary"]+="M "+b+" "+d+" L "+c+" "+e)},d.prototype.setGridLineStyle=function(a,b){a.setAttribute("shape-rendering","crispEdges"),a.setAttribute("stroke",b?this.getPrimaryGridColor():this.getSecondaryGridColor()),a.setAttribute("stroke-width",b?this.getPrimaryGridWidth():this.getSecondaryGridWidth()),a.setAttribute("stroke-opacity",b?this.getPrimaryGridOpacity():this.getSecondaryGridOpacity());var c;(c=b?this.getPrimaryGridDasharray():this.getSecondaryGridDasharray())&&a.setAttribute("stroke-dasharray",c)},d.prototype.setGridLinesStyle=function(){return this.setGridLineStyle(this.gridPrimary,!0),this.setGridLineStyle(this.gridSecondary,!1),this},d.prototype.resetTicksLength=function(){},d.prototype.secondaryTicks=function(){return this.options.nbTicksSecondary},d.prototype.drawLogTicks=function(){var a=this.getCurrentMin(),b=this.getCurrentMax(),c=Math.min(a,b),b=Math.max(a,b);1e-50>c&&(c=1e-50),Math.log(c)-Math.log(b)>20&&(b=Math.pow(10,20*Math.log(c)));var d={fontSize:"1.0em",exponential:!0,overwrite:!1};0>c&&(c=0);for(var e,f=0==c?0:Math.floor(Math.log(c)/Math.log(10)),c=1;(e=c*Math.pow(10,f))<b;)1==c&&e>a&&this.drawTickWrapper(e,!0,1,d),10==c?(c=1,f++):(1!=c&&e>a&&this.drawTickWrapper(e,!1,2,{overwrite:"",fontSize:"0.6em"}),c++);return this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick},d.prototype.drawTickWrapper=function(a,b,c,d){this.drawTick(a,b,c,d)},d.prototype.linkToAxis=function(a,b,c){this.linkedToAxis={axis:a,scalingFunction:b,decimals:c||1}},d.prototype.drawLinkedToAxisTicksWrapper=function(a,b){var c,d,e,f,g=this.linkedToAxis,h=0,i=0;g.deltaPx||(g.deltaPx=10);do{if(c=g.scalingFunction(g.axis.getVal(h+this.getMinPx())),g.decimals&&(this.decimals=g.decimals),d=this.drawTick(c,!0,1,{},h+this.getMinPx()),!d){console.log(c,h,this.getMinPx()),console.error("Problem here");break}if(e=8*String(d[1].textContent).length,f=5*Math.round(e/5),f>g.deltaPx)return g.deltaPx=f,this.drawInit(),void this.drawLinkedToAxisTicksWrapper(a,b);i++,h+=g.deltaPx}while(a>h)},d.prototype.getPos=function(a){return this.getPx(a)},d.prototype.getPx=function(a){if(this.options.logScale){if(0>a)return;var a=(Math.log(a)-Math.log(this.getCurrentMin()))/(Math.log(this.getCurrentMax())-Math.log(this.getCurrentMin()))*(this.getMaxPx()-this.getMinPx())+this.getMinPx();return a}return(a-this.getCurrentMin())/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())+this.getMinPx()},d.prototype.getVal=function(a){return this.options.logScale?Math.exp((a-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*(Math.log(this.getCurrentMax())-Math.log(this.getCurrentMin()))+Math.log(this.getCurrentMin())):(a-this.getMinPx())/(this.getMaxPx()-this.getMinPx())*this.getCurrentInterval()+this.getCurrentMin()},d.prototype.getRelPx=function(a){return a/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())},d.prototype.getRelVal=function(a){return a/(this.getMaxPx()-this.getMinPx())*this.getCurrentInterval()},d.prototype.valueToText=function(a){if(this.scientificExponent)return a/=Math.pow(10,this.scientificExponent),a.toFixed(1);if(a=a*Math.pow(10,this.getExponentialFactor())*Math.pow(10,this.getExponentialLabelFactor()),this.options.shiftToZero&&(a-=this.dataMin),this.options.ticklabelratio&&(a*=this.options.ticklabelratio),this.options.unitModification)return a=this.modifyUnit(a,this.options.unitModification);var b=this.decimals-this.getExponentialFactor()-this.getExponentialLabelFactor();return isNaN(a)?"":b>0?a.toFixed(b):a.toFixed(0)},d.prototype.getModifiedValue=function(a){return this.options.ticklabelratio&&(a*=this.options.ticklabelratio),this.options.shiftToZero&&(a-=this.getMinValue()*(this.options.ticklabelratio||1)),a},d.prototype.modifyUnit=function(a,b){var c="",d=this.incrTick;switch(b){case"time":var e,f=this.getModifiedValue(this.getMaxValue()),g=[[60,"min"],[3600,"h"],[86400,"d"]];if(3600>f?umin=0:86400>f?umin=1:2592e3>f&&(umin=2),!g[umin])return!1;a/=g[umin][0];var h=Math.floor(a);for(c=h+g[umin][1],umin--;d<1*g[umin+1][0]&&umin>-1;)e=!1,a=(a-h)*g[umin+1][0]/g[umin][0],h=Math.round(a),c+=" "+h+g[umin][1],umin--;break;case"time:min.sec":a/=60;var h=Math.floor(a),i=Math.round(60*(a-h))+"";i=1==i.length?"0"+i:i,c=h+"."+i}return c},d.prototype.getExponentialFactor=function(){return this.options.exponentialFactor},d.prototype.setExponentialFactor=function(a){this.options.exponentialFactor=a},d.prototype.setExponentialLabelFactor=function(a){this.options.exponentialLabelFactor=a},d.prototype.getExponentialLabelFactor=function(){return this.options.exponentialLabelFactor},d.prototype.setLabel=function(a){return this.options.labelValue=a,this},d.prototype.getLabel=function(){return this.options.labelValue},d.prototype.setSpan=function(a,b){return this.options.span=[a,b],this},d.prototype.getSpan=function(){return this.options.span},d.prototype.setLevel=function(a){return this._level=a,this},d.prototype.getLevel=function(){return this._level},d.prototype.setShift=function(a){this.shift=a,this._setShift()},d.prototype.getShift=function(){return this.shift},d.prototype.setTickPosition=function(a){switch(a){case 3:case"outside":a=3;break;case 2:case"centered":a=2;break;default:case 1:case"inside":a=1}return this.options.tickPosition=a,this},d.prototype.setGrids=function(a){return this.options.primaryGrid=a,this.options.secondaryGrid=a,this},d.prototype.setPrimaryGrid=function(a){return this.options.primaryGrid=a,this},d.prototype.setSecondaryGrid=function(a){return this.options.secondaryGrid=a,this},d.prototype.primaryGridOn=function(){return this.setPrimaryGrid(!0)},d.prototype.primaryGridOff=function(){return this.setPrimaryGrid(!1)},d.prototype.secondaryGridOn=function(){return this.setSecondaryGrid(!0)},d.prototype.secondaryGridOff=function(){return this.setSecondaryGrid(!1)},d.prototype.gridsOn=function(){return this.setGrids(!0)},d.prototype.gridsOff=function(){return this.setGrids(!1)},d.prototype.turnGridsOff=d.prototype.gridsOff,d.prototype.turnGridsOn=d.prototype.gridsOn,d.prototype.setAxisColor=function(a){return this.options.axisColor=a,this},d.prototype.getAxisColor=function(a){return this.options.axisColor||"black"},d.prototype.setPrimaryTicksColor=function(a){return this.options.primaryTicksColor=a,this},d.prototype.getPrimaryTicksColor=function(a){return this.options.primaryTicksColor||"black"},d.prototype.setSecondaryTicksColor=function(a){return this.options.secondaryTicksColor=a,this},d.prototype.getSecondaryTicksColor=function(a){return this.options.secondaryTicksColor||"black"},d.prototype.setTicksLabelColor=function(a){return this.options.ticksLabelColor=a,this},d.prototype.getTicksLabelColor=function(a){return this.options.ticksLabelColor||"black"},d.prototype.setPrimaryGridColor=function(a){return this.options.primaryGridColor=a,this},d.prototype.getPrimaryGridColor=function(){return this.options.primaryGridColor},d.prototype.setSecondaryGridColor=function(a){return this.options.secondaryGridColor=a,this},d.prototype.getSecondaryGridColor=function(){return this.options.secondaryGridColor},d.prototype.setPrimaryGridWidth=function(a){return this.options.primaryGridWidth=a,this},d.prototype.getPrimaryGridWidth=function(){return this.options.primaryGridWidth},d.prototype.setSecondaryGridWidth=function(a){return this.options.secondaryGridWidth=a,this},d.prototype.getSecondaryGridWidth=function(){return this.options.secondaryGridWidth},d.prototype.setPrimaryGridOpacity=function(a){return this.options.primaryGridOpacity=a,this},d.prototype.getPrimaryGridOpacity=function(){return this.options.primaryGridOpacity},d.prototype.setSecondaryGridOpacity=function(a){return this.options.secondaryGridOpacity=a,this},d.prototype.getSecondaryGridOpacity=function(){return this.options.secondaryGridOpacity},d.prototype.setPrimaryGridDasharray=function(a){return this.options.primaryGridDasharray=a,this},d.prototype.getPrimaryGridDasharray=function(){return this.options.primaryGridDasharray},d.prototype.setSecondaryGridDasharray=function(a){return this.options.secondaryGridDasharray=a,this},d.prototype.getSecondaryGridDasharray=function(){return this.options.secondaryGridDasharray},d.prototype.setLabelColor=function(a){this.options.labelColor=a},d.prototype.getLabelColor=function(){return this.options.labelColor},d.prototype.setTickContent=function(a,b,c){if(c||(c={}),c.overwrite||!c.exponential)a.textContent=c.overwrite||this.valueToText(b);else{var d=Math.round(Math.log(b)/Math.log(10)),e=Math.floor(b*Math.pow(10,-d));a.textContent=1!=e?e+"x10":"10";var f=document.createElementNS(this.graph.ns,"tspan");f.textContent=d,f.setAttribute("font-size","0.7em"),f.setAttribute("dy",-5),a.appendChild(f)}c.fontSize&&a.setAttribute("font-size",c.fontSize)},d.prototype.isX=function(){return!1},d.prototype.isY=function(){return!1},d.prototype.setUnit=function(a){return this.options.unit=a,this},d.prototype.setUnitDecade=function(a){this.options.unitDecade=a},d.prototype.setScientific=function(a){return this.options.scientificScale=a,this},d.prototype.setScientificScaleExponent=function(a){return this.options.scientificScaleExponent=a,this},d.prototype.setEngineering=function(a){return this.options.scientificScale=a,this.options.engineeringScale=a,this},d.prototype.getEngineeringExponent=function(a){return a-=a>0?a%3:(3- -a%3)%3},d.prototype.setLogScale=function(a){return this.options.logScale=a,this},d.prototype.isZoomed=function(){return!(this.currentAxisMin==this.getMinValue()||this.currentAxisMax==this.getMaxValue())},d}(c["./jquery"],c["./dependencies/eventEmitter/EventEmitter"],c["./graph.util"]),c["./graph.axis.x"]=function(a,b){var c=function(a,b,c){this.init(a,c),this.top="top"==b};return a.extend(c.prototype,b.prototype,{getAxisPosition:function(){if(!this.options.display)return 0;var a=(1==this.options.tickPosition?8:20)+1*this.graph.options.fontSize;return this.getLabel()&&(a+=this.graph.options.fontSize),a},getAxisWidthHeight:function(){},isX:function(){return!0},isY:function(){return!1},_setShift:function(){void 0!==this.getShift()&&this.graph.getDrawingHeight()&&this.group.setAttribute("transform","translate(0 "+(this.floating?this.getShift():this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+")")},getMaxSizeTick:function(){return(this.top?-1:1)*(1==this.options.tickPosition,10)},drawTick:function(a,b,c,d,e){var f,g=this;if(f=e||this.getPos(a),void 0!=f&&!isNaN(f)){var h=this.nextTick(c,function(a){a.setAttribute("y1",(g.top?1:-1)*g.tickPx1*g.tickScaling[c]),a.setAttribute("y2",(g.top?1:-1)*g.tickPx2*g.tickScaling[c]),1==c?a.setAttribute("stroke",g.getPrimaryTicksColor()):a.setAttribute("stroke",g.getSecondaryTicksColor())});if(h.setAttribute("x1",f),h.setAttribute("x2",f),this.nextGridLine(1==c,f,f,0,this.graph.getDrawingHeight()),1==c){var i=this.nextTickLabel(function(a){a.setAttribute("y",(g.top?-1:1)*((1==g.options.tickPosition?8:20)+(g.top?10:0))),a.setAttribute("text-anchor","middle"),"black"!==g.getTicksLabelColor()&&a.setAttribute("fill",g.getTicksLabelColor()),a.style.dominantBaseline="hanging"});i.setAttribute("x",f),this.setTickContent(i,a,d)}return[h,i]}},drawSpecifics:function(){this.label.setAttribute("text-anchor","middle"),this.label.setAttribute("x",Math.abs(this.getMaxPx()-this.getMinPx())/2+this.getMinPx()),this.label.setAttribute("y",(this.top?-1:1)*((1==this.options.tickPosition?10:15)+this.graph.options.fontSize)),this.labelTspan.textContent=this.getLabel(),this.line.setAttribute("x1",this.getMinPx()),this.line.setAttribute("x2",this.getMaxPx()),this.line.setAttribute("y1",0),this.line.setAttribute("y2",0),this.line.setAttribute("stroke",this.getAxisColor()),this.top||(this.labelTspan.style.dominantBaseline="hanging",this.expTspan.style.dominantBaseline="hanging",this.expTspanExp.style.dominantBaseline="hanging",this.unitTspan.style.dominantBaseline="hanging",this.preunitTspan.style.dominantBaseline="hanging")},_draw0Line:function(a){this._0line||(this._0line=document.createElementNS(this.graph.ns,"line")),this._0line.setAttribute("x1",a),this._0line.setAttribute("x2",a),this._0line.setAttribute("y1",0),this._0line.setAttribute("y2",this.getMaxPx()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},handleMouseMoveLocal:function(a,b,c){a-=this.graph.getPaddingLeft(),this.mouseVal=this.getVal(a)},setMinMaxFlipped:function(){var a=this.maxPx-this.minPx,b=a*this.options.span[1]+this.minPx,c=a*this.options.span[0]+this.minPx;this.minPxFlipped=this.isFlipped()?b:c,this.maxPxFlipped=this.isFlipped()?c:b}}),c}(c["./jquery"],c["./graph.axis"]),c["./graph.axis.y"]=function(a){var c=function(a,b,c){this.init(a,c),this.leftright=b,this.left="left"==b};return b.extend(c.prototype,a.prototype,{getAxisPosition:function(){return this.options.display&&1==this.options.tickPosition?15:0},getAxisWidthHeight:function(){return 15},isX:function(){return!1},isY:function(){return!0},resetTicksLength:function(){this.longestTick=[!1,0]},getMaxSizeTick:function(){return(this.longestTick&&this.longestTick[0]?this.longestTick[0].getComputedTextLength():0)+10},drawTick:function(a,b,c,d,e){var f,g,h=this;this.groupTicks;if(f=e||this.getPos(a),void 0!=f&&!isNaN(f)){var i=this.nextTick(c,function(a){a.setAttribute("x1",(h.left?1:-1)*h.tickPx1*h.tickScaling[c]),a.setAttribute("x2",(h.left?1:-1)*h.tickPx2*h.tickScaling[c]),1==c?a.setAttribute("stroke",h.getPrimaryTicksColor()):a.setAttribute("stroke",h.getSecondaryTicksColor())});if(i.setAttribute("y1",f),i.setAttribute("y2",f),this.nextGridLine(1==c,0,this.graph.getDrawingWidth(),f,f),1==c){var g=this.nextTickLabel(function(a){a.setAttribute("x",h.left?-10:10),"black"!==h.getTicksLabelColor()&&a.setAttribute("fill",h.getTicksLabelColor()),h.left?a.setAttribute("text-anchor","end"):a.setAttribute("text-anchor","start"),a.style.dominantBaseline="central"});g.setAttribute("y",f),this.setTickContent(g,a,d),String(g.textContent).length>=this.longestTick[1]&&(this.longestTick[0]=g,this.longestTick[1]=String(g.textContent).length)}}},drawSpecifics:function(){this.label.setAttribute("transform","translate("+(this.left?1:-1)*(-this.widthHeightTick-10-5)+", "+(Math.abs(this.getMaxPx()-this.getMinPx())/2+Math.min(this.getMinPx(),this.getMaxPx()))+") rotate(-90)"),"black"!==this.getLabelColor()&&this.label.setAttribute("fill",this.getLabelColor()),this.labelTspan.textContent=this.getLabel(),this.left||(this.labelTspan.style.dominantBaseline="hanging",this.expTspan.style.dominantBaseline="hanging",this.expTspanExp.style.dominantBaseline="hanging",this.unitTspan.style.dominantBaseline="hanging",this.preunitTspan.style.dominantBaseline="hanging"),this.line.setAttribute("y1",this.getMinPx()),this.line.setAttribute("y2",this.getMaxPx()),this.line.setAttribute("x1",0),this.line.setAttribute("x2",0),this.line.setAttribute("stroke",this.getAxisColor())},_setShift:function(){if(this.getShift()&&this.graph.getWidth()){var a=this.floating?this.getShift():this.isLeft()?this.getShift():this.graph.getWidth()-this.graph.getPaddingRight()-this.graph.getPaddingLeft()-this.getShift();this.group.setAttribute("transform","translate( "+a+" 0 )")}},isLeft:function(){return this.left},isRight:function(){return!this.left},isFlipped:function(){return!this.options.flipped},_draw0Line:function(a){this._0line||(this._0line=document.createElementNS(this.graph.ns,"line")),this._0line.setAttribute("y1",a),this._0line.setAttribute("y2",a),this._0line.setAttribute("x1",0),this._0line.setAttribute("x2",this.graph.getDrawingWidth()),this._0line.setAttribute("stroke","black"),this.groupGrids.appendChild(this._0line)},handleMouseMoveLocal:function(a,b,c){b-=this.graph.getPaddingTop(),this.mouseVal=this.getVal(b)},scaleToFitAxis:function(a,b,c,d,e,f){a&&a.isX()||(a=this.graph.getXAxis()),isNaN(c)&&(c=a.getCurrentMin()),isNaN(d)&&(d=a.getCurrentMax()),void 0===e&&(e=!0),void 0===f&&(f=!0),"number"==typeof b&&(d=c,c=b,b=!1);for(var g=-(1/0),h=1/0,i=0,j=0,k=this.graph.series.length;k>j;j++)this.graph.series[j].isShown()&&this.graph.series[j]!=b&&this.graph.series[j].getXAxis()==a&&this.graph.series[j].getYAxis()===this&&(i++,g=f?Math.max(g,this.graph.series[j].getMax(c,d)):0,h=e?Math.min(h,this.graph.series[j].getMin(c,d)):0);if(0==i)this.setMinMaxToFitSeries();else{h=e?h:this.getCurrentMin(),g=f?g:this.getCurrentMax();var l=g-h;h-=this.options.axisDataSpacing.min*l,g+=this.options.axisDataSpacing.max*l,this._doZoomVal(h,g)}return this},setMinMaxFlipped:function(){var a=this.maxPx-this.minPx,b=this.maxPx-a*this.options.span[0],c=this.maxPx-a*this.options.span[1];this.minPxFlipped=this.isFlipped()?b:c,this.maxPxFlipped=this.isFlipped()?c:b}}),c}(c["./graph.axis"]),c["./graph.axis.broken"]=function(a){var b=function(){};return b.prototype={getNbTicksPrimary:function(){return this.options.nbTicksPrimary},getNbTicksSecondary:function(){return this.options.nbTicksSecondary},getBreakingSpacing:function(){return this.options.breakingSpacing||5},setBrokenRanges:function(a){this.ranges=[],this._broken=!0;var b=this,c=(a.length,0);a.map(function(a){c+=a[1]-a[0]}),a.map(function(a){b.ranges.push({ratio:(a[1]-a[0])/c,diff:a[1]-a[0],min:a[0],max:a[1],minPx:void 0,maxPx:void 0})}),b.totalValRanges=c},drawLinearTicksWrapper:function(){var a=this.ranges.length-1,b=this.maxPx-this.minPx-a*this.getBreakingSpacing(),c=this.getNbTicksPrimary(),d=this.getUnitPerTick(b,c,this.totalValRanges),e=this.secondaryTicks();return this.drawTicks(d,e)},setTickLabelRatio:function(a){this.options.ticklabelratio=a},drawTicks:function(a,b){var c=this,d=a[0],e=this.getMinPx(),f=(this.getMaxPx(),e),g=this.ranges.length-1,h=this.getMaxPx()-this.getMinPx()-g*this.getBreakingSpacing()*(c.isFlipped()?-1:1);return this.resetTicks(),this.ranges.map(function(g,i){g.minPx=0==i?e:f+c.getBreakingSpacing()*(c.isFlipped()?-1:1),g.maxPx=g.minPx+h*g.ratio,f=g.maxPx,i>0&&(g.brokenMin||(g.brokenMin=c.createBrokenLine(g),c.group.appendChild(g.brokenMin)),c.placeBrokenLine(g,g.brokenMin,g.minPx)),i<c.ranges.length-1&&(g.brokenMax||(g.brokenMax=c.createBrokenLine(g),c.group.appendChild(g.brokenMax)),c.placeBrokenLine(g,g.brokenMax,g.maxPx));var j,k,l,m=g.min,n=g.max;for(b&&(j=d/b),k=Math.floor(m/d)*d;n>k;){if(b)for(l=k+j;k+d>l;)m>l||l>n?l+=j:(c.drawTick(l,!1,Math.abs(l-k-d/2)<1e-4?3:2),l+=j);m>k||k>n?k+=a[0]:(c.drawTick(k,!0,4),k+=a[0])}}),this.widthHeightTick=this.getMaxSizeTick(),this.widthHeightTick},secondaryTicks:function(){return this.options.nbTicksSecondary},drawLogTicks:function(){return 0},getPx:function(a){return this.getPos(a)},getPos:function(a){for(var b=0,c=this.ranges.length;c>b;b++)if(a<=this.ranges[b].max&&a>=this.ranges[b].min)return(a-this.ranges[b].min)/this.ranges[b].diff*(this.ranges[b].maxPx-this.ranges[b].minPx)+this.ranges[b].minPx},getRelPx:function(a){return a/this.getCurrentInterval()*(this.getMaxPx()-this.getMinPx())},getRelVal:function(a){return a/(this.maxPx-this.minPx-nbIntervals*this.getBreakingSpacing())*this.totalValRanges},getVal:function(a){for(var b=0,c=this.ranges.length;c>b;b++)if(a<=this.ranges[b].maxPx&&a>=this.ranges[b].minPx)return(a-this.ranges[b].minPx)/(this.ranges[b].maxPx-this.ranges[b].minPx)*(this.ranges[b].max-this.ranges[b].min)+this.ranges[b].min},sign:function(a){return a>0?1:-1},getBoundary:function(a,b){for(var c=0,d=this.ranges.length;d>c;c++)if(a<=this.ranges[c].max&&a>=this.ranges[c].min)return b>this.ranges[c].max?this.ranges[c].max:this.ranges[c].min},getInRange:function(a,b){for(var c=0,d=this.ranges.length;d>c;c++)if(a<=this.ranges[c].max&&a>=this.ranges[c].min)return(b-this.ranges[c].min)/this.ranges[c].diff*(this.ranges[c].maxPx-this.ranges[c].minPx)+this.ranges[c].minPx},getRange:function(a){for(var b=0,c=this.ranges.length;c>b;b++)if(a<=this.ranges[b].max&&a>=this.ranges[b].min)return[b,(a-this.ranges[b].min)/this.ranges[b].diff*(this.ranges[b].maxPx-this.ranges[b].minPx)+this.ranges[b].minPx];return[void 0,void 0]}},b}(c["./jquery"]),c["./graph.axis.x.broken"]=function(a,c){var d=function(a,b,c){this.init(a,c),this.top="top"==b};return b.extend(d.prototype,a.prototype,c.prototype,{createBrokenLine:function(a){var b=document.createElementNS(this.graph.ns,"line");return b.setAttribute("x1","-3"),b.setAttribute("x2","3"),b.setAttribute("y1","-5"),b.setAttribute("y2","5"),b.setAttribute("stroke","black"),b},placeBrokenLine:function(a,b,c){b.setAttribute("transform","translate("+c+", 0)")}}),d}(c["./graph.axis.x"],c["./graph.axis.broken"]),c["./graph.axis.y.broken"]=function(a,c){var d=function(a,b,c){this.init(a,c),this.leftright=b,this.left="left"==b};return b.extend(d.prototype,a.prototype,c.prototype,{createBrokenLine:function(a){var b=document.createElementNS(this.graph.ns,"line");return b.setAttribute("x1","-5"),b.setAttribute("x2","5"),b.setAttribute("y1","-3"),b.setAttribute("y2","3"),b.setAttribute("stroke","black"),b},placeBrokenLine:function(a,b,c){b.setAttribute("transform","translate(0, "+c+")")}}),d}(c["./graph.axis.y"],c["./graph.axis.broken"]),c["./graph.axis.x.time"]=function(a,b){function c(a,b){return Math.round(a/b)*b}function d(a,b){switch(b.unit){case"s":a.setSeconds(c(a.getSeconds(),b.increment)),a.setMilliseconds(0);break;case"i":a.setMinutes(c(a.getMinutes(),b.increment)),a.setSeconds(0),a.setMilliseconds(0);break;case"h":a.setHours(c(a.getHours(),b.increment)),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);break;case"d":a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(c(a.getDate(),b.increment));break;case"m":a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1),a.setMonth(c(a.getMonth(),b.increment));break;case"y":a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1),a.setMonth(0);break;default:throw"Date format not recognized"}return a}function e(a,b){switch(b.unit){case"s":a.setSeconds(a.getSeconds()+b.increment),a.setMilliseconds(0);break;case"i":a.setMinutes(a.getMinutes()+b.increment),a.setSeconds(0),a.setMilliseconds(0);break;case"h":a.setHours(a.getHours()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);break;case"d":a.setDate(a.getDate()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0);break;case"m":a.setMonth(a.getMonth()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1);break;case"y":a.setFullYear(a.getFullYear()+b.increment),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(0),a.setDate(1),a.setMonth(0);break;default:throw"Date format not recognized"}return a}function f(a,b,c){if(a.groups[b][c])return a.groups[b][c].group.setAttribute("display","block"),a.groups[b][c];var d={group:document.createElementNS(a.graph.ns,"g"),text:document.createElementNS(a.graph.ns,"text")},e=document.createElementNS(a.graph.ns,"line");switch(e.setAttribute("stroke","black"),e.setAttribute("y1",0),b){case 2:e.setAttribute("y2",6),d.text.setAttribute("y",15),d.line=e,d.group.appendChild(d.line);break;case 1:e.setAttribute("y2",20),d.text.setAttribute("y",10),d.line1=e,d.line2=e.cloneNode(),d.group.appendChild(d.line1),d.group.appendChild(d.line2)}return d.text.setAttribute("text-anchor","middle"),d.text.setAttribute("dominant-baseline","middle"),d.group.appendChild(d.text),a.getWrapper(b).appendChild(d.group),a.groups[b][c]=d}function g(a,b,c){for(;c<a.groups[b].length;c++)h(a.groups[b][c])}function h(a){a.group.setAttribute("display","none")}function i(a,b){return l(a,b)}function j(a,b,c,d,e,f,g){switch(a){case 1:var i=Math.max(d,Math.min(e,f)),j=Math.max(d,Math.min(e,g));if(isNaN(j)||isNaN(i))return;for(b.line1.setAttribute("x1",i),b.line2.setAttribute("x1",j),b.line1.setAttribute("x2",i),b.line2.setAttribute("x2",j),b.text.setAttribute("x",(i+j)/2);8*c.length>j-i;)if(c=c.substr(0,c.length-2)+".",1==c.length){c="";break}b.text.textContent=c;break;case 2:if(d>f||f>e)return void h(b);b.line.setAttribute("x1",f),b.line.setAttribute("x2",f),b.text.setAttribute("x",f),b.text.textContent=c}}var k=function(a,b,c){this.wrapper={1:document.createElementNS(a.ns,"g"),2:document.createElementNS(a.ns,"g")},this.groups={1:[],2:[]};var d=document.createElementNS(a.ns,"rect");d.setAttribute("fill","#c0c0c0"),d.setAttribute("stroke","#808080"),d.setAttribute("height","20"),d.setAttribute("x","0"),d.setAttribute("y","0"),this.rect=d,this.wrapper[1].appendChild(this.rect),this.init(a,c),this.group.appendChild(this.wrapper[1]),this.group.appendChild(this.wrapper[2]),this.wrapper[1].setAttribute("transform","translate( 0, 25 )"),this.wrapper[2].setAttribute("transform","translate( 0, 00 )")},l=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[WLloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,c=/[^-+\dA-Z]/g,d=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a},e=function(a,b){var c=new Date(a[b+"FullYear"](),0,1);return Math.ceil(((a-c)/864e5+c[b+"Day"]()+1)/7)};return function(f,g,h){var i=l;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(f)||/\d/.test(f)||(g=f,f=void 0),f=f?new Date(f):new Date,isNaN(f))throw SyntaxError("invalid date:"+f);g=String(i.masks[g]||g||i.masks.default),"UTC:"==g.slice(0,4)&&(g=g.slice(4),h=!0);var j=h?"getUTC":"get",k=f[j+"Date"](),m=f[j+"Day"](),n=f[j+"Month"](),o=f[j+"FullYear"](),p=f[j+"Hours"](),q=f[j+"Minutes"](),r=f[j+"Seconds"](),s=f[j+"Milliseconds"](),t=h?0:f.getTimezoneOffset(),u={d:k,dd:d(k),ddd:i.i18n.dayNames[m],dddd:i.i18n.dayNames[m+7],m:n+1,mm:d(n+1),mmm:i.i18n.monthNames[n],mmmm:i.i18n.monthNames[n+12],yy:String(o).slice(2),yyyy:o,h:p%12||12,hh:d(p%12||12),H:p,HH:d(p),M:q,MM:d(q),s:r,ss:d(r),l:d(s,3),L:d(s>99?Math.round(s/10):s),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:h?"UTC":(String(f).match(b)||[""]).pop().replace(c,""),o:(t>0?"-":"+")+d(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4),S:["th","st","nd","rd"][k%10>3?0:(k%100-k%10!=10)*k%10],W:e(f,j)};return g.replace(a,function(a){return a in u?u[a]:a.slice(1,a.length-1)})}}();return l.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},l.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},k.prototype=new a,k.prototype.draw=function(){this.drawInit(),this.cacheCurrentMax(),this.cacheCurrentMin(),void 0!=this.currentAxisMin&&void 0!=this.currentAxisMax||this.setMinMaxToFitSeries(!0),this.line.setAttribute("x1",this.getMinPx()),this.line.setAttribute("x2",this.getMaxPx()),this.line.setAttribute("y1",0),this.line.setAttribute("y2",0);var a=this.maxPx-this.minPx,c=this.getCurrentInterval(),h=c/a,k=this.getCurrentMax(),l=this.getCurrentMin();if(this.rect.setAttribute("width",a),this.rect.setAttribute("x",this.minPx),!k||!l)return 0;var m,n=[{threshold:40,increments:{1:{increment:1,unit:"i",format:'HH"h"MM (dd/mm/yy)'},2:{increment:1,unit:"s",format:'MM:ss"s"'}}},{threshold:150,increments:{1:{increment:1,unit:"i",format:'HH"h"MM (dd/mm/yy)'},2:{increment:5,unit:"s",format:'MM:ss"s"'}}},{threshold:600,increments:{1:{increment:10,unit:"i",format:'HH"h"MM (dd/mm/yy)'},2:{increment:30,unit:"s",format:'MM:ss"s"'}}},{threshold:1e3,increments:{1:{increment:1,unit:"h",format:'HH"h"MM (dd/mm/yy)'},2:{increment:10,unit:"i",format:'MM"min"'}}},{threshold:1500,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:1,unit:"i",format:'H"h"MM'}}},{threshold:4e3,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:2,unit:"i",format:'H"h"MM'}}},{threshold:8e3,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:10,unit:"i",format:'H"h"MM'}}},{threshold:26400,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:20,unit:"i",format:'H"h"MM'}}},{threshold:86400,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:1,unit:"h",format:'H"h"MM'}}},{threshold:2e5,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:2,unit:"h",format:'H"h"MM'}}},{threshold:4e5,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:6,unit:"h",format:'H"h"MM'}}},{threshold:14e5,increments:{1:{increment:1,unit:"d",format:"dd/mm/yyyy"},2:{increment:12,unit:"h",format:'HH"h"MM'}}},{threshold:64e5,increments:{1:{increment:1,unit:"m",format:"mmmm yyyy"},2:{increment:1,unit:"d",format:"dd"}}},{threshold:124e5,increments:{1:{increment:1,unit:"m",format:"mmmm yyyy"},2:{increment:2,unit:"d",format:"dd"}}},{threshold:432e5,increments:{1:{increment:1,unit:"m",format:"mmmm yyyy"},2:{increment:7,unit:"d",format:"dd"}}},{threshold:6912e4,increments:{1:{increment:1,unit:"m",format:"mmmm yyyy"},2:{increment:15,unit:"d",format:"dd"}}},{threshold:864e5,increments:{1:{increment:1,unit:"y",format:"yyyy"},2:{increment:3,unit:"m",format:"mm/yyyy"}}},{threshold:1728e5,increments:{1:{increment:1,unit:"m",format:"mm"},2:{increment:4,unit:"m",format:"yyyy"}}},{threshold:864e6,increments:{1:{increment:1,unit:"m",format:"mm"},2:{increment:6,unit:"m",format:"yyyy"}}},{threshold:10368e5,increments:{1:{increment:1,unit:"m",format:"mmmm"},2:{increment:1,unit:"y",format:"yyyy"}}}];for(u=0;u<n.length;u++)if(n[u].threshold>h){m=n[u];break}m||(m=n[n.length-1]);var o,p,q,r,s,t,u,v=0;for(v=1;2>=v;v++){if(!b.isNumeric(l)){g(this,v,0);break}q=new Date(l),r=d(q,m.increments[v]),u=0;do if(s=i(r,m.increments[v].format),t=f(this,v,u),o=this.getPx(r.getTime()),r=e(r,m.increments[v]),p=this.getPx(r.getTime()),j(v,t,s,this.getMinPx(),this.getMaxPx(),o,p),u++,u>100)break;while(r.getTime()<k);g(this,v,u)}},k.prototype.isX=function(){return!0},k.prototype.getWrapper=function(a){return this.wrapper[a]},k.prototype.setShift=function(a,b){this.shift=a,this.group.setAttribute("transform","translate(0 "+(this.top?this.shift:this.graph.getDrawingHeight()-this.shift)+")")},k.prototype.getAxisPosition=function(){return 60},k}(c["./graph.axis"],c["./graph.util"]),c["./graph.legend"]=function(a){var c={backgroundColor:"rgba(255, 255, 255, 0.8)",frame:!0,frameWidth:1,frameColor:"black",paddingTop:10,paddingLeft:10,paddingBottom:10,paddingRight:10,frameRounding:3,movable:!1,shapesToggleable:!0,isSerieHideable:!0,isSerieSelectable:!0},d=function(a,d){this.options=b.extend({},c,d),this.graph=a,this.svg=document.createElementNS(this.graph.ns,"g"),this.subG=document.createElementNS(this.graph.ns,"g"),this.groups=[],this.rect=document.createElementNS(this.graph.ns,"rect"),this.rectBottom=document.createElementNS(this.graph.ns,"rect"),this.rect.setAttribute("x",0),this.rect.setAttribute("y",0),this.rectBottom.setAttribute("x",0),this.rectBottom.setAttribute("y",0),this.series=!1,this.svg.appendChild(this.subG),this.svg.setAttribute("display","none"),this.pos={x:void 0,y:void 0,transformX:0,transformY:0},this.setEvents(),this.applyStyle()};return d.prototype={setPosition:function(a,b,c){a&&(this.position=a,this.alignToX=b,this.alignToY=c)},setDraggable:function(a){this.options.movable=a},setAutoPosition:function(a){return["bottom","left","top","right"].indexOf(a=a.toLowerCase())>-1?(this.autoPosition=a,this):void(this.autoPosition=!1)},calculatePosition:function(){this.autoPosition?this.graph.getDom().appendChild(this.getDom()):this.graph.graphingZone.appendChild(this.getDom());for(var b=this.series||this.graph.getSeries(),c=0,d=this.options.paddingTop,e=0,f=b.length;f>e;e++)if(b[e].isInLegend()||this.series){
if("bottom"==this.autoPosition||"top"==this.autoPosition){var g=this.groups[e].getBBox();c+g.width>this.graph.getDrawingWidth()-this.options.paddingRight&&(d+=16,c=0)}this.groups[e].setAttribute("transform","translate( "+c+", "+d+")"),"bottom"==this.autoPosition||"top"==this.autoPosition?(c+=g.width+10,d+=0):(c=0,d+=16)}var g=this.subG.getBBox();switch(this.width=g.width+this.options.paddingRight+this.options.paddingLeft,this.height=g.height+this.options.paddingBottom+this.options.paddingTop,this.rect.setAttribute("width",this.width),this.rect.setAttribute("height",this.height),this.rect.setAttribute("fill","none"),this.rect.setAttribute("pointer-events","fill"),this.rect.setAttribute("display","none"),this.options.movable&&(this.rectBottom.style.cursor="move"),this.rectBottom.setAttribute("width",this.width),this.rectBottom.setAttribute("height",this.height),this.rectBottom.setAttribute("x",g.x-this.options.paddingTop),this.rectBottom.setAttribute("y",g.y-this.options.paddingLeft),this.position=this.position||{},this.autoPosition){case"bottom":this.position.y=this.graph.getHeight()+"px",this.position.x=(this.graph.getWidth()-this.width)/2+"px",this.alignToY="bottom",this.alignToX=!1;break;case"left":this.position.x="6px",this.position.y=(this.graph.getHeight()-this.height)/2+"px",this.alignToX="left",this.alignToY=!1;break;case"right":this.position.x=this.graph.getWidth()+"px",this.position.y=(this.graph.getHeight()-this.height)/2+"px",this.alignToX="right",this.alignToY=!1;break;case"top":this.position.x=(this.graph.getWidth()-this.width)/2+"px",this.position.y="10px",this.alignToY="top",this.alignToX=!1}var h=new a(this.position),i=this.alignToY,j=this.alignToX;if(h=h.compute(this.graph,this.graph.getXAxis(),this.graph.getYAxis()),h&&("right"==j&&(h.x-=this.width),"bottom"==i&&(h.y-=this.height),this.pos.transformX=h.x,this.pos.transformY=h.y,this._setPosition(),this.autoPosition)){switch(this.autoPosition){case"bottom":this.graph.options.paddingBottom=this.height+10;break;case"left":this.graph.options.paddingLeft=this.width+5;break;case"right":this.graph.options.paddingRight=this.width+10;break;case"top":this.graph.options.paddingTop=this.height+14}this.graph.updateGraphingZone()}},update:function(){var a=this;for(this.applyStyle();this.subG.hasChildNodes();)this.subG.removeChild(this.subG.lastChild);this.svg.insertBefore(this.rectBottom,this.svg.firstChild);var b=this.series||this.graph.getSeries();if(b.length>0){if(this.svg.setAttribute("display","block"),"bottom"==this.autoPosition||"top"==this.autoPosition){this.graph.getDrawingWidth()}for(var c=0,d=b.length;d>c;c++)(b[c].isInLegend()||this.series)&&function(d){var e,f,g;if("bottom"==this.autoPosition||"top"==this.autoPosition){this.graph.getDrawingWidth()}e=document.createElementNS(a.graph.ns,"g"),a.subG.appendChild(e);var f=b[d].getSymbolForLegend(),h=b[d].getMarkerForLegend(),g=b[d].getTextForLegend();e.appendChild(f),"scatter"==b[c].getType()&&f.setAttribute("transform","translate( 20, 0 )"),h&&e.appendChild(h),e.appendChild(g),a.groups[d]=e,e.addEventListener("click",function(c){var e=b[d];e.isShown()&&a.isHideable()?a.isSelectable()&&!e.isSelected()?a.graph.selectSerie(e):(e.hide(a.isToggleShapes()),e.unselect()):!e.isShown()&&a.isHideable()?e.show():a.isSelectable()&&(e.isSelected()?a.graph.unselectSerie(e):a.graph.selectSerie(e))})}.call(this,c);this.svg.appendChild(this.rect),this.calculatePosition()}},isHideable:function(){return this.options.isSerieHideable},isSelectable:function(){return this.options.isSerieSelectable},isToggleShapes:function(){return this.options.shapesToggleable},getDom:function(){return this.svg},setEvents:function(){var a=this,b=this.pos,c=function(c){a.options.movable&&(b.x=c.clientX,b.y=c.clientY,c.stopPropagation(),c.preventDefault(),a.mousedown=!0,a.graph.elementMoving(a),a.rect.setAttribute("display","block"))},d=function(b){a.handleMouseMove(b)};this.rectBottom.addEventListener("mousedown",c),this.rectBottom.addEventListener("mousemove",d),this.rect.addEventListener("mousemove",d)},handleMouseUp:function(a){a.stopPropagation(),a.preventDefault(),this.mousedown=!1,this.rect.setAttribute("display","none"),this.graph.elementMoving(!1)},handleMouseMove:function(a){if(this.mousedown){var b=this.pos,c=a.clientX-b.x,d=a.clientY-b.y;b.transformX+=c,b.transformY+=d,b.x=a.clientX,b.y=a.clientY,a.stopPropagation(),a.preventDefault(),this._setPosition()}},_setPosition:function(){var a=this.pos;isNaN(a.transformX)||isNaN(a.transformY)||a.transformX===!1||a.transformY===!1||this.svg.setAttribute("transform","translate("+a.transformX+", "+a.transformY+")")},applyStyle:function(){this.options.frame&&(this.rectBottom.setAttribute("stroke",this.options.frameColor),this.rectBottom.setAttribute("stroke-width",this.options.frameWidth+"px"),this.rectBottom.setAttribute("rx",this.options.frameRounding),this.rectBottom.setAttribute("ry",this.options.frameRounding)),this.rectBottom.setAttribute("fill",this.options.backgroundColor)},fixSeries:function(){var a=[];if(arguments[0]===!1)return this.series=!1,void this.update();for(var b=0,c=arguments.length;c>b;b++)Array.isArray(arguments[b])?a=a.concat(arguments[b]):a.push(arguments[b]);this.update(),this.series=a},fixSeriesAdd:function(a){this.series=this.series||[],this.series.push(a)}},d}(c["./graph.position"]),c["./plugins/graph.plugin"]=function(a){var b=function(){};return b.prototype=new a,b.prototype.init=function(){},b.prototype.onMouseDown=function(){},b.prototype.onMouseUp=function(){},b.prototype.onMouseMove=function(){},b}(c["./dependencies/eventEmitter/EventEmitter"]),c["./plugins/graph.plugin.drag"]=function(b){var c=function(){};return c.prototype=new b,c.prototype.defaults={dragX:!0,dragY:!0,persistanceX:!1,persistanceY:!1},c.prototype.init=function(a){this.graph=a,this.time=null,this.totaltime=2e3},c.prototype.onMouseDown=function(a,b,c,d,e){return this._draggingX=b,this._draggingY=c,this._lastDraggingX=this._draggingX,this._lastDraggingY=this._draggingY,this.stopAnimation=!0,this.moved=!1,!0},c.prototype.onMouseMove=function(a,b,c,d,e){var f=b-this._draggingX,g=c-this._draggingY;this.options.dragX&&a._applyToAxes(function(a){a.setCurrentMin(a.getVal(a.getMinPx()-f)),a.setCurrentMax(a.getVal(a.getMaxPx()-f))},!1,!0,!1),this.options.dragY&&a._applyToAxes(function(a){a.setCurrentMin(a.getVal(a.getMinPx()-g)),a.setCurrentMax(a.getVal(a.getMaxPx()-g))},!1,!1,!0),this._lastDraggingX=this._draggingX,this._lastDraggingY=this._draggingY,this._draggingX=b,this._draggingY=c,this.moved=!0,this.time=Date.now(),this.emit("dragging"),a.draw(!0)},c.prototype.onMouseUp=function(a,b,c,d,e){var f=Date.now()-this.time;return b==this._lastDraggingX||c==this._lastDraggingY?void(this.moved&&this.emit("dragged")):(this.speedX=(b-this._lastDraggingX)/f,this.speedY=(c-this._lastDraggingY)/f,isNaN(this.speedX)||isNaN(this.speedY)?void this.emit("dragged"):(a._applyToAxes(function(a){a._pluginDragMin=a.getCurrentMin(),a._pluginDragMax=a.getCurrentMax()},!1,!0,!0),this.stopAnimation=!1,this.accelerationX=-this.speedX/this.totaltime,this.accelerationY=-this.speedY/this.totaltime,void(this.options.persistanceX||this.options.persistanceY?this._persistanceMove(a):this.emit("dragged"))))},c.prototype._persistanceMove=function(b){var c=this;return c.stopAnimation?void c.emit("dragged"):void a.requestAnimationFrame(function(){var a=Date.now()-c.time,d=(.5*c.accelerationX*a+c.speedX)*a,e=(.5*c.accelerationY*a+c.speedY)*a;c.options.persistanceX&&b._applyToAxes(function(a){a.setCurrentMin(-a.getRelVal(d)+a._pluginDragMin),a.setCurrentMax(-a.getRelVal(d)+a._pluginDragMax),a.cacheCurrentMin(),a.cacheCurrentMax(),a.cacheInterval()},!1,!0,!1),c.options.persistanceY&&b._applyToAxes(function(a){a.setCurrentMin(-a.getRelVal(e)+a._pluginDragMin),a.setCurrentMax(-a.getRelVal(e)+a._pluginDragMax),a.cacheCurrentMin(),a.cacheCurrentMax(),a.cacheInterval()},!1,!1,!0),b.draw(),a<c.totaltime?(c.emit("dragging"),c._persistanceMove(b)):c.emit("dragged")})},c}(c["./plugins/graph.plugin"]),c["./plugins/graph.plugin.shape"]=function(a,b,c){var d=function(){};return d.prototype=new b,d.prototype.init=function(a,b){this.graph=a,this.shapeType=b.type},d.prototype.setShape=function(a){this.shapeInfo.shapeType=a},d.prototype.onMouseDown=function(a,b,d,e,f){if(this.shapeType||this.options.url){var g,h,i=this;this.count=this.count||0,b-=a.getPaddingLeft(),d-=a.getPaddingTop(),g=a.getXAxis().getVal(b),h=a.getYAxis().getVal(d);var j={position:[{x:g,y:h},{x:g,y:h}],onChange:function(b){a.triggerEvent("onAnnotationChange",b)},locked:!1,selectable:!0,resizable:!0,movable:!0};if(c.extend(!0,j,this.options),this.emit("beforeNewShape",j),!this.graph.prevent(!1)){var k=a.newShape(j.type,j);k&&(i.currentShape=k,i.currentShapeEvent=e),a.once("mouseUp",function(){i.emit("newShape",k)})}}},d.prototype.onMouseMove=function(a,b,c,d){var e=this;if(e.currentShape){e.count++;var f=e.currentShape;e.currentShape=!1,a.selectedSerie&&f.setSerie(a.selectedSerie),f.resizing=!0,f.options&&f.options.onCreate&&f.options.onCreate.call(f),f.draw(),a.selectShape(f),f.handleMouseDown(e.currentShapeEvent,!0),f.handleSelected=1,f.handleMouseMove(d,!0)}},d.prototype.onMouseUp=function(){var a=this;a.currentShape&&(a.currentShape=!1)},d}(c["./jquery"],c["./plugins/graph.plugin"],c["./graph.util"]),c["./plugins/graph.plugin.selectScatter"]=function(a,b){var c=function(){};return c.prototype=new a,c.prototype.init=function(a,c){this._path=document.createElementNS(a.ns,"path"),b.setAttributeTo(this._path,{display:"none",fill:"rgba(0,0,0,0.1)",stroke:"rgba(0,0,0,1)","shape-rendering":"crispEdges",x:0,y:0,height:0,width:0,d:""}),this.graph=a,a.dom.appendChild(this._path)},c.prototype.setSerie=function(a){this.serie=a},c.prototype.onMouseDown=function(a,b,c,d,e){this.serie&&(this.path="M "+b+" "+c+" ",this.currentX=b,this.currentY=c,this.xs=[this.serie.getXAxis().getVal(b-a.getPaddingLeft())],this.ys=[this.serie.getYAxis().getVal(c-a.getPaddingTop())],this._path.setAttribute("d",""),this._path.setAttribute("display","block"))},c.prototype.onMouseMove=function(a,b,c,d,e){Math.pow(b-this.currentX,2)+Math.pow(c-this.currentY,2)>25&&(this.path+=" L "+b+" "+c+" ",this.currentX=b,this.currentY=c,this.xs.push(this.serie.getXAxis().getVal(b-a.getPaddingLeft())),this.ys.push(this.serie.getYAxis().getVal(c-a.getPaddingTop())),this._path.setAttribute("d",this.path+" z"),this.findPoints())},c.prototype.findPoints=function(){for(var a,b=this.serie.data,c=[],d=0,e=0,f=b.length;f>e;e+=2){d=0;for(var g=0,h=this.xs.length;h>g;g+=1)a=g==h-1?0:g+1,(this.ys[g]<b[e+1]&&this.ys[a]>b[e+1]||this.ys[g]>b[e+1]&&this.ys[a]<b[e+1])&&b[e]>(b[e+1]-this.ys[g])/(this.ys[a]-this.ys[g])*(this.xs[a]-this.xs[g])+this.xs[g]&&d++;d%2==1?(c.push(e/2),this.serie.selectPoint(e/2,!0,"selected")):this.serie.unselectPoint(e/2)}this.selected=c,this.emit("selectionProcess",c)},c.prototype.onMouseUp=function(a,b,c,d){this._path.setAttribute("display","none"),this.emit("selectionEnd",this.selected)},c}(c["./plugins/graph.plugin"],c["./graph.util"]),c["./plugins/graph.plugin.zoom"]=function(b,c,d){var e=function(){};return e.prototype=new d,e.prototype.init=function(a,b){this._zoomingGroup=document.createElementNS(a.ns,"g"),this._zoomingSquare=document.createElementNS(a.ns,"rect"),this._zoomingSquare.setAttribute("display","none"),c.setAttributeTo(this._zoomingSquare,{display:"none",fill:"rgba(171,12,12,0.2)",stroke:"rgba(171,12,12,1)","shape-rendering":"crispEdges",x:0,y:0,height:0,width:0}),this.graph=a,a.groupEvent.appendChild(this._zoomingGroup),this._zoomingGroup.appendChild(this._zoomingSquare)},e.prototype.onMouseDown=function(a,b,c,d,e){var f=this.options.zoomMode;if(f){switch(this._zoomingMode=f,void 0===b&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="y",b=0),void 0===c&&(this._backedUpZoomMode=this._zoomingMode,this._zoomingMode="x",c=0),this._zoomingXStart=b,this._zoomingYStart=c,this.x1=b-a.getPaddingLeft(),this.y1=c-a.getPaddingTop(),this._zoomingSquare.setAttribute("width",0),this._zoomingSquare.setAttribute("height",0),this._zoomingSquare.setAttribute("display","block"),this._zoomingMode){case"x":this._zoomingSquare.setAttribute("y",a.options.paddingTop),this._zoomingSquare.setAttribute("height",a.getDrawingHeight()-a.shift.bottom);break;case"y":this._zoomingSquare.setAttribute("x",a.options.paddingLeft),this._zoomingSquare.setAttribute("width",a.getDrawingWidth());break;case"forceY2":this.y2=a.getYAxis().getPx(this.options.forcedY)+a.options.paddingTop}this.options.onZoomStart&&!e&&this.options.onZoomStart(a,b,c,d,e)}},e.prototype.onMouseMove=function(a,b,c,d,e){switch(this._zoomingMode){case"xy":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,c)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-c));break;case"forceY2":this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,this.y2)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-this.y2)),this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b));break;case"x":this._zoomingSquare.setAttribute("x",Math.min(this._zoomingXStart,b)),this._zoomingSquare.setAttribute("width",Math.abs(this._zoomingXStart-b));break;case"y":this._zoomingSquare.setAttribute("y",Math.min(this._zoomingYStart,c)),this._zoomingSquare.setAttribute("height",Math.abs(this._zoomingYStart-c))}this.options.onZoomMove&&!e&&this.options.onZoomMove(a,b,c,d,e)},e.prototype.onMouseUp=function(a,b,c,d,e){var f=this;this.removeZone();var g=b-a.options.paddingLeft,h=c-a.options.paddingTop;if(!(b-this._zoomingXStart==0&&"y"!=this._zoomingMode||c-this._zoomingYStart==0&&"x"!=this._zoomingMode))if(a.cancelClick=!0,this.options.transition){var i=!1,j=!1;"x"!=this._zoomingMode&&"xy"!=this._zoomingMode&&"forceY2"!=this._zoomingMode||(this.fullX=!1,a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=Math.min(a.getVal(g),a.getVal(f.x1)),a._pluginZoomMaxFinal=Math.max(a.getVal(g),a.getVal(f.x1)),console.log(a._pluginZoomMin,a._pluginZoomMinFinal)},!1,!0,!1),i=!0),"y"!=this._zoomingMode&&"xy"!=this._zoomingMode||(this.fullY=!1,a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=Math.min(a.getVal(h),a.getVal(f.y1)),a._pluginZoomMaxFinal=Math.max(a.getVal(h),a.getVal(f.y1))},!1,!1,!0),j=!0),"forceY2"==this._zoomingMode&&(this.fullY=!1,a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=Math.min(a.getVal(f.y2),a.getVal(f.y1)),a._pluginZoomMaxFinal=Math.max(a.getVal(f.y2),a.getVal(f.y1))},!1,!1,!0),j=!0),this.transition(i,j,"zoomEnd")}else{switch(this._zoomingMode){case"x":this.fullX=!1,a._applyToAxes("_doZoom",[g,this.x1],!0,!1);break;case"y":this.fullY=!1,a._applyToAxes("_doZoom",[h,this.y1],!1,!0);break;case"xy":this.fullX=!1,this.fullY=!1,a._applyToAxes("_doZoom",[g,this.x1],!0,!1),a._applyToAxes("_doZoom",[h,this.y1],!1,!0);break;case"forceY2":this.fullX=!1,this.fullY=!1,a._applyToAxes("_doZoom",[g,this.x1],!0,!1),a._applyToAxes("_doZoom",[this.y1,this.y2],!1,!0)}a.prevent(!0),a.draw(),this._backedUpZoomMode&&(this._zoomingMode=this._backedUpZoomMode),this.emit("zoomed")}},e.prototype.removeZone=function(){this._zoomingSquare.setAttribute("display","none")},e.prototype.onMouseWheel=function(a,b,c){c||(c={}),c.baseline||(c.baseline=0);var d;if(!(d=this.graph.getSelectedSerie())||!d.getYAxis().handleMouseWheel(a,b)){var e="x"==c.direction,f=!("y"!==c.direction);this.graph._applyToAxes("handleMouseWheel",[a,b,c.baseline],e,f),this.graph.drawSeries()}},e.prototype.onDblClick=function(a,b,c,d,e,f){if(this.emit("beforeDblClick",{graph:a,x:b,y:c,pref:d,e:e,mute:f}),!a.prevent(!1)){if(this.options.transition){var g=!1,h=!1;"xtotal"!=d.mode&&"total"!=d.mode||(a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=a.getMinValue(),a._pluginZoomMaxFinal=a.getMaxValue()},!1,!0,!1),g=!0),"ytotal"!=d.mode&&"total"!=d.mode||(a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=a.getMinValue(),a._pluginZoomMaxFinal=a.getMaxValue()},!1,!1,!0),h=!0),"gradualX"!=d.mode&&"gradual"!=d.mode||(a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=a.getCurrentMin()-(a.getCurrentMax()-a.getCurrentMin()),a._pluginZoomMaxFinal=a.getCurrentMax()+(a.getCurrentMax()-a.getCurrentMin())},!1,!0,!1),g=!0),"gradualY"!=d.mode&&"gradual"!=d.mode||(a._applyToAxes(function(a){a._pluginZoomMin=a.getCurrentMin(),a._pluginZoomMax=a.getCurrentMax(),a._pluginZoomMinFinal=a.getCurrentMin()-(a.getCurrentMax()-a.getCurrentMin()),a._pluginZoomMaxFinal=a.getCurrentMax()+(a.getCurrentMax()-a.getCurrentMin())},!1,!0,!1),h=!0),this.transition(g,h,"dblClick")}var i=this.graph.getXAxis(),j=this.graph.getYAxis();if("xtotal"==d.mode)this.graph._applyToAxes("setMinMaxToFitSeries",null,!0,!1),this.fullX=!0,this.fullY=!1;else if("ytotal"==d.mode)this.graph._applyToAxes("setMinMaxToFitSeries",null,!1,!0),this.fullX=!1,this.fullY=!0;else if("total"==d.mode)this.graph.autoscaleAxes(),this.fullX=!0,this.fullY=!0;else{b-=this.graph.options.paddingLeft,c-=this.graph.options.paddingTop;var k=i.getCurrentMin(),l=i.getCurrentMax(),m=i.getVal(b),n=l-k,o=j.getCurrentMin(),p=j.getCurrentMax(),q=j.getVal(c),r=p-o;if("gradualXY"==d.mode||"gradualX"==d.mode){var s=(m-k)/(l-k);k=Math.max(i.getMinValue(),k-n*s),l=Math.min(i.getMaxValue(),l+n*(1-s)),i.setCurrentMin(k),i.setCurrentMax(l),i.options.onZoom&&i.options.onZoom(k,l),i.cacheCurrentMin(),i.cacheCurrentMax(),i.cacheInterval()}if("gradualXY"==d.mode||"gradualY"==d.mode){var s=(q-o)/(p-o);o=Math.max(j.getMinValue(),o-r*s),p=Math.min(j.getMaxValue(),p+r*(1-s)),j.setCurrentMin(o),j.setCurrentMax(p),j.options.onZoom&&j.options.onZoom(o,p),j.cacheCurrentMin(),j.cacheCurrentMax(),j.cacheInterval()}}this.graph.draw()}},e.prototype.transition=function(b,c,d){var e=this;e.gradualUnzoomStart||(e.gradualUnzoomStart=Date.now()),a.requestAnimationFrame(function(){var a=Date.now()-e.gradualUnzoomStart,f=Math.sin(a/500*Math.PI/2);e.graph._applyToAxes(function(a){a.setCurrentMin(a._pluginZoomMin+(a._pluginZoomMinFinal-a._pluginZoomMin)*f),a.setCurrentMax(a._pluginZoomMax+(a._pluginZoomMaxFinal-a._pluginZoomMax)*f),a.cacheCurrentMin(),a.cacheCurrentMax(),a.cacheInterval()},!1,b,c),e.graph.draw(),500>a?(e.transition(b,c,d),e.emit("zooming")):(e.emit("zoomed"),d&&e.emit(d),e.gradualUnzoomStart=0)})},e.prototype.isFullX=function(){return this.fullX},e.prototype.isFullY=function(){return this.fullY},e}(c["./jquery"],c["./graph.util"],c["./plugins/graph.plugin"],c["./plugins/ "]),c["./graph.lru"]=function(){function a(a,b){b=b||50,d[a]||(d[a]={},f[a]=0),g[a]=b}function b(a,b){var c,f;return d[a]&&d[a][b]?(f=e[a],c=d[a][b],c.prev=f,c.next=f.next,f.next.prev=c,f.next=c,e[a]=c,c.data):void 0}function c(a,c,h){var i,j,k;return d[a]&&void 0!==f[a]&&g[a]?(k=e[a],d[a][c]?(b(a,c),d[a][c].data.data=h,d[a][c].data.timeout=Date.now()):(i={data:{data:h,timeout:Date.now()}},"undefined"==typeof k?(i.prev=i,i.next=i):(i.prev=k.prev,i.next=k.next,k.next.prev=i,k.next=i),e[a]=i,d[a][c]=i,f[a]++),f[a]>g[a]&&k&&(j=k.next,k.next.next.prev=k,k.next=k.next.next,j.next.next=void 0,j.next.prev=void 0,f[a]--),h):void 0}var d={},e={},f={},g={};return{create:function(b,c){a(b,c)},get:function(a,c){var d;return void 0!=(d=b(a,c))?d:void 0},store:function(a,b,d){return c(a,b,d),d},empty:function(a){emptyMemory(a)},exists:function(a){return d[a]}}}(),c["./plugins/graph.plugin.timeseriemanager"]=function(a,b,c){var d=function(){var a=this;this.series=[],this.plugins=[],this.currentSlots={},this.requestLevels={},this.update=function(b,c){a.series.forEach(function(c){a.updateSerie(c,b)}),b||a.recalculateSeries(c)}};return d.prototype=new c,d.prototype.defaults={LRUName:"PluginTimeSerieManager",intervals:[1e3,15e3,6e4,9e5,36e5,864e4],maxParallelRequests:3,optimalPxPerPoint:2,nbPoints:1e3,url:""},d.prototype.init=function(a,c){this.graph=a,b.create(this.options.LRUName,200),this.requestsRunning=0},d.prototype.setURL=function(a){return this.options.url=a,this},d.prototype.setAvailableIntervals=function(){this.options.intervals=arguments},d.prototype.newSerie=function(a,b,c,d,e){var f=this.graph.newSerie(a,b,c);return this.currentSlots[a]={min:0,max:0,interval:0},f.setInfo("timeSerieManagerDBElements",d),e||(f._zoneSerie=this.graph.newSerie(a+"_zone",{},"zone")),this.series.push(f),f},d.prototype.registerPlugin=function(a,b){var c;if((c=this.plugins.indexOf(a))>-1)for(var d=1;d<arguments.length;d++)a.removeListener(arguments[d],this.update);for(var d=1;d<arguments.length;d++)a.on(arguments[d],this.update)},d.prototype.updateSerie=function(a,b){for(var c,d=this,e=a.getXAxis().getCurrentMin(),f=a.getXAxis().getCurrentMax(),g=this.getOptimalInterval(f-e),h=this.options.intervals.indexOf(g),i=h-1;h+1>=i;i++){c=this.options.intervals[i];var j=d.computeSlotID(e,c),k=d.computeSlotID(f,c),l=[[2,5,6],[1,2,4],[0,1,3]];l.forEach(function(e){for(var f=j-e[0]*(k-j),h=k+e[0]*(k-j),i=f;h>=i&&!(d.computeTimeMin(i,c)>Date.now());)d.register(a,i,c,c==g?e[1]:e[2],!0,b),i++})}this.processRequests()},d.prototype.register=function(a,c,d,e,f,g){var h=this.computeUniqueID(a,c,d),i=b.get(this.options.LRUName,h);(!i||this.computeTimeMax(c,d)>Date.now()&&i.timeout<Date.now()-(g?5e3:1e5)&&1==e)&&this.request(a,c,d,e,h,f)},d.prototype.request=function(a,b,c,d,e,f){for(var g in this.requestLevels)g!=d&&this.requestLevels[g][e]&&(1!==this.requestLevels[g][e][0]?delete this.requestLevels[g][e]:this.requestLevels[g][e][5]=d);this.requestLevels[d]&&this.requestLevels[d][e]||(this.requestLevels[d]=this.requestLevels[d]||{},this.requestLevels[d][e]=[0,e,a.getName(),b,c,d,a.getInfo("timeSerieManagerDBElements")],f||this.processRequests())},d.prototype.processRequests=function(){if(!(this.requestsRunning>=this.options.maxParallelRequests)){for(var c,d=this,e=1;;){for(var f in this.requestLevels[e])if(1!=this.requestLevels[e][f][0]){c=this.requestLevels[e][f];break}if(c)break;if(e++,e>10)return}this.requestsRunning++,c&&(c[0]=1,a.ajax({url:this.getURL(c),method:"get",dataType:"json"}).done(function(a){1==a.status&&(d.requestsRunning--,delete d.requestLevels[e][f],b.store(d.options.LRUName,c[1],a.data),d.processRequests(),1==c[5]&&0==Object.keys(d.requestLevels[1]).length&&d.recalculateSeries(!0))}))}},d.prototype.computeTimeMax=function(a,b){return(a+1)*(b*this.options.nbPoints)},d.prototype.computeTimeMin=function(a,b){return a*(b*this.options.nbPoints)},d.prototype.getURL=function(a){var b=this.options.url.replace("<measurementid>",a[2]).replace("<from>",this.computeTimeMin(a[3],a[4])).replace("<to>",this.computeTimeMax(a[3],a[4])).replace("<interval>",a[4]),c=a[6]||{};for(var d in c)b=b.replace("<"+d+">",c[d]);return b},d.prototype.getOptimalInterval=function(a){var b,c=(this.options.optimalPxPerPoint||1)*a/this.graph.getDrawingWidth(),d=1/0;return this.options.intervals.forEach(function(a){var e=Math.min(d,Math.abs(a-c));d!==e&&(b=a,d=e)}),b||1e3},d.prototype.computeUniqueID=function(a,b,c){var d="",e=a.getInfo("timeSerieManagerDBElements");for(var f in e)d+=";"+f+":"+e[f];return a.getName()+";"+b+";"+c+d},d.prototype.computeSlotID=function(a,b){return Math.floor(a/(b*this.options.nbPoints))},d.prototype.computeSlotTime=function(a,b){return a*(b*this.options.nbPoints)},d.prototype.getZoneSerie=function(a){return a._zoneSerie},d.prototype.updateZoneSerie=function(a){var b=this.graph.getSerie(a);b&&b._zoneSerie&&(b._zoneSerie.setXAxis(b.getXAxis()),b._zoneSerie.setYAxis(b.getYAxis()),b._zoneSerie.setFillColor(b.getLineColor()),b._zoneSerie.setLineColor(b.getLineColor()),b._zoneSerie.setFillOpacity(.2),b._zoneSerie.setLineOpacity(.3))},d.prototype.recalculateSeries=function(a){var b=this;this.changed=!1,this.series.map(function(c){b.recalculateSerie(c,a)}),this.changed=!1,b.graph.draw()},d.prototype.recalculateSerie=function(a,c){var d,e=a.getXAxis().getCurrentMin(),f=a.getXAxis().getCurrentMax(),g=this.getOptimalInterval(f-e),h=this.computeSlotID(e,g),i=this.computeSlotID(f,g),j=[],k=[];if(!(!c&&g==this.currentSlots[a.getName()].interval&&this.currentSlots[a.getName()].min<=h&&this.currentSlots[a.getName()].max>=i)){h-=2,i+=2,this.currentSlots[a.getName()].min=h,this.currentSlots[a.getName()].max=i,this.currentSlots[a.getName()].interval=g;for(var l=h;i>=l;)(d=b.get(this.options.LRUName,this.computeUniqueID(a,l,g)))?(j=j.concat(d.data.mean),k=k.concat(d.data.minmax)):this.recalculateSerieUpwards(a,l,g,j,k),l++;this.changed=!0,a.setData(j),a._zoneSerie&&a._zoneSerie.setData(k)}},d.prototype.setIntervalCheck=function(a){this.interval&&clearInterval(this.interval);var b=this;this.interval=setInterval(function(){b.update(!0,!1)},a)},d.prototype.recalculateSerieUpwards=function(a,c,d,e,f){var g=this.options.intervals.slice(0);g.sort();var h,i=g[g.indexOf(d)+1]||-1;if(0>i)return[];var j=this.computeSlotTime(c,d),k=this.computeSlotTime(c+1,d),l=this.computeSlotID(j,i),m=!1;if(h=b.get(this.options.LRUName,this.computeUniqueID(a,l,i)))for(var n=0,o=h.data.mean.length;o>n;n+=2)if(!(h.data.mean[n]<j)&&(m===!1&&(m=n),h.data.mean[n]>=k))return e=e.concat(h.data.mean.slice(m,n)),void(f=e.concat(h.data.minmax.slice(m,n)));return this.recalculateSerieUpwards(a,l,i,e,f)},d}(c["./jquery"],c["./graph.lru"],c["./plugins/graph.plugin"],c["./plugins/ "]),c["./series/graph.serie"]=function(a,b){var c=function(){};return c.prototype=new a,c.prototype.setData=function(a,c,d){function e(a){var b=Object.prototype.toString.call(a);return"[object Array]"===b||"[object Int16Array]"===b||"[object Int32Array]"===b||"[object Float32Array]"===b||"[object Float64Array]"===b||"[object Uint8Array]"===b||"[object Uint16Array]"===b||"[object Uint32Array]"===b||"[object Int8Array]"===b}var f,g,h,i,j=0,c=c||!1,d=d||"float",k=0;this.minX=+(1/0),this.minY=+(1/0),this.maxX=-(1/0),this.maxY=-(1/0);var l=e(a),m=[];if(l||"object"!=typeof a){if(l&&!e(a[0]))a=[a],c=!0;else if(!l)return void b.throwError("Data is not an array")}else a=[a];var n=e(a[0]),o=e(a[0][0]);if(!n||c||o||(a=[a]),n)for(var p=0,q=a.length;q>p;p++){h=this._addData(d,c?a[p].length:2*a[p].length),m.push(h),j=0;for(var r=0,s=a[p].length;s>r;r++)c?(h[j]=a[p][r],this[r%2==0?"_checkX":"_checkY"](h[j]),j++,k+=r%2?1:0):(h[j]=a[p][r][0],this._checkX(h[j]),j++,h[j]=a[p][r][1],this._checkY(h[j]),j++,k++)}else if("object"==typeof a[0])if(a[0].x)for(var p=0,s=a.length;s>p;p++){var h=this._addData(d,2*a[p].x.length);m.push(h),j=0;for(var r=0,t=a[0].x.length;t>r;r++)h[j]=a[p].x[r],j++,h[j]=a[p].y[r],j++,this._checkX(a[p].x[r]),this._checkY(a[p].y[r]),k++}else{this.mode="x_equally_separated";var u,v=0,w=[],m=[],q=0;if(!a[0].y)return console.log(a),void b.throwError("No y data");for(var p=0,s=a.length;s>p;p++)v+=a[p].y.length,i=0!=p&&(!a[p+1]||a[p].x+a[p].dx*a[p].y.length==a[p+1].x),i||(m.push(this._addData(d,v)),w.push(v),v=0);this.xData=[],v=0,q=0,j=0;for(var p=0,s=a.length;s>p;p++){f=a[p].x,g=a[p].dx,this.xData.push({x:f,dx:g}),u=a[p].y.length,this._checkX(f),this._checkX(f+g*u);for(var r=0;u>r;r++)m[q][j]=a[p].y[r],this._checkY(m[q][j]),j++,k++;v+=a[p].y.length,w[q]==v&&(q++,v=0,j=0)}}var x=((this.maxX-this.minX)/this.graph.getDrawingWidth(),[]),y=4*this.graph.getDrawingWidth(),z=k/4,y=this.graph.getDrawingWidth(),z=k;if(this.data=m,y>0){for(;z>y;)x.push(y),y*=4;this.slots=x,this.options.useSlots&&this.calculateSlots()}if(this.isFlipped()){var A=this.maxX,B=this.maxY,C=this.minX,D=this.minY;this.maxX=B,this.maxY=A,this.minX=D,this.minY=C}return this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this},c.prototype._addData=function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},c.prototype.getData=function(){return this.data},c.prototype.setOptions=function(a){this.options=a||{}},c.prototype.kill=function(){this.graph.removeSerieFromDom(this),this.graph._removeSerie(this),this.graph.legend&&this.graph.legend.update(),this.killImpl()},c.prototype.killImpl=function(){},c.prototype.hide=function(a){if(this.hidden=!0,this.groupMain.setAttribute("display","none"),this.getSymbolForLegend().setAttribute("opacity",.5),this.getTextForLegend().setAttribute("opacity",.5),this.hideImpl(),a)for(var b=this.graph.getShapesOfSerie(this),c=0,d=b.length;d>c;c++)b[c].hide();return this},c.prototype.show=function(a){if(this.hidden=!1,this.groupMain.setAttribute("display","block"),this.getSymbolForLegend().setAttribute("opacity",1),this.getTextForLegend().setAttribute("opacity",1),this.showImpl(),this.draw(),a)for(var b=this.graph.getShapesOfSerie(this),c=0,d=b.length;d>c;c++)b[c].show();return this},c.prototype.hideImpl=function(){},c.prototype.showImpl=function(){},c.prototype.toggleDisplay=function(){return this.isShown()?this.hide():this.show(),this},c.prototype.isShown=function(){return!this.hidden},c.prototype.getX=function(a){return(a=this.getXAxis().getPx(a))-a%.2},c.prototype.getY=function(a){return(a=this.getYAxis().getPx(a))-a%.2},c.prototype.isSelected=function(){return this.selected||"unselected"!==this.selectionType},c.prototype._checkX=function(a){this.minX=Math.min(this.minX,a),this.maxX=Math.max(this.maxX,a)},c.prototype._checkY=function(a){this.minY=Math.min(this.minY,a),this.maxY=Math.max(this.maxY,a)},c.prototype.getName=function(){return this.name},c.prototype.autoAxis=function(){return this.isFlipped()?(this.setXAxis(this.graph.getYAxis()),this.setYAxis(this.graph.getXAxis())):(this.setXAxis(this.graph.getXAxis()),this.setYAxis(this.graph.getYAxis())),this.graph.updateDataMinMaxAxes(),this},c.prototype.setXAxis=function(a){return"number"==typeof a?this.xaxis=this.isFlipped()?this.graph.getYAxis(a):this.graph.getXAxis(a):this.xaxis=a,this.graph.updateDataMinMaxAxes(),this},c.prototype.setYAxis=function(a){return"number"==typeof a?this.xaxis=this.isFlipped()?this.graph.getXAxis(a):this.graph.getYAxis(a):this.yaxis=a,this.graph.updateDataMinMaxAxes(),this},c.prototype.setAxes=function(){for(var a=0;2>a;a++)arguments[a]&&this[arguments[a].isX()?"setXAxis":"setYAxis"](arguments[a]);return this},c.prototype.getXAxis=function(){return this.xaxis},c.prototype.getYAxis=function(){return this.yaxis},c.prototype.getMinX=function(){return this.minX},c.prototype.getMaxX=function(){return this.maxX},c.prototype.getMinY=function(){return this.minY},c.prototype.getMaxY=function(){return this.maxY},c.prototype.getSymbolForLegend=function(){if(!this.lineForLegend){var a=document.createElementNS(this.graph.ns,"line");this.applyLineStyle(a),a.setAttribute("x1",5),a.setAttribute("x2",25),a.setAttribute("y1",0),a.setAttribute("y2",0),a.setAttribute("cursor","pointer"),this.lineForLegend=a}return this.lineForLegend},c.prototype.setLegendSymbolStyle=function(){this.applyLineStyle(this.getSymbolForLegend())},c.prototype.updateStyle=function(){this.setLegendSymbolStyle(),this.graph.updateLegend()},c.prototype.getTextForLegend=function(){if(!this.textForLegend){var a=document.createElementNS(this.graph.ns,"text");a.setAttribute("transform","translate(35, 3)"),a.setAttribute("cursor","pointer"),a.textContent=this.getLabel(),this.textForLegend=a}return this.textForLegend},c.prototype.getIndex=function(){return this.graph.series.indexOf(this)},c.prototype.getLabel=function(){return this.options.label||this.name},c.prototype.setLabel=function(a){return this.options.label=a,this.textForLegend&&(this.textForLegend.textContent=a),this},c.prototype.setFlip=function(a){return this.options.flip=a,this},c.prototype.getFlip=function(){return this.options.flip},c.prototype.isFlipped=function(){
return this.options.flip},c.prototype.setLayer=function(a){return this.options.layer=parseInt(a)||1,this},c.prototype.getLayer=function(){return this.options.layer||1},c.prototype.styleHasChanged=function(a){if(this._changedStyles=this._changedStyles||{},a===!1)for(var b in this._changedStyles)this._changedStyles[b]=!1;else this._changedStyles[a||"unselected"]=!0;return this},c.prototype.hasStyleChanged=function(a){return this._changedStyles=this._changedStyles||{},this._changedStyles[a||"unselected"]},c.prototype.dataHasChanged=function(a){return this._dataHasChanged=void 0===a||a,this},c.prototype.hasDataChanged=function(){return this._dataHasChanged},c.prototype.setInfo=function(a,b){return this.infos=this.infos||{},this.infos[a]=b,this},c.prototype.getInfo=function(a,b){return(this.infos||{})[a]},c.prototype.setAdditionalData=function(a){return this.additionalData=a,this},c.prototype.getAdditionalData=function(){return this.additionalData},c.prototype.select=function(){return this.selected=!0,this},c.prototype.unselect=function(){return this.selected=!1,this},c.prototype.enableTracking=function(a,b){this._tracker=!0,this._trackingCallback=a,this._trackingOutCallback=b},c.prototype.disableTracking=function(){this._trackerDom&&this._trackerDom.parentNode.removeChild(this._trackerDom),this._tracker=!1,this._trackingCallback=null},c.prototype.setLegend=function(a){this._legend=a},c.prototype.isInLegend=function(){return this._legend!==!1},c.prototype.getMarkerForLegend=function(){return!1},c.prototype.getType=function(){return this.type},c}(c["./dependencies/eventEmitter/EventEmitter"],c["./graph.util"]),c["./series/slotoptimizer"]=function(a){function c(){var a=URL.createObjectURL(new Blob([" ( "+function(){onmessage=function(a){for(var b,c=a.data.data,d=a.data.slotNumber,e=a.data.slot,f=(a.data.flip,a.data.max),g=a.data.min,h=e/(f-g),i=[],j=0,k=c.length;k>j;j++)for(var l=0,m=c[j].length;m>l;l+=2)b=Math.floor((c[j][l]-g)*h),i[b]=i[b]||{min:c[j][l+1],max:c[j][l+1],start:c[j][l+1],stop:!1,x:c[j][l]},i[b].stop=c[j][l+1],i[b].min=Math.min(c[j][l+1],i[b].min),i[b].max=Math.max(c[j][l+1],i[b].max);postMessage({slotNumber:d,slot:e,data:i,_queueId:a.data._queueId})}}.toString()+")()"],{type:"application/javascript"}));d=new Worker(a),d.onmessage=function(a){var b=a.data._queueId;delete a.data._queueId,e[b].resolve(a.data.data),delete e[b]}}var d,e={};return function(f){d||c();var g=a.guid();return f._queueId=g,e[g]=b.Deferred(),d.postMessage(f),e[g]}}(c["./graph.util"]),c["./mixins/graph.mixin.errorbars"]=function(a){return function(){this.doErrorDraw=function(a,b,c,d,e,f){b instanceof Array||(b=[b]);var g,h="y"==a?"getY":"getX",i="y"==a?["top","bottom"]:["left","right"];if(!isNaN(e)&&!isNaN(f))for(var j=0,k=b.length;k>j;j++)b[j]instanceof Array?(g=i[0],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c+b[j][0]),d,g),g=i[1],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c-b[j][1]),d,g)):(g=i[0],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c+b[j]),d,g),g=i[1],this.errorstyles[j].paths[g]+=" M "+e+" "+f,this.errorstyles[j].paths[g]+=this.makeError(a,j,this[h](c-b[j]),d,g))},this.makeError=function(a,b,c,d,e){var f;switch(this.errorstyles[b].type){case"bar":f="makeBar";break;case"box":f="makeBox"}return this[f+a.toUpperCase()](c,d,this.errorstyles[b][e])},this.makeBarY=function(b,c,d){var e=a.isNumeric(d.width)?d.width:10;return" V "+b+" m -"+e/2+" 0 h "+e+" m -"+e/2+" 0 V "+c+" "},this.makeBoxY=function(a,b,c){return" m 5 0 V "+a+" h -10 V "+b+" m 5 0 "},this.makeBarX=function(b,c,d){a.isNumeric(d.width)?d.width:10;return" H "+b+" m 0 -"+height/2+" v "+height+" m 0 -"+height/2+" H "+c+" "},this.makeBoxX=function(a,b,c){return" v 5 H "+a+" v -10 H "+b+" v 5 "},this.setDataError=function(a){return this.error=a,this.dataHasChanged(),this},this.setErrorStyle=function(a){function c(a){a.dom=document.createElementNS(d.graph.ns,"path"),a.dom.setAttribute("fill",a.fillColor||"none"),a.dom.setAttribute("stroke",a.strokeColor||"black"),a.dom.setAttribute("stroke-opacity",a.strokeOpacity||1),a.dom.setAttribute("fill-opacity",a.fillOpacity||1),a.dom.setAttribute("stroke-width",a.strokeWidth||1),d.groupMain.appendChild(a.dom)}var d=this;a=a||["box","bar"],Array.isArray(a)||(a=[a]);for(var e=[],f=[["y","top","bottom"],["x","left","right"]],g=0;g<a.length;g++){e[g]={},"string"==typeof a[g]&&(a[g]={type:a[g],y:{}}),e[g].type=a[g].type;for(var h=0,i=f.length;i>h;h++){a[g][f[h][0]]&&(a[g][f[h][1]]=b.extend(!0,{},a[g][f[h][0]]),a[g][f[h][2]]=b.extend(!0,{},a[g][f[h][0]]));for(var j=1;2>=j;j++)a[g][f[h][j]]&&(e[g][f[h][j]]=a[g][f[h][j]],c(e[g][f[h][j]]))}}return this.errorstyles=e,this},this.errorDrawInit=function(){if(this.errorstyles)for(var a=0,b=this.errorstyles.length;b>a;a++)this.errorstyles[a].paths={top:"",bottom:"",left:"",right:""}},this.errorAddPoint=function(a,b,c,d,e){var f;this.error&&(f=this.error[a/2])&&(f[0]&&this.doErrorDraw("y",f[0],c,e,d,e),f[1]&&this.doErrorDraw("x",f[1],b,d,d,e))},this.errorDraw=function(){if(this.error&&this.errorstyles)for(var a=0,b=this.errorstyles.length;b>a;a++)for(var c in this.errorstyles[a].paths)this.errorstyles[a][c]&&this.errorstyles[a][c].dom&&this.errorstyles[a][c].dom.setAttribute("d",this.errorstyles[a].paths[c])}}}(c["./graph.util"]),c["./series/graph.serie.line"]=function(a,c,d,e){function f(a,b,c,d){if(b){if(a.options.markersIndependant){var e=a.getMarkerDomIndependant(a.counter1,a.counter2,b),f="M "+c+" "+d+" ";f+=b.markerPath+" ",e.setAttribute("d",f)}b.path=b.path||"",b.path+="M "+c+" "+d+" ",b.path+=b.markerPath+" "}}function g(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=0,q=a.data.length,r=0,s=[],t=0,u=1,v=a.isXMonotoneous(),w=a.getXAxis().getMathMaxPx();a.isFlipped()&&(t=1,u=0);var x=[],y=[],z=[],A=0;if("x_equally_separated"==a.mode){if(a.isFlipped())return[a.data,a.xData];for(z=[];q>p;p++){r=0,f=0,g=a.data[p].length;var B=Math.round(a.degradationPx/a.getXAxis().getRelPx(a.xData[p].dx));for(1==B&&(y.push(a.xData[p]),x.push(a.data[p])),h=1/0,i=-(1/0);g>r;r+=1)if(b=a.xData[p].x+r*a.xData[p].dx,v&&0>b)o=[b,c,a.data[p][r]];else{if(v&&o&&(A+=o[2],h=Math.min(h,o[2]),i=Math.max(i,o[2]),o=!1,f++),A+=a.data[p][r],h=Math.min(h,a.data[p][r]),i=Math.max(i,a.data[p][r]),(r%B==0&&r>0||n)&&(z.push(A/B),s.push(a.xData[p].x+r*a.xData[p].dx-B/2*a.xData[p].dx,h,i),h=1/0,i=-(1/0),A=0),v&&b>w){n=!0;break}f++}x.push(z),y.push({dx:B*a.xData[p].dx,x:a.xData[p].x+B*a.xData[p].dx/2})}return a.degradationSerie&&(a.degradationSerie.setData(s),a.degradationSerie.draw()),[x,y]}for(;q>p;p++){r=0,f=0,g=a.data[p].length,j=0,k=0,h=1/0,i=-(1/0);for(var C=[];g>r;r+=2)if(d=a.getX(a.data[p][r+t]),v&&0>d)o=[d,a.getY(a.data[p][r+u]),a.data[p][r+t],a.data[p][r+u]];else{if(v&&o?(k+=o[3],j++,h=Math.min(h,o[3]),i=Math.max(i,o[3]),l=o[2],m=o[0],o=!1,f++):void 0===l&&(l=a.data[p][r+t],m=d),Math.abs(d-m)>a.degradationPx&&g>r){if(C.push((l+a.data[p][r+t])/2,k/j),s.push((a.data[p][r+t]+l)/2,h,i),m>w)break;l=void 0,j=0,k=0,h=1/0,i=-(1/0),f++}k+=a.data[p][r+u],j++,h=Math.min(h,a.data[p][r+u]),i=Math.max(i,a.data[p][r+u]),v&&d>w&&(n=!0),b=d,c=e}if(x.push(C),n)break}return a.degradationSerie&&(a.degradationSerie.setData(s),a.degradationSerie.draw()),[x]}function h(a){if(a.picks)for(var b=0;b<a.picks.length;b++)a.picks[b].hide()}function i(a){if(a.picks)for(var b=0;b<a.picks.length;b++)a.picks[b].show()}var j=function(){};return j.prototype=new a,j.prototype.init=function(a,c,e){var f=this;if(this.selectionType="unselected",this.markerFamilies={},this.graph=a,this.name=c,this.options=b.extend(!0,{},j.prototype.defaults,e||{}),d.mapEventEmission(this.options,this),this.styles={},this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,lineWidth:this.options.lineWidth,markers:this.options.markers},this.styles.selected={lineWidth:3},this.extendStyles(),this.options.markers&&this.setMarkers(this.options.markers,"unselected"),this.shown=!0,this.data=[],this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupLines=document.createElementNS(this.graph.ns,"g"),this.domMarker=document.createElementNS(this.graph.ns,"path"),this.domMarker.style.cursor="pointer",this.groupMain=document.createElementNS(this.graph.ns,"g"),this.additionalData={},this.marker=document.createElementNS(this.graph.ns,"circle"),this.marker.setAttribute("fill","black"),this.marker.setAttribute("r",3),this.marker.setAttribute("display","none"),this.markerLabel=document.createElementNS(this.graph.ns,"text"),this.markerLabelSquare=document.createElementNS(this.graph.ns,"rect"),this.markerLabelSquare.setAttribute("fill","white"),this.domMarkerHover={},this.domMarkerSelect={},this.markerHovered=0,this.groupMarkerSelected=document.createElementNS(this.graph.ns,"g"),this.lines=[],this.groupMain.appendChild(this.groupLines),this.groupMain.appendChild(this.marker),this.groupMain.appendChild(this.groupMarkerSelected),this.groupMain.appendChild(this.markerLabelSquare),this.groupMain.appendChild(this.markerLabel),this.independantMarkers=[],this.initExtended1&&this.initExtended1(),this.options.autoPeakPicking){this.picks=this.picks||[];for(var g=0,h=this.options.autoPeakPickingNb;h>g;g++){var i=this.graph.newShape({type:"label",label:{text:"",position:{x:0},anchor:"middle"},selectable:!0,shapeOptions:{minPosY:15}});i.draw(),i.setSerie(f),f.picks.push(i)}}this.groupLines.addEventListener("click",function(a){f.options.selectableOnClick&&(f.isSelected()?f.graph.unselectSerie(f):f.graph.selectSerie(f))})},j.prototype.defaults={lineColor:"black",lineStyle:1,flip:!1,label:"",lineWidth:1,markers:!1,trackMouse:!1,trackMouseLabel:!1,trackMouseLabelRouding:1,lineToZero:!1,autoPeakPicking:!1,autoPeakPickingNb:4,autoPeakPickingMinDistance:10,autoPeakPickingFormat:!1,autoPeakPickingAllowAllY:!1,selectableOnClick:!0,markersIndependant:!1},j.prototype.setOptions=function(a){return this.options=b.extend(!0,{},j.prototype.defaults,a||{}),this.styles.unselected={lineColor:this.options.lineColor,lineStyle:this.options.lineStyle,markers:this.options.markers},this.applyLineStyles(),this},j.prototype.calculateSlots=function(){this.slotsData={};for(var a=0,b=this.slots.length;b>a;a++)this.calculateSlot(this.slots[a],a)},j.prototype.slotCalculator=function(a,b){return c({min:this.minX,max:this.maxX,data:this.data,slot:a,slotNumber:b,flip:this.getFlip()})},j.prototype.calculateSlot=function(a,b){var c=this;this.slotsData[a]=this.slotCalculator(a,b),this.slotsData[a].pipe(function(b){return c.slotsData[a]=b,b})},j.prototype.onMouseOverMarker=function(a,b){this.toggleMarker(b,!0,!0);this.options.onMouseOverMarker&&this.options.onMouseOverMarker(b,this.infos?this.infos[b[0]]||!1:!1,[this.data[b[1]][2*b[0]],this.data[b[1]][2*b[0]+1]])},j.prototype.onMouseOutMarker=function(a,b){this.markersOffHover(),this.options.onMouseOutMarker&&this.options.onMouseOutMarker(b,this.infos?this.infos[b[0]]||!1:!1,[this.data[b[1]][2*b[0]],this.data[b[1]][2*b[0]+1]])},j.prototype.toggleMarker=function(a,b,c){var d=a[0],e=a[1]||0;a=a.join();var f;"undefined"==typeof b&&(f=c?!this.domMarkerHover[a]:!this.domMarkerSelect[a]);var g=this["domMarker"+(c?"Hover":"Select")];if(f||b===!0){if(g[a])h=g[a];else{var h=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(h,this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(d)]),this["domMarker"+(c?"Hover":"Select")][a]=h,this.groupMarkerSelected.appendChild(h)}var i,j;"x_equally_separated"==this.mode?(i=this._xDataToUse[e].x+d*this._xDataToUse[e].dx,j=this.data[e][d]):(i=this.data[e][2*d],j=this.data[e][2*d+1]),i=this.getX(i),j=this.getY(j),h.setAttribute("d","M "+i+" "+j+" "+this.getMarkerPath(this.markerFamilies[this.selectionType][this.getMarkerCurrentFamily(d)],1)),c&&this.markerHovered++}else if((!f||b===!1)&&(c&&this.domMarkerHover[a]&&!this.domMarkerSelect[a]||this.domMarkerSelect[a])){if(!g[a])return;this.groupMarkerSelected.removeChild(g[a]),delete g[a],c&&this.markerHovered--}return f},j.prototype.markersOffHover=function(){for(var a in this.domMarkerHover)this.toggleMarker(a.split(","),!1,!0);return this},j.prototype.markersOffSelect=function(){for(var a in this.domMarkerSelect)this.toggleMarker(a.split(","),!1,!1);return this},j.prototype.onClickOnMarker=function(a,b){var c=this.toggleMarker(b);c&&this.options.onSelectMarker&&this.options.onSelectMarker(b,this.infos?this.infos[b[0]]||!1:!1),!c&&this.options.onUnselectMarker&&this.options.onUnselectMarker(b,this.infos?this.infos[b[0]]||!1:!1),this.options.onToggleMarker&&this.options.onToggleMarker(b,this.infos?this.infos[b[0]]||!1:!1,c)},j.prototype._getMarkerIndexFromEvent=function(a){var b=this.graph._getXY(a);return this.searchIndexByPxXY(b.x-this.graph.getPaddingLeft(),b.y-this.graph.getPaddingTop())},j.prototype.onMouseWheel=function(){},j.prototype.empty=function(){for(var a=0,b=this.lines.length;b>a;a++)this.groupLines.removeChild(this.lines[a]);return this.lines=[],this},j.prototype.select=function(a){return a=a||"selected",this.selected="unselected"!==a,this.areMarkersShown()||this.areMarkersShown(a)?(this.selectionType=a,this.draw(),this.applyLineStyles()):(this.selectionType=a,this.applyLineStyles()),this.applyLineStyle(this.getSymbolForLegend()),this},j.prototype.unselect=function(){return this.selected=!1,this.select("unselected")},j.prototype.degrade=function(a,b){var c=this.graph.newSerie(this.name+"_degraded",b,"zone");return this.degradationPx=a,c?(c.setData([]),c.setXAxis(this.getXAxis()),c.setYAxis(this.getYAxis()),this.degradationSerie=c,c):void 0},j.prototype.drawInit=function(){var a,b;if(this.currentLineId=0,this.counter=0,this._drawn=!0,this.currentLine="",this.degradationPx?(a=g(this),b=a[1],a=a[0],this._dataToUse=a,this._xDataToUse=b):(this._dataToUse=this.data,this._xDataToUse=this.xData),this._optimizeMonotoneous=this.isXMonotoneous(),this.optimizeMonotoneousDirection=this.XMonotoneousDirection()&&!this.getXAxis().isFlipped()||!this.XMonotoneousDirection()&&this.getXAxis().isFlipped(),this._optimizeBreak,this._optimizeBuffer,this._slotToUse=!1,this.options.useSlots&&this.slots&&this.slots.length>0){if(this.isFlipped())var c=this.graph.getDrawingHeight()*(this.maxY-this.minY)/(this.getYAxis().getCurrentMax()-this.getYAxis().getCurrentMin());else var c=this.graph.getDrawingWidth()*(this.maxX-this.minX)/(this.getXAxis().getCurrentMax()-this.getXAxis().getCurrentMin());for(var d=0,e=this.slots.length;e>d;d++)if(c<this.slots[d]){this._slotToUse=this.slotsData[this.slots[d]],this._slotId=d;break}}this.detectedPeaks=[],this.lastYPeakPicking=!1},j.prototype.removeLinesGroup=function(){this._afterLinesGroup=this.groupLines.nextSibling,this.groupMain.removeChild(this.groupLines)},j.prototype.insertLinesGroup=function(){if(!this._afterLinesGroup)throw"Could not find group after lines to insertion.";this.groupMain.insertBefore(this.groupLines,this._afterLinesGroup),this._afterLinesGroup=!1},j.prototype.removeExtraLines=function(){for(var a=this.currentLineId,b=this.lines.length;b>a;a++)this.groupLines.removeChild(this.lines[a]);this.lines.splice(this.currentLineId,b-this.currentLineId),this.currentLineId=0},j.prototype.detectPeaks=function(a,b){this.options.autoPeakPicking&&(this.options.lineToZero?this.detectedPeaks.push([b,a]):this.lastYPeakPicking?b>=this.lastYPeakPicking[0]&&this.lookForMaxima||b<=this.lastYPeakPicking[0]&&this.lookForMinima?this.lastYPeakPicking=[b,a]:(b<this.lastYPeakPicking[0]&&this.lookForMaxima||b>this.lastYPeakPicking[0]&&this.lookForMinima)&&(this.lookForMinima?(this.lookForMinima=!1,this.lookForMaxima=!0):(this.lookForMinima=!0,this.lookForMaxima=!1,this.detectedPeaks.push(this.lastYPeakPicking),this.lastYPeakPicking=!1),this.lastYPeakPicking=[b,a]):this.lastYPeakPicking=[b,a])},j.prototype.draw=function(a){if(a||this.hasDataChanged()){this.drawInit();this._dataToUse,this._xDataToUse,this._slotToUse;this.removeLinesGroup(),this.eraseMarkers(),this.lookForMaxima=!0,this.lookForMinima=!1,this.error&&this.errorDrawInit(),this._draw_slot()||("x_equally_separated"==this.mode?this._draw_equally_separated():this._draw_standard()),this.error&&this.errorDraw(),this.makePeakPicking(),this.removeExtraLines(),this.insertMarkers(),this.insertLinesGroup()}for(var b in this.domMarkerHover)this.toggleMarker(b.split(","),!1,!0);for(var b in this.domMarkerSelect)this.toggleMarker(b.split(","),!1,!1);this.applyLineStyle(this.getSymbolForLegend()),this.hasStyleChanged(this.selectionType)&&this.updateStyle(),this.dataHasChanged(!1)},j.prototype._draw_standard=function(){var a,b,c,d,e,f,c,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this,u=this._dataToUse,v=0,w=u.length,x=!1,y=!1,z=this.getXAxis(),A=this.getYAxis(),B=z.getCurrentMin(),C=A.getCurrentMin(),D=z.getCurrentMax(),E=A.getCurrentMax(),F=0,G=1,H=!1,I=!1;for(this.isFlipped()&&(F=1,G=0),v=0;w>v;v++){for(a=!1,this.counter1=v,this.currentLine="",b=0,c=0,d=u[v].length,b=0;d>b;b+=2)if(e=u[v][b+F],f=u[v][b+G],B>e&&B>x||e>D&&x>D||(C>f&&C>y||f>E&&y>E)&&!this.options.lineToZero)x=e,y=f,I=!0;else if(this.counter2=b/2,this.markersShown()&&this.getMarkerCurrentFamily(this.counter2),i=this.getX(e),j=this.getY(f),i!=g||j!=h){if(H=B>e||C>f||e>D||f>E,this.options.lineToZero){if(H=B>e||e>D)continue}else if(H||I){x!==!1&&y!==!1||I?(s=[],k=(e-B)/(e-x),l=f-k*(f-y),m=(e-D)/(e-x),n=f-m*(f-y),o=(f-C)/(f-y),p=e-o*(e-x),q=(f-E)/(f-y),r=e-q*(e-x),1>k&&k>0&&l!==!1&&E>l&&l>C&&s.push([B,l]),1>m&&m>0&&n!==!1&&E>n&&n>C&&s.push([D,n]),1>o&&o>0&&p!==!1&&D>p&&p>B&&s.push([p,C]),1>q&&q>0&&r!==!1&&D>r&&r>B&&s.push([r,E]),s.length>0?H?I?2==s.length&&(this._createLine(),this._addPoint(this.getX(s[0][0]),this.getY(s[0][1]),s[0][0],s[0][1],!1,!1,!1),this._addPoint(this.getX(s[1][0]),this.getY(s[1][1]),s[0][0],s[0][1],!1,!1,!1)):(s.length>1&&(console.error("Programmation error. Please e-mail me."),console.log(s,r,p,n,l,f,C,E,y)),this._addPoint(this.getX(s[0][0]),this.getY(s[0][1]),s[0][0],s[0][1],!1,!1,!1)):(s.length>1&&(console.error("Programmation error. Please e-mail me."),console.log(s,r,p,n,l,f,C,E,y)),this._createLine(),this._addPoint(this.getX(s[0][0]),this.getY(s[0][1]),s[0][0],s[0][1],!1,!1,!1),this._addPoint(i,j,x,y,!1,!1,!0)):H||this._addPoint(i,j,x,y,b,!1,!1)):(g=i,h=j,x=e,y=f),g=i,h=j,x=e,y=f,I=H;continue}if(isNaN(i)||isNaN(j))this.counter>0&&this._createLine();else if(this._optimize_before(i,j)){if(this._addPoint(i,j,e,f,b,!1,!0),this.detectPeaks(e,f),!this._optimize_after(i,j)){a=!0;break}g=i,h=j,x=e,y=f}}if(this._createLine(),a)break}if(this._tracker){this._trackerDom&&this.groupLines.removeChild(this._trackerDom);var J=this.groupLines.cloneNode(!0);this.groupMain.appendChild(J);for(var v=0,w=J.children.length;w>v;v++)J.children[v].setAttribute("stroke","transparent"),J.children[v].setAttribute("stroke-width","25px"),J.children[v].setAttribute("pointer-events","stroke");t._trackerDom=J,t.groupMain.addEventListener("mousemove",function(a){var b=t.graph._getXY(a),c=t.handleMouseMove(!1,!1);t._trackingCallback(t,c,b.x,b.y)}),t.groupMain.addEventListener("mouseleave",function(a){t._trackingOutCallback(t)})}return this},j.prototype._draw_slot=function(){var a=this;return this._slotToUse?(this._slotToUse.done?this._slotToUse.done(function(b){a.drawSlot(b,a._slotId)}):this.drawSlot(this._slotToUse,a._slotId),!0):!1},j.prototype._draw_equally_separated=function(){for(var a,b,c,d,e,f,g,h,i,j=0,k=this._dataToUse,l=this._xDataToUse,m=k.length;m>j;j++){for(i="M ",a=0,b=0,c=k[j].length,this.counter1=j;c>a;a+=1)if(this.counter2=a,this.markersShown()&&this.getMarkerCurrentFamily(b),this.isFlipped()?(e=l[j].x+a*l[j].dx,d=k[j][a],g=this.getX(e),f=this.getY(d)):(d=l[j].x+a*l[j].dx,e=k[j][a],f=this.getX(d),g=this.getY(e)),this._optimize_before(f,g)&&(this._addPoint(f,g,d,e,a,!1,!1),!this._optimize_after(f,g))){h=!0;break}if(this._createLine(),h)break}},j.prototype._optimize_before=function(a,b){return this._optimizeMonotoneous?this.optimizeMonotoneousDirection&&a<this.getXAxis().getMathMinPx()||!this.optimizeMonotoneousDirection&&a>this.getXAxis().getMathMaxPx()?(this._optimizeBuffer=[a,b],!1):(this._optimizeBuffer&&(this._addPoint(this._optimizeBuffer[0],this._optimizeBuffer[1],!1,!1,!1,!1,!1),this._optimizeBuffer=!1),!0):!0},j.prototype._optimize_after=function(a,b){return this._optimizeMonotoneous?!(this.optimizeMonotoneousDirection&&a>this.getXAxis().getMathMaxPx()||!this.optimizeMonotoneousDirection&&a<this.getXAxis().getMathMinPx()):!0},j.prototype.hidePeakPicking=function(a){this._hidePeakPickingLocked||(this._hidePeakPickingLocked=a),h(this)},j.prototype.showPeakPicking=function(a){this._hidePeakPickingLocked&&!a||i(this)},j.prototype.killPeakPicking=function(){if(this.picks)for(var a=0,b=this.picks.length;b>a;a++)this.picks[a].kill()},j.prototype.killImpl=function(){this.killPeakPicking()},j.prototype.getMarkerCurrentFamily=function(a){if(this.markerPoints[this.selectionType]){for(var b=0;b<this.markerPoints[this.selectionType].length&&this.markerPoints[this.selectionType][b][0]<=a;b++)this.markerPoints[this.selectionType][b][1]>=a&&(this.markerCurrentFamily=this.markerPoints[this.selectionType][b][2]);return this.markerCurrentFamily}},j.prototype.drawSlot=function(a,b){var c,d,e,f=0;if(this.isFlipped())var g=this.slots[b]/(this.maxY-this.minY),h=Math.floor((this.getYAxis().getCurrentMin()-this.minY)*g),i=Math.ceil((this.getYAxis().getCurrentMax()-this.minY)*g);else var g=this.slots[b]/(this.maxX-this.minX),h=Math.floor((this.getXAxis().getCurrentMin()-this.minX)*g),i=Math.ceil((this.getXAxis().getCurrentMax()-this.minX)*g);for(e=h;i>=e;e++)a[e]&&(this.isFlipped()?(ypx=Math.floor(this.getY(a[e].x)),d=this.getX(a[e].max),this._addPoint(this.getX(a[e].start),ypx,!1,!1,!1,!1,!1),this._addPoint(d,ypx,!1,!1,!1,!0,!1),this._addPoint(this.getX(a[e].min),ypx,!1,!1,!1,!1,!1),this._addPoint(this.getX(a[e].stop),ypx,!1,!1,!1,!0,!1)):(c=Math.floor(this.getX(a[e].x)),d=this.getY(a[e].max),this.options.autoPeakPicking&&allY.push([a[e].max,a[e].x]),this._addPoint(c,this.getY(a[e].start),!1,!1,!1,!1,!1),this._addPoint(c,d,!1,!1,!1,!0,!1),this._addPoint(c,this.getY(a[e].min),!1,!1,!1,!1,!1),this._addPoint(c,this.getY(a[e].stop),!1,!1,!1,!0,!1)));this._createLine(),f++},j.prototype.setMarkerStyleTo=function(a,b){if(!a||!b)throw console.trace(),"Cannot set marker style. DOM does not exist.";a.setAttribute("fill",b.fillColor||"transparent"),a.setAttribute("stroke",b.strokeColor||this.getLineColor()),a.setAttribute("stroke-width",b.strokeWidth||1)},j.prototype.hideTrackingMarker=function(){this.marker.setAttribute("display","none"),this.markerLabel.setAttribute("display","none"),this.markerLabelSquare.setAttribute("display","none")},j.prototype._addPoint=function(a,b,c,d,e,g,h){var i;if(!isNaN(a)&&!isNaN(b)){if(0==this.counter?this.currentLine="M ":this.options.lineToZero||g?this.currentLine+="M ":this.currentLine+="L ",this.currentLine+=a,this.currentLine+=" ",this.currentLine+=b,this.currentLine+=" ",this.options.lineToZero&&void 0!==(i=this.getYAxis().getPos(0))&&(this.currentLine+="L ",this.currentLine+=a,this.currentLine+=" ",this.currentLine+=i,this.currentLine+=" "),this.error&&this.errorAddPoint(e,c,d,a,b),!this.markerPoints)return void this.counter++;this.markersShown()&&h!==!1&&f(this,this.markerFamilies[this.selectionType][this.markerCurrentFamily],a,b),this.counter++}},j.prototype._createLine=function(){var a,b=this.currentLineId++;return this.lines[b]?a=this.lines[b]:(a=document.createElementNS(this.graph.ns,"path"),this.applyLineStyle(a),this.groupLines.appendChild(a),this.lines[b]=a),0==this.counter?a.setAttribute("d",""):a.setAttribute("d",this.currentLine),this.currentLine="M ",this.counter=0,a},j.prototype.applyLineStyles=function(){for(var a=0;a<this.lines.length;a++)this.applyLineStyle(this.lines[a])},j.prototype.applyLineStyle=function(a){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()),this.getLineDashArray()?a.setAttribute("stroke-dasharray",this.getLineDashArray()):a.removeAttribute("stroke-dasharray"),a.setAttribute("fill","none")},j.prototype.updateStyle=function(){this.applyLineStyles(),this.setLegendSymbolStyle(),this.styleHasChanged(!1)},j.prototype.getMarkerPath=function(a,b){var c=a.zoom||1,b=b||0,d=[];switch(a.type){case 2:d=["m",-2,-2,"l",4,4,"m",-4,0,"l",4,-4];break;case 3:d=["m",-2,0,"l",4,0,"m",-2,-2,"l",0,4];break;case 4:d=["m",-1,-1,"l",2,0,"l",-1,2,"z"];break;default:case 1:d=["m",-2,-2,"l",4,0,"l",0,4,"l",-4,0,"z"]}if(!(1!=c&&c||b))return d.join(" ");var e="number";if(d){for(var f=0,g=d.length;g>f;f++)typeof d[f]==e&&(d[f]*=c+b);return d.join(" ")}},j.prototype.getMarkerDom=function(a){var b=this;if(!a.dom){var c=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(c,a),a.dom=c,a.path="",c.addEventListener("mouseover",function(a){var c=b._getMarkerIndexFromEvent(a);b.onMouseOverMarker(a,c)}),c.addEventListener("mouseout",function(a){var c=b._getMarkerIndexFromEvent(a);b.onMouseOutMarker(a,c)}),c.addEventListener("click",function(a){var c=b._getMarkerIndexFromEvent(a);b.onClickOnMarker(a,c)})}return a.dom},j.prototype.getMarkerDomIndependant=function(a,b,c){var d=this,e=a+","+b;if(!this.independantMarkers[e]){var f=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(f,c),f.addEventListener("mouseover",function(c){d.onMouseOverMarker(c,[b,a])}),f.addEventListener("mouseout",function(c){d.onMouseOutMarker(c,[b,a])}),f.addEventListener("click",function(c){d.onClickOnMarker(c,[b,a])}),this.independantMarkers[e]=f}return this.groupMain.appendChild(this.independantMarkers[e]),this.independantMarkers[e]},j.prototype.searchIndexByPxXY=function(a,b){var c,d,e,f=!1,g=!1,h=this._xDataToUse;if("x_equally_separated"==this.mode)for(var i=0,j=this.data.length;j>i;i++)for(var k=0,l=this.data[i].length;l>k;k+=1)d=h[i].x+k*h[i].dx,e=this.data[i][k],c=Math.pow(this.getX(d)-a,2)+Math.pow(this.getY(e)-b,2),(!f||f>c)&&(f=c,g=[k,i]);else for(var i=0,j=this.data.length;j>i;i++)for(var k=0,l=this.data[i].length;l>k;k+=2)d=this.data[i][k],e=this.data[i][k+1],c=Math.pow(this.getX(d)-a,2)+Math.pow(this.getY(e)-b,2),(!f||f>c)&&(f=c,g=[k/2,i]);return g},j.prototype.searchClosestValue=function(a){for(var b,c=0;c<this.data.length;c++){if(a<=this.data[c][this.data[c].length-2]&&a>=this.data[c][0])b=this._searchBinary(a,this.data[c],!1);else{if(!(a>=this.data[c][this.data[c].length-2]&&a<=this.data[c][0]))continue;b=this._searchBinary(a,this.data[c],!0)}return{dataIndex:c,xMin:this.data[c][b],xMax:this.data[c][b+2],yMin:this.data[c][b+1],yMax:this.data[c][b+3],xBeforeIndex:b/2,xAfterIndex:b/2+1,xBeforeIndexArr:b,xClosest:(Math.abs(this.data[c][b+2]-a)<Math.abs(this.data[c][b]-a)?b+2:b)/2}}},j.prototype.handleMouseMove=function(a,b){var c=a||this.getXAxis().getMouseVal(),d=this.searchClosestValue(c);if(d){var e=(c-d.xMin)/(d.xMax-d.xMin),f=(1-e)*d.yMin+e*d.yMax;if(b&&this.options.trackMouse){if(void 0==d.xMin)return!1;var g=this.getX(this.getFlip()?f:c),h=this.getY(this.getFlip()?c:f);switch(this.marker.setAttribute("display","block"),this.marker.setAttribute("cx",g),this.marker.setAttribute("cy",h),this.markerLabel.setAttribute("display","block"),this.markerLabelSquare.setAttribute("display","block"),this.options.trackMouseLabel){case!1:break;default:this.markerLabel.textContent=this.options.trackMouseLabel.replace("<x>",c.toFixed(this.options.trackMouseLabelRouding)).replace("<y>",f.toFixed(this.options.trackMouseLabelRouding))}this.markerLabel.setAttribute("x",g+5),this.markerLabel.setAttribute("y",h-5),this.markerLabelSquare.setAttribute("x",g+5),this.markerLabelSquare.setAttribute("y",h-5-this.graph.options.fontSize),this.markerLabelSquare.setAttribute("width",this.markerLabel.getComputedTextLength()+2),this.markerLabelSquare.setAttribute("height",this.graph.options.fontSize+2)}return{xBefore:d.xMin,xAfter:d.xMax,yBefore:d.yMin,yAfter:d.yMax,trueX:c,interpolatedY:f,xBeforeIndex:d.xBeforeIndex,xIndexClosest:d.xClosest}}},j.prototype._searchBinary=function(a,b,c){var d=0,e=b.length,f=e-2;if(b[d]==a)return d;if(b[f]==a)return f;for(var g,h=0;;){if(h++,h>100)throw"Error loop";if(g=(d+f)/2,g-=g%2,g==d||b[g]==a)return g;b[g]<=a?c?f=g:d=g:b[g]>a&&(c?d=g:f=g)}},j.prototype.getMax=function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=-(1/0);if(i||(g=this.minX,i=this.searchClosestValue(g)),j||(h=this.maxX,j=this.searchClosestValue(h)),!i||!j)return-(1/0);for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=2)k=Math.max(k,this.data[c][d+1]);return k},j.prototype.getMin=function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=1/0;if(i||(g=this.minX,i=this.searchClosestValue(g)),j||(h=this.maxX,j=this.searchClosestValue(h)),!i||!j)return 1/0;for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=2)k=Math.min(k,this.data[c][d+1]);return k},j.prototype.setStyle=function(a,b){this.styles[b]=a,this.styleHasChanged(b)},j.prototype.setLineStyle=function(a,b){return b=b||"unselected",this.styles[b]=this.styles[b]||{},this.styles[b].lineStyle=a,this.styleHasChanged(b),this},j.prototype.getLineStyle=function(a){return this.getStyle(a).lineStyle},j.prototype.getLineDashArray=function(a){switch(this.getStyle(a).lineStyle){case 2:return"1, 1";case 3:return"2, 2";case 3:return"3, 3";case 4:return"4, 4";case 5:return"5, 5";case 6:return"5 2";case 7:return"2 5";case 8:return"4 2 4 4";case 9:return"1,3,1";case 10:return"9 2";case 11:return"2 9";case!1:case 1:return!1;default:return this.styles[a||this.selectionType||"unselected"].lineStyle}this.styleHasChanged(a)},j.prototype.getStyle=function(a){return this.styles[a||this.selectionType||"unselected"]},j.prototype.extendStyles=function(){for(var a in this.styles){var c=this.styles[a];c&&(this.styles[a]=b.extend(!0,{},this.styles.unselected,c))}},j.prototype.setLineWidth=function(a,b){return b=b||"unselected",this.styles[b]=this.styles[b]||{},this.styles[b].lineWidth=a,this.styleHasChanged(b),this},j.prototype.getLineWidth=function(a){return this.getStyle(a).lineWidth},j.prototype.setLineColor=function(a,b){return b=b||"unselected",this.styles[b]=this.styles[b]||{},this.styles[b].lineColor=a,this.styleHasChanged(b),this},j.prototype.getLineColor=function(a){return this.getStyle(a).lineColor},j.prototype.showMarkers=function(a,b){return a=a||"unselected",this.styles[a]=this.styles[a]||{},this.styles[a].showMarkers=!0,b&&this._drawn?this.draw():this.styleHasChanged(a),this},j.prototype.hideMarkers=function(a,b){return a=a||"unselected",this.styles[a].showMarkers=!1,b&&this._drawn?this.draw():this.styleHasChanged(a),this},j.prototype.markersShown=function(a){return this.getStyle(a).showMarkers},j.prototype.areMarkersShown=function(){return this.markersShown.apply(this,arguments)},j.prototype.isMarkersShown=function(){return this.markersShown.apply(this,arguments)},j.prototype.setMarkers=function(a,b){return this.styles[b||"unselected"]=this.styles[b||"unselected"]||{},this.showMarkers(b,!1),Array.isArray(a)||"object"!=typeof a?a||(a=[{type:1,zoom:1,points:"all"}]):a=[a],this.styles[b||"unselected"].markers=a,this._recalculateMarkerPoints(b,a),this.styleHasChanged(b),this.dataHasChanged(!0),this},j.prototype.setMarkersPoints=function(a,b,c){b=b||0,c=c||"unselected",this.styles[c]&&this.styles[c].markers&&(this.styles[c].markers[b].points=a,this._recalculateMarkerPoints(c,this.styles[c].markers))},j.prototype._recalculateMarkerPoints=function(a,b){var c=[];c.push([0,1/0,null]);for(var d=0,e=b.length;e>d;d++){this.getMarkerDom(b[d]),b[d].markerPath=this.getMarkerPath(b[d]),b[d].points||(b[d].points="all"),Array.isArray(b[d].points)||(b[d].points=[b[d].points]);for(var f=0,g=b[d].points.length;g>f;f++)"all"==b[d].points[f]?c.push([0,1/0,d]):Array.isArray(b[d].points[f])?c.push([b[d].points[f][0],b[d].points[f][1],d]):c.push([b[d].points[f],b[d].points[f],d]);
}this.markerFamilies=this.markerFamilies||{},this.markerFamilies[a||"unselected"]=b,c.sort(function(a,b){return a[0]-b[0]||(null==a[2]?-1:1)}),this.markerPoints=this.markerPoints||{},this.markerPoints[a||"unselected"]=c},j.prototype.insertMarkers=function(a){if(this.markerFamilies&&this.markerFamilies[a||this.selectionType]&&!this.options.markersIndependant)for(var b=0,c=this.markerFamilies[a||this.selectionType].length;c>b;b++)this.markerFamilies[a||this.selectionType][b].dom.setAttribute("d",this.markerFamilies[a||this.selectionType][b].path),this.groupMain.appendChild(this.markerFamilies[a||this.selectionType][b].dom),this.currentMarkersSelectionType=this.selectionType},j.prototype.getMarkerForLegend=function(){if(this.markerPoints&&this.markerPoints[this.selectionType]){if(!this.markerForLegend){var a=document.createElementNS(this.graph.ns,"path");this.setMarkerStyleTo(a,this.markerFamilies[this.selectionType][0]),a.setAttribute("d","M 14 0 "+this.getMarkerPath(this.markerFamilies[this.selectionType][0])),this.markerForLegend=a}return this.markerForLegend}},j.prototype.eraseMarkers=function(){var a=this;if(this.options.markersIndependant){for(var b in this.independantMarkers)a.groupMain.removeChild(this.independantMarkers[b]);this.independantMarkers={}}else this.currentMarkersSelectionType&&(this.markerFamilies[this.currentMarkersSelectionType].map(function(b){a.groupMain.removeChild(b.dom),b.path=""}),this.currentMarkersSelectionType=!1)},j.prototype.showImpl=function(){this.showPeakPicking()},j.prototype.hideImpl=function(){this.hidePeakPicking()},j.prototype.XIsMonotoneous=function(){return this.xmonotoneous=!0,this},j.prototype.isXMonotoneous=function(){return this.xmonotoneous||!1},j.prototype.XMonotoneousDirection=function(){return this.data&&this.data[0]&&this.data[0][2]-this.data[0][0]>0},j.prototype.makePeakPicking=function(){var a,b,b,c,d,e,f,g=this,h=this.detectedPeaks,i=[],j=0,k=h.length,l=g.graph.selectedShapes.map(function(a){return a.getProp("xval")});for(h.sort(function(a,b){return b[0]-a[0]}),d=0;k>j;j++)if(a=h[j][1],b=g.getX(a),c=0,e=g.getY(h[j][0]),!(b<g.getXAxis().getMinPx()||b>g.getXAxis().getMaxPx())&&(g.options.autoPeakPickingAllowAllY||!(e>g.getYAxis().getMinPx()||e<g.getYAxis().getMaxPx()))){for(;c<i.length&&!(Math.abs(i[c]-b)<g.options.autoPeakPickingMinDistance);c++);if(!(c<i.length))if((f=l.indexOf(a))>-1)i.push(b);else{if(!g.picks[d])return;for(this.getYAxis().getPx(h[j][0])-20<0?(g.picks[d].setLabelPosition({x:a,y:"5px"}),g.picks[d].setLabelBaseline("hanging")):(g.picks[d].setLabelBaseline("no-change"),g.picks[d].setLabelPosition({x:a,y:h[j][0],dy:"-15px"})),g.picks[d].setProp("xval",a),g.options.autoPeakPickingFormat?g.picks[d].setLabelText(g.options.autoPeakPickingFormat.call(g.picks[d],a,d)):g.picks[d].setLabelText(String(Math.round(1e3*a)/1e3)),g.picks[d].makeLabels(),d++;g.picks[d]&&g.picks[d].isSelected();)d++;if(i.length==g.options.autoPeakPickingNb)break}}},e.call(j.prototype),j}(c["./series/graph.serie"],c["./series/slotoptimizer"],c["./graph.util"],c["./mixins/graph.mixin.errorbars"]),c["./series/graph.serie.contour"]=function(a,c){var d=function(){this.negativeDelta=0,this.positiveDelta=0,this.negativeThreshold=0,this.positiveThreshold=0};return d.prototype=new a,b.extend(d.prototype,{setData:function(a,b,c){var d,e,f,g,c=c||"float",h=a.length,i=[];for(a instanceof Array||"object"==typeof a&&(this.minX=a.minX,this.minY=a.minY,this.maxX=a.maxX,this.maxY=a.maxY,a=a.segments,h=a.length),d=0;h>d;d++){for(f=a[d].lines.length,g=this._addData(c,f),e=0;f>e;e+=2)g[e]=a[d].lines[e],this._checkX(g[e]),g[e+1]=a[d].lines[e+1],this._checkY(g[e+1]);i.push({lines:g,zValue:a[d].zValue})}return this.data=i,this.graph.updateDataMinMaxAxes(),this.dataHasChanged(!0),this},draw:function(a){if(a||this.hasDataChanged()){this.currentLine=0;var b,c,d,e,f,g,h,i,j=0,k=this.data.length,l=0;this.minZ=1/0,this.maxZ=-(1/0);var m=this.groupLines.nextSibling;this.groupMain.removeChild(this.groupLines),this.zValues={};var n=0,o=1;this.getFlip()&&(n=0,o=1);var p=this.getYAxis().getCurrentMin(),q=this.getXAxis().getCurrentMin(),r=this.getXAxis().getCurrentMax(),s=this.getYAxis().getCurrentMax();for(this.counter=0,this.currentLineId=0;k>j;j++){for(this.currentLine="",l=0,f=0,i=this.data[j].lines,g=i.length;g>l;l+=4){var t,u;i[l+n]<q&&i[l+2+n]<q||i[l+o]<p&&i[l+2+o]<p||i[l+o]>s&&i[l+2+o]>s||i[l+n]>r&&i[l+2+n]>r||(d=this.getX(i[l+n]),e=this.getY(i[l+o]),b=this.getX(i[l+2+n]),c=this.getY(i[l+2+o]),b==d&&c==e||(this.currentLine+="M ",this.currentLine+=d,this.currentLine+=" ",this.currentLine+=e,this.currentLine+="L ",this.currentLine+=b,this.currentLine+=" ",this.currentLine+=c,this.counter++,t=b,u=c,f++))}this.currentLine+=" z",h=this._createLine(),h.setAttribute("data-zvalue",this.data[j].zValue),this.zValues[this.data[j].zValue]={dom:h},this.minZ=Math.min(this.minZ,this.data[j].zValue),this.maxZ=Math.max(this.maxZ,this.data[j].zValue)}for(j++,j=this.currentLine+1;j<this.lines.length;j++)this.groupLines.removeChild(this.lines[j]),this.lines.splice(j,1);for(j=0;k>j;j++)this.setColorTo(this.lines[j],this.data[j].zValue,this.minZ,this.maxZ);this.onMouseWheel(0,{shiftKey:!1}),this.groupMain.insertBefore(this.groupLines,m)}else if(this.hasStyleChanged(this.selectionType))for(;k>j;j++)this.setColorTo(this.lines[j],this.data[j].zValue,this.minZ,this.maxZ)},onMouseWheel:function(a,b,c,d){a/=250,void 0!==c?(d||(this.negativeThreshold=-c*this.minZ,this.negativeDelta=-Math.pow(Math.abs(this.negativeThreshold/-this.minZ),1/3)),d&&(this.positiveThreshold=c*this.maxZ,this.positiveDelta=Math.pow(this.positiveThreshold/this.maxZ,1/3))):b.shiftKey&&this.options.hasNegative?(this.negativeDelta=Math.min(0,Math.max(-1,this.negativeDelta+Math.min(.1,Math.max(-.1,a)))),this.negativeThreshold=-this.minZ*Math.pow(this.negativeDelta,3)):(this.positiveDelta=Math.min(1,Math.max(0,this.positiveDelta+Math.min(.1,Math.max(-.1,a)))),this.positiveThreshold=this.maxZ*Math.pow(this.positiveDelta,3)),isNaN(this.positiveDelta)&&(this.positiveDelta=0),isNaN(this.negativeDelta)&&(this.negativeDelta=0);for(var e in this.zValues)this.zValues[e].dom.setAttribute("display",e>=0&&e>=this.positiveThreshold||0>=e&&e<=this.negativeThreshold?"block":"none");this._shapeZoom&&(this.options.hasNegative?(this._shapeZoom.setHandleNeg(-Math.pow(this.negativeDelta,3),this.minZ),this._shapeZoom.showHandleNeg()):this._shapeZoom.hideHandleNeg(),this._shapeZoom.setHandlePos(Math.pow(this.positiveDelta,3),this.maxZ))},setDynamicColor:function(a){this.lineColors=a,this.styleHasChanged()},setNegative:function(a){this.options.hasNegative=a,a&&(this.negativeThreshold=0)},setColorTo:function(a,b,d,e){if(this.lineColors){var f={h:0,s:0,l:0};for(var g in f)b>0?f[g]=this.lineColors.fromPositive[g]+(this.lineColors.toPositive[g]-this.lineColors.fromPositive[g])*(b/e):f[g]=this.lineColors.fromNegative[g]+(this.lineColors.toNegative[g]-this.lineColors.fromNegative[g])*(b/d);f.h/=360;var h=c.hslToRgb(f.h,f.s,f.l);a.setAttribute("stroke","rgb("+h.join()+")")}},getSymbolForLegend:function(){if(!this.lineForLegend){var a=document.createElementNS(this.graph.ns,"ellipse");a.setAttribute("cx",7),a.setAttribute("cy",0),a.setAttribute("rx",8),a.setAttribute("ry",3),a.setAttribute("cursor","pointer"),this.lineForLegend=a}return this.applyLineStyle(this.lineForLegend,this.maxZ),this.lineForLegend},applyLineStyle:function(a,b){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()+(this.isSelected()?2:0)),this.getLineDashArray()&&a.setAttribute("stroke-dasharray",this.getLineDashArray()),a.setAttribute("fill","none"),this.setColorTo(a,void 0!==b?b:a.getAttribute("data-zvalue"),this.minZ,this.maxZ),this.hasStyleChanged(!1)},setShapeZoom:function(a){this._shapeZoom=a}}),d}(c["./series/graph.serie.line"],c["./graph.util"]),c["./series/graph.serie.line.broken"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{draw:function(a){if(a||this.hasDataChanged()){this.drawInit();this._dataToUse,this._xDataToUse,this._slotToUse;if(this.removeLinesGroup(),this.eraseMarkers(),this.lookForMaxima=!0,this.lookForMinima=!1,"x_equally_separated"==this.mode)throw"Not supported";this._draw_standard(),this.removeExtraLines(),this.insertLinesGroup()}this.hasStyleChanged(this.selectionType)&&this.updateStyle()},_draw_standard:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=this._dataToUse,n=0,o=m.length,p=0,q=1;for(this.isFlipped()&&(p=1,q=0);o>n;n++){for(a=!1,this.currentLine="",b=0,c=0,d=m[n].length;d>b;b+=2){e=m[n][b+p],f=m[n][b+q];var r=this.getXAxis().getRange?this.getXAxis().getRange(e):[1,this.getX(e)],s=this.getYAxis().getRange?this.getYAxis().getRange(f):[1,this.getY(f)];(r[0]!=g||s[0]!=h)&&void 0!==r[0]&&void 0!==s[0]&&b>0?(void 0!==g&&void 0!==h&&(this.break(i,j,k,l,e,f,c),this._createLine()),this.break(e,f,r[1],s[1],i,j,c),this._addPoint(r[1],s[1])):void 0==r[0]||void 0==s[0]&&g&&h?(this.break(i,j,k,l,e,f,c),this._createLine()):isNaN(r[1])||isNaN(s[1])||this._addPoint(r[1],s[1]),g=r[0],h=s[0],i=e,j=f,k=r[1],l=s[1]}this._createLine()}},break:function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o;this.getXAxis()._broken?(l=this.getXAxis().getBoundary(a,e),g=(l-a)/(e-c)):(g=1,j=e),this.getYAxis()._broken?(m=this.getYAxis().getBoundary(b,f),h=(m-b)/(f-b)):(h=1,k=f);var i=Math.min(h,g),e=i*(e-a)+a,f=i*(f-b)+b;return n=this.getXAxis()._broken?this.getXAxis().getInRange(a,e):this.getX(e),o=this.getYAxis()._broken?this.getYAxis().getInRange(b,f):this.getY(f),this._addPoint(n,o)}}),c}(c["./series/graph.serie.line"]),c["./series/graph.serie.scatter"]=function(a,c,d){var e=function(){};return e.prototype=new a,e.prototype.defaults={},e.prototype.init=function(a,d,f){var g=this;this.graph=a,this.name=d,this.id=Math.random()+Date.now(),this.shapes=[],this.shown=!0,this.options=b.extend(!0,{},e.prototype.defaults,f),this.data=[],this.shapesDetails=[],this.shapes=[],c.mapEventEmission(this.options,this),this._isMinOrMax={x:{min:!1,max:!1},y:{min:!1,max:!1}},this.groupPoints=document.createElementNS(this.graph.ns,"g"),this.groupMain=document.createElementNS(this.graph.ns,"g"),this.additionalData={},this.selectedStyleGeneral={},this.selectedStyleModifiers={},this.groupPoints.addEventListener("mouseover",function(a){var c=parseInt(b(a.target).parent().attr("data-shapeid"));g.emit("mouseover",c,g.data[2*c],g.data[2*c+1])}),this.groupPoints.addEventListener("mouseout",function(a){var c=parseInt(b(a.target).parent().attr("data-shapeid"));g.emit("mouseout",c,g.data[2*c],g.data[2*c+1])}),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.groupMain.appendChild(this.groupPoints),this.currentAction=!1,this.initExtended1&&this.initExtended1(),this.styles={},this.styles.unselected={},this.styles.selected={},this.styles.unselected.default={shape:"circle",cx:0,cy:0,r:3,stroke:"transparent",fill:"black"},this.styles.selected.default={shape:"circle",cx:0,cy:0,r:4,stroke:"transparent",fill:"black"}},e.prototype.setData=function(a,b,c){var d,e=0,b=b||"2D",c=c||"float",f=0;if(this.empty(),this.shapesDetails=[],this.shapes=[],!a instanceof Array)return this;a instanceof Array&&!(a[0]instanceof Array)&&(b="1D");var g="2D"==b;d=this._addData(c,g?2*a.length:a.length),e=0;for(var h=0,i=a.length;i>h;h++)g?(d[e]=a[h][0],this._checkX(d[e]),e++,d[e]=a[h][1],this._checkY(d[e]),e++,f++):(d[e]=a[h],this[h%2==0?"_checkX":"_checkY"](d[e]),e++,f+=h%2?1:0);return this.dataHasChanged(),this.graph.updateDataMinMaxAxes(),this.data=d,this},e.prototype.empty=function(){for(;this.groupPoints.firstChild;)this.groupPoints.removeChild(this.groupPoints.firstChild)},e.prototype.getSymbolForLegend=function(){if(this.symbol)return this.symbol;var a=document.createElementNS(this.graph.ns,"g");a.setAttribute("data-shapeid",-1);var b=this.doShape(a,this.styles.unselected.default),c=this.getStyle("unselected",-1,!0);for(var d in c[-1])"shape"!=d&&b.setAttribute(d,c[-1][d]);return a},e.prototype.setStyle=function(a,b,c){return"string"==typeof b&&(c=b,b=!1),void 0===c&&(c="unselected"),this.styles[c]=this.styles[c]||{},this.styles[c].all=a,this.styles[c].modifiers=b,this.styleHasChanged(c),this},e.prototype.draw=function(a){if(a||this.hasDataChanged()||this.hasStyleChanged("unselected")){var b,c,d,e,f=0;this._drawn=!0,this.dataHasChanged(!1),this.styleHasChanged(!1),this.groupMain.removeChild(this.groupPoints);var g=0,h=1;this.getFlip()&&(g=1,h=0);var i=(this.data.length/2,[]);for(f=0,d=0,e=this.data.length,this.error&&this.errorDrawInit();e>f;f+=2){b=this.getX(this.data[f+g]),c=this.getY(this.data[f+h]);this.data[f+h];this.error&&this.errorAddPoint(f,this.data[f+g],this.data[f+h],b,c),this.shapesDetails[f/2]=this.shapesDetails[f/2]||[],this.shapesDetails[f/2][0]=b,this.shapesDetails[f/2][1]=c,i.push(f/2)}this.error&&this.errorDraw(),this.applyStyle("unselected",i),this.groupMain.appendChild(this.groupPoints)}},e.prototype._addPoint=function(a,b,c){var d=document.createElementNS(this.graph.ns,"g");d.setAttribute("transform","translate("+a+", "+b+")"),d.setAttribute("data-shapeid",c),this.extraStyle&&this.extraStyle[c]?shape=this.doShape(d,this.extraStyle[c]):this.stdStylePerso?shape=this.doShape(d,this.stdStylePerso):shape=this.doShape(d,this.stdStyle),this.shapes[c]=shape,this.groupPoints.appendChild(d)},e.prototype.doShape=function(a,b){var c=document.createElementNS(this.graph.ns,b.shape);return a.appendChild(c),c},e.prototype.getStyle=function(a,c,d){var e,a=a||"unselected",f={};"number"==typeof c?e=[c]:Array.isArray(c)&&(e=c);var g,c,h,i,j;void 0!==this.styles[a].all&&(j=this.styles[a].all,"function"==typeof j?j=j():j===!1&&(j={}));for(var k=0,l=e.length;l>k;k++){if(c=e[k],g=this.shapes[c],(h=this.styles[a].modifiers)&&("function"==typeof h||h[c])){"function"==typeof h?i=h(c,g):h[c]&&(i=h[c]);var m=b.extend({},j,i);i=b.extend(i,m)}else i=void 0!==j?j:this.styles[a].default;if(!g){var n=document.createElementNS(this.graph.ns,"g");n.setAttribute("data-shapeid",c),this.shapes[c]=this.doShape(n,i),this.groupPoints.appendChild(n),g=this.shapes[c]}d||g.parentNode.setAttribute("transform","translate("+this.shapesDetails[c][0]+", "+this.shapesDetails[c][1]+")"),f[c]=i}return f},e.prototype.applyStyle=function(a,b,c){var d,e,f=this.getStyle(a,b,c);for(d in f)for(e in f[d])"shape"!==e&&(f[d][e]?this.shapes[d].setAttribute(e,f[d][e]):this.shapes[d].removeAttribute(e))},e.prototype.unselectPoint=function(a){this.selectPoint(a,!1)},e.prototype.selectPoint=function(a,b,c){if(!this.shapesDetails[a][2]||this.shapesDetails[a][2]!=c){if("string"==typeof b&&(c=b,b=void 0),Array.isArray(a))return this.selectPoints(a);if(this.shapes[a]&&this.shapesDetails[a])if(!this.shapesDetails[a][2]&&b!==!1||b===!0)c=c||"selected",this.shapesDetails[a][2]=c,this.applyStyle(c,a,!0);else{var d=this.shapesDetails[a][2];this.shapesDetails[a][2]=!1;var e=this.getStyle(d,a,!0);for(var f in e[a])this.shapes[a].removeAttribute(f);this.applyStyle("unselected",a,!0)}}},d.call(e.prototype),e}(c["./series/graph.serie"],c["./graph.util"],c["./mixins/graph.mixin.errorbars"]),c["./series/graph.serie.zone"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{defaults:{fillColor:"rgba( 0, 0, 0, 0.1 )",lineColor:"rgba( 0, 0, 0, 1 )",lineWidth:"1px"},init:function(a,d,e){this.graph=a,this.name=d,this.selectionType="unselected",this.id=Math.random()+Date.now(),this.shown=!0,this.options=b.extend(!0,{},c.prototype.defaults,e),this.data=[],this.groupZones=document.createElementNS(this.graph.ns,"g"),this.groupMain=document.createElementNS(this.graph.ns,"g"),this.lineZone=document.createElementNS(this.graph.ns,"path"),this.lineZone.setAttribute("stroke","black"),this.lineZone.setAttribute("stroke-width","1px"),this.additionalData={},this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE,this.groupMain.appendChild(this.groupZones),this.groupZones.appendChild(this.lineZone),this.currentAction=!1,this.applyLineStyle(this.lineZone),this.styleHasChanged()},setData:function(a,b,c){var d,e=0,b=b||"2D",c=c||"float",f=0;if(this.data=[],this.dataHasChanged(),!(!a instanceof Array)){var g;a instanceof Array&&!(a[0]instanceof Array)?(b="1D",g=1.5*a.length,a[1]instanceof Array||(b="1D_flat",g=1*a.length)):a instanceof Array&&!(a[0][1]instanceof Array)?(b="2D_flat",g=3*a.length):(b="2D",g=3*a.length),d=this._addData(c,g),e=0;for(var h=0,i=a.length;i>h;h++)if("2D"==b||"2D_flat"==b)d[e]=a[h][0],this._checkX(d[e]),e++,"2D"==b?(d[e]=a[h][1][0],this._checkY(d[e]),e++,f++,d[e]=a[h][1][1],this._checkY(d[e]),e++,f++):(d[e]=a[h][1],this._checkY(d[e]),e++,f++,d[e]=a[h][2],this._checkY(d[e]),e++,f++);else if("1D_flat"==b){if(h%3==0){d[e]=a[h],this._checkX(d[e]),e++,f++;continue}d[e]=a[h],this._checkY(d[e]),e++,f++}else{if(h%2==0){d[e]=a[h],this._checkX(d[e]),e++,f++;continue}d[e]=a[h][0],this_checkY(d[e]),e++,f++,d[e]=a[h][1],this_checkY(d[e]),e++,f++}return this.graph.updateDataMinMaxAxes(),this.data=d,this.dataHasChanged(),this}},_addData:function(a,b){switch(a){case"int":var c=4*b;break;case"float":var c=8*b}var d=new ArrayBuffer(c);switch(a){case"int":return new Int32Array(d);default:case"float":return new Float64Array(d)}},empty:function(){for(;this.group.firstChild;)this.group.removeChild(this.group.firstChild)},draw:function(a){if(a||this.hasDataChanged()){var b,c,d,e,f,g=0;this._drawn=!0,this.groupMain.removeChild(this.groupZones);this.data.length/2;g=0,e=0,f=this.data.length;for(var h,i=[],j=[];f>g;g+=3)if(b=this.getX(this.data[g]),c=this.getY(this.data[g+1]),d=this.getY(this.data[g+2]),0>b)h=[b,c,d];else if(h&&(i.push([b,Math.max(c,d)]),j.push([b,Math.min(c,d)]),h=!1,e++),d>c?(i.push([b,c]),j.push([b,d])):(i.push([b,d]),j.push([b,c])),b>this.getXAxis().getMaxPx())break;j.reverse(),i.length>0&&j.length>0?this.lineZone.setAttribute("d","M "+i[0]+" L "+i.join(" L ")+" L "+j.join(" L ")+" z"):this.lineZone.setAttribute("d",""),this.groupMain.appendChild(this.groupZones)}this.hasStyleChanged(this.selectionType)&&(this.applyLineStyle(this.lineZone),this.styleHasChanged(!1))},applyLineStyle:function(a){a.setAttribute("stroke",this.getLineColor()),a.setAttribute("stroke-width",this.getLineWidth()),a.setAttribute("fill",this.getFillColor()),a.setAttribute("fill-opacity",this.getFillOpacity()),a.setAttribute("stroke-opacity",this.getLineOpacity())},setLineWidth:function(a){return this.options.lineWidth=a,this.styleHasChanged(),this},getLineWidth:function(){return this.options.lineWidth},setLineOpacity:function(a){return this.options.lineOpacity=a,this.styleHasChanged(),this},getLineOpacity:function(){return this.options.lineOpacity},setLineColor:function(a){return this.options.lineColor=a,this.styleHasChanged(),this},getLineColor:function(){return this.options.lineColor},setFillOpacity:function(a){return this.options.fillOpacity=a,this.styleHasChanged(),this},getFillOpacity:function(){return this.options.fillOpacity},setFillColor:function(a){return this.options.fillColor=a,this.styleHasChanged(),this},getFillColor:function(){return this.options.fillColor},getMax:function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=-(1/0);if(i||(g=this.minX,i=this.searchClosestValue(g)),j||(h=this.maxX,j=this.searchClosestValue(h)),!i||!j)return-(1/0);for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=3)k=Math.max(k,this.data[c][d+1],this.data[c][d+2]);return k},getMin:function(a,b){var c,d,e,f,g=Math.min(a,b),h=Math.max(a,b),i=this.searchClosestValue(g),j=this.searchClosestValue(h),k=1/0;if(i||(g=this.minX,i=this.searchClosestValue(g)),j||(h=this.maxX,j=this.searchClosestValue(h)),!i||!j)return 1/0;for(c=i.dataIndex;c<=j.dataIndex;c++)for(e=c==i.dataIndex?i.xBeforeIndexArr:0,f=c==j.dataIndex?j.xBeforeIndexArr:this.data[c].length,d=e;f>=d;d+=3)k=Math.min(k,this.data[c][d+1],this.data[c][d+2]);return k},searchClosestValue:function(a){for(var b,c=0;c<this.data.length;c++){if(a<=this.data[c][this.data[c].length-3]&&a>=this.data[c][0])b=this._searchBinary(a,this.data[c],!1);else{if(!(a>=this.data[c][this.data[c].length-3]&&a<=this.data[c][0]))continue;b=this._searchBinary(a,this.data[c],!0)}return{dataIndex:c,xMin:this.data[c][b],xMax:this.data[c][b+3],yMin:this.data[c][b+1],yMax:this.data[c][b+4],xBeforeIndex:b/3,xAfterIndex:b/3+1,xBeforeIndexArr:b,xClosest:(Math.abs(this.data[c][b+3]-a)<Math.abs(this.data[c][b]-a)?b+3:b)/2}}},_searchBinary:function(a,b,c){var d=0,e=b.length,f=e-3;if(b[d]==a)return d;if(b[f]==a)return f;for(var g,h=0;;){if(h++,h>100)throw"Error loop";if(g=(d+f)/3,g-=g%3,g==d||b[g]==a)return g;b[g]<=a?c?f=g:d=g:b[g]>a&&(c?d=g:f=g)}}}),c}(c["./series/graph.serie"]),c["./shapes/graph.shape"]=function(a,c,d){function e(a){var c=parseInt(a.target.getAttribute("data-label-i"));c&&self.isLabelEditable(c)&&(a.preventDefault(),a.stopPropagation(),b('<input type="text" />').attr("value",self.getProp("labelText",c)).prependTo(self.graph._dom).css({position:"absolute","margin-top":parseInt(a.target.getAttribute("y").replace("px",""))-10+"px","margin-left":parseInt(a.target.getAttribute("x").replace("px",""))-50+"px",textAlign:"center",width:"100px"}).bind("blur",function(){b(this).remove(),self.setLabelText(b(this).setProp("value"),c),self._labels[c].textContent=b(this).setProp("value"),self.triggerChange()}).bind("keyup",function(a){a.stopPropagation(),a.preventDefault(),13==a.keyCode&&b(this).trigger("blur")}).bind("keypress",function(a){a.stopPropagation()}).bind("keydown",function(a){a.stopPropagation()}).focus().get(0).select())}var f=function(){};return f.prototype=new d,f.prototype.init=function(a){var b=this;if(this.graph=a,this.properties={},this.handles=[],this.options=this.options||{},this.group=document.createElementNS(this.graph.ns,"g"),this._selected=!1,this.createDom(),this.setEvents(),this._dom&&(this._dom.jsGraphIsShape=this),this.group.jsGraphIsShape=this,this.classes=[],this.transforms=[],this._data.masker){var c=document.createElementNS(this.graph.ns,"mask");this.maskingId=Math.random(),c.setAttribute("id",this.maskingId),this.maskDomWrapper=document.createElementNS(this.graph.ns,"rect"),this.maskDomWrapper.setAttribute("fill","white"),c.appendChild(this.maskDomWrapper);var d=this._dom.cloneNode();c.appendChild(d),this.maskDom=d,this.graph.defs.appendChild(c)}return this.group&&(this._dom&&this.group.appendChild(this._dom),this.group.addEventListener("mouseover",function(a){b.handleMouseOver(a)}),this.group.addEventListener("mouseout",function(a){b.handleMouseOut(a)}),this.group.addEventListener("mousedown",function(a){b.graph.focus(),b.handleMouseDown(a)}),this.group.addEventListener("click",function(a){b.handleClick(a)}),this.group.addEventListener("dblclick",function(a){b.handleDblClick(a)})),this.initImpl(),this.graph.emit("shapeNew",this),this},f.prototype.initImpl=function(){},f.prototype.getData=function(){return this._data},f.prototype.getType=function(){return this.type},f.prototype.kill=function(a){this.graph.removeShapeFromDom(this),a||this.graph._removeShape(this),this.graph.stopElementMoving(this),this.graph.emit("shapeRemoved",this),this._inDom=!1},f.prototype.remove=f.prototype.kill,f.prototype.hide=function(){return this.hidden?void 0:(this.hidden=!0,this.group.style.display="none",this)},f.prototype.show=function(){return this.hidden?(this.hidden=!1,this.group.style.display="block",this.redraw(),this):void 0},f.prototype.addClass=function(a){return this.classes=this.classes||[],-1==this.classes.indexOf(a)&&this.classes.push(a),this.makeClasses(),this},f.prototype.removeClass=function(a){return this.classes.splice(this.classes.indexOf(a),1),this.makeClasses(),this},f.prototype.makeClasses=function(){return this._dom&&this._dom.setAttribute("class",this.classes.join(" ")),this},f.prototype.changed=function(){return this.graph.emit("shapeChanged",this),this},f.prototype.setEvents=function(){},f.prototype.setEventReceptacle=function(){this.rectEvent||(this.rectEvent=document.createElementNS(this.graph.ns,"rect"),this.rectEvent.setAttribute("pointer-events","fill"),this.rectEvent.setAttribute("fill","transparent"),this.group.appendChild(this.rectEvent),this.rectEvent.jsGraphIsShape=this);var a=this.group.getBBox();this.rectEvent.setAttribute("x",a.x),this.rectEvent.setAttribute("y",a.y-10),this.rectEvent.setAttribute("width",a.width),this.rectEvent.setAttribute("height",a.height+20)},f.prototype.setSerie=function(a){return this.serie=a,this.xAxis=a.getXAxis(),this.yAxis=a.getYAxis(),this},f.prototype.getSerie=function(){return this.serie},f.prototype.autoAxes=function(){return this.xAxis||(this.xAxis=this.graph.getXAxis()),this.yAxis||(this.yAxis=this.graph.getYAxis()),this},f.prototype.setXAxis=function(a){return this.xAxis=a,this},f.prototype.setYAxis=function(a){this.yAxis=a},f.prototype.getXAxis=function(){return this.xAxis||this.autoAxes(),this.xAxis},f.prototype.getYAxis=function(){return this.yAxis||this.autoAxes(),this.yAxis},f.prototype.setLayer=function(a){return this.setProp("layer",a),this},f.prototype.getLayer=function(){var a=this.getProp("layer");return void 0!==a?a:1},f.prototype.draw=function(a){return this._inDom&&!a||(this.appendToDom(),this._inDom=!0),this.makeLabels(),this.redraw(),this.applyStyle(),this},f.prototype.redraw=function(){return!this.hidden&&(this.position=this.applyPosition(),this.redrawImpl(),this.position)?(this.updateLabels(),this._applyTransforms(),this):void 0},f.prototype.redrawImpl=function(){},f.prototype.setProperties=function(b){this.properties=b,Array.isArray(this.properties.position)||(this.properties.position=[this.properties.position]);for(var c=0,d=this.properties.position.length;d>c;c++){var e=this,f=a.check(this.properties.position[c],function(a){return e.getRelativePosition(a)});this.properties.position[c]=f}return this.emit("propertiesChanged"),this},f.prototype.getRelativePosition=function(a){var b;return null!==(b=/position([0-9]*)/.exec(a))?this.getPosition(b[1]):null!==(b=/labelPosition([0-9]*)/.exec(a))?this.getLabelPosition(b[1]):void 0},f.prototype.getProperties=function(a){return this.properties},f.prototype.setProp=function(a,b,c){return this.properties=this.properties||{},this.properties[a]=this.properties[a]||[],this.properties[a][c||0]=b,this.emit("propertyChanged",a),this},f.prototype.getProp=function(a,b){return(this.properties[a]||[])[b||0]},f.prototype.addProp=function(a,b){this.properties[a]=this.properties[a]||[],this.properties[a].push(b)},f.prototype.resetProp=function(a){this.properties[a]=[]},Object.defineProperty(f.prototype,"setDom",{enumerable:!0,writable:!1,configurable:!1,value:function(a,b){this._dom&&this._dom.setAttribute(a,b)}}),Object.defineProperty(f.prototype,"setDomGroup",{enumerable:!0,writable:!1,configurable:!1,value:function(a,b){this.group&&this.group.setAttribute(a,b)}}),f.prototype.setStrokeColor=function(a){return this.setProp("strokeColor",a),this},f.prototype.getStrokeColor=function(){return this.getProp("strokeColor")},f.prototype.setFillColor=function(a){return this.setProp("fillColor",a),this},f.prototype.getFillColor=function(){return this.getProp("fillColor")},f.prototype.setFillOpacity=function(a){return this.setProp("fillOpacity",a),this},f.prototype.setStrokeWidth=function(a){return this.setProp("strokeWidth",a),this},f.prototype.getStrokeWidth=function(){return this.getProp("strokeWidth")},f.prototype.setStrokeDasharray=function(a){return this.setProp("strokeDasharray",a),this},f.prototype.setAttributes=function(a){return this.setProp("attributes",a),this},f.prototype.addTransform=function(a,b){return this.addProp("transforms",{type:a,arguments:Array.isArray(b)?b:[b]}),this},f.prototype.resetTransforms=function(){return this.resetProp("transforms"),this},f.prototype.setLabelText=function(a,b){return this.setProp("labelText",a,b||0),this},f.prototype.displayLabel=function(a){return this.setProp("labelVisible",!0,a||0),this},f.prototype.showLabel=f.prototype.displayLabel,f.prototype.hideLabel=function(a){return this.setProp("labelVisible",!1,a||0),this},f.prototype.setLabelColor=function(a,b){return this.setProp("labelColor",a,b||0),this},f.prototype.setLabelFontSize=function(a,b){return this.setProp("labelFontSize",a,b||0),this},f.prototype.getLabelPosition=function(a){return this.getProp("labelPosition",a||0)},f.prototype.setLabelPosition=function(b,c){var d,e=a.check(b,function(a){return d.getRelativePosition(a)});return this.setProp("labelPosition",e,c||0),this},f.prototype.setLabelAngle=function(a,b){return this.setProp("labelAngle",a,b||0),this},f.prototype.setLabelBaseline=function(a,b){return this.setProp("labelBaseline",a,b||0),this},f.prototype.setLabelAnchor=function(a,b){return this.setProp("labelAnchor",a,b||0),this},f.prototype.setLabelSize=function(a,b){return this.setProp("labelSize",a,b||0),this},f.prototype.applyGenericStyle=function(){this.setDom("fill",this.getProp("fillColor")),this.setDom("fill-opacity",this.getProp("fillOpacity")),this.setDom("stroke",this.getProp("strokeColor")),this.setDom("stroke-width",this.getProp("strokeWidth")),this.setDom("stroke-dasharray",this.getProp("strokeDasharray"));var a=this.getProp("attributes")||{};for(var b in a)this.setDom(b,"function"==typeof a[b]?a[b].call(this,b):a[b]);return this._applyTransforms(),this},f.prototype.applyStyle=function(){return this.applyGenericStyle()},f.prototype.calculatePosition=function(b){var c;return(c=b instanceof a?b:this.getPosition(b))?c&&c.compute?c.compute(this.graph,this.getXAxis(),this.getYAxis(),this.getSerie()):void this.graph.throw():void 0},f.prototype.computePosition=f.prototype.calculatePosition,f.prototype.getPosition=function(b){var c=this.getProp("position",b||0);return this.setProp("position",c=a.check(c),b),c},f.prototype.setPosition=function(b,c){var d=this,e=a.check(b,function(a){return d.getRelativePosition(a)});return this.setProp("position",e,c||0)},f.prototype._applyTransforms=function(){var b=this.getProp("transforms"),c="";if(b&&(b=Array.isArray(b)?b:[b],0!=b.length)){for(var d=0;d<b.length;d++){switch(c+=b[d].type+"(",b[d].type){case"translate":c+=a.getDeltaPx(b[d].arguments[0],this.getXAxis()).replace("px",""),c+=", ",c+=a.getDeltaPx(b[d].arguments[1],this.getYAxis()).replace("px","");break;case"rotate":if(c+=b[d].arguments[0],c+=", ",1==this.transforms[d].arguments.length){var e=this.getPosition(0);c+=e.x+", "+e.y}else c+=a.getDeltaPx(b[d].arguments[1],this.getXAxis()).replace("px",""),c+=", ",c+=a.getDeltaPx(b[d].arguments[2],this.getYAxis()).replace("px","")}c+=") "}return this.setDomGroup("transform",c),this}},f.prototype.makeLabels=function(){var a=this;this._labels=this._labels||[],this._labels.map(function(b){a.group.removeChild(b)}),this._labels=[];for(var b=0;this.getProp("labelText",b);)a._labels[b]||(a._labels[b]=document.createElementNS(a.graph.ns,"text"),a._labels[b].setAttribute("data-label-i",b),a._labels[b].jsGraphIsShape=a,a.group.appendChild(this._labels[b])),b++;return this.updateLabels(),this},f.prototype.isLabelEditable=function(a){return this.getProp("labelEditable",a)},f.prototype.updateLabels=function(){this._labels=this._labels||[];for(var a=0,b=this._labels.length;b>a;a++)this._applyLabelData(a),this._labels[a].removeEventListener("dblclick",e),this._labels[a].addEventListener("dblclick",e)},f.prototype._applyLabelData=function(b){b=b||0;var c=this.getProp("labelVisible",b);if(!c)return void this._labels[b].setAttribute("display","none");this._labels[b].setAttribute("display","initial");var d=this.calculatePosition(a.check(this.getProp("labelPosition",b)));if(!isNaN(d.x)&&!isNaN(d.y)){"NaNpx"==d.x||isNaN(d.x)||"NaN"===d.x||d.x===!1||(this._labels[b].setAttribute("x",d.x),this._labels[b].setAttribute("y",d.y));var e=this.getProp("labelAngle",b)||0;if(0!=e){var f=this._labels[b].getAttribute("x"),g=this._labels[b].getAttribute("y");this._labels[b].setAttribute("transform","rotate("+e+" "+f+" "+g+")")}return this._labels[b].setAttribute("dominant-baseline",this.getProp("labelBaseline",b)||"no-change"),
this._labels[b].textContent=this.getProp("labelText",b),this._labels[b].setAttribute("fill",this.getProp("labelColor",b)||"black"),this._labels[b].setAttribute("font-size",this.getProp("labelSize",b)+"px"||"12px"),this._labels[b].setAttribute("text-anchor",this._getLabelAnchor(b)),this}},f.prototype._getLabelAnchor=function(a){var b=this.getProp("labelAnchor",a);switch(b){case"middle":case"start":case"end":return b;case"right":return"end";case"left":return"start";default:return"start"}},f.prototype.isSelected=function(){return this._selectStatus||!1},f.prototype.hasHandles=function(a){return void 0!==a&&this.setProp("handles",a),!!this.getProp("handles")||!!this.getProp("statichandles")},f.prototype.addHandles=function(){if(!this.isLocked()){if(!this.handlesInDom){this.handlesInDom=!0;for(var a=1;a<this.handles.length;a++)this.handles[a]&&this.group.appendChild(this.handles[a])}return this}},f.prototype.removeHandles=function(){this.hideHandles(),this.handles=[]},f.prototype.hideHandles=function(){if(!this.handlesInDom)return this;for(var a=1;a<this.handles.length;a++)this.group.removeChild(this.handles[a]);return this.handlesInDom=!1,this},f.prototype.areHandlesInDom=function(){return this.handlesInDom},f.prototype._select=function(a){if(!this.isSelectable())return!1;this.appendToDom(),this._selectStatus=!0;var b=this.getSelectStyle(),d={};for(var e in b)"function"==typeof b[e]?d[e]=b[e].call(this):d[e]=b[e];c.saveDomAttributes(this._dom,d,"select"),this.hasHandles()&&!this.hasStaticHandles()&&(this.addHandles(),this.setHandles()),a||this.graph.emit("shapeSelected",this)},f.prototype._unselect=function(a){this._selectStatus=!1,c.restoreDomAttributes(this._dom,"select"),this.hasHandles()&&!this.hasStaticHandles()&&this.hideHandles(),a||this.graph.emit("shapeUnselected",this)},f.prototype.getSelectStyle=function(){return this.selectStyle},f.prototype.setSelectStyle=function(a){return this.selectStyle=a,this},f.prototype.setStaticHandles=function(a){this.setProp("staticHandles",a)},f.prototype.hasStaticHandles=function(a){return!!this.getProp("staticHandles")},f.prototype._createHandles=function(a,b,c,d){if(!(this.handles&&this.handles.length>0)){for(var e=1,f=a;f>=e;e++)(function(a){var e=this,f=document.createElementNS(e.graph.ns,b);if(f.jsGraphIsShape=!0,c)for(var g in c)f.setAttribute(g,c[g]);f.addEventListener("mousedown",function(b){e.isResizable()&&(b.preventDefault(),b.stopPropagation(),e.graph.emit("beforeShapeResize",e),e.graph.prevent(!1)||(e.resizing=!0,e.handleSelected=a,e.handleMouseDown(b)))}),d&&d(e.handles[a]),e.handles[a]=f}).call(this,e);return this.handles}},f.prototype.createHandles=function(){},f.prototype.handleMouseDownImpl=function(){},f.prototype.handleMouseMoveImpl=function(){},f.prototype.handleMouseUpImpl=function(){},f.prototype.handleCreateImpl=function(){},f.prototype.handleMouseDown=function(a){return this.isLocked()?void 0:((this.isMovable()||this.isResizable())&&this.graph.elementMoving(this),this.getProp("selectOnMouseDown")&&this.graph.selectShape(this),this.isMovable()&&(this.resizing||(this.graph.emit("beforeShapeMove",self),this.graph.prevent(!1)||(this.moving=!0))),this._mouseCoords=this.graph._getXY(a),this.handleMouseDownImpl(a,this._mouseCoords))},f.prototype.handleClick=function(a){return this.getProp("selectOnClick")&&this.graph.selectShape(this),this.isSelectable()?(a.shiftKey||this.graph.unselectShapes(),void this.graph.selectShape(this)):!1},f.prototype.handleMouseMove=function(a){if(!this.resizing&&!this.moving||this.isSelected()||this.graph.selectShape(this),this.graph.emit("beforeShapeMouseMove",this),this.graph.prevent(!1)||!this._mouseCoords)return!1;var b=this.graph._getXY(a),c=this.getXAxis().getRelVal(b.x-this._mouseCoords.x),d=this.getYAxis().getRelVal(b.y-this._mouseCoords.y);0==c&&0===d||(this.preventUnselect=!0),this._mouseCoords=b;var e=this.handleMouseMoveImpl(a,c,d,b.x-this._mouseCoords.x,b.y-this._mouseCoords.y);return e},f.prototype.handleMouseUp=function(a){return this.moving&&this.graph.emit("shapeMoved",this),(this.handleSelected||this.resize)&&this.graph.emit("shapeResized",this),this.moving=!1,this.resizing=!1,this.handleSelected=!1,this.graph.elementMoving(!1),this.handleMouseUpImpl(a)},f.prototype.handleDblClick=function(a){},f.prototype.handleMouseOver=function(){this.getProp("highlightOnMouseOver")&&(this.moving||this.resizing||this.highlight()),this.graph.emit("shapeMouseOver",this)},f.prototype.handleMouseOut=function(){this.getProp("highlightOnMouseOver")&&this.unHighlight(),this.graph.emit("shapeMouseOut",this)},f.prototype.lock=function(){return this.setProp("locked",!0),this},f.prototype.unlock=function(){return this.setProp("locked",!1),this},f.prototype.isLocked=function(){return this.getProp("locked")||this.graph.shapesLocked},f.prototype.movable=function(a){this.setProp("movable",!0)},f.prototype.unmovable=function(){return this.setProp("movable",!1),!1},f.prototype.isMovable=function(){return this.getProp("movable")},f.prototype.resizable=function(){this.setProp("resizable",!0)},f.prototype.unresizable=function(){this.setProp("resizable",!1)},f.prototype.isResizable=function(){return this.getProp("resizable")},f.prototype.selectable=function(){this.setProp("selectable",!0)},f.prototype.unselectable=function(){this.graph.unselectShape(this),this.setProp("selectable",!1)},f.prototype.isSelectable=function(){return this.getProp("selectable")},f.prototype.highlight=function(a,b){return a||(a=this.getHighlightAttributes()),b||(b="highlight"),c.saveDomAttributes(this._dom,a,b),this.highlightImpl(),this},f.prototype.unHighlight=function(a){return a||(a="highlight"),c.restoreDomAttributes(this._dom,a),this.unHighlightImpl(),this},f.prototype.highlightImpl=function(){},f.prototype.unHighlightImpl=function(){},f.prototype.getHighlightAttributes=function(){return this._highlightAttributes},f.prototype.setHighlightAttributes=function(a){return this._highlightAttributes=a,this},f.prototype.getMaskingID=function(){return this.maskingId},f.prototype.maskWith=function(a){var b;(b=a.getMaskingID())?this._dom.setAttribute("mask","url(#"+b+")"):this._dom.removeAttribute("mask")},f.prototype.updateMask=function(){return},f.prototype.appendToDom=function(){return this._forcedParentDom?this._forcedParentDom.appendChild(this.group):this.graph.appendShapeToDom(this),this},f.prototype.forceParentDom=function(a){return this._forcedParentDom=a,this},f}(c["./graph.position"],c["./graph.util"],c["./dependencies/eventEmitter/EventEmitter"]),c["./shapes/graph.shape.areaundercurve"]=function(a){var c=function(a){};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"path")},createHandles:function(){this._createHandles(2,"line",{"stroke-width":"3",stroke:"transparent","pointer-events":"stroke",cursor:"ew-resize"})},handleMouseMoveImpl:function(a,b,c){if(!this.isLocked()){if(this.moving)this.getPosition(0).deltaPosition("x",b,this.getXAxis()),this.getPosition(1).deltaPosition("x",b,this.getXAxis());else if(this.serie&&this.handleSelected){this.resizingPosition=1==this.handleSelected?this.getPosition(0):this.getPosition(1);var d=this.serie.searchClosestValue(this.getXAxis().getVal(this.graph._getXY(a).x-this.graph.getPaddingLeft()));if(!d)return;this.resizingPosition.x!=d.xMin&&(this.preventUnselect=!0),this.resizingPosition.x=d.xMin}else this.handleSelected&&(this.resizingPosition=1==this.handleSelected?this.getPosition(0):this.getPosition(1),this.resizingPosition.deltaPosition("x",b,this.getXAxis()));this.applyPosition()}},applyPosition:function(){if(this.serie){var a=this.computePosition(0),b=this.computePosition(1),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);if(2>c||0>d+c||d>this.graph.getDrawingWidth())return this.setDom("d",""),!1;var e,f,g,h,i,j,d,k,l=this.serie.searchClosestValue(this.getPosition(0).x),m=this.serie.searchClosestValue(this.getPosition(1).x),n=0,o=Number.MAX_VALUE;if(!l||!m)return!1;for(l.xBeforeIndex>m.xBeforeIndex&&(e=l,l=m,m=e),this.counter=0,f=l.dataIndex;f<=m.dataIndex;f++){for(this.currentLine="",h=f==l.dataIndex?l.xBeforeIndexArr:0,i=f==m.dataIndex?m.xBeforeIndexArr:this.serie.data[f].length,j=0,h==i&&i++,g=h;i>=g;g+=2)d=this.serie.getX(this.serie.data[f][g+0]),k=this.serie.getY(this.serie.data[f][g+1]),n=Math.max(this.serie.data[f][g+1],n),o=Math.min(this.serie.data[f][g+1],o),g==h&&(this.firstX=d,this.firstY=k),j>0?this.currentLine+=" L "+d+" "+k+" ":this.currentLine+=" M "+d+" "+k+" ",j++;if(this.lastX=d,this.lastY=k,!(this.firstX&&this.firstY&&this.lastX&&this.lastY))return;this.currentLine+=" V "+this.getYAxis().getPx(0)+" H "+this.firstX+" z",this.setDom("d",this.currentLine)}return this.maxY=this.serie.getY(n),this.setHandles(),!0}},setHandles:function(){if(this.firstX){var a=this.computePosition(0),b=this.computePosition(1);a.x<b.x?(this.handles[1].setAttribute("x1",this.firstX),this.handles[1].setAttribute("x2",this.firstX),this.handles[2].setAttribute("x1",this.lastX),this.handles[2].setAttribute("x2",this.lastX)):(this.handles[1].setAttribute("x1",this.lastX),this.handles[1].setAttribute("x2",this.lastX),this.handles[2].setAttribute("x1",this.firstX),this.handles[2].setAttribute("x2",this.firstX)),this.handles[1].setAttribute("y1",this.getYAxis().getMaxPx()),this.handles[1].setAttribute("y2",this.serie.getY(0)),this.handles[2].setAttribute("y1",this.getYAxis().getMaxPx()),this.handles[2].setAttribute("y2",this.serie.getY(0))}}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.line"]=function(a){var b=function(a,b){};return b.prototype=new a,b.prototype.createDom=function(){this._dom=document.createElementNS(this.graph.ns,"line"),this.setStrokeColor("black"),this.setStrokeWidth(1)},b.prototype.createHandles=function(){this._createHandles(2,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})},b.prototype.applyPosition=function(){var a=this.calculatePosition(0),b=this.calculatePosition(1);return a&&a.x&&a.y?(this.setDom("x2",a.x),this.setDom("y2",a.y),this.setDom("y1",b.y),this.setDom("x1",b.x),this.currentPos2x=b.x,this.currentPos2y=b.y,this.currentPos1x=a.x,this.currentPos1y=a.y,!0):void 0},b.prototype.handleMouseMoveImpl=function(a,b,c,d,e){if(!this.isLocked()){var f,g=this.getPosition(0),h=this.getPosition(1);if(1==this.handleSelected?f=g:2==this.handleSelected&&(f=h),f&&(this._data.vertical||f.deltaPosition("x",b,this.getXAxis()),this._data.horizontal||f.deltaPosition("y",c,this.getYAxis())),this.moving&&(g.x&&g.deltaPosition("x",b,this.getXAxis()),g.y&&g.deltaPosition("y",c,this.getYAxis()),h.x&&h.deltaPosition("x",b,this.getXAxis()),h.y&&h.deltaPosition("y",c,this.getYAxis())),this._data.forcedCoords){var i=this._data.forcedCoords;void 0!==i.y&&("function"==typeof i.y?h.y=g.y=i.y(this):(h.y=i.y,g.y=i.y)),void 0!==i.x&&("function"==typeof i.x?h.x=g.x=i.x(this):(h.x=i.x,g.x=i.x))}return this.rectEvent&&this.setEventReceptacle(),this.redraw(),this.changed(),this.setHandles(),!0}},b.prototype.setHandles=function(){this.areHandlesInDom()&&(isNaN(this.currentPos1x)||(this.handles[1].setAttribute("x",this.currentPos1x),this.handles[1].setAttribute("y",this.currentPos1y),this.handles[2].setAttribute("x",this.currentPos2x),this.handles[2].setAttribute("y",this.currentPos2y)))},b.prototype.setEventReceptacle=function(){this.currentPos1x&&(this.rectEvent||(this.rectEvent=document.createElementNS(this.graph.ns,"line"),this.rectEvent.setAttribute("pointer-events","stroke"),this.rectEvent.setAttribute("stroke","transparent"),this.rectEvent.jsGraphIsShape=this,this.group.appendChild(this.rectEvent)),this.rectEvent.setAttribute("x1",this.currentPos1x),this.rectEvent.setAttribute("y1",this.currentPos1y),this.rectEvent.setAttribute("x2",this.currentPos2x),this.rectEvent.setAttribute("y2",this.currentPos2y),this.rectEvent.setAttribute("stroke-width",this.getProp("strokeWidth")+2))},b}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.arrow"]=function(a){var b=function(a){};return b.prototype=new a,b.prototype.createDom=function(){this._dom=document.createElementNS(this.graph.ns,"line"),this._dom.setAttribute("marker-end","url(#arrow"+this.graph._creation+")"),this._createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"}),this.setStrokeColor("black"),this.setStrokeWidth(1)},b}(c["./shapes/graph.shape.line"]),c["./shapes/graph.shape.ellipse"]=function(a){var c=function(a,b){};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"ellipse")},applyPosition:function(){var a=this.computePosition(0);return this.setDom("cx",a.x||0),this.setDom("cy",a.y||0),this.setDom("rx",this.getProp("rx")||0),this.setDom("ry",this.getProp("ry")||0),!0},handleMouseUpImpl:function(){this.triggerChange()},handleMouseMoveImpl:function(a,b,c,d,e){}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.label"]=function(a){var c=function(a,b){this.selectStyle={stroke:"red"}};return c.prototype=new a,b.extend(c.prototype,a.prototype,{createDom:function(){return!1},applyPosition:function(){return!0}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.nmrintegral"]=function(a,c){var d=function(a,b){this.nbHandles=2};return b.extend(d.prototype,a.prototype,{applyPosition:function(){var a,b,d=this.calculatePosition(0),e=this.calculatePosition(1),f=this.getAxis(),g=this.yBaseline||30;if(d&&e){if(this.serie.isFlipped()?(g=this.getXAxis().getPx(0)-g,a=Math.abs(d.y-e.y),b=Math.min(d.y,e.y)):(g=this.getYAxis().getPx(0)-g,a=Math.abs(d.x-e.x),b=Math.min(d.x,e.x)),this.computedBaseline=g,this.reversed=b==e.x,"x"==f){if(2>a||0>b+a||b>this.graph.getDrawingWidth())return!1}else if(2>a||0>b+a||b>this.graph.getDrawingHeight())return!1;var h,i,j,k,l,m,b,n,o,p,q=this.getPosition(0),r=this.getPosition(1),s=this.serie.searchClosestValue(q[f]),t=this.serie.searchClosestValue(r[f]),u="",v=0,w=1,x=0;Number.MAX_VALUE;if(!s||!t)return!1;s.xBeforeIndex>t.xBeforeIndex&&(h=s,s=t,t=h);var o,p,y,z,A,B,C,D,E,F=0,G=(this.scaling,[]);for(this.serie.isFlipped()&&(w=0,x=1),i=s.dataIndex;i<=t.dataIndex;i++){for(k=i==s.dataIndex?s.xBeforeIndexArr:0,l=i==t.dataIndex?t.xBeforeIndexArr:this.serie.data[i].length,m=0,j=k;l>=j;j+=2){if(b=this.serie.getX(this.serie.data[i][j+x]),n=this.serie.getY(this.serie.data[i][j+w]),this.serie.isFlipped()){var H=b;b=n,n=H}o||(o=b,p=n,A=this.serie.data[i][j+x],B=this.serie.data[i][j+w]),void 0!=y?(F+=(this.serie.data[i][j+x]-C)*this.serie.data[i][j+w]*.5,b==y&&n==z||(C=this.serie.data[i][j+x],y=b,z=n,G.push([b,F]),m++)):(y=b,z=n,C=this.serie.data[i][j+x],D=this.serie.data[i][j+w])}if(this.lastX=b,this.lastY=n,!(o&&p&&this.lastX&&this.lastY))return}0==F&&(F=1),this.maxPx=this._data.maxPx||50,this.ratio||(this.ratio=1);for(var I=this.maxIntegration||F,i=0,J=G.length;J>i;i++)G[i][1]=g-G[i][1]/F*this.maxPx*(F/I)*this.ratio,0==i&&(this.firstPointY=G[i][1]),u+=" L "+G[i][x]+", "+G[i][w]+" ",this.lastPointY=G[i][1];this.points=G,this.lastSum=Math.abs(F);var z=p,y=this.lastX;return E=Math.min(20,y-o),u=this.serie.isFlipped()?" M "+g+", "+o+" "+u:" M "+o+", "+g+" "+u,this.setDom("d",u),this.firstX=o,this.firstY=p,this.maxY=this.serie.getY(v),this._selected&&this.select(),this.setLabelPosition(new c({x:(q.x+r.x)/2,y:(this.firstPointY+this.lastPointY)/2+"px"})),this.setHandles(),!0}},getAxis:function(){return this._data.axis||"x"},setScale:function(a,b){this.maxPx=a,this.maxIntegration=b},setYBaseline:function(a){this.yBasline=a},selectStyle:function(){this.setDom("stroke-width","2px")},selectHandles:function(){},setHandles:function(){this._selected&&void 0!=this.points&&(this.addHandles(),this.handle1.setAttribute("x",this.points[0][0]),this.handle1.setAttribute("y",this.points[0][1]),this.handle2.setAttribute("x",this.points[this.points.length-1][0]-1),this.handle2.setAttribute("y",this.points[this.points.length-1][1]))}}),d}(c["./shapes/graph.shape.areaundercurve"],c["./graph.position"]),c["./shapes/graph.shape.rect"]=function(a,b){var c=function(a,b){};return c.prototype=new a,c.prototype.createDom=function(){return this._dom=document.createElementNS(this.graph.ns,"rect"),this.setStrokeColor("black"),this.setStrokeWidth(1),this.setFillColor("transparent"),this},c.prototype.createHandles=function(){if(this.hasHandles()){var a=this.getProp("handles");switch("object"!=typeof a&&(a={}),a.type||(a.type="corners"),a.type){case"sides":b.extend(a,{sides:{top:!0,bottom:!0,left:!0,right:!0}});var c=0;for(var d in a.sides)a.sides[d]&&c++;this._createHandles(c,"g").map(function(a){var b=document.createElementNS(self.graph.ns,"rect");b.setAttribute("x","-3"),b.setAttribute("width","6"),b.setAttribute("y","-6"),b.setAttribute("height","12"),b.setAttribute("stroke","black"),b.setAttribute("fill","white"),b.setAttribute("cursor","pointer"),a.appendChild(b)});var c=1;for(var d in a.sides)a.sides[d]&&(this.handles[d]=this["handle"+c],this.sides[c]=d,c++);break;case"corners":this._createHandles(4,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white"}),this.handles&&(this.handles[2].setAttribute("cursor","nesw-resize"),this.handles[4].setAttribute("cursor","nesw-resize"),this.handles[1].setAttribute("cursor","nwse-resize"),this.handles[3].setAttribute("cursor","nwse-resize"))}return this}},c.prototype.applyPosition=function(){var a,b,c,d,e=this.computePosition(0),f=this.computePosition(1);return e.x<f.x?(a=e.x,c=f.x-e.x):(a=f.x,c=e.x-f.x),e.y<f.y?(b=e.y,d=f.y-e.y):(b=f.y,d=e.y-f.y),this.currentX=a,this.currentY=b,this.currentW=c,this.currentH=d,isNaN(a)||isNaN(b)||a===!1||b===!1?!1:(this.setDom("width",c),this.setDom("height",d),this.setDom("x",a),this.setDom("y",b),this.setHandles(),this.updateMask(),!0)},c.prototype.handleMouseMoveImpl=function(a,b,c,d,e){var f=this.getProp("handles");if(this.moving||this.handleSelected){var g=this.getPosition(0),h=this.getPosition(1);this.getXAxis().isFlipped(),this.getYAxis().isFlipped(),g.x,g.y,h.x,h.y;if(this.moving)g.deltaPosition("x",b,this.getXAxis()),g.deltaPosition("y",c,this.getYAxis()),h.deltaPosition("x",b,this.getXAxis()),h.deltaPosition("y",c,this.getYAxis());else switch(f.type){case"sides":switch(this.sides[this.handleSelected]){case"left":g.deltaPosition("x",b,this.getXAxis());break;case"right":h.deltaPosition("x",b,this.getXAxis());break;case"top":g.deltaPosition("y",c,this.getYAxis());break;case"bottom":h.deltaPosition("y",c,this.getYAxis())}break;case"corners":default:1==this.handleSelected?(g.deltaPosition("x",b,this.getXAxis()),g.deltaPosition("y",c,this.getYAxis())):2==this.handleSelected?(h.deltaPosition("x",b,this.getXAxis()),g.deltaPosition("y",c,this.getYAxis())):3==this.handleSelected?(h.deltaPosition("y",c,this.getYAxis()),h.deltaPosition("x",b,this.getXAxis())):4==this.handleSelected&&(g.deltaPosition("x",b,this.getXAxis()),h.deltaPosition("y",c,this.getYAxis()))}return this.redraw(),this.changed(),this.setHandles(),!0}},c.prototype.setHandles=function(){if(!this.isLocked()&&(this.isSelectable()||this._staticHandles)&&this.handlesInDom){var a=this.computePosition(0),b=this.computePosition(1),c=this.getProp("handles");switch(c.type){case"sides":this.handles.left&&this.handles.left.setAttribute("transform","translate("+this.currentX+" "+(this.currentY+this.currentH/2)+")"),this.handles.right&&this.handles.right.setAttribute("transform","translate( "+(this.currentX+this.currentW)+" "+(this.currentY+this.currentH/2)+")"),this.handles.top&&this.handles.top.setAttribute("transform","translate( "+(this.currentX+this.currentW/2)+" "+this.currentY+")"),this.handles.bottom&&this.handles.bottom.setAttribute("transform","translate( "+(this.currentX+this.currentW/2)+" "+(this.currentY+this.currentH)+")");break;case"corners":default:this.handles[1].setAttribute("x",a.x),this.handles[1].setAttribute("y",a.y),this.handles[2].setAttribute("x",b.x),this.handles[2].setAttribute("y",a.y),this.handles[3].setAttribute("x",b.x),this.handles[3].setAttribute("y",b.y),this.handles[4].setAttribute("x",a.x),this.handles[4].setAttribute("y",b.y)}}},c}(c["./shapes/graph.shape"],c["./graph.util"]),c["./shapes/graph.shape.peakintegration2d"]=function(a){var c=function(a,b){this.nbHandles=4};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect"),this._dom.element=this,this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})},redrawImpl:function(){this.setPosition(),this.setHandles(),this.setBindableToDom(this._dom)}}),c}(c["./shapes/graph.shape.rect"]),c["./shapes/graph.shape.peakinterval"]=function(a){var c=function(a){};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this._dom.setAttribute("marker-end","url(#verticalline"+this.graph._creation+")"),this._dom.setAttribute("marker-start","url(#verticalline"+this.graph._creation+")")},setLabelPosition:function(a){var b=this._getPosition(this.getFromData("pos")),c=this._getPosition(this.getFromData("pos2"),this.getFromData("pos"));this._setLabelPosition(a,this._getPosition(this.get("labelPosition",a),{x:(b.x+c.x)/2+"px",y:(b.y+c.y)/2+"px"}))},afterDone:function(){}}),c}(c["./shapes/graph.shape.line"]),c["./shapes/graph.shape.peakinterval2"]=function(a){var c=5,d=function(a,b){this.nbHandles=2};return b.extend(d.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"line"),this.line1=document.createElementNS(this.graph.ns,"line"),this.line2=document.createElementNS(this.graph.ns,"line"),this.group.appendChild(this.line1),this.group.appendChild(this.line2),this.line1.setAttribute("stroke","black"),this.line2.setAttribute("stroke","black"),this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"}),this._dom.element=this},redrawImpl:function(){this.setPosition(),this.setPosition2(),this.setHandles(),this.redrawLines(c),this.setBindableToDom(this._dom)},redrawLines:function(a){var b=this.findxs(),c=this._getPosition({x:b[0]}),d=this._getPosition({x:b[1]});c.x&&d.x&&this.currentPos2y&&this.currentPos1y&&(this.line1.setAttribute("x1",c.x),this.line1.setAttribute("x2",c.x),this.line2.setAttribute("x1",d.x),this.line2.setAttribute("x2",d.x),this.setLinesY(a))},setLinesY:function(a){this.line1.setAttribute("y1",this.currentPos2y-a),this.line1.setAttribute("y2",this.currentPos2y+a),this.line2.setAttribute("y1",this.currentPos1y-a),this.line2.setAttribute("y2",this.currentPos1y+a)},findxs:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);if(this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth())return!1;var e,f,g,h,i,j,d,k,l,m,n=this.serie.searchClosestValue(this.getFromData("pos").x),o=this.serie.searchClosestValue(this.getFromData("pos2").x);Number.MAX_VALUE;if(!n||!o)return!1;n.xBeforeIndex>o.xBeforeIndex&&(e=n,n=o,o=e);var l,m,p,q,r=0,s=(this.scaling,[]),t=[];for(f=n.dataIndex;f<=o.dataIndex;f++){for(h=f==n.dataIndex?n.xBeforeIndexArr:0,i=f==o.dataIndex?o.xBeforeIndexArr:this.serie.data[f].length,j=0,g=h;i>=g;g+=2)d=this.serie.data[f][g+0],k=this.serie.data[f][g+1],l||(l=d,m=k),void 0==p&&(p=d,q=k),r+=Math.abs((d-p)*(k-q)*.5),s.push(r),t.push(d),p=d,q=k,j++;if(this.lastX=d,this.lastY=k,!(l&&m&&this.lastX&&this.lastY))return!1}if(0==r)return[l,p];for(var u=.05*r,v=.95*r,w=!1,x=!1,f=0,y=s.length;y>f;f++)if(s[f]>u){w=f;break}for(var f=s.length;f>0;f--)if(s[f]<v){x=f;break}return[t[w],t[x]]},highlight:function(){this.isBindable()&&(this._dom.setAttribute("stroke-width","5"),this.setLinesY(c+2))},unhighlight:function(){this.isBindable()&&(this.setStrokeWidth(),this.setLinesY(c))}}),d}(c["./shapes/graph.shape.line"]),c["./shapes/graph.shape.rangex"]=function(a){var c=function(a){};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"rect"),this._dom.setAttribute("class","rangeRect"),this._dom.setAttribute("cursor","move");var a=this;this.nbHandles=2,this.createHandles(this.nbHandles,"g",{"stroke-width":"3",stroke:"transparent","pointer-events":"stroke",cursor:"ew-resize"},function(b){a._makeHandle(b)}),this.setDom("cursor","move"),this.doDraw=void 0},setPosition:function(){var a=this._getPosition(this.getFromData("pos")),b=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),c=Math.abs(a.x-b.x),d=Math.min(a.x,b.x);return this.reversed=d==b.x,2>c||0>d+c||d>this.graph.getDrawingWidth()?!1:(this.setDom("x",d),this.setDom("width",c),this.setDom("y",0),this.setDom("height",this.graph.getDrawingHeight()-this.graph.shift.bottom),this.setHandles(d,c),!0)},setHandles:function(a,b){var c=this._getPosition(this.getFromData("pos")),d=this._getPosition(this.getFromData("pos2"),this.getFromData("pos")),b=Math.abs(c.x-d.x),a=Math.min(c.x,d.x);this.handle1.setAttribute("transform","translate("+(a-6)+" "+((this.graph.getDrawingHeight()-this.graph.shift.bottom)/2-10)+")"),this.handle2.setAttribute("transform","translate("+(a+b-6)+" "+((this.graph.getDrawingHeight()-this.graph.shift.bottom)/2-10)+")")},selectHandles:function(){},_makeHandle:function(a){a.setAttribute("id","rangeHandle"+this.graph._creation);var b=document.createElementNS(this.graph.ns,"rect");b.setAttribute("rx",0),b.setAttribute("ry",0),b.setAttribute("stroke","black"),b.setAttribute("fill","white"),b.setAttribute("width",10),b.setAttribute("height",20),b.setAttribute("x",0),b.setAttribute("y",0),b.setAttribute("shape-rendering","crispEdges"),b.setAttribute("cursor","ew-resize"),a.appendChild(b);var c=document.createElementNS(this.graph.ns,"line");c.setAttribute("x1",4),c.setAttribute("x2",4),c.setAttribute("y1",4),c.setAttribute("y2",18),c.setAttribute("stroke","black"),c.setAttribute("shape-rendering","crispEdges"),c.setAttribute("cursor","ew-resize"),a.appendChild(c);var c=document.createElementNS(this.graph.ns,"line");return c.setAttribute("x1",6),c.setAttribute("x2",6),c.setAttribute("y1",4),c.setAttribute("y2",18),c.setAttribute("stroke","black"),c.setAttribute("shape-rendering","crispEdges"),c.setAttribute("cursor","ew-resize"),a.appendChild(c),a}}),c}(c["./shapes/graph.shape.areaundercurve"]),c["./shapes/graph.shape.cross"]=function(a){var c=function(a,b){this.nbHandles=1};return b.extend(c.prototype,a.prototype,{getLength:function(){return this.options.length||10},createDom:function(){this._dom=document.createElementNS(this.graph.ns,"path"),this._dom.setAttribute("d","M -"+this.getLength()/2+" 0 h "+this.getLength()+" m -"+this.getLength()/2+" -"+this.getLength()/2+" v "+this.getLength()),this.createHandles(this.nbHandles,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));if(a.x&&a.y)return this.setDom("transform","translate( "+a.x+", "+a.y+")"),this.currentPos1x=a.x,this.currentPos1y=a.y,!0},redrawImpl:function(){this.setPosition(),this.setHandles()},handleCreateImpl:function(){},handleMouseDownImpl:function(a){return this.moving=!0,!0},handleMouseUpImpl:function(){return this.triggerChange(),!0},handleMouseMoveImpl:function(a,b,c,d,e){if(!this.isLocked()){var f=this.getFromData("pos");return this.moving&&(f.x=this.graph.deltaPosition(f.x,b,this.getXAxis()),f.y=this.graph.deltaPosition(f.y,c,this.getYAxis())),this.redrawImpl(),!0}},setHandles:function(){this.isLocked()||this._selected&&void 0!=this.currentPos1x&&(this.addHandles(),this.handle1.setAttribute("x",this.currentPos1x),this.handle1.setAttribute("y",this.currentPos1y))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2")}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.zoom2d"]=function(a){var c=function(){};return b.extend(c.prototype,a.prototype,{createDom:function(){this._dom=document.createElementNS(this.graph.ns,"g");var a=document.createElementNS(this.graph.ns,"rect");a.setAttribute("rx",3),a.setAttribute("ry",3),a.setAttribute("height",100),a.setAttribute("width",6),a.setAttribute("fill","rgb(150, 140, 180)"),a.setAttribute("stroke","rgb( 40, 40, 40 )"),a.setAttribute("stroke-width","1px"),a.setAttribute("x",0),a.setAttribute("y",0),this.rect=a,this._dom.appendChild(a);var b=document.createElementNS(this.graph.ns,"rect");b.setAttribute("height",5),b.setAttribute("width",12),b.setAttribute("fill","rgb(190, 180, 220)"),b.setAttribute("stroke","rgb( 40, 40, 40 )"),b.setAttribute("stroke-width","1px"),b.setAttribute("x",-3),b.setAttribute("y",0),b.setAttribute("class","positive"),b.setAttribute("cursor","pointer");var c=document.createElementNS(this.graph.ns,"rect");c.setAttribute("height",5),c.setAttribute("width",12),c.setAttribute("fill","rgb(190, 180, 220)"),c.setAttribute("stroke","rgb( 40, 40, 40 )"),c.setAttribute("stroke-width","1px"),c.setAttribute("x",-3),c.setAttribute("y",0),c.setAttribute("class","negative"),c.setAttribute("cursor","pointer"),this._dom.appendChild(b),this._dom.appendChild(c),this.handlePos=b,this.handleNeg=c},setPosition:function(){var a=this._getPosition(this.getFromData("pos"));if(a&&a.x&&a.y)return this.setDom("transform","translate("+a.x+", "+a.y+")"),!0},setHandleNeg:function(a,b){this.handleNeg.setAttribute("y",45*a+55)},setHandlePos:function(a,b){this.handlePos.setAttribute("y",45*(1-a))},redrawImpl:function(){this.setPosition()},handleCreateImpl:function(){this.resize=!0,this.handleSelected=2},handleMouseDownImpl:function(a){return this.selected="positive"==a.target.getAttribute("class")?"positive":"negative"==a.target.getAttribute("class")?"negative":!1,!0},handleMouseUpImpl:function(){return this.selected=!1,this.triggerChange(),!0},addSerie:function(a){this.series.push(a)},handleMouseMoveImpl:function(a){var c=b(this._dom).offset(),d=a.pageY-c.top;"negative"==this.selected&&(d>100?d=100:55>d&&(d=55),d=-(d-55)/45,this.series.map(function(a){a.onMouseWheel(!1,!1,d,!1)})),"positive"==this.selected&&(0>d?d=0:d>45&&(d=45),d=(45-d)/45,this.series.map(function(a){a.onMouseWheel(!1,!1,d,!0)}))},selectStyle:function(){this.setDom("stroke","red"),this.setDom("stroke-width","2")},hideHandleNeg:function(){this.handleNeg.setAttribute("display","none"),this.rect.setAttribute("height",45)},showHandleNeg:function(){this.handleNeg.setAttribute("display","block"),this.rect.setAttribute("height",100)},setHandles:function(){}}),c}(c["./shapes/graph.shape"]),c["./shapes/graph.shape.peakboundariescenter"]=function(a){var b=function(a){this.lineHeight=6};return b.prototype=new a,b.prototype.createDom=function(){this._dom=document.createElementNS(this.graph.ns,"line"),this.line1=document.createElementNS(this.graph.ns,"line"),this.line2=document.createElementNS(this.graph.ns,"line"),this.line3=document.createElementNS(this.graph.ns,"line"),this.rectBoundary=document.createElementNS(this.graph.ns,"path"),this.rectBoundary.setAttribute("fill","transparent"),this.rectBoundary.setAttribute("stroke","none"),this.rectBoundary.setAttribute("pointer-events","fill"),this.rectBoundary.jsGraphIsShape=!0,this.group.appendChild(this.rectBoundary),this.group.appendChild(this.line1),this.group.appendChild(this.line2),this.group.appendChild(this.line3),this._dom.element=this},b.prototype.createHandles=function(){this._createHandles(3,"rect",{transform:"translate(-3 -3)",width:6,height:6,stroke:"black",fill:"white",cursor:"nwse-resize"})},b.prototype.redrawImpl=function(){this.line1.setAttribute("stroke",this.getStrokeColor()),this.line2.setAttribute("stroke",this.getStrokeColor()),this.line3.setAttribute("stroke",this.getStrokeColor()),this.line1.setAttribute("stroke-width",this.getStrokeWidth()),this.line2.setAttribute("stroke-width",this.getStrokeWidth()),this.line3.setAttribute("stroke-width",this.getStrokeWidth()),this.setHandles(),this.redrawLines()},b.prototype.redrawLines=function(){var a=this.computePosition(0),b=this.computePosition(1),c=this.computePosition(2);
if(a.x&&b.x&&c.x&&this.posYPx){var d=this.lineHeight;this.rectBoundary.setAttribute("d","M "+a.x+" "+(this.posYPx-d)+" v "+2*d+" H "+b.x+" v "+-2*d+"z"),this.line1.setAttribute("x1",a.x),this.line1.setAttribute("x2",a.x),this.line2.setAttribute("x1",b.x),this.line2.setAttribute("x2",b.x),this.line3.setAttribute("x1",c.x),this.line3.setAttribute("x2",c.x),this._dom.setAttribute("x1",a.x),this._dom.setAttribute("x2",b.x),this.setLinesY(d)}},b.prototype.setLinesY=function(){if(this.posYPx){var a=this.lineHeight;this.line1.setAttribute("y1",this.posYPx-a),this.line1.setAttribute("y2",this.posYPx+a),this.line2.setAttribute("y1",this.posYPx-a),this.line2.setAttribute("y2",this.posYPx+a),this.line3.setAttribute("y1",this.posYPx-a),this.line3.setAttribute("y2",this.posYPx+a),this._dom.setAttribute("y1",this.posYPx),this._dom.setAttribute("y2",this.posYPx)}},b.prototype.setHandles=function(){if(this.posYPx){var a=this.computePosition(0),b=this.computePosition(1),c=this.computePosition(2);a.x&&b.x&&c.x&&(this.handles[1].setAttribute("x",a.x),this.handles[1].setAttribute("y",this.posYPx),this.handles[2].setAttribute("x",b.x),this.handles[2].setAttribute("y",this.posYPx),this.handles[3].setAttribute("x",c.x),this.handles[3].setAttribute("y",this.posYPx))}},b.prototype.setY=function(a){this.posYPx=a},b.prototype.setLineHeight=function(a){this.lineHeihgt=a},b.prototype.handleMouseMoveImpl=function(a,b,c){if(!this.isLocked()){var d=this.getPosition(0),e=this.getPosition(1),f=this.getPosition(2);switch(this.handleSelected){case 1:d.deltaPosition("x",b,this.getXAxis()),(Math.abs(f.x-e.x)>Math.abs(e.x-d.x)||Math.abs(f.x-d.x)>Math.abs(e.x-d.x))&&(f.x=d.x+.1*(e.x-d.x));break;case 2:e.deltaPosition("x",b,this.getXAxis()),(Math.abs(f.x-e.x)>Math.abs(e.x-d.x)||Math.abs(f.x-d.x)>Math.abs(e.x-d.x))&&(f.x=e.x+.1*(d.x-e.x));break;case 3:if(f.deltaPosition("x",b,this.getXAxis()),Math.abs(f.x-e.x)>Math.abs(e.x-d.x)||Math.abs(f.x-d.x)>Math.abs(e.x-d.x))return}this.setLabelPosition({y:this.getLabelPosition(0).y,x:f.x}),this.updateLabels(),this.redrawLines(),this.setHandles()}},b.prototype.applyPosition=function(){return!0},b}(c["./shapes/graph.shape.line"]),c["./graph.toolbar"]=function(){function a(){var a=document.createElementNS(g,"svg");return a.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),a.setAttribute("xmlns",g),a}function c(){var b=a(),c=document.createElementNS(g,"line");return c.setAttribute("x1",16),c.setAttribute("y1",3),c.setAttribute("x2",4),c.setAttribute("y2",15),c.setAttribute("stroke","#aa0000"),b.appendChild(c),b}function d(){var b=a(),c=document.createElementNS(g,"rect");return c.setAttribute("x",4),c.setAttribute("y",4),c.setAttribute("width",12),c.setAttribute("height",12),c.setAttribute("stroke","black"),c.setAttribute("fill","#dd0000"),b.appendChild(c),b}function e(){var b="M 4,18 C 8,10 14,1 18,18",c=a(),d=document.createElementNS(g,"path");d.setAttribute("d",b),d.setAttribute("stroke","black"),d.setAttribute("fill","transparent");var e=document.createElementNS(g,"path");return e.setAttribute("d",b+" Z"),e.setAttribute("stroke","red"),e.setAttribute("fill","rgba(255, 0, 0, 0.1)"),c.appendChild(e),c.appendChild(d),c}var f={buttons:["none","rect","line","areaundercurve"]},g="http://www.w3.org/2000/svg",h=function(a,c){var d=this;this.options=b.extend(!0,{},f,c),this.graph=a,this.div=b("<ul />").addClass("graph-toolbar"),this.graph.getPlugin("./graph.plugin.shape").then(function(a){d.plugin=a,d.plugin&&(d.div.on("click","li",function(){var a=b(this).attr("data-shape");d.plugin.setShape(a),b(this).parent().children().removeClass("selected"),b(this).addClass("selected")}),d.makeButtons())})};return h.prototype={makeButtons:function(){for(var a=0,b=this.options.buttons.length;b>a;a++)this.div.append(this.makeButton(this.options.buttons[a]))},makeButton:function(a){var f=b("<li />");switch(a){case"line":f.html(c()).attr("data-shape","line");break;case"rect":f.html(d()).attr("data-shape","rect");break;case"areaundercurve":f.html(e()).attr("data-shape","areaundercurve")}return f},getDom:function(){return this.div}},h}(),function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K){return a.registerConstructor("graph.position",b),a.registerConstructor("graph.axis.x",d),a.registerConstructor("graph.axis.y",e),a.registerConstructor("graph.axis.x.broken",f),a.registerConstructor("graph.axis.y.broken",g),a.registerConstructor("graph.axis.x.time",h),a.registerConstructor("graph.serie.line",r),a.registerConstructor("graph.serie.contour",q),a.registerConstructor("graph.serie.line.broken",s),a.registerConstructor("graph.serie.scatter",t),a.registerConstructor("graph.serie.zone",u),a.registerConstructor("graph.plugin.shape",l),a.registerConstructor("graph.plugin.drag",k),a.registerConstructor("graph.plugin.zoom",n),a.registerConstructor("graph.plugin.selectScatter",m),a.registerConstructor("graph.plugin.timeSerieManager",o),a.registerConstructor("graph.shape",v),a.registerConstructor("graph.shape.areaundercurve",w),a.registerConstructor("graph.shape.arrow",x),a.registerConstructor("graph.shape.ellipse",y),a.registerConstructor("graph.shape.label",z),a.registerConstructor("graph.shape.line",A),a.registerConstructor("graph.shape.nmrintegral",B),a.registerConstructor("graph.shape.peakintegration2d",C),a.registerConstructor("graph.shape.peakinterval",D),a.registerConstructor("graph.shape.peakinterval2",E),a.registerConstructor("graph.shape.rangex",F),a.registerConstructor("graph.shape.rect",G),a.registerConstructor("graph.shape.rectangle",G),a.registerConstructor("graph.shape.cross",H),a.registerConstructor("graph.shape.zoom2d",I),a.registerConstructor("graph.shape.peakboundariescenter",J),a.registerConstructor("graph.toolbar",K),a.registerConstructor("graph.legend",i),a}(c["./graph.core"],c["./graph.position"],c["./graph.axis"],c["./graph.axis.x"],c["./graph.axis.y"],c["./graph.axis.x.broken"],c["./graph.axis.y.broken"],c["./graph.axis.x.time"],c["./graph.legend"],c["./plugins/graph.plugin"],c["./plugins/graph.plugin.drag"],c["./plugins/graph.plugin.shape"],c["./plugins/graph.plugin.selectScatter"],c["./plugins/graph.plugin.zoom"],c["./plugins/graph.plugin.timeseriemanager"],c["./series/graph.serie"],c["./series/graph.serie.contour"],c["./series/graph.serie.line"],c["./series/graph.serie.line.broken"],c["./series/graph.serie.scatter"],c["./series/graph.serie.zone"],c["./shapes/graph.shape"],c["./shapes/graph.shape.areaundercurve"],c["./shapes/graph.shape.arrow"],c["./shapes/graph.shape.ellipse"],c["./shapes/graph.shape.label"],c["./shapes/graph.shape.line"],c["./shapes/graph.shape.nmrintegral"],c["./shapes/graph.shape.peakintegration2d"],c["./shapes/graph.shape.peakinterval"],c["./shapes/graph.shape.peakinterval2"],c["./shapes/graph.shape.rangex"],c["./shapes/graph.shape.rect"],c["./shapes/graph.shape.cross"],c["./shapes/graph.shape.zoom2d"],c["./shapes/graph.shape.peakboundariescenter"],c["./graph.toolbar"])};if("function"==typeof define&&define.amd)define("jsgraph",["jquery"],function(a){return b(a)});else if(a){if(!a.jQuery)throw"jQuery has not been loaded. Abort graph initialization.";a.Graph=b(a.jQuery)}}),define("src/util/typerenderer/chart",["jsgraph"],function(a){function b(b,g,h,i){b.empty();var j=Object.assign({},e,g,i);j.close===!0&&(j.close=f);var k=new a(b,j),l=g.axis,m={top:0,right:0,bottom:0,left:0},n=[],o=void 0,p=void 0;if(Array.isArray(l))for(var q=0;q<l.length;q++){var r=l[q],s=r.type;if(!m.hasOwnProperty(s))throw new Error("invalid axis type: "+s);var t=s[0].toUpperCase()+s.substring(1),u=k["get"+t+"Axis"](m[s]++);o||"top"!==s&&"bottom"!==s||(o=u),p||"left"!==s&&"right"!==s||(p=u),u.flip(r.flip).setPrimaryGrid(!1).setSecondaryGrid(!1).setGridLinesStyle().setLabel(r.label||"").forceMin(r.min||!1).forceMax(r.max||!1).setAxisDataSpacing(0),n.push(u)}if(o||(o=k.getXAxis(),o.setPrimaryGrid(!1).setSecondaryGrid(!1).setGridLinesStyle().setAxisDataSpacing(0)),p||(p=k.getYAxis(),p.setPrimaryGrid(!1).setSecondaryGrid(!1).setGridLinesStyle().setAxisDataSpacing(0)),i.legend){var v=Object.assign({},{},i.legend);k.makeLegend(v)}var w=g.data;if(w){for(var x=i.series||[],y=0;y<w.length;y++){var z=w[y],A=c(z,x[y]||{}),B=k.newSerie(z.label||"serie_"+y,A,A.type);d(B,z,x[y]||{});for(var C=new Array(2*z.x.length),D=0;D<z.x.length;D++)C[2*D]=z.x[D],C[2*D+1]=z.y[D];B.setXAxis(z.xAxis?n[z.xAxis]:o),B.setYAxis(z.yAxis?n[z.yAxis]:p),B.setData(C)}k.resize(Math.max(b.width()-15,20),Math.max(b.height()-15,20)),k.draw()}}function c(a,b){var c={type:a.type||"line",lineToZero:!1};return"bar"===c.type&&(c.type="line",c.lineToZero=!0),b.peakPicking&&(c.autoPeakPicking=!0),c}function d(a,b){var c=Object.assign({},g,b.defaultStyle);a.setLineWidth(c.lineWidth),a.setLineColor(c.lineColor),a.setLineStyle(c.lineStyle)}var e={close:{top:!1,right:!1,bottom:!1,left:!1}},f={top:!0,right:!0,bottom:!0,left:!0},g={lineWidth:1,lineColor:"#000",lineStyle:1};return{toscreen:b}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};if(define("src/util/typerenderer",["require","jquery","lodash","moment","numeral","sprintf","./api","./util","./typerenderer/chart"],function(a,b,c,d,e,f,g,h,i){function j(a){return a.hasOwnProperty("dateFormat")||a.hasOwnProperty("dateFromNow")||a.hasOwnProperty("dateCalendar")}function k(a,b){return b.dateFormat?d(a).format(b.dateFormat):b.dateFromNow?d(a).fromNow():b.dateCalendar?d(a).calendar():void 0}function l(c,d,e,f){return new Promise(function(g){f=b.extend({},r,f),a([q],function(a){var i=h.getNextUniqueId(),j=Math.max(100,c.height()),k=c.width(),l=b("<canvas>",{id:i}),m=l.get(0);m.height=j-3,m.width=k,c.html(l),a.StructureView.drawStructure(i,String(d),String(e),f),g()})})}function m(c,d,e,f,g){return g=g||{},new Promise(function(f){a(["lib/bio-pv/bio-pv.min"],function(a){var i=b('<div style="width:100%; height:100%" />');d.html(i);var j;"pdb"===c?j=a.io.pdb(e,{loadAllModels:!0}):"mol3d"===c&&(j=a.io.sdf(e));var k=a.Viewer(i.get(0),{width:.99*d.width(),height:Math.max(250,.99*d.height()),quality:"medium"});k.addListener("viewerReady",function(){function a(){k.destroy(),d.off("remove")}g.mode=k[g.mode]?g.mode:"cartoon";var b=h.getNextUniqueId();"pdb"===c?(k.clear(),j.forEach(function(a){if("cartoon"===g.mode){var c=a.select({rnames:["RVP","SAH"]});k.ballsAndSticks("ligand-"+b,c)}k[g.mode](b,a),k.autoZoom()})):"mol3d"===c&&k.ballsAndSticks(b,j),k.fitTo(j),d.on("remove",a)}),f()})})}function n(a,c,d){return void 0==c?(a.html(""),Promise.resolve()):Promise.resolve(c.get(!0)).then(function(e){var f;if(d&&d.forceType?(e&&e.value&&(e=e.value),f=d.forceType.toLowerCase()):f=c.getType().toLowerCase(),!p[f])return h.warnOnce("no-typerenderer-"+f,"No renderer found for type "+f),void a.html(String(e));d=b.extend(d,c._options),d.backgroundColor&&a.css("background-color",d.backgroundColor);var g=s[f];return g||(g="function"==typeof p[f].init?Promise.resolve(p[f].init()):Promise.resolve(),s[f]=g),g.then(function(){return p[f].toscreen(a,e,c,d)})})}var o,p={};p.country={},p.country.init=function(){var b=[];return b.push(h.loadCss("components/flag-icon-css/css/flag-icon.min.css")),b.push(new Promise(function(b){a(["browserified/country-data/index.js"],b)})),Promise.all(b).then(function(a){o=a[1]})},p.country.toscreen=function(a,b,c,d){b=String(b);var e;2===b.length?(b=b.toUpperCase(),e=o.lookup.countries({alpha2:b})[0]):3===b.length?(b=b.toUpperCase(),e=o.lookup.countries({alpha3:b})[0]):(b=b.slice(0,1).toUpperCase()+b.slice(1,b.length),e=o.lookup.countries({name:b})[0]),e?a.html('<span title="'+e.name+'" class="flag-icon flag-icon-'+e.alpha2.toLowerCase()+'"></span>'):a.html(b)},p.qrcode={},p.qrcode.init=function(){return new Promise(function(b){a(["components/jquery-qrcode/jquery.qrcode.min"],b)})},p.qrcode.toscreen=function(a,b,c,d){d=Object.assign({width:128,height:128,text:String(b),render:"table"},d),a.qrcode(d)},p.barcode={},p.barcode.init=function(){return new Promise(function(b){a(["jsbarcode"],b)})},p.barcode.toscreen=function(a,c,d,e){var f={format:"CODE128"},g=b("<img>");a.append(g);var h=Object.assign({},f,e);c=h.format.startsWith("CODE")?String(c):Number(c),g.JsBarcode(c,h)},p.sparkline={},p.sparkline.init=function(){return new Promise(function(b){a(["sparkline"],b)})},p.sparkline.toscreen=function(a,b,d,e){var f={width:"discrete"===e.type?"auto":"100%",height:"100%"};e=c.defaults(e,f),a.sparkline(b,e)},p.string={},p.string.toscreen=function(a,b,c,d){if(b=String(b),b=b.replace(/</g,"&lt;").replace(/>/g,"&gt;"),d.search){var e;try{e=new RegExp(d.search)}catch(a){e=d.search}b=b.replace(e,d.replace||"")}j(d)&&(b=k(b,d)),a.html(b)},p.html={},p.html.toscreen=function(a,b){a.html(String(b))},p.date={},p.date.toscreen=function(a,b){try{var c=new Date(b);a.html(c.toLocaleString())}catch(b){a.html("Invalid date")}},p.color={},p.color.toscreen=function(a,b){var c='<div style="background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAIAAADZF8uwAAAAGUlEQVQYV2M4gwH+YwCGIasIUwhT25BVBADtzYNYrHvv4gAAAABJRU5ErkJggg==); width:100%; height:100%"><div style="background-color: '+b+'; width: 100%; height:100%; padding:0; margin:0">&nbsp;</div></div>';a.html(c)},p.number={},p.number.toscreen=function(a,b,c,d){var g=Number(b);isNaN(g)?g="NaN":d.hasOwnProperty("toPrecision")?g=g.toPrecision(d.toPrecision):d.hasOwnProperty("toFixed")?g=g.toFixed(d.toFixed):d.hasOwnProperty("numeral")?g=e(g).format(d.numeral):d.hasOwnProperty("sprintf")?g=f.sprintf(d.sprintf,g):j(d)&&(g=k(g,d)),a.html(g)},p.picture={},p.picture.toscreen=function(a,c,d,e){var f=b("<img>");f.attr({src:c,width:e?e.width:void 0}),e.css&&f.css(e.css),a.html(f)},p.gif=p.picture,p.jpeg=p.picture,p.jpg=p.picture,p.png=p.picture,p.webp=p.picture,p.image=p.picture,p.svg={},p.svg.toscreen=function(a,c){var d=b(String(c)),e=[0,0,parseInt(d.attr("width")),parseInt(d.attr("height"))];d[0].setAttribute("viewBox",e.join(" ")),d.removeAttr("id"),d.attr("width","100%"),d.attr("height","100%"),d.css("display","block"),a.html(d)},p.doi={},p.doi.toscreen=function(a,b){return a.html(b.replace(/^(.*)$/,'<a target="_blank" href="http://dx.doi.org/$1"><img src="bin/logo/doi.png" /></a>'))};var q="openchemlib/openchemlib-full",r={suppressChiralText:!0,suppressESR:!0,suppressCIPParity:!0,noStereoProblem:!0};p.jme={},p.jme.toscreen=function(b,c,d,e){return new Promise(function(f){a(["lib/chemistry/jme-converter"],function(a){var g=a.toMolfile(String(c));f(p.mol2d.toscreen(b,g,d,e))})})},p.smiles={},p.smiles.toscreen=function(b,c,d,e){return new Promise(function(d){a([q],function(a){var f=a.Molecule.fromSmiles(String(c));d(l(b,f.getIDCode(),f.getIDCoordinates(),e))})})},p.oclid={},p.oclid.toscreen=function(b,c,d,e){return new Promise(function(f){a([q],function(a){if(!d.coordinates){var g=a.Molecule.fromIDCode(String(c),!0);Object.defineProperty(d,"coordinates",{configurable:!0,enumerable:!1,value:g.getIDCoordinates(),writable:!0})}f(l(b,String(c),String(d.coordinates),e))})})},p.actelionid=p.oclid,p.mol2d={},p.mol2d.toscreen=function(b,c,d,e){return new Promise(function(d){a([q],function(a){var f=a.Molecule.fromMolfile(String(c));d(l(b,f.getIDCode(),f.getIDCoordinates(),e))})})},p.molfile2d=p.mol2d,p.mf={},p.mf.toscreen=function(a,b){b?(b=b.replace(/\[([0-9]+)/g,"[<sup>$1</sup>"),b=b.replace(/([a-zA-Z)\]])([0-9.]+)/g,"$1<sub>$2</sub>"),b=b.replace(/([+-]+)/g,function(a){for(var b=0,c=0;c<a.length;c++)"+"===a.charAt(c)?b++:b--;return b>1?"<sup>"+b+"+</sup>":-1>b?"<sup>"+-b+"‒</sup>":1===b?"<sup>+</sup>":-1===b?"<sup>‒</sup>":""}),b=b.replace(/<sub>([0-9.]+)<\/sub><sup>([0-9]*[+‒])<\/sup>/g,'<span style="position: relative;"><span style="position: absolute; left:0; font-size: smaller"><sup style="position: relative; vertical-align: baseline; top: -0.4em;">$2</sup></span><span style="position: absolute; left:0; font-size: smaller"><sub style="position: relative; vertical-align: baseline; top: 0.6em;">3</sub></span></span>'),a.html(b)):a.html("")},p.pdb={},p.pdb.toscreen=m.bind(p.pdb,"pdb"),p.mol3d={},p.mol3d.toscreen=m.bind(p.pdb,"mol3d"),p.molfile3d=p.mol3d,p.downloadlink={},p.downloadlink.toscreen=function(a,b,c,d){var e=d&&d.title;e=e||"Download resource",a.html("<a download"+(d.filename?"="+d.filename:"")+' title="'+e+'" href="'+b+'">⤵</a>')},p.openlink={},p.openlink.toscreen=function(a,b){a.html(b.replace(/^(.*)$/,'<a href="$1" target="_blank"><i class="fa fa-external-link"></i></a>'))},p.boolean={},p.boolean.toscreen=function(a,b){b instanceof DataBoolean&&(b=b.get()),b?a.html('<span style="color: green;">&#10004;</span>'):a.html('<span style="color: red;">&#10008;</span>')},p.colorbar={},p.colorbar.toscreen=function(a,c){for(var d=b("<div>&nbsp;</div>"),e="linear-gradient(to right",f=0,g=0,h=c.length;h>g;f+=c[g++][0]);var i,j,k=0;for(g=0;h>g;g++)i=k+c[g][0]/f*100,j=c[g][1],e+=", "+j+" "+k+"%, "+j+" "+i+"%",k=i;e+=")",d.css({height:"100%",width:"100%"}).css("background",e),a.html(d)},p.indicator={},p.indicator.init=function(){var a,c=b('<div class="ci-tooltip"></div>').css({display:"none",opacity:0}).appendTo("#ci-visualizer"),d=b("#modules-grid");d.on("mouseenter","[data-tooltip]",function(d){a=setTimeout(function(){var a=b(d.target),e=a.offset();c.css({left:e.left,top:e.top,display:"block"}).text(a.attr("data-tooltip")),c.animate({opacity:1})},500)}),d.on("mouseleave","[data-tooltip]",function(b){clearTimeout(a),c.css({opacity:0,display:"none"})})},p.indicator.toscreen=function(d,e){return new Promise(function(f){a(["src/util/color"],function(a){if(!Array.isArray(e))return f();var g='<table cellpadding="0" cellspacing="0" style="text-align: center; height:100%; width:100%; table-layout: fixed;"><tr>';e=DataObject.resurrect(e),e=c.cloneDeep(e),isNaN(e[0])||(e=e.map(function(a){return{size:a}}));for(var h=e.length,i=a.getDistinctColors(e.length),j=0,k=0;h>k;k++)e[k].bgcolor||(e[k].bgcolor=a.getColor(i[k])),e[k].size||0===e[k].size||(e[k].size=10),j+=e[k].size;for(var k=0;h>k;k++){var l=e[k],m=b("<td>&nbsp;</td>").css({width:100*l.size/j+"%",border:"none",overflow:"hidden","max-width":100*l.size/j+"%","white-space":"nowrap","text-overflow":"ellipsis"});l.bgcolor&&m.css("background-color",l.bgcolor),l.color&&m.css("color",l.color),l.text&&m.append(l.text),l.class&&m.addClass(l.class),l.icon&&m.prepend('<i class="fa fa-'+l.icon+'"></i>'),l.css&&m.css(l.css),l.tooltip&&m.attr("data-tooltip",l.tooltip),g+=m.get(0).outerHTML}g+="</tr></table>",d.html(g),f()})})},p.regexp={},p.regexp.toscreen=function(c,d){var e=String(d);return new Promise(function(d){a(["lib/regexper/regexper"],function(a){var f=b("<div>").appendTo(c),g=new a(f.get(0));g.parse(e).invoke("render"),d()})})},p.regex=p.regexp,p.object={},p.object.init=function(){return new Promise(function(b){a(["lib/twigjs/twig"],function(a){p.object.twig=a,b()})})},p.object.toscreen=function(a,b,c,d){if(d.twig){var e=p.object.twig.twig({data:d.twig}),f=e.renderAsync(b);a.html(f.html),f.render()}else a.html(Object.prototype.toString.call(b))},p.chart=i;var s={},t=new WeakMap;return{render:function(a,c,d,e){"object"!==("undefined"==typeof d?"undefined":_typeof(d))||Array.isArray(d)||(e=d,d=null);var f;f=t.has(a)?t.get(a):Promise.resolve();var g=b(a);c=DataObject.check(c,!0);var h=function(){return d?c.getChild(d).then(function(a){return n(g,a,e)}):n(g,c,e)};return f=f.then(h,h),t.set(a,f),f},addType:function(a,b){p[a]=b}}}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/core",["jquery"],a):a(jQuery)}(function(a){function b(b,d){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap='#"+f+"']")[0],!!g&&c(g)):!1):(/^(input|select|textarea|button|object)$/.test(h)?!b.disabled:"a"===h?b.href||d:d)&&c(b)}function c(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}a.ui=a.ui||{},a.extend(a.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({scrollParent:function(b){var c=this.css("position"),d="absolute"===c,e=b?/(auto|scroll|hidden)/:/(auto|scroll)/,f=this.parents().filter(function(){var b=a(this);return d&&"static"===b.css("position")?!1:e.test(b.css("overflow")+b.css("overflow-y")+b.css("overflow-x"))}).eq(0);return"fixed"!==c&&f.length?f:a(this[0].ownerDocument||document)},uniqueId:function(){var a=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++a)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(c){return b(c,!isNaN(a.attr(c,"tabindex")))},tabbable:function(c){var d=a.attr(c,"tabindex"),e=isNaN(d);return(e||d>=0)&&b(c,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(b,c){function d(b,c,d,f){return a.each(e,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),f&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var e="Width"===c?["Left","Right"]:["Top","Bottom"],f=c.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+c]=function(b){return void 0===b?g["inner"+c].call(this):this.each(function(){a(this).css(f,d(this,b)+"px")})},a.fn["outer"+c]=function(b,e){return"number"!=typeof b?g["outer"+c].call(this,b):this.each(function(){a(this).css(f,d(this,b,!0,e)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),disableSelection:function(){var a="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(a+".ui-disableSelection",function(a){a.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(b){if(void 0!==b)return this.css("zIndex",b);if(this.length)for(var c,d,e=a(this[0]);e.length&&e[0]!==document;){if(c=e.css("position"),("absolute"===c||"relative"===c||"fixed"===c)&&(d=parseInt(e.css("zIndex"),10),!isNaN(d)&&0!==d))return d;e=e.parent()}return 0}}),a.ui.plugin={add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c,d){var e,f=a.plugins[b];if(f&&(d||a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType))for(e=0;e<f.length;e++)a.options[f[e][0]]&&f[e][1].apply(a.element,c)}}}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/widget",["jquery"],a):a(jQuery)}(function(a){var b=0,c=Array.prototype.slice;return a.cleanData=function(b){return function(c){var d,e,f;for(f=0;null!=(e=c[f]);f++)try{d=a._data(e,"events"),d&&d.remove&&a(e).triggerHandler("remove")}catch(a){}b(c)}}(a.cleanData),a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];return b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g),g},a.widget.extend=function(b){for(var d,e,f=c.call(arguments,1),g=0,h=f.length;h>g;g++)for(d in f[g])e=f[g][d],f[g].hasOwnProperty(d)&&void 0!==e&&(a.isPlainObject(e)?b[d]=a.isPlainObject(b[d])?a.widget.extend({},b[d],e):a.widget.extend({},e):b[d]=e);return b},a.widget.bridge=function(b,d){var e=d.prototype.widgetFullName||b;a.fn[b]=function(f){var g="string"==typeof f,h=c.call(arguments,1),i=this;return g?this.each(function(){var c,d=a.data(this,e);return"instance"===f?(i=d,!1):d?a.isFunction(d[f])&&"_"!==f.charAt(0)?(c=d[f].apply(d,h),c!==d&&void 0!==c?(i=c&&c.jquery?i.pushStack(c.get()):c,!1):void 0):a.error("no such method '"+f+"' for "+b+" widget instance"):a.error("cannot call methods on "+b+" prior to initialization; attempted to call method '"+f+"'")}):(h.length&&(f=a.widget.extend.apply(null,[f].concat(h))),this.each(function(){var b=a.data(this,e);b?(b.option(f||{}),b._init&&b._init()):a.data(this,e,new d(f,this))})),i}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(c,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=b++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this.options=a.widget.extend({},this.options,this._getCreateOptions(),c),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(b,c){var d,e,f,g=b;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof b)if(g={},d=b.split("."),b=d.shift(),d.length){for(e=g[b]=a.widget.extend({},this.options[b]),f=0;f<d.length-1;f++)e[d[f]]=e[d[f]]||{},e=e[d[f]];if(b=d.pop(),1===arguments.length)return void 0===e[b]?null:e[b];e[b]=c}else{if(1===arguments.length)return void 0===this.options[b]?null:this.options[b];g[b]=c}return this._setOptions(g),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!b),b&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^([\w:-]*)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(b,c){c=(c||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,b.unbind(c).undelegate(c),this.bindings=a(this.bindings.not(b).get()),this.focusable=a(this.focusable.not(b).get()),this.hoverable=a(this.hoverable.not(b).get())},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.widget}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/mouse",["jquery","./widget"],a):a(jQuery)}(function(a){var b=!1;return a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){if(this._mouseMoved){if(a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button)return this._mouseUp(b);if(!b.which)return this._mouseUp(b)}return(b.which||b.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(b),
b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(c){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,c.target===this._mouseDownEvent.target&&a.data(c.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(c)),b=!1,!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/sortable",["jquery","./core","./mouse","./widget"],a):a(jQuery)}(function(a){return a.widget("ui.sortable",a.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(a,b,c){return a>=b&&b+c>a},_isFloating:function(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(a,b){this._super(a,b),"handle"===a&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),a.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d&&(!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e))?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-this.document.scrollTop()<g.scrollSensitivity?h=this.document.scrollTop(this.document.scrollTop()-g.scrollSpeed):this.window.height()-(b.pageY-this.document.scrollTop())<g.scrollSensitivity&&(h=this.document.scrollTop(this.document.scrollTop()+g.scrollSpeed)),b.pageX-this.document.scrollLeft()<g.scrollSensitivity?h=this.document.scrollLeft(this.document.scrollLeft()-g.scrollSpeed):this.window.width()-(b.pageX-this.document.scrollLeft())<g.scrollSensitivity&&(h=this.document.scrollLeft(this.document.scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var b="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),c="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),d=b&&c,e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return d?this.floating?f&&"right"===f||"down"===e?2:1:e&&("down"===e?2:1):!1},_intersectsWithSides:function(a){var b=this._isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),c=this._isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?"right"===e&&c||"left"===e&&!c:d&&("down"===d&&b||"up"===d&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d],this.document[0]),e=f.length-1;e>=0;e--)g=a.data(f[e],this.widgetFullName),g&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c],this.document[0]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===d?b._createTrPlaceholder(b.currentItem.find("tr").eq(0),a("<tr>",b.document[0]).appendTo(e)):"tr"===d?b._createTrPlaceholder(b.currentItem,e):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){c&&!d.forcePlaceholderSize||(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_createTrPlaceholder:function(b,c){var d=this;b.children().each(function(){a("<td>&#160;</td>",d.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(c)})},_contactContainers:function(b){var c,d,e,f,g,h,i,j,k,l,m=null,n=null;for(c=this.containers.length-1;c>=0;c--)if(!a.contains(this.currentItem[0],this.containers[c].element[0]))if(this._intersectsWith(this.containers[c].containerCache)){if(m&&a.contains(this.containers[c].element[0],m.element[0]))continue;m=this.containers[c],n=c}else this.containers[c].containerCache.over&&(this.containers[c]._trigger("out",b,this._uiHash(this)),this.containers[c].containerCache.over=0);if(m)if(1===this.containers.length)this.containers[n].containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1);else{for(e=1e4,f=null,k=m.floating||this._isFloating(this.currentItem),g=k?"left":"top",h=k?"width":"height",l=k?"clientX":"clientY",d=this.items.length-1;d>=0;d--)a.contains(this.containers[n].element[0],this.items[d].item[0])&&this.items[d].item[0]!==this.currentItem[0]&&(i=this.items[d].item.offset()[g],j=!1,b[l]-i>this.items[d][h]/2&&(j=!0),Math.abs(b[l]-i)<e&&(e=Math.abs(b[l]-i),f=this.items[d],this.direction=j?"up":"down"));if(!f&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[n])return void(this.currentContainer.containerCache.over||(this.containers[n]._trigger("over",b,this._uiHash()),this.currentContainer.containerCache.over=1));f?this._rearrange(b,f,null,!0):this._rearrange(b,null,this.containers[n].element,!0),this._trigger("change",b,this._uiHash()),this.containers[n]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[n],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[n]._trigger("over",b,this._uiHash(this)),this.containers[n].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),d[0].style.width&&!c.forceHelperSize||d.width(this.currentItem.width()),d[0].style.height&&!c.forceHelperSize||d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),"document"!==e.containment&&"window"!==e.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===e.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===e.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)"auto"!==this._storedCSS[d]&&"static"!==this._storedCSS[d]||(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!b){for(d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}),function(a){function b(b,c,d,e){var f={data:e||(c?c.data:{}),_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:j,nest:k,wrap:l,html:m,update:n};return b&&a.extend(f,b,{nodes:[],parent:c}),d&&(f.tmpl=d,f._ctnt=f._ctnt||f.tmpl(a,f),f.key=++v,(x.length?t:s)[v]=f),f}function c(b,e,f){var g,h=f?a.map(f,function(a){return"string"==typeof a?b.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+q+'="'+b.key+'" $2'):a:c(a,b,a._ctnt)}):b;return e?h:(h=h.join(""),h.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(b,c,e,f){g=a(e).get(),i(g),c&&(g=d(c).concat(g)),f&&(g=g.concat(d(f)))}),g?g:d(h))}function d(b){var c=document.createElement("div");return c.innerHTML=b,a.makeArray(c.childNodes)}function e(b){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(b,c,d,e,f,h,i){var j,k,l,m=a.tmpl.tag[d];if(!m)throw"Template command not found: "+d;return j=m._default||[],h&&!/\w$/.test(f)&&(f+=h,h=""),f?(f=g(f),i=i?","+g(i)+")":h?")":"",k=h?f.indexOf(".")>-1?f+h:"("+f+").call($item"+i:f,l=h?k:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):l=k=j.$1||"null",e=g(e),"');"+m[c?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(l).split("$1").join(k).split("$2").join(e?e.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(a,b,c,d){return d=d?","+d+")":c?")":"",d?"("+b+").call($item"+d:a}):j.$2||"")+"_.push('"})+"');}return _;")}function f(b,d){b._wrap=c(b,!0,a.isArray(d)?d:[r.test(d)?d:a(d).html()]).join("")}function g(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function h(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML}function i(c){function d(c){function d(a){a+=j,g=k[a]=k[a]||b(g,s[g.parent.key+j]||g.parent,null,!0)}var e,f,g,h,i=c;if(h=c.getAttribute(q)){for(;i.parentNode&&1===(i=i.parentNode).nodeType&&!(e=i.getAttribute(q)););e!==h&&(i=i.parentNode?11===i.nodeType?0:i.getAttribute(q)||0:0,(g=s[h])||(g=t[h],g=b(g,s[i]||t[i],null,!0),g.key=++v,s[v]=g),w&&d(h)),c.removeAttribute(q)}else w&&(g=a.data(c,"tmplItem"))&&(d(g.key),s[g.key]=g,i=a.data(c.parentNode,"tmplItem"),i=i?i.key:0);if(g){for(f=g;f&&f.key!=i;)f.nodes.push(c),f=f.parent;delete g._ctnt,delete g._wrap,a.data(c,"tmplItem",g)}}var e,f,g,h,i,j="_"+w,k={};for(g=0,h=c.length;h>g;g++)if(1===(e=c[g]).nodeType){for(f=e.getElementsByTagName("*"),i=f.length-1;i>=0;i--)d(f[i]);d(e)}}function j(a,b,c,d){return a?void x.push({_:a,tmpl:b,item:this,data:c,options:d}):x.pop()}function k(b,c,d){return a.tmpl(a.template(b),c,d,this)}function l(b,c){var d=b.options||{};return d.wrapped=c,a.tmpl(a.template(b.tmpl),b.data,d,b.item)}function m(b,c){var d=this._wrap;return a.map(a(a.isArray(d)?d.join(""):d).filter(b||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||h(a)})}function n(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]),a(b).remove()}var o,p=a.fn.domManip,q="_tmplitem",r=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,s={},t={},u={key:0,data:{}},v=0,w=0,x=[];a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b,c){a.fn[b]=function(d){var e,f,g,h,i=[],j=a(d),k=1===this.length&&this[0].parentNode;if(o=s||{},k&&11===k.nodeType&&1===k.childNodes.length&&1===j.length)j[c](this[0]),i=this;else{for(f=0,g=j.length;g>f;f++)w=f,e=(f>0?this.clone(!0):this).get(),a.fn[c].apply(a(j[f]),e),i=i.concat(e);w=0,i=this.pushStack(i,b,j.selector)}return h=o,o=null,a.tmpl.complete(h),i}}),a.fn.extend({tmpl:function(b,c,d){return a.tmpl(this[0],b,c,d)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(b,c,d){if(b[0]&&b[0].nodeType){for(var e,f=a.makeArray(arguments),g=b.length,h=0;g>h&&!(e=a.data(b[h++],"tmplItem")););g>1&&(f[0]=[a.makeArray(b)]),e&&w&&(f[2]=function(b){a.tmpl.afterManip(this,b,d)}),p.apply(this,f)}else p.apply(this,arguments);return w=0,!o&&a.tmpl.complete(s),this}}),a.extend({tmpl:function(d,e,g,h){var i,j=!h;if(j)h=u,d=a.template[d]||a.template(null,d),t={};else if(!d)return d=h.tmpl,s[h.key]=h,h.nodes=[],h.wrapped&&f(h,h.wrapped),a(c(h,null,h.tmpl(a,h)));return d?("function"==typeof e&&(e=e.call(h||{})),g&&g.wrapped&&f(g,g.wrapped),i=a.isArray(e)?a.map(e,function(a){return a?b(g,h,d,a):null}):[b(g,h,d,e)],j?a(c(h,null,i)):i):[]},tmplItem:function(b){var c;for(b instanceof a&&(b=b[0]);b&&1===b.nodeType&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode););return c||u},template:function(b,c){return c?("string"==typeof c?c=e(c):c instanceof a&&(c=c[0]||{}),c.nodeType&&(c=a.data(c,"tmpl")||a.data(c,"tmpl",e(c.innerHTML))),"string"==typeof b?a.template[b]=c:c):b?"string"!=typeof b?a.template(null,b):a.template[b]||a.template(null,r.test(b)?b:a(b)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){s={}},afterManip:function(b,c,d){var e=11===c.nodeType?a.makeArray(c.childNodes):1===c.nodeType?[c]:[];d.call(b,c),i(e),w++}})}(jQuery),define("jquery-tmpl",function(){}),function(a){function b(){var a=!1,b=!1;this.stopPropagation=function(){a=!0},this.isPropagationStopped=function(){return a},this.stopImmediatePropagation=function(){b=!0},this.isImmediatePropagationStopped=function(){return b}}function c(){var a=[];this.subscribe=function(b){a.push(b)},this.unsubscribe=function(b){for(var c=a.length-1;c>=0;c--)a[c]===b&&a.splice(c,1)},this.notify=function(c,d,e){d=d||new b,e=e||this;for(var f,g=0;g<a.length&&!d.isPropagationStopped()&&!d.isImmediatePropagationStopped();g++)f=a[g].call(e,d,c);
return f}}function d(){var a=[];this.subscribe=function(b,c){return a.push({event:b,handler:c}),b.subscribe(c),this},this.unsubscribe=function(b,c){for(var d=a.length;d--;)if(a[d].event===b&&a[d].handler===c)return a.splice(d,1),void b.unsubscribe(c);return this},this.unsubscribeAll=function(){for(var b=a.length;b--;)a[b].event.unsubscribe(a[b].handler);return a=[],this}}function e(a,b,c,d){void 0===c&&void 0===d&&(c=a,d=b),this.fromRow=Math.min(a,c),this.fromCell=Math.min(b,d),this.toRow=Math.max(a,c),this.toCell=Math.max(b,d),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(a,b){return a>=this.fromRow&&a<=this.toRow&&b>=this.fromCell&&b<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}function f(){this.__nonDataRow=!0}function g(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function h(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function i(){var a=null;this.isActive=function(b){return b?a===b:null!==a},this.activate=function(b){if(b!==a){if(null!==a)throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController";if(!b.commitCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()";if(!b.cancelCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()";a=b}},this.deactivate=function(b){if(a!==b)throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one";a=null},this.commitCurrentEdit=function(){return a?a.commitCurrentEdit():!0},this.cancelCurrentEdit=function(){return a?a.cancelCurrentEdit():!0}}a.extend(!0,window,{Slick:{Event:c,EventData:b,EventHandler:d,Range:e,NonDataRow:f,Group:g,GroupTotals:h,EditorLock:i,GlobalEditorLock:new i,keyCode:{BACKSPACE:8,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,RIGHT:39,TAB:9,UP:38}}}),g.prototype=new f,g.prototype.equals=function(a){return this.value===a.value&&this.count===a.count&&this.collapsed===a.collapsed&&this.title===a.title},h.prototype=new f}(jQuery),define("slickgrid_core",["jquery","jquery-ui/core","jquery-ui/sortable","jquery-tmpl"],function(){}),function(a){function b(b){function c(a,c,d,e,f){if(!b.enableExpandCollapse)return f.title;var g=15*f.level+"px";return"<span class='"+b.toggleCssClass+" "+(f.collapsed?b.toggleCollapsedCssClass:b.toggleExpandedCssClass)+"' style='margin-left:"+g+"'></span><span class='"+b.groupTitleCssClass+"' level='"+f.level+"'>"+f.title+"</span>"}function d(a,b,c,d,e){return d.groupTotalsFormatter&&d.groupTotalsFormatter(e,d)||""}function e(a){k=a,k.onClick.subscribe(g),k.onKeyDown.subscribe(h)}function f(){k&&(k.onClick.unsubscribe(g),k.onKeyDown.unsubscribe(h))}function g(c,d){var e=this,f=this.getDataItem(d.row);f&&f instanceof Slick.Group&&a(c.target).hasClass(b.toggleCssClass)&&(d.item=f,f.collapsed?(this.getData().expandGroup(f.groupingKey),m.notify(d,c,e)):(this.getData().collapseGroup(f.groupingKey),n.notify(d,c,e)),c.stopImmediatePropagation(),c.preventDefault())}function h(c,d){var e=this;if(b.enableExpandCollapse&&c.which==a.ui.keyCode.SPACE){var f=this.getActiveCell();if(f){var g=this.getDataItem(f.row);g&&g instanceof Slick.Group&&(d.item=g,g.collapsed?(this.getData().expandGroup(g.groupingKey),m.notify(d,c,e)):(this.getData().collapseGroup(g.groupingKey),n.notify(d,c,e)),c.stopImmediatePropagation(),c.preventDefault())}}}function i(a){return{selectable:!1,focusable:b.groupFocusable,cssClasses:b.groupCssClass,columns:{0:{colspan:"*",formatter:c,editor:null}}}}function j(a){return{selectable:!1,focusable:b.totalsFocusable,cssClasses:b.totalsCssClass,formatter:d,editor:null}}var k,l={groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0};b=a.extend(!0,{},l,b);var m=new Slick.Event,n=new Slick.Event;return{init:e,destroy:f,getGroupRowMetadata:i,getTotalsRowMetadata:j,onGroupExpanded:m,onGroupCollapsed:n}}a.extend(!0,window,{Slick:{Data:{GroupItemMetadataProvider:b}}})}(jQuery),define("components/slickgrid/slick.groupitemmetadataprovider",function(){}),function(a){function b(b){function c(a){Ca=a}function d(){wa=!0}function e(){wa=!1,fa()}function f(a){ya=a}function g(a){ka=a}function i(a){a=a||0;for(var b,c=a,d=qa.length;d>c;c++){if(b=qa[c][pa],void 0===b)throw"Each data element must implement a unique 'id' property";sa[b]=c}}function j(){for(var a,b=0,c=qa.length;c>b;b++)if(a=qa[b][pa],void 0===a||sa[a]!==b)throw"Each data element must implement a unique 'id' property"}function k(){return qa}function l(a,b){void 0!==b&&(pa=b),qa=Aa=a,sa={},i(),j(),fa()}function m(a){void 0!=a.pageSize&&(Ia=a.pageSize,Ja=Ia?Math.min(Ja,Math.max(0,Math.ceil(Ka/Ia)-1)):0),void 0!=a.pageNum&&(Ja=Math.min(a.pageNum,Math.max(0,Math.ceil(Ka/Ia)-1))),Na.notify(n(),null,na),fa()}function n(){var a=Ia?Math.max(1,Math.ceil(Ka/Ia)):1;return{pageSize:Ia,pageNum:Ja,totalRows:Ka,totalPages:a,dataView:na}}function o(a,b,c){if(c){for(var d=new Array(qa.length),e=0;e<qa.length;e++)d[e]=[c(qa[e]),qa[e]];h.sort(d,function(b,c){return a(b[0],c[0])});for(var e=0;e<d.length;e++)qa[e]=d[e][1]}else h.sort(qa,a);b===!1&&qa.reverse(),sa={},i(),fa()}function p(a,b){xa=b,ja=a,ia=null,b===!1&&qa.reverse(),qa=_.sortBy(qa,a),b===!1&&qa.reverse(),sa={},i(),fa()}function q(a,b){xa=b,ia=a,ja=null;var c=Object.prototype.toString;Object.prototype.toString="function"==typeof a?a:function(){return this[a]},b===!1&&qa.reverse(),qa.sort(),Object.prototype.toString=c,b===!1&&qa.reverse(),sa={},i(),fa()}function r(){ja?o(ja,xa):ia&&q(ia,xa)}function s(a){ua=a,b.inlineFilters&&(la=Z(),ma=$()),fa()}function t(){return Ea}function u(c){b.groupItemMetadataProvider||(b.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider),Fa=[],Ga=[],c=c||[],Ea=Array.isArray(c)?c:[c];for(var d=0;d<Ea.length;d++){var e=Ea[d]=a.extend(!0,{},Da,Ea[d]);e.getterIsAFn="function"==typeof e.getter,e.compiledAccumulators=[];for(var f=e.aggregators.length;f--;)e.compiledAccumulators[f]=Y(e.aggregators[f]);Ga[d]={}}fa()}function v(a,b,c){return null==a?void u([]):void u({getter:a,formatter:b,comparer:c})}function w(a,b){if(!Ea.length)throw new Error("At least one grouping must be specified before calling setAggregators().");Ea[0].aggregators=a,Ea[0].aggregateCollapsed=b,u(Ea)}function x(a){return qa[a]}function y(a){return sa[a]}function z(){if(!ta){ta={};for(var a=0,b=ra.length;b>a;a++)ta[ra[a][pa]]=a}}function A(a){return z(),ta[a]}function B(a){return qa[sa[a]]}function C(a){var b=[];z();for(var c=0;c<a.length;c++){var d=ta[a[c]];null!=d&&(b[b.length]=d)}return b}function D(a){for(var b=[],c=0;c<a.length;c++)a[c]<ra.length&&(b[b.length]=ra[a[c]][pa]);return b}function E(a,b){if(void 0===sa[a]||a!==b[pa])throw"Invalid or non-matching id";qa[sa[a]]=b,va||(va={}),va[a]=!0,fa()}function F(a,b){qa.splice(a,0,b),i(a),fa()}function G(a){qa.push(a),i(qa.length-1),fa()}function H(a){var b=sa[a];if(void 0===b)throw"Invalid id";delete sa[a],qa.splice(b,1),i(b),fa()}function I(){return ra.length}function J(a){return ra[a]}function K(a){var c=ra[a];return void 0===c?null:c.__group?b.groupItemMetadataProvider.getGroupRowMetadata(c):c.__groupTotals?b.groupItemMetadataProvider.getTotalsRowMetadata(c):null}function L(a,b){if(null==a)for(var c=0;c<Ea.length;c++)Ga[c]={},Ea[c].collapsed=b;else Ga[a]={},Ea[a].collapsed=b;fa()}function M(a){L(a,!0)}function N(a){L(a,!1)}function O(a,b,c){Ga[a][b]=Ea[a].collapsed^c,fa()}function P(a){var b=Array.prototype.slice.call(arguments),c=b[0];1==b.length&&-1!=c.indexOf(Ha)?O(c.split(Ha).length-1,c,!0):O(b.length-1,b.join(Ha),!0)}function Q(a){var b=Array.prototype.slice.call(arguments),c=b[0];1==b.length&&-1!=c.indexOf(Ha)?O(c.split(Ha).length-1,c,!1):O(b.length-1,b.join(Ha),!1)}function R(){return Fa}function S(a,b){for(var c,d,e,f=[],g={},h=b?b.level+1:0,i=Ea[h],j=0,k=i.predefinedValues.length;k>j;j++)d=i.predefinedValues[j],c=g[d],c||(c=new Slick.Group,c.value=d,c.level=h,c.groupingKey=(b?b.groupingKey+Ha:"")+d,f[f.length]=c,g[d]=c);for(var j=0,k=a.length;k>j;j++)e=a[j],d=i.getterIsAFn?i.getter(e):e[i.getter],c=g[d],c||(c=new Slick.Group,c.value=d,c.level=h,c.groupingKey=(b?b.groupingKey+Ha:"")+d,f[f.length]=c,g[d]=c),c.rows[c.count++]=e;if(h<Ea.length-1)for(var j=0;j<f.length;j++)c=f[j],c.groups=S(c.rows,c);return f.sort(Ea[h].comparer),f}function T(a){for(var b,c=Ea[a.level],d=a.level==Ea.length,e=new Slick.GroupTotals,f=c.aggregators.length;f--;)b=c.aggregators[f],b.init(),c.compiledAccumulators[f].call(b,!d&&c.aggregateChildGroups?a.groups:a.rows),b.storeResult(e);e.group=a,a.totals=e}function U(a,b){b=b||0;for(var c,d=Ea[b],e=a.length;e--;)c=a[e],c.collapsed&&!d.aggregateCollapsed||(c.groups&&U(c.groups,b+1),d.aggregators.length&&(d.aggregateEmpty||c.rows.length||c.groups&&c.groups.length)&&T(c))}function V(a,b){b=b||0;for(var c,d=Ea[b],e=d.collapsed,f=Ga[b],g=a.length;g--;)c=a[g],c.collapsed=e^f[c.groupingKey],c.title=d.formatter?d.formatter(c):c.value,c.groups&&(V(c.groups,b+1),c.rows=[])}function W(a,b){b=b||0;for(var c,d,e=Ea[b],f=[],g=0,h=0,i=a.length;i>h;h++){if(d=a[h],f[g++]=d,!d.collapsed){c=d.groups?W(d.groups,b+1):d.rows;for(var j=0,k=c.length;k>j;j++)f[g++]=c[j]}d.totals&&e.displayTotalsRow&&(!d.collapsed||e.aggregateCollapsed)&&(f[g++]=d.totals)}return f}function X(a){var b=/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/,c=a.toString().match(b);return{params:c[1].split(","),body:c[2]}}function Y(a){var b=X(a.accumulate),c=new Function("_items","for (var "+b.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+b.params[0]+" = _items[_i]; "+b.body+"}");return c.displayName=c.name="compiledAccumulatorLoop",c}function Z(){var a=X(ua),b="{ continue _coreloop; }$1",c="{ _retval[_idx++] = $item$; continue _coreloop; }$1",d=a.body.replace(/return false\s*([;}]|\}|$)/gi,b).replace(/return!1([;}]|\}|$)/gi,b).replace(/return true\s*([;}]|\}|$)/gi,c).replace(/return!0([;}]|\}|$)/gi,c).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),e=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");e=e.replace(/\$filter\$/gi,d),e=e.replace(/\$item\$/gi,a.params[0]),e=e.replace(/\$args\$/gi,a.params[1]);var f=new Function("_items,_args",e);return f.displayName=f.name="compiledFilter",f}function $(){var a=X(ua),b="{ continue _coreloop; }$1",c="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",d=a.body.replace(/return false\s*([;}]|\}|$)/gi,b).replace(/return!1([;}]|\}|$)/gi,b).replace(/return true\s*([;}]|\}|$)/gi,c).replace(/return!0([;}]|\}|$)/gi,c).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),e=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");e=e.replace(/\$filter\$/gi,d),e=e.replace(/\$item\$/gi,a.params[0]),e=e.replace(/\$args\$/gi,a.params[1]);var f=new Function("_items,_args,_cache",e);return f.displayName=f.name="compiledFilterWithCaching",f}function aa(a,b){for(var c=[],d=0,e=0,f=a.length;f>e;e++)ua(a[e],b)&&(c[d++]=a[e]);return c}function ba(a,b,c){for(var d,e=[],f=0,g=0,h=a.length;h>g;g++)d=a[g],c[g]?e[f++]=d:ua(d,b)&&(e[f++]=d,c[g]=!0);return e}function ca(a){if(ua){var c=b.inlineFilters?la:aa,d=b.inlineFilters?ma:ba;ya.isFilterNarrowing?Aa=c(Aa,ka):ya.isFilterExpanding?Aa=d(a,ka,Ba):ya.isFilterUnchanged||(Aa=c(a,ka))}else Aa=Ia?a:a.concat();var e;return Ia?(Aa.length<Ja*Ia&&(Ja=Math.floor(Aa.length/Ia)),e=Aa.slice(Ia*Ja,Ia*Ja+Ia)):e=Aa,{totalRows:Aa.length,rows:e}}function da(a,b){var c,d,e,f=[],g=0,h=b.length;ya&&ya.ignoreDiffsBefore&&(g=Math.max(0,Math.min(b.length,ya.ignoreDiffsBefore))),ya&&ya.ignoreDiffsAfter&&(h=Math.min(b.length,Math.max(0,ya.ignoreDiffsAfter)));for(var i=g,j=a.length;h>i;i++)i>=j?f[f.length]=i:(c=b[i],d=a[i],(Ea.length&&(e=c.__nonDataRow||d.__nonDataRow)&&c.__group!==d.__group||c.__group&&!c.equals(d)||e&&(c.__groupTotals||d.__groupTotals)||c[pa]!=d[pa]||va&&va[c[pa]])&&(f[f.length]=i));return f}function ea(a){ta=null,ya.isFilterNarrowing==za.isFilterNarrowing&&ya.isFilterExpanding==za.isFilterExpanding||(Ba=[]);var b=ca(a);Ka=b.totalRows;var c=b.rows;Fa=[],Ea.length&&(Fa=S(c),Fa.length&&(U(Fa),V(Fa),c=W(Fa)));var d=da(ra,c);return ra=c,d}function fa(){if(!wa){var a=ra.length,b=Ka,c=ea(qa,ua);Ia&&Ja*Ia>Ka&&(Ja=Math.max(0,Math.ceil(Ka/Ia)-1),c=ea(qa,ua)),va=null,za=ya,ya={},b!==Ka&&Na.notify(n(),null,na),a!==ra.length&&La.notify({previous:a,current:ra.length,dataView:na},null,na),c.length>0&&Ma.notify({rows:c,dataView:na},null,na)}}function ga(a,b){function c(){if(f.length>0){d=!0;var c=e.mapIdsToRows(f);b||(f=e.mapRowsToIds(c)),a.setSelectedRows(c),d=!1}}var d,e=this,f=e.mapRowsToIds(a.getSelectedRows());a.onSelectedRowsChanged.subscribe(function(b,c){d||(f=e.mapRowsToIds(a.getSelectedRows()))}),this.onRowsChanged.subscribe(c),this.onRowCountChanged.subscribe(c)}function ha(a,b){function c(a){e={};for(var b in a){var c=ra[b][pa];e[c]=a[b]}}function d(){if(e){f=!0,z();var c={};for(var d in e){var g=ta[d];void 0!=g&&(c[g]=e[d])}a.setCellCssStyles(b,c),f=!1}}var e,f;c(a.getCellCssStyles(b)),a.onCellCssStylesChanged.subscribe(function(a,d){f||b==d.key&&d.hash&&c(d.hash)}),this.onRowsChanged.subscribe(d),this.onRowCountChanged.subscribe(d)}var ia,ja,ka,la,ma,na=this,oa={groupItemMetadataProvider:null,inlineFilters:!1},pa="id",qa=[],ra=[],sa={},ta=null,ua=null,va=null,wa=!1,xa=!0,ya={},za={},Aa=[],Ba=[],Ca=null,Da={getter:null,formatter:null,comparer:function(a,b){return a.value===b.value?0:a.value>b.value?1:-1},predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0},Ea=[],Fa=[],Ga=[],Ha=":|:",Ia=0,Ja=0,Ka=0,La=new Slick.Event,Ma=new Slick.Event,Na=new Slick.Event;b=a.extend(!0,{},oa,b),a.extend(this,{setModule:c,beginUpdate:d,endUpdate:e,setPagingOptions:m,getPagingInfo:n,getItems:k,setItems:l,setFilter:s,sort:o,sortBy:p,fastSort:q,reSort:r,setGrouping:u,getGrouping:t,groupBy:v,setAggregators:w,collapseAllGroups:M,expandAllGroups:N,collapseGroup:P,expandGroup:Q,getGroups:R,getIdxById:y,getRowById:A,getItemById:B,getItemByIdx:x,mapRowsToIds:D,mapIdsToRows:C,setRefreshHints:f,setFilterArgs:g,refresh:fa,updateItem:E,insertItem:F,addItem:G,deleteItem:H,syncGridSelection:ga,syncGridCellCssStyles:ha,getLength:I,getItem:J,getItemMetadata:K,onRowCountChanged:La,onRowsChanged:Ma,onPagingInfoChanged:Na})}function c(a){this.field_=a,this.init=function(){this.count_=0,this.nonNullCount_=0,this.sum_=0},this.accumulate=function(a){var b=a[this.field_];this.count_++,null==b||""===b||isNaN(b)||(this.nonNullCount_++,this.sum_+=parseFloat(b))},this.storeResult=function(a){a.avg||(a.avg={}),0!=this.nonNullCount_&&(a.avg[this.field_]=this.sum_/this.nonNullCount_)}}function d(a){this.field_=a,this.init=function(){this.min_=null},this.accumulate=function(a){var b=a[this.field_];null==b||""===b||isNaN(b)||(null==this.min_||b<this.min_)&&(this.min_=b)},this.storeResult=function(a){a.min||(a.min={}),a.min[this.field_]=this.min_}}function e(a){this.field_=a,this.init=function(){this.max_=null},this.accumulate=function(a){var b=a[this.field_];null==b||""===b||isNaN(b)||(null==this.max_||b>this.max_)&&(this.max_=b)},this.storeResult=function(a){a.max||(a.max={}),a.max[this.field_]=this.max_}}function f(a){this.field_=a,this.init=function(){this.sum_=null},this.accumulate=function(a){var b=a[this.field_];null==b||""===b||isNaN(b)||(this.sum_+=parseFloat(b))},this.storeResult=function(a){a.sum||(a.sum={}),a.sum[this.field_]=this.sum_}}function g(a){"use strict";function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){if(a===b)return 0;var c=String(a),d=String(b);return c===d?0:d>c?-1:1}function d(a){for(var b=0;a>=k;)b|=1&a,a>>=1;return a+b}function e(a,b,c,d){var e=b+1;if(e===c)return 1;if(d(a[e++],a[b])<0){for(;c>e&&d(a[e],a[e-1])<0;)e++;f(a,b,e)}else for(;c>e&&d(a[e],a[e-1])>=0;)e++;return e-b}function f(a,b,c){for(c--;c>b;){var d=a[b];a[b++]=a[c],a[c--]=d}}function g(a,b,c,d,e){for(d===b&&d++;c>d;d++){for(var f=a[d],g=b,h=d;h>g;){var i=g+h>>>1;e(f,a[i])<0?h=i:g=i+1}var j=d-g;switch(j){case 3:a[g+3]=a[g+2];case 2:a[g+2]=a[g+1];case 1:a[g+1]=a[g];break;default:for(;j>0;)a[g+j]=a[g+j-1],j--}a[g]=f}}function h(a,b,c,d,e,f){var g=0,h=0,i=1;if(f(a,b[c+e])>0){for(h=d-e;h>i&&f(a,b[c+e+i])>0;)g=i,i=(i<<1)+1,0>=i&&(i=h);i>h&&(i=h),g+=e,i+=e}else{for(h=e+1;h>i&&f(a,b[c+e-i])<=0;)g=i,i=(i<<1)+1,0>=i&&(i=h);i>h&&(i=h);var j=g;g=e-i,i=e-j}for(g++;i>g;){var k=g+(i-g>>>1);f(a,b[c+k])>0?g=k+1:i=k}return i}function i(a,b,c,d,e,f){var g=0,h=0,i=1;if(f(a,b[c+e])<0){for(h=e+1;h>i&&f(a,b[c+e-i])<0;)g=i,i=(i<<1)+1,0>=i&&(i=h);i>h&&(i=h);var j=g;g=e-i,i=e-j}else{for(h=d-e;h>i&&f(a,b[c+e+i])>=0;)g=i,i=(i<<1)+1,0>=i&&(i=h);i>h&&(i=h),g+=e,i+=e}for(g++;i>g;){var k=g+(i-g>>>1);f(a,b[c+k])<0?i=k:g=k+1}return i}function j(a,b,f,h){if(!Array.isArray(a))throw new TypeError("Can only sort arrays");b?"function"!=typeof b&&(h=f,f=b,b=c):b=c,f||(f=0),h||(h=a.length);var i=h-f;if(!(2>i)){var j=0;if(k>i)return j=e(a,f,h,b),void g(a,f,h,f+j,b);var l=new n(a,b),m=d(i);do{if(j=e(a,f,h,b),m>j){var o=i;o>m&&(o=m),g(a,f,f+o,f+j,b),j=o}l.pushRun(f,j),l.mergeRuns(),i-=j,f+=j}while(0!==i);l.forceMergeRuns()}}a.__esModule=!0,a.sort=j;var k=32,l=7,m=256,n=function(){function a(c,d){b(this,a),this.array=null,this.compare=null,this.minGallop=l,this.length=0,this.tmpStorageLength=m,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=c,this.compare=d,this.length=c.length,this.length<2*m&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return a.prototype.pushRun=function(a,b){this.runStart[this.stackSize]=a,this.runLength[this.stackSize]=b,this.stackSize+=1},a.prototype.mergeRuns=function(){for(;this.stackSize>1;){var a=this.stackSize-2;if(a>=1&&this.runLength[a-1]<=this.runLength[a]+this.runLength[a+1]||a>=2&&this.runLength[a-2]<=this.runLength[a]+this.runLength[a-1])this.runLength[a-1]<this.runLength[a+1]&&a--;else if(this.runLength[a]>this.runLength[a+1])break;this.mergeAt(a)}},a.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var a=this.stackSize-2;a>0&&this.runLength[a-1]<this.runLength[a+1]&&a--,this.mergeAt(a)}},a.prototype.mergeAt=function(a){var b=this.compare,c=this.array,d=this.runStart[a],e=this.runLength[a],f=this.runStart[a+1],g=this.runLength[a+1];this.runLength[a]=e+g,a===this.stackSize-3&&(this.runStart[a+1]=this.runStart[a+2],this.runLength[a+1]=this.runLength[a+2]),this.stackSize--;var j=i(c[f],c,d,e,0,b);d+=j,e-=j,0!==e&&(g=h(c[d+e-1],c,f,g,g-1,b),0!==g&&(g>=e?this.mergeLow(d,e,f,g):this.mergeHigh(d,e,f,g)))},a.prototype.mergeLow=function(a,b,c,d){var e=this.compare,f=this.array,g=this.tmp,j=0;for(j=0;b>j;j++)g[j]=f[a+j];var k=0,m=c,n=a;if(f[n++]=f[m++],0!==--d){if(1===b){for(j=0;d>j;j++)f[n+j]=f[m+j];return void(f[n+d]=g[k])}for(var o=this.minGallop;;){var p=0,q=0,r=!1;do if(e(f[m],g[k])<0){if(f[n++]=f[m++],q++,p=0,0===--d){r=!0;break}}else if(f[n++]=g[k++],p++,q=0,1===--b){r=!0;break}while(o>(p|q));if(r)break;do{if(p=i(f[m],g,k,b,0,e),0!==p){for(j=0;p>j;j++)f[n+j]=g[k+j];if(n+=p,k+=p,b-=p,1>=b){r=!0;break}}if(f[n++]=f[m++],0===--d){r=!0;break}if(q=h(g[k],f,m,d,0,e),0!==q){for(j=0;q>j;j++)f[n+j]=f[m+j];if(n+=q,m+=q,d-=q,0===d){r=!0;break}}if(f[n++]=g[k++],1===--b){r=!0;break}o--}while(p>=l||q>=l);if(r)break;0>o&&(o=0),o+=2}if(this.minGallop=o,1>o&&(this.minGallop=1),1===b){for(j=0;d>j;j++)f[n+j]=f[m+j];f[n+d]=g[k]}else{if(0===b)throw new Error("mergeLow preconditions were not respected");for(j=0;b>j;j++)f[n+j]=g[k+j]}}else for(j=0;b>j;j++)f[n+j]=g[k+j]},a.prototype.mergeHigh=function(a,b,c,d){var e=this.compare,f=this.array,g=this.tmp,j=0;for(j=0;d>j;j++)g[j]=f[c+j];var k=a+b-1,m=d-1,n=c+d-1,o=0,p=0;if(f[n--]=f[k--],0!==--b){if(1===d){for(n-=b,k-=b,p=n+1,o=k+1,j=b-1;j>=0;j--)f[p+j]=f[o+j];return void(f[n]=g[m])}for(var q=this.minGallop;;){var r=0,s=0,t=!1;do if(e(g[m],f[k])<0){if(f[n--]=f[k--],r++,s=0,0===--b){t=!0;break}}else if(f[n--]=g[m--],s++,r=0,1===--d){t=!0;break}while(q>(r|s));if(t)break;do{if(r=b-i(g[m],f,a,b,b-1,e),0!==r){for(n-=r,k-=r,b-=r,p=n+1,o=k+1,j=r-1;j>=0;j--)f[p+j]=f[o+j];if(0===b){t=!0;break}}if(f[n--]=g[m--],1===--d){t=!0;break}if(s=d-h(f[k],g,0,d,d-1,e),0!==s){for(n-=s,m-=s,d-=s,p=n+1,o=m+1,j=0;s>j;j++)f[p+j]=g[o+j];if(1>=d){t=!0;break}}if(f[n--]=f[k--],0===--b){t=!0;break}q--}while(r>=l||s>=l);if(t)break;0>q&&(q=0),q+=2}if(this.minGallop=q,1>q&&(this.minGallop=1),1===d){for(n-=b,k-=b,p=n+1,o=k+1,j=b-1;j>=0;j--)f[p+j]=f[o+j];f[n]=g[m]}else{if(0===d)throw new Error("mergeHigh preconditions were not respected");for(o=n-(d-1),j=0;d>j;j++)f[o+j]=g[j]}}else for(o=n-(d-1),j=0;d>j;j++)f[o+j]=g[j]},a}()}a.extend(!0,window,{Slick:{Data:{DataView:b,Aggregators:{Avg:c,Min:d,Max:e,Sum:f}}}});var h={};g(h)}(jQuery),define("components/slickgrid/slick.dataview",function(){}),function(a){a.fn.drop=function(b,c,d){var e="string"==typeof b?b:"",f=a.isFunction(b)?b:a.isFunction(c)?c:null;return 0!==e.indexOf("drop")&&(e="drop"+e),d=(b==f?c:d)||{},f?this.bind(e,d,f):this.trigger(e)},a.drop=function(b){b=b||{},d.multi=b.multi===!0?1/0:b.multi===!1?1:isNaN(b.multi)?d.multi:b.multi,d.delay=b.delay||d.delay,d.tolerance=a.isFunction(b.tolerance)?b.tolerance:null===b.tolerance?null:d.tolerance,d.mode=b.mode||d.mode||"intersect"};var b=a.event,c=b.special,d=a.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(b){var c=a.data(this,d.datakey);c.related+=1},remove:function(){a.data(this,d.datakey).related-=1},setup:function(){if(!a.data(this,d.datakey)){var b={related:0,active:[],anyactive:0,winner:0,location:{}};a.data(this,d.datakey,b),d.targets.push(this)}},teardown:function(){var b=a.data(this,d.datakey)||{};if(!b.related){a.removeData(this,d.datakey);var c=this;d.targets=a.grep(d.targets,function(a){return a!==c})}},handler:function(b,e){var f;if(e)switch(b.type){case"mousedown":case"touchstart":f=a(d.targets),"string"==typeof e.drop&&(f=f.filter(e.drop)),f.each(function(){var b=a.data(this,d.datakey);b.active=[],b.anyactive=0,b.winner=0}),e.droppable=f,c.drag.hijack(b,"dropinit",e);break;case"mousemove":case"touchmove":d.event=b,d.timer||d.tolerate(e);break;case"mouseup":case"touchend":d.timer=clearTimeout(d.timer),e.propagates&&(c.drag.hijack(b,"drop",e),c.drag.hijack(b,"dropend",e))}},locate:function(b,c){var e=a.data(b,d.datakey),f=a(b),g=f.offset()||{},h=f.outerHeight(),i=f.outerWidth(),j={elem:b,width:i,height:h,top:g.top,left:g.left,right:g.left+i,bottom:g.top+h};return e&&(e.location=j,e.index=c,e.elem=b),j},contains:function(a,b){return(b[0]||b.left)>=a.left&&(b[0]||b.right)<=a.right&&(b[1]||b.top)>=a.top&&(b[1]||b.bottom)<=a.bottom},modes:{intersect:function(a,b,c){return this.contains(c,[a.pageX,a.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(a,b,c){return Math.max(0,Math.min(c.bottom,b.bottom)-Math.max(c.top,b.top))*Math.max(0,Math.min(c.right,b.right)-Math.max(c.left,b.left))},fit:function(a,b,c){return this.contains(c,b)?1:0},middle:function(a,b,c){return this.contains(c,[b.left+.5*b.width,b.top+.5*b.height])?1:0}},sort:function(a,b){return b.winner-a.winner||a.index-b.index},tolerate:function(b){var e,f,g,h,i,j,k,l,m=0,n=b.interactions.length,o=[d.event.pageX,d.event.pageY],p=d.tolerance||d.modes[d.mode];do if(l=b.interactions[m]){if(!l)return;l.drop=[],i=[],j=l.droppable.length,p&&(g=d.locate(l.proxy)),e=0;do if(k=l.droppable[e]){if(h=a.data(k,d.datakey),f=h.location,!f)continue;h.winner=p?p.call(d,d.event,g,f):d.contains(f,o)?1:0,i.push(h)}while(++e<j);i.sort(d.sort),e=0;do(h=i[e])&&(h.winner&&l.drop.length<d.multi?(h.active[m]||h.anyactive||(c.drag.hijack(d.event,"dropstart",b,m,h.elem)[0]!==!1?(h.active[m]=1,h.anyactive+=1):h.winner=0),h.winner&&l.drop.push(h.elem)):h.active[m]&&1==h.anyactive&&(c.drag.hijack(d.event,"dropend",b,m,h.elem),h.active[m]=0,h.anyactive-=1));while(++e<j)}while(++m<n);d.last&&o[0]==d.last.pageX&&o[1]==d.last.pageY?delete d.timer:d.timer=setTimeout(function(){d.tolerate(b)},d.delay),d.last=d.event}};c.dropinit=c.dropstart=c.dropend=d}(jQuery),define("components/slickgrid/lib/jquery.event.drop-2.2",function(){}),function(a){a.fn.drag=function(b,c,d){var e="string"==typeof b?b:"",f=a.isFunction(b)?b:a.isFunction(c)?c:null;return 0!==e.indexOf("drag")&&(e="drag"+e),d=(b==f?c:d)||{},f?this.bind(e,d,f):this.trigger(e)};var b=a.event,c=b.special,d=c.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(b){var c=a.data(this,d.datakey),e=b.data||{};c.related+=1,a.each(d.defaults,function(a,b){void 0!==e[a]&&(c[a]=e[a])})},remove:function(){a.data(this,d.datakey).related-=1},setup:function(){if(!a.data(this,d.datakey)){var c=a.extend({related:0},d.defaults);a.data(this,d.datakey,c),b.add(this,"touchstart mousedown",d.init,c),this.attachEvent&&this.attachEvent("ondragstart",d.dontstart)}},teardown:function(){var c=a.data(this,d.datakey)||{};c.related||(a.removeData(this,d.datakey),b.remove(this,"touchstart mousedown",d.init),d.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",d.dontstart))},init:function(e){if(!d.touched){var f,g=e.data;if(!(0!=e.which&&g.which>0&&e.which!=g.which)&&!a(e.target).is(g.not)&&(!g.handle||a(e.target).closest(g.handle,e.currentTarget).length)&&(d.touched="touchstart"==e.type?this:null,g.propagates=1,g.mousedown=this,g.interactions=[d.interaction(this,g)],g.target=e.target,g.pageX=e.pageX,g.pageY=e.pageY,g.dragging=null,f=d.hijack(e,"draginit",g),g.propagates))return f=d.flatten(f),f&&f.length&&(g.interactions=[],a.each(f,function(){g.interactions.push(d.interaction(this,g))})),g.propagates=g.interactions.length,g.drop!==!1&&c.drop&&c.drop.handler(e,g),d.textselect(!1),d.touched?b.add(d.touched,"touchmove touchend",d.handler,g):b.add(document,"mousemove mouseup",d.handler,g),!d.touched||g.live?!1:void 0}},interaction:function(b,c){var e=a(b)[c.relative?"position":"offset"]()||{top:0,left:0};return{drag:b,callback:new d.callback,droppable:[],offset:e}},handler:function(e){var f=e.data;switch(e.type){case!f.dragging&&"touchmove":e.preventDefault();case!f.dragging&&"mousemove":if(Math.pow(e.pageX-f.pageX,2)+Math.pow(e.pageY-f.pageY,2)<Math.pow(f.distance,2))break;e.target=f.target,d.hijack(e,"dragstart",f),f.propagates&&(f.dragging=!0);case"touchmove":e.preventDefault();case"mousemove":if(f.dragging){if(d.hijack(e,"drag",f),f.propagates){f.drop!==!1&&c.drop&&c.drop.handler(e,f);break}e.type="mouseup"}case"touchend":case"mouseup":default:d.touched?b.remove(d.touched,"touchmove touchend",d.handler):b.remove(document,"mousemove mouseup",d.handler),f.dragging&&(f.drop!==!1&&c.drop&&c.drop.handler(e,f),d.hijack(e,"dragend",f)),d.textselect(!0),f.click===!1&&f.dragging&&a.data(f.mousedown,"suppress.click",(new Date).getTime()+5),f.dragging=d.touched=!1}},hijack:function(c,e,f,g,h){if(f){var i,j,k,l={event:c.originalEvent,type:c.type},m=e.indexOf("drop")?"drag":"drop",n=g||0,o=isNaN(g)?f.interactions.length:g;c.type=e,c.originalEvent=null,f.results=[];do if(j=f.interactions[n]){if("dragend"!==e&&j.cancelled)continue;k=d.properties(c,f,j),j.results=[],a(h||j[m]||f.droppable).each(function(g,h){return k.target=h,c.isPropagationStopped=function(){return!1},i=h?b.dispatch.call(h,c,k):null,i===!1?("drag"==m&&(j.cancelled=!0,f.propagates-=1),"drop"==e&&(j[m][g]=null)):"dropinit"==e&&j.droppable.push(d.element(i)||h),"dragstart"==e&&(j.proxy=a(d.element(i)||j.drag)[0]),j.results.push(i),delete c.result,"dropinit"!==e?i:void 0}),f.results[n]=d.flatten(j.results),"dropinit"==e&&(j.droppable=d.flatten(j.droppable)),"dragstart"!=e||j.cancelled||k.update()}while(++n<o);return c.type=l.type,c.originalEvent=l.event,d.flatten(f.results)}},properties:function(a,b,c){var e=c.callback;return e.drag=c.drag,e.proxy=c.proxy||c.drag,e.startX=b.pageX,e.startY=b.pageY,e.deltaX=a.pageX-b.pageX,e.deltaY=a.pageY-b.pageY,e.originalX=c.offset.left,e.originalY=c.offset.top,e.offsetX=e.originalX+e.deltaX,e.offsetY=e.originalY+e.deltaY,e.drop=d.flatten((c.drop||[]).slice()),e.available=d.flatten((c.droppable||[]).slice()),e},element:function(a){return a&&(a.jquery||1==a.nodeType)?a:void 0},flatten:function(b){return a.map(b,function(b){return b&&b.jquery?a.makeArray(b):b&&b.length?d.flatten(b):b})},textselect:function(b){a(document)[b?"unbind":"bind"]("selectstart",d.dontstart).css("MozUserSelect",b?"":"none"),document.unselectable=b?"off":"on"},dontstart:function(){return!1},callback:function(){}};d.callback.prototype={update:function(){c.drop&&this.available.length&&a.each(this.available,function(a){c.drop.locate(this,a)})}};var e=b.dispatch;b.dispatch=function(b){return a.data(this,"suppress."+b.type)-(new Date).getTime()>0?void a.removeData(this,"suppress."+b.type):e.apply(this,arguments)};var f=b.fixHooks.touchstart=b.fixHooks.touchmove=b.fixHooks.touchend=b.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(b,c){if(c){var d=c.touches&&c.touches[0]||c.changedTouches&&c.changedTouches[0]||null;d&&a.each(f.props,function(a,c){b[c]=d[c]})}return b}};c.draginit=c.dragstart=c.dragend=d}(jQuery),define("components/slickgrid/lib/jquery.event.drag-2.2",function(){}),function(a){function b(b,c){function d(d){f||(f=a("<div></div>",{css:c.selectionCss}).addClass(c.selectionCssClass).css("position","absolute").appendTo(b.getCanvasNode()));var e=b.getCellNodeBox(d.fromRow,d.fromCell),g=b.getCellNodeBox(d.toRow,d.toCell);return f.css({top:e.top-1,left:e.left-1,height:g.bottom-e.top-2,width:g.right-e.left-2}),f}function e(){f&&(f.remove(),f=null)}var f,g={selectionCssClass:"slick-range-decorator",selectionCss:{zIndex:"9999",border:"2px dashed red"}};c=a.extend(!0,{},g,c),a.extend(this,{show:d,hide:e})}a.extend(!0,window,{Slick:{CellRangeDecorator:b}})}(jQuery),define("components/slickgrid/plugins/slick.cellrangedecorator",function(){}),function(a){function b(b){function c(c){b=a.extend(!0,{},o,b),l=new Slick.CellRangeDecorator(c,b),i=c,j=i.getCanvasNode(),n.subscribe(i.onDragInit,e).subscribe(i.onDragStart,f).subscribe(i.onDrag,g).subscribe(i.onDragEnd,h)}function d(){n.unsubscribeAll()}function e(a,b){a.stopImmediatePropagation()}function f(b,c){var d=i.getCellFromEvent(b);if(m.onBeforeCellRangeSelected.notify(d)!==!1&&i.canCellBeSelected(d.row,d.cell)&&(k=!0,b.stopImmediatePropagation()),k){i.focus();var e=i.getCellFromPoint(c.startX-a(j).offset().left,c.startY-a(j).offset().top);return c.range={start:e,end:{}},l.show(new Slick.Range(e.row,e.cell))}}function g(b,c){if(k){b.stopImmediatePropagation();var d=i.getCellFromPoint(b.pageX-a(j).offset().left,b.pageY-a(j).offset().top);i.canCellBeSelected(d.row,d.cell)&&(c.range.end=d,l.show(new Slick.Range(c.range.start.row,c.range.start.cell,d.row,d.cell)))}}function h(a,b){k&&(k=!1,a.stopImmediatePropagation(),l.hide(),m.onCellRangeSelected.notify({range:new Slick.Range(b.range.start.row,b.range.start.cell,b.range.end.row,b.range.end.cell)
}))}var i,j,k,l,m=this,n=new Slick.EventHandler,o={selectionCss:{border:"2px dashed blue"}};a.extend(this,{init:c,destroy:d,onBeforeCellRangeSelected:new Slick.Event,onCellRangeSelected:new Slick.Event})}a.extend(!0,window,{Slick:{CellRangeSelector:b}})}(jQuery),define("components/slickgrid/plugins/slick.cellrangeselector",function(){}),function(a){function b(b){function c(c){n=a.extend(!0,{},r,b),l=c,m=l.getCanvasNode(),l.onActiveCellChanged.subscribe(j),l.onKeyDown.subscribe(k),c.registerPlugin(q),q.onCellRangeSelected.subscribe(i),q.onBeforeCellRangeSelected.subscribe(h)}function d(){l.onActiveCellChanged.unsubscribe(j),l.onKeyDown.unsubscribe(k),q.onCellRangeSelected.unsubscribe(i),q.onBeforeCellRangeSelected.unsubscribe(h),l.unregisterPlugin(q)}function e(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];l.canCellBeSelected(d.fromRow,d.fromCell)&&l.canCellBeSelected(d.toRow,d.toCell)&&b.push(d)}return b}function f(a){(o&&0!==o.length||a&&0!==a.length)&&(o=e(a),p.onSelectedRangesChanged.notify(o))}function g(){return o}function h(a,b){return l.getEditorLock().isActive()?(a.stopPropagation(),!1):void 0}function i(a,b){f([b.range])}function j(a,b){n.selectActiveCell&&null!=b.row&&null!=b.cell&&f([new Slick.Range(b.row,b.cell)])}function k(a){var b,c,d=l.getActiveCell();if(d&&a.shiftKey&&!a.ctrlKey&&!a.altKey&&(37==a.which||39==a.which||38==a.which||40==a.which)){b=g(),b.length||b.push(new Slick.Range(d.row,d.cell)),c=b.pop(),c.contains(d.row,d.cell)||(c=new Slick.Range(d.row,d.cell));var h=c.toRow-c.fromRow,i=c.toCell-c.fromCell,j=d.row==c.fromRow?1:-1,k=d.cell==c.fromCell?1:-1;37==a.which?i-=k:39==a.which?i+=k:38==a.which?h-=j:40==a.which&&(h+=j);var m=new Slick.Range(d.row,d.cell,d.row+j*h,d.cell+k*i);if(e([m]).length){b.push(m);var n=j>0?m.toRow:m.fromRow,o=k>0?m.toCell:m.fromCell;l.scrollRowIntoView(n),l.scrollCellIntoView(n,o)}else b.push(c);f(b),a.preventDefault(),a.stopPropagation()}}var l,m,n,o=[],p=this,q=new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}),r={selectActiveCell:!0};a.extend(this,{getSelectedRanges:g,setSelectedRanges:f,init:c,destroy:d,onSelectedRangesChanged:new Slick.Event})}a.extend(!0,window,{Slick:{CellSelectionModel:b}})}(jQuery),define("components/slickgrid/plugins/slick.cellselectionmodel",function(){}),function(a){function b(b){function c(c){r=a.extend(!0,{},v,b),p=c,u.subscribe(p.onActiveCellChanged,e(m)),u.subscribe(p.onKeyDown,e(n)),u.subscribe(p.onClick,e(o))}function d(){u.unsubscribeAll()}function e(a){return function(){q||(q=!0,a.apply(this,arguments),q=!1)}}function f(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].fromRow;d<=a[c].toRow;d++)b.push(d);return b}function g(a){for(var b=[],c=p.getColumns().length-1,d=0;d<a.length;d++)b.push(new Slick.Range(a[d],0,a[d],c));return b}function h(a,b){var c,d=[];for(c=a;b>=c;c++)d.push(c);for(c=b;a>c;c++)d.push(c);return d}function i(){return f(s)}function j(a){k(g(a))}function k(a){(s&&0!==s.length||a&&0!==a.length)&&(s=a,t.onSelectedRangesChanged.notify(s))}function l(){return s}function m(a,b){r.selectActiveRow&&null!=b.row&&k([new Slick.Range(b.row,0,b.row,p.getColumns().length-1)])}function n(a){var b=p.getActiveCell();if(b&&a.shiftKey&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&(38==a.which||40==a.which)){var c=i();c.sort(function(a,b){return a-b}),c.length||(c=[b.row]);var d,e=c[0],f=c[c.length-1];d=40==a.which?b.row<f||e==f?++f:++e:b.row<f?--f:--e,d>=0&&d<p.getDataLength()&&(p.scrollRowIntoView(d),s=g(h(e,f)),k(s)),a.preventDefault(),a.stopPropagation()}}function o(b){var c=p.getCellFromEvent(b);if(!c||!p.canCellBeActive(c.row,c.cell))return!1;if(!p.getOptions().multiSelect||!b.ctrlKey&&!b.shiftKey&&!b.metaKey)return!1;var d=f(s),e=a.inArray(c.row,d);if(-1===e&&(b.ctrlKey||b.metaKey))d.push(c.row),p.setActiveCell(c.row,c.cell);else if(-1!==e&&(b.ctrlKey||b.metaKey))d=a.grep(d,function(a,b){return a!==c.row}),p.setActiveCell(c.row,c.cell);else if(d.length&&b.shiftKey){var h=d.pop(),i=Math.min(c.row,h),j=Math.max(c.row,h);d=[];for(var l=i;j>=l;l++)l!==h&&d.push(l);d.push(h),p.setActiveCell(c.row,c.cell)}return s=g(d),k(s),b.stopImmediatePropagation(),!0}var p,q,r,s=[],t=this,u=new Slick.EventHandler,v={selectActiveRow:!0};a.extend(this,{getSelectedRows:i,setSelectedRows:j,getSelectedRanges:l,setSelectedRanges:k,init:c,destroy:d,onSelectedRangesChanged:new Slick.Event})}a.extend(!0,window,{Slick:{RowSelectionModel:b}})}(jQuery),define("components/slickgrid/plugins/slick.rowselectionmodel",function(){}),function(a){function b(b){function c(c){b=a.extend(!0,{},n,b),i=c,j=i.getCanvasNode(),m.subscribe(i.onDragInit,e).subscribe(i.onDragStart,f).subscribe(i.onDrag,g).subscribe(i.onDragEnd,h)}function d(){m.unsubscribeAll()}function e(a,b){a.stopImmediatePropagation()}function f(c,d){var e=i.getCellFromEvent(c);if(b.cancelEditOnDrag&&i.getEditorLock().isActive()&&i.getEditorLock().cancelCurrentEdit(),i.getEditorLock().isActive()||!/move|selectAndMove/.test(i.getColumns()[e.cell].behavior))return!1;k=!0,c.stopImmediatePropagation();var f=i.getSelectedRows();0!=f.length&&-1!=a.inArray(e.row,f)||(f=[e.row],i.setSelectedRows(f));var g=i.getOptions().rowHeight;d.selectedRows=f,d.selectionProxy=a("<div class='slick-reorder-proxy'/>").css("position","absolute").css("zIndex","99999").css("width",a(j).innerWidth()).css("height",g*f.length).appendTo(j),d.guide=a("<div class='slick-reorder-guide'/>").css("position","absolute").css("zIndex","99998").css("width",a(j).innerWidth()).css("top",-1e3).appendTo(j),d.insertBefore=-1}function g(b,c){if(k){b.stopImmediatePropagation();var d=b.pageY-a(j).offset().top;c.selectionProxy.css("top",d-5);var e=Math.max(0,Math.min(Math.round(d/i.getOptions().rowHeight),i.getDataLength()));if(e!==c.insertBefore){var f={rows:c.selectedRows,insertBefore:e};l.onBeforeMoveRows.notify(f)===!1?(c.guide.css("top",-1e3),c.canMove=!1):(c.guide.css("top",e*i.getOptions().rowHeight),c.canMove=!0),c.insertBefore=e}}}function h(a,b){if(k&&(k=!1,a.stopImmediatePropagation(),b.guide.remove(),b.selectionProxy.remove(),b.canMove)){var c={rows:b.selectedRows,insertBefore:b.insertBefore};l.onMoveRows.notify(c)}}var i,j,k,l=this,m=new Slick.EventHandler,n={cancelEditOnDrag:!1};a.extend(this,{onBeforeMoveRows:new Slick.Event,onMoveRows:new Slick.Event,init:c,destroy:d})}a.extend(!0,window,{Slick:{RowMoveManager:b}})}(jQuery),define("components/slickgrid/plugins/slick.rowmovemanager",function(){}),function(a){function b(b){var c,d;this.init=function(){c=a("<INPUT type=text class='editor-text' />").appendTo(b.container).bind("keydown.nav",function(b){b.keyCode!==a.ui.keyCode.LEFT&&b.keyCode!==a.ui.keyCode.RIGHT||b.stopImmediatePropagation()}).focus().select()},this.destroy=function(){c.remove()},this.focus=function(){c.focus()},this.getValue=function(){return c.val()},this.setValue=function(a){c.val(a)},this.loadValue=function(a){d=a[b.column.field]||"",c.val(d),c[0].defaultValue=d,c.select()},this.serializeValue=function(){return c.val()},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return!(""==c.val()&&null==d)&&c.val()!=d},this.validate=function(){if(b.column.validator){var a=b.column.validator(c.val());if(!a.valid)return a}return{valid:!0,msg:null}},this.init()}function c(b){var c,d;this.init=function(){c=a("<INPUT type=text class='editor-text' />"),c.bind("keydown.nav",function(b){b.keyCode!==a.ui.keyCode.LEFT&&b.keyCode!==a.ui.keyCode.RIGHT||b.stopImmediatePropagation()}),c.appendTo(b.container),c.focus().select()},this.destroy=function(){c.remove()},this.focus=function(){c.focus()},this.loadValue=function(a){d=a[b.column.field],c.val(d),c[0].defaultValue=d,c.select()},this.serializeValue=function(){return parseInt(c.val(),10)||0},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return!(""==c.val()&&null==d)&&c.val()!=d},this.validate=function(){if(isNaN(c.val()))return{valid:!1,msg:"Please enter a valid integer"};if(b.column.validator){var a=b.column.validator(c.val());if(!a.valid)return a}return{valid:!0,msg:null}},this.init()}function d(b){function c(){var a=b.column.editorFixedDecimalPlaces;return"undefined"==typeof a&&(a=d.DefaultDecimalPlaces),a||0===a?a:null}var e,f;this.init=function(){e=a("<INPUT type=text class='editor-text' />"),e.bind("keydown.nav",function(b){b.keyCode!==a.ui.keyCode.LEFT&&b.keyCode!==a.ui.keyCode.RIGHT||b.stopImmediatePropagation()}),e.appendTo(b.container),e.focus().select()},this.destroy=function(){e.remove()},this.focus=function(){e.focus()},this.loadValue=function(a){f=a[b.column.field];var d=c();null!==d&&(f||0===f)&&f.toFixed&&(f=f.toFixed(d)),e.val(f),e[0].defaultValue=f,e.select()},this.serializeValue=function(){var a=parseFloat(e.val())||0,b=c();return null!==b&&(a||0===a)&&a.toFixed&&(a=parseFloat(a.toFixed(b))),a},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return!(""==e.val()&&null==f)&&e.val()!=f},this.validate=function(){if(isNaN(e.val()))return{valid:!1,msg:"Please enter a valid number"};if(b.column.validator){var a=b.column.validator(e.val());if(!a.valid)return a}return{valid:!0,msg:null}},this.init()}function e(b){var c,d,e=!1;this.init=function(){c=a("<INPUT type=text class='editor-text' />"),c.appendTo(b.container),c.focus().select(),c.datepicker({showOn:"button",buttonImageOnly:!0,buttonImage:"../images/calendar.gif",beforeShow:function(){e=!0},onClose:function(){e=!1}}),c.width(c.width()-18)},this.destroy=function(){a.datepicker.dpDiv.stop(!0,!0),c.datepicker("hide"),c.datepicker("destroy"),c.remove()},this.show=function(){e&&a.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){e&&a.datepicker.dpDiv.stop(!0,!0).hide()},this.position=function(b){e&&a.datepicker.dpDiv.css("top",b.top+30).css("left",b.left)},this.focus=function(){c.focus()},this.loadValue=function(a){d=a[b.column.field],c.val(d),c[0].defaultValue=d,c.select()},this.serializeValue=function(){return c.val()},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return!(""==c.val()&&null==d)&&c.val()!=d},this.validate=function(){if(b.column.validator){var a=b.column.validator(c.val());if(!a.valid)return a}return{valid:!0,msg:null}},this.init()}function f(b){var c,d;this.init=function(){c=a("<SELECT tabIndex='0' class='editor-yesno'><OPTION value='yes'>Yes</OPTION><OPTION value='no'>No</OPTION></SELECT>"),c.appendTo(b.container),c.focus()},this.destroy=function(){c.remove()},this.focus=function(){c.focus()},this.loadValue=function(a){c.val((d=a[b.column.field])?"yes":"no"),c.select()},this.serializeValue=function(){return"yes"==c.val()},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return c.val()!=d},this.validate=function(){return{valid:!0,msg:null}},this.init()}function g(b){var c,d;this.init=function(){c=a("<INPUT type=checkbox value='true' class='editor-checkbox' hideFocus>"),c.appendTo(b.container),c.focus()},this.destroy=function(){c.remove()},this.focus=function(){c.focus()},this.loadValue=function(a){d=!!a[b.column.field],d?c.prop("checked",!0):c.prop("checked",!1)},this.serializeValue=function(){return c.prop("checked")},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return this.serializeValue()!==d},this.validate=function(){return{valid:!0,msg:null}},this.init()}function h(b){var c,d,e;this.init=function(){c=a("<INPUT type=text class='editor-percentcomplete' />"),c.width(a(b.container).innerWidth()-25),c.appendTo(b.container),d=a("<div class='editor-percentcomplete-picker' />").appendTo(b.container),d.append("<div class='editor-percentcomplete-helper'><div class='editor-percentcomplete-wrapper'><div class='editor-percentcomplete-slider' /><div class='editor-percentcomplete-buttons' /></div></div>"),d.find(".editor-percentcomplete-buttons").append("<button val=0>Not started</button><br/><button val=50>In Progress</button><br/><button val=100>Complete</button>"),c.focus().select(),d.find(".editor-percentcomplete-slider").slider({orientation:"vertical",range:"min",value:e,slide:function(a,b){c.val(b.value)}}),d.find(".editor-percentcomplete-buttons button").bind("click",function(b){c.val(a(this).attr("val")),d.find(".editor-percentcomplete-slider").slider("value",a(this).attr("val"))})},this.destroy=function(){c.remove(),d.remove()},this.focus=function(){c.focus()},this.loadValue=function(a){c.val(e=a[b.column.field]),c.select()},this.serializeValue=function(){return parseInt(c.val(),10)||0},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return!(""==c.val()&&null==e)&&(parseInt(c.val(),10)||0)!=e},this.validate=function(){return isNaN(parseInt(c.val(),10))?{valid:!1,msg:"Please enter a valid positive number"}:{valid:!0,msg:null}},this.init()}function i(b){var c,d,e,f=this;this.init=function(){var e=a("body");d=a("<DIV style='z-index:10000;position:absolute;background:white;padding:5px;border:3px solid gray; -moz-border-radius:10px; border-radius:10px;'/>").appendTo(e),c=a("<TEXTAREA hidefocus rows=5 style='backround:white;width:250px;height:80px;border:0;outline:0'>").appendTo(d),a("<DIV style='text-align:right'><BUTTON>Save</BUTTON><BUTTON>Cancel</BUTTON></DIV>").appendTo(d),d.find("button:first").bind("click",this.save),d.find("button:last").bind("click",this.cancel),c.bind("keydown",this.handleKeyDown),f.position(b.position),c.focus().select()},this.handleKeyDown=function(c){c.which==a.ui.keyCode.ENTER&&c.ctrlKey?f.save():c.which==a.ui.keyCode.ESCAPE?(c.preventDefault(),f.cancel()):c.which==a.ui.keyCode.TAB&&c.shiftKey?(c.preventDefault(),b.grid.navigatePrev()):c.which==a.ui.keyCode.TAB&&(c.preventDefault(),b.grid.navigateNext())},this.save=function(){b.commitChanges()},this.cancel=function(){c.val(e),b.cancelChanges()},this.hide=function(){d.hide()},this.show=function(){d.show()},this.position=function(a){d.css("top",a.top-5).css("left",a.left-5)},this.destroy=function(){d.remove()},this.focus=function(){c.focus()},this.loadValue=function(a){c.val(e=a[b.column.field]),c.select()},this.serializeValue=function(){return c.val()},this.applyValue=function(a,c){a[b.column.field]=c},this.isValueChanged=function(){return!(""==c.val()&&null==e)&&c.val()!=e},this.validate=function(){if(b.column.validator){var a=b.column.validator(c.val());if(!a.valid)return a}return{valid:!0,msg:null}},this.init()}a.extend(!0,window,{Slick:{Editors:{Text:b,Integer:c,Float:d,Date:e,YesNoSelect:f,Checkbox:g,PercentComplete:h,LongText:i}}}),d.DefaultDecimalPlaces=null}(jQuery),define("components/slickgrid/slick.editors",function(){}),function(a){"use strict";"function"==typeof define&&define.amd?define("components/spectrum/spectrum",["jquery"],a):"object"==typeof exports&&"object"==typeof module?module.exports=a(require("jquery")):a(jQuery)}(function(a,b){"use strict";function c(b,c,d,e){for(var f=[],g=0;g<b.length;g++){var h=b[g];if(h){var i=tinycolor(h),j=i.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";j+=tinycolor.equals(c,h)?" sp-thumb-active":"";var k=i.toString(e.preferredFormat||"rgb"),l=q?"background-color:"+i.toRgbString():"filter:"+i.toFilter();f.push('<span title="'+k+'" data-color="'+i.toRgbString()+'" class="'+j+'"><span class="sp-thumb-inner" style="'+l+';" /></span>')}else{var m="sp-clear-display";f.push(a("<div />").append(a('<span data-color="" style="background-color:transparent;" class="'+m+'"></span>').attr("title",e.noColorSelectedText)).html())}}return"<div class='sp-cf "+d+"'>"+f.join("")+"</div>"}function d(){for(var a=0;a<o.length;a++)o[a]&&o[a].hide()}function e(b,c){var d=a.extend({},n,b);return d.callbacks={move:j(d.move,c),change:j(d.change,c),show:j(d.show,c),hide:j(d.hide,c),beforeShow:j(d.beforeShow,c)},d}function f(f,h){function j(){if(U.showPaletteOnly&&(U.showPalette=!0),Ma.text(U.showPaletteOnly?U.togglePaletteMoreText:U.togglePaletteLessText),U.palette){na=U.palette.slice(0),oa=a.isArray(na[0])?na:[na],pa={};for(var b=0;b<oa.length;b++)for(var c=0;c<oa[b].length;c++){var d=tinycolor(oa[b][c]).toRgbString();pa[d]=!0}}xa.toggleClass("sp-flat",V),xa.toggleClass("sp-input-disabled",!U.showInput),xa.toggleClass("sp-alpha-enabled",U.showAlpha),xa.toggleClass("sp-clear-enabled",Ya),xa.toggleClass("sp-buttons-disabled",!U.showButtons),xa.toggleClass("sp-palette-buttons-disabled",!U.togglePaletteOnly),xa.toggleClass("sp-palette-disabled",!U.showPalette),xa.toggleClass("sp-palette-only",U.showPaletteOnly),xa.toggleClass("sp-initial-disabled",!U.showInitial),xa.addClass(U.className).addClass(U.containerClassName),O()}function n(){function b(b){return b.data&&b.data.ignore?(H(a(b.target).closest(".sp-thumb-el").data("color")),K()):(H(a(b.target).closest(".sp-thumb-el").data("color")),K(),N(!0),U.hideAfterPaletteSelect&&F()),!1}if(p&&xa.find("*:not(input)").attr("unselectable","on"),j(),Pa&&va.after(Qa).hide(),Ya||Ka.hide(),V)va.after(xa).hide();else{var c="parent"===U.appendTo?va.parent():a(U.appendTo);1!==c.length&&(c=a("body")),c.append(xa)}t(),Ra.bind("click.spectrum touchstart.spectrum",function(b){wa||B(),b.stopPropagation(),a(b.target).is("input")||b.preventDefault()}),(va.is(":disabled")||U.disabled===!0)&&S(),xa.click(i),Ga.change(A),Ga.bind("paste",function(){setTimeout(A,1)}),Ga.keydown(function(a){13==a.keyCode&&A()}),Ja.text(U.cancelText),Ja.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),G(),F()}),Ka.attr("title",U.clearText),Ka.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),Xa=!0,K(),V&&N(!0)}),La.text(U.chooseText),La.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),p&&Ga.is(":focus")&&Ga.trigger("change"),J()&&(N(!0),F())}),Ma.text(U.showPaletteOnly?U.togglePaletteMoreText:U.togglePaletteLessText),Ma.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),U.showPaletteOnly=!U.showPaletteOnly,U.showPaletteOnly||V||xa.css("left","-="+(ya.outerWidth(!0)+5)),j()}),k(Ea,function(a,b,c){ma=a/ga,Xa=!1,c.shiftKey&&(ma=Math.round(10*ma)/10),K()},y,z),k(Ba,function(a,b){ja=parseFloat(b/ea),Xa=!1,U.showAlpha||(ma=1),K()},y,z),k(za,function(a,b,c){if(c.shiftKey){if(!ta){var d=ka*ba,e=ca-la*ca,f=Math.abs(a-d)>Math.abs(b-e);ta=f?"x":"y"}}else ta=null;var g=!ta||"x"===ta,h=!ta||"y"===ta;g&&(ka=parseFloat(a/ba)),h&&(la=parseFloat((ca-b)/ca)),Xa=!1,U.showAlpha||(ma=1),K()},y,z),Ta?(H(Ta),L(),Va=U.preferredFormat||tinycolor(Ta).format,u(Ta)):L(),V&&C();var d=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Ha.delegate(".sp-thumb-el",d,b),Ia.delegate(".sp-thumb-el:nth-child(1)",d,{ignore:!0},b)}function t(){if(X&&window.localStorage){try{var b=window.localStorage[X].split(",#");b.length>1&&(delete window.localStorage[X],a.each(b,function(a,b){u(b)}))}catch(a){}try{qa=window.localStorage[X].split(";")}catch(a){}}}function u(b){if(W){var c=tinycolor(b).toRgbString();if(!pa[c]&&-1===a.inArray(c,qa))for(qa.push(c);qa.length>ra;)qa.shift();if(X&&window.localStorage)try{window.localStorage[X]=qa.join(";")}catch(a){}}}function v(){var a=[];if(U.showPalette)for(var b=0;b<qa.length;b++){var c=tinycolor(qa[b]).toRgbString();pa[c]||a.push(qa[b])}return a.reverse().slice(0,U.maxSelectionSize)}function w(){var b=I(),d=a.map(oa,function(a,d){return c(a,b,"sp-palette-row sp-palette-row-"+d,U)});t(),qa&&d.push(c(v(),b,"sp-palette-row sp-palette-row-selection",U)),Ha.html(d.join(""))}function x(){if(U.showInitial){var a=Ua,b=I();Ia.html(c([a,b],b,"sp-palette-row-initial",U))}}function y(){(0>=ca||0>=ba||0>=ea)&&O(),aa=!0,xa.addClass(sa),ta=null,va.trigger("dragstart.spectrum",[I()])}function z(){aa=!1,xa.removeClass(sa),va.trigger("dragstop.spectrum",[I()])}function A(){var a=Ga.val();if(null!==a&&""!==a||!Ya){var b=tinycolor(a);b.isValid()?(H(b),N(!0)):Ga.addClass("sp-validation-error")}else H(null),N(!0)}function B(){_?F():C()}function C(){var b=a.Event("beforeShow.spectrum");return _?void O():(va.trigger(b,[I()]),void(Z.beforeShow(I())===!1||b.isDefaultPrevented()||(d(),_=!0,a(ua).bind("keydown.spectrum",D),a(ua).bind("click.spectrum",E),a(window).bind("resize.spectrum",$),Qa.addClass("sp-active"),xa.removeClass("sp-hidden"),O(),L(),Ua=I(),x(),Z.show(Ua),va.trigger("show.spectrum",[Ua]))))}function D(a){27===a.keyCode&&F()}function E(a){2!=a.button&&(aa||(Wa?N(!0):G(),F()))}function F(){_&&!V&&(_=!1,a(ua).unbind("keydown.spectrum",D),a(ua).unbind("click.spectrum",E),a(window).unbind("resize.spectrum",$),Qa.removeClass("sp-active"),xa.addClass("sp-hidden"),Z.hide(I()),va.trigger("hide.spectrum",[I()]))}function G(){H(Ua,!0)}function H(a,b){if(tinycolor.equals(a,I()))return void L();var c,d;!a&&Ya?Xa=!0:(Xa=!1,c=tinycolor(a),d=c.toHsv(),ja=d.h%360/360,ka=d.s,la=d.v,ma=d.a),L(),c&&c.isValid()&&!b&&(Va=U.preferredFormat||c.getFormat())}function I(a){return a=a||{},Ya&&Xa?null:tinycolor.fromRatio({h:ja,s:ka,v:la,a:Math.round(100*ma)/100},{format:a.format||Va})}function J(){return!Ga.hasClass("sp-validation-error")}function K(){L(),Z.move(I()),va.trigger("move.spectrum",[I()])}function L(){Ga.removeClass("sp-validation-error"),M();var a=tinycolor.fromRatio({h:ja,s:1,v:1});za.css("background-color",a.toHexString());var b=Va;1>ma&&(0!==ma||"name"!==b)&&("hex"!==b&&"hex3"!==b&&"hex6"!==b&&"name"!==b||(b="rgb"));var c=I({format:b}),d="";if(Sa.removeClass("sp-clear-display"),Sa.css("background-color","transparent"),!c&&Ya)Sa.addClass("sp-clear-display");else{var e=c.toHexString(),f=c.toRgbString();if(q||1===c.alpha?Sa.css("background-color",f):(Sa.css("background-color","transparent"),Sa.css("filter",c.toFilter())),U.showAlpha){var g=c.toRgb();g.a=0;var h=tinycolor(g).toRgbString(),i="linear-gradient(left, "+h+", "+e+")";p?Da.css("filter",tinycolor(h).toFilter({gradientType:1},e)):(Da.css("background","-webkit-"+i),Da.css("background","-moz-"+i),Da.css("background","-ms-"+i),Da.css("background","linear-gradient(to right, "+h+", "+e+")"))}d=c.toString(b)}U.showInput&&Ga.val(d),U.showPalette&&w(),x()}function M(){var a=ka,b=la;if(Ya&&Xa)Fa.hide(),Ca.hide(),Aa.hide();else{Fa.show(),Ca.show(),Aa.show();var c=a*ba,d=ca-b*ca;c=Math.max(-da,Math.min(ba-da,c-da)),d=Math.max(-da,Math.min(ca-da,d-da)),Aa.css({top:d+"px",left:c+"px"});var e=ma*ga;Fa.css({left:e-ha/2+"px"});var f=ja*ea;Ca.css({top:f-ia+"px"})}}function N(a){var b=I(),c="",d=!tinycolor.equals(b,Ua);b&&(c=b.toString(Va),u(b)),Na&&va.val(c),a&&d&&(Z.change(b),va.trigger("change",[b]))}function O(){_&&(ba=za.width(),ca=za.height(),da=Aa.height(),fa=Ba.width(),ea=Ba.height(),ia=Ca.height(),ga=Ea.width(),ha=Fa.width(),V||(xa.css("position","absolute"),U.offset?xa.offset(U.offset):xa.offset(g(xa,Ra))),M(),U.showPalette&&w(),va.trigger("reflow.spectrum"))}function P(){va.show(),Ra.unbind("click.spectrum touchstart.spectrum"),xa.remove(),Qa.remove(),o[Za.id]=null}function Q(c,d){return c===b?a.extend({},U):d===b?U[c]:(U[c]=d,"preferredFormat"===c&&(Va=U.preferredFormat),void j())}function R(){wa=!1,va.attr("disabled",!1),Ra.removeClass("sp-disabled")}function S(){F(),wa=!0,va.attr("disabled",!0),Ra.addClass("sp-disabled")}function T(a){U.offset=a,O()}var U=e(h,f),V=U.flat,W=U.showSelectionPalette,X=U.localStorageKey,Y=U.theme,Z=U.callbacks,$=l(O,10),_=!1,aa=!1,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=1,na=[],oa=[],pa={},qa=U.selectionPalette.slice(0),ra=U.maxSelectionSize,sa="sp-dragging",ta=null,ua=f.ownerDocument,va=(ua.body,a(f)),wa=!1,xa=a(s,ua).addClass(Y),ya=xa.find(".sp-picker-container"),za=xa.find(".sp-color"),Aa=xa.find(".sp-dragger"),Ba=xa.find(".sp-hue"),Ca=xa.find(".sp-slider"),Da=xa.find(".sp-alpha-inner"),Ea=xa.find(".sp-alpha"),Fa=xa.find(".sp-alpha-handle"),Ga=xa.find(".sp-input"),Ha=xa.find(".sp-palette"),Ia=xa.find(".sp-initial"),Ja=xa.find(".sp-cancel"),Ka=xa.find(".sp-clear"),La=xa.find(".sp-choose"),Ma=xa.find(".sp-palette-toggle"),Na=va.is("input"),Oa=Na&&"color"===va.attr("type")&&m(),Pa=Na&&!V,Qa=Pa?a(r).addClass(Y).addClass(U.className).addClass(U.replacerClassName):a([]),Ra=Pa?Qa:va,Sa=Qa.find(".sp-preview-inner"),Ta=U.color||Na&&va.val(),Ua=!1,Va=U.preferredFormat,Wa=!U.showButtons||U.clickoutFiresChange,Xa=!Ta,Ya=U.allowEmpty&&!Oa;n();var Za={show:C,hide:F,toggle:B,reflow:O,option:Q,enable:R,disable:S,offset:T,set:function(a){H(a),N()},get:I,destroy:P,container:xa};return Za.id=o.push(Za)-1,Za}function g(b,c){var d=0,e=b.outerWidth(),f=b.outerHeight(),g=c.outerHeight(),h=b[0].ownerDocument,i=h.documentElement,j=i.clientWidth+a(h).scrollLeft(),k=i.clientHeight+a(h).scrollTop(),l=c.offset();return l.top+=g,l.left-=Math.min(l.left,l.left+e>j&&j>e?Math.abs(l.left+e-j):0),l.top-=Math.min(l.top,l.top+f>k&&k>f?Math.abs(f+g-d):d),l}function h(){}function i(a){a.stopPropagation()}function j(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function k(b,c,d,e){function f(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}function g(a){if(k){if(p&&j.documentMode<9&&!a.button)return i();var d=a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0],e=d&&d.pageX||a.pageX,g=d&&d.pageY||a.pageY,h=Math.max(0,Math.min(e-l.left,n)),q=Math.max(0,Math.min(g-l.top,m));o&&f(a),c.apply(b,[h,q,a])}}function h(c){var e=c.which?3==c.which:2==c.button;e||k||d.apply(b,arguments)!==!1&&(k=!0,m=a(b).height(),n=a(b).width(),l=a(b).offset(),a(j).bind(q),a(j.body).addClass("sp-dragging"),g(c),f(c))}function i(){k&&(a(j).unbind(q),a(j.body).removeClass("sp-dragging"),setTimeout(function(){e.apply(b,arguments)},0)),k=!1}c=c||function(){},d=d||function(){},e=e||function(){};var j=document,k=!1,l={},m=0,n=0,o="ontouchstart"in window,q={};q.selectstart=f,q.dragstart=f,q["touchmove mousemove"]=g,q["touchend mouseup"]=i,a(b).bind("touchstart mousedown",h)}function l(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),!c&&d||(d=setTimeout(g,b))}}function m(){return a.fn.spectrum.inputTypeColorSupport()}var n={beforeShow:h,move:h,change:h,show:h,hide:h,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},o=[],p=!!/msie/i.exec(window.navigator.userAgent),q=function(){function a(a,b){return!!~(""+a).indexOf(b)}var b=document.createElement("div"),c=b.style;return c.cssText="background-color:rgba(0,0,0,.5)",a(c.backgroundColor,"rgba")||a(c.backgroundColor,"hsla")}(),r=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),s=function(){var a="";if(p)for(var b=1;6>=b;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",a,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),t="spectrum.id";a.fn.spectrum=function(b,c){if("string"==typeof b){var d=this,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=o[a(this).data(t)];if(c){var f=c[b];if(!f)throw new Error("Spectrum: no such method: '"+b+"'");"get"==b?d=c.get():"container"==b?d=c.container:"option"==b?d=c.option.apply(c,e):"destroy"==b?(c.destroy(),a(this).removeData(t)):f.apply(c,e)}}),d}return this.spectrum("destroy").each(function(){var c=a.extend({},b,a(this).data()),d=f(this,c);a(this).data(t,d.id)})},a.fn.spectrum.load=!0,a.fn.spectrum.loadOpts={},a.fn.spectrum.draggable=k,a.fn.spectrum.defaults=n,a.fn.spectrum.inputTypeColorSupport=function b(){if("undefined"==typeof b._cachedResult){var c=a("<input type='color'/>")[0];b._cachedResult="color"===c.type&&""!==c.value}return b._cachedResult},a.spectrum={},a.spectrum.localization={},a.spectrum.palettes={},a.fn.spectrum.processNativeColorInputs=function(){var b=a("input[type=color]");b.length&&!m()&&b.spectrum({preferredFormat:"hex6"})},function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=G(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=D(a.s),a.v=D(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=D(a.s),a.l=D(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=w(e),{ok:g,format:a.format||h,r:M(255,N(c.r,0)),g:M(255,N(c.g,0)),b:M(255,N(c.b,0)),a:e}}function b(a,b,c){return{r:255*x(a,255),g:255*x(b,255),b:255*x(c,255)}}function c(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=x(a,360),b=x(b,100),c=x(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*x(a,360),b=x(b,100),c=x(c,100);var d=K.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],k=[h,c,c,g,f,f][i],l=[f,f,h,c,c,g][i];return{r:255*j,g:255*k,b:255*l}}function g(a,b,c,d){var e=[C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){var e=[C(E(d)),C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return e.join("")}function i(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s-=b/100,c.s=y(c.s),P(c)}function j(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s+=b/100,c.s=y(c.s),P(c)}function k(a){return P(a).desaturate(100)}function l(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l+=b/100,c.l=y(c.l),P(c)}function m(a,b){b=0===b?0:b||10;var c=P(a).toRgb();return c.r=N(0,M(255,c.r-L(255*-(b/100)))),c.g=N(0,M(255,c.g-L(255*-(b/100)))),c.b=N(0,M(255,c.b-L(255*-(b/100)))),P(c)}function n(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l-=b/100,c.l=y(c.l),P(c)}function o(a,b){var c=P(a).toHsl(),d=(L(c.h)+b)%360;return c.h=0>d?360+d:d,P(c)}function p(a){var b=P(a).toHsl();return b.h=(b.h+180)%360,P(b)}function q(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({
h:(c+120)%360,s:b.s,l:b.l}),P({h:(c+240)%360,s:b.s,l:b.l})]}function r(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+90)%360,s:b.s,l:b.l}),P({h:(c+180)%360,s:b.s,l:b.l}),P({h:(c+270)%360,s:b.s,l:b.l})]}function s(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+72)%360,s:b.s,l:b.l}),P({h:(c+216)%360,s:b.s,l:b.l})]}function t(a,b,c){b=b||6,c=c||30;var d=P(a).toHsl(),e=360/c,f=[P(a)];for(d.h=(d.h-(e*b>>1)+720)%360;--b;)d.h=(d.h+e)%360,f.push(P(d));return f}function u(a,b){b=b||6;for(var c=P(a).toHsv(),d=c.h,e=c.s,f=c.v,g=[],h=1/b;b--;)g.push(P({h:d,s:e,v:f})),f=(f+h)%1;return g}function v(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function w(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function x(a,b){A(a)&&(a="100%");var c=B(a);return a=M(b,N(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),K.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function y(a){return M(1,N(0,a))}function z(a){return parseInt(a,16)}function A(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function B(a){return"string"==typeof a&&-1!=a.indexOf("%")}function C(a){return 1==a.length?"0"+a:""+a}function D(a){return 1>=a&&(a=100*a+"%"),a}function E(a){return Math.round(255*parseFloat(a)).toString(16)}function F(a){return z(a)/255}function G(a){a=a.replace(H,"").replace(I,"").toLowerCase();var b=!1;if(Q[a])a=Q[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=S.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=S.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=S.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=S.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=S.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=S.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=S.hex8.exec(a))?{a:F(c[1]),r:z(c[2]),g:z(c[3]),b:z(c[4]),format:b?"name":"hex8"}:(c=S.hex6.exec(a))?{r:z(c[1]),g:z(c[2]),b:z(c[3]),format:b?"name":"hex"}:(c=S.hex3.exec(a))?{r:z(c[1]+""+c[1]),g:z(c[2]+""+c[2]),b:z(c[3]+""+c[3]),format:b?"name":"hex"}:!1}var H=/^[\s,#]+/,I=/\s+$/,J=0,K=Math,L=K.round,M=K.min,N=K.max,O=K.random,P=function(b,c){if(b=b?b:"",c=c||{},b instanceof P)return b;if(!(this instanceof P))return new P(b,c);var d=a(b);this._originalInput=b,this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=L(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=L(this._r)),this._g<1&&(this._g=L(this._g)),this._b<1&&(this._b=L(this._b)),this._ok=d.ok,this._tc_id=J++};P.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=w(a),this._roundA=L(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=L(360*a.h),c=L(100*a.s),d=L(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=L(360*a.h),d=L(100*a.s),e=L(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:L(this._r),g:L(this._g),b:L(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+L(this._r)+", "+L(this._g)+", "+L(this._b)+")":"rgba("+L(this._r)+", "+L(this._g)+", "+L(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:L(100*x(this._r,255))+"%",g:L(100*x(this._g,255))+"%",b:L(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%)":"rgba("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:R[g(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";if(a){var e=P(a);c=e.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),"hex"!==a&&"hex6"!==a||(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(l,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(n,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(j,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(o,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(t,arguments)},complement:function(){return this._applyCombination(p,arguments)},monochromatic:function(){return this._applyCombination(u,arguments)},splitcomplement:function(){return this._applyCombination(s,arguments)},triad:function(){return this._applyCombination(q,arguments)},tetrad:function(){return this._applyCombination(r,arguments)}},P.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&("a"===d?c[d]=a[d]:c[d]=D(a[d]));a=c}return P(a,b)},P.equals=function(a,b){return a&&b?P(a).toRgbString()==P(b).toRgbString():!1},P.random=function(){return P.fromRatio({r:O(),g:O(),b:O()})},P.mix=function(a,b,c){c=0===c?0:c||50;var d,e=P(a).toRgb(),f=P(b).toRgb(),g=c/100,h=2*g-1,i=f.a-e.a;d=h*i==-1?h:(h+i)/(1+h*i),d=(d+1)/2;var j=1-d,k={r:f.r*d+e.r*j,g:f.g*d+e.g*j,b:f.b*d+e.b*j,a:f.a*g+e.a*(1-g)};return P(k)},P.readability=function(a,b){var c=P(a),d=P(b),e=c.toRgb(),f=d.toRgb(),g=c.getBrightness(),h=d.getBrightness(),i=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(g-h),color:i}},P.isReadable=function(a,b){var c=P.readability(a,b);return c.brightness>125&&c.color>500},P.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=P.readability(a,b[f]),h=g.brightness>125&&g.color>500,i=3*(g.brightness/125)+g.color/500;(h&&!e||h&&e&&i>d||!h&&!e&&i>d)&&(e=h,d=i,c=P(b[f]))}return c};var Q=P.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=P.hexNames=v(Q),S=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=P}(),a(function(){a.fn.spectrum.load&&a.fn.spectrum.processNativeColorInputs()})}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/datepicker",["jquery","./core"],a):a(jQuery)}(function(a){function b(a){for(var b,c;a.length&&a[0]!==document;){if(b=a.css("position"),("absolute"===b||"relative"===b||"fixed"===b)&&(c=parseInt(a.css("zIndex"),10),!isNaN(c)&&0!==c))return c;a=a.parent()}return 0}function c(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},a.extend(this._defaults,this.regional[""]),this.regional.en=a.extend(!0,{},this.regional[""]),this.regional["en-US"]=a.extend(!0,{},this.regional.en),this.dpDiv=d(a("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function d(b){var c="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return b.delegate(c,"mouseout",function(){a(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate(c,"mouseover",e)}function e(){a.datepicker._isDisabledDatepicker(g.inline?g.dpDiv.parent()[0]:g.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))}function f(b,c){a.extend(b,c);for(var d in c)null==c[d]&&(b[d]=c[d]);return b}a.extend(a.ui,{datepicker:{version:"1.11.4"}});var g;return a.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return f(this._defaults,a||{}),this},_attachDatepicker:function(b,c){var d,e,f;d=b.nodeName.toLowerCase(),e="div"===d||"span"===d,b.id||(this.uuid+=1,b.id="dp"+this.uuid),f=this._newInst(a(b),e),f.settings=a.extend({},c||{}),"input"===d?this._connectDatepicker(b,f):e&&this._inlineDatepicker(b,f)},_newInst:function(b,c){var e=b[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:e,input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:c?d(a("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(b,c){var d=a(b);c.append=a([]),c.trigger=a([]),d.hasClass(this.markerClassName)||(this._attachments(d,c),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(c),a.data(b,"datepicker",c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var d,e,f,g=this._get(c,"appendText"),h=this._get(c,"isRTL");c.append&&c.append.remove(),g&&(c.append=a("<span class='"+this._appendClass+"'>"+g+"</span>"),b[h?"before":"after"](c.append)),b.unbind("focus",this._showDatepicker),c.trigger&&c.trigger.remove(),d=this._get(c,"showOn"),"focus"!==d&&"both"!==d||b.focus(this._showDatepicker),"button"!==d&&"both"!==d||(e=this._get(c,"buttonText"),f=this._get(c,"buttonImage"),c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:f,alt:e,title:e}):a("<button type='button'></button>").addClass(this._triggerClass).html(f?a("<img/>").attr({src:f,alt:e,title:e}):e)),b[h?"before":"after"](c.trigger),c.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput===b[0]?a.datepicker._hideDatepicker():a.datepicker._datepickerShowing&&a.datepicker._lastInput!==b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1}))},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=this._get(a,"dateFormat");g.match(/[DM]/)&&(b=function(a){for(c=0,d=0,e=0;e<a.length;e++)a[e].length>c&&(c=a[e].length,d=e);return d},f.setMonth(b(this._get(a,g.match(/MM/)?"monthNames":"monthNamesShort"))),f.setDate(b(this._get(a,g.match(/DD/)?"dayNames":"dayNamesShort"))+20-f.getDay())),a.input.attr("size",this._formatDate(a,f).length)}},_inlineDatepicker:function(b,c){var d=a(b);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(c.dpDiv),a.data(b,"datepicker",c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&this._disableDatepicker(b),c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,d,e,g){var h,i,j,k,l,m=this._dialogInst;return m||(this.uuid+=1,h="dp"+this.uuid,this._dialogInput=a("<input type='text' id='"+h+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),m=this._dialogInst=this._newInst(this._dialogInput,!1),m.settings={},a.data(this._dialogInput[0],"datepicker",m)),f(m.settings,e||{}),c=c&&c.constructor===Date?this._formatDate(m,c):c,this._dialogInput.val(c),this._pos=g?g.length?g:[g.pageX,g.pageY]:null,this._pos||(i=document.documentElement.clientWidth,j=document.documentElement.clientHeight,k=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[i/2-100+k,j/2-150+l]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),m.settings.onSelect=d,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],"datepicker",m),this},_destroyDatepicker:function(b){var c,d=a(b),e=a.data(b,"datepicker");d.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),a.removeData(b,"datepicker"),"input"===c?(e.append.remove(),e.trigger.remove(),d.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):"div"!==c&&"span"!==c||d.removeClass(this.markerClassName).empty(),g===e&&(g=null))},_enableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,"datepicker");e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!1,f.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==c&&"span"!==c||(d=e.children("."+this._inlineClass),d.children().removeClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}))},_disableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,"datepicker");e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!0,f.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==c&&"span"!==c||(d=e.children("."+this._inlineClass),d.children().addClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}),this._disabledInputs[this._disabledInputs.length]=b)},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]===a)return!0;return!1},_getInst:function(b){try{return a.data(b,"datepicker")}catch(a){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(b,c,d){var e,g,h,i,j=this._getInst(b);return 2===arguments.length&&"string"==typeof c?"defaults"===c?a.extend({},a.datepicker._defaults):j?"all"===c?a.extend({},j.settings):this._get(j,c):null:(e=c||{},"string"==typeof c&&(e={},e[c]=d),void(j&&(this._curInst===j&&this._hideDatepicker(),g=this._getDateDatepicker(b,!0),h=this._getMinMaxDate(j,"min"),i=this._getMinMaxDate(j,"max"),f(j.settings,e),null!==h&&void 0!==e.dateFormat&&void 0===e.minDate&&(j.settings.minDate=this._formatDate(j,h)),null!==i&&void 0!==e.dateFormat&&void 0===e.maxDate&&(j.settings.maxDate=this._formatDate(j,i)),"disabled"in e&&(e.disabled?this._disableDatepicker(b):this._enableDatepicker(b)),this._attachments(a(b),j),this._autoSize(j),this._setDate(j,g),this._updateAlternate(j),this._updateDatepicker(j))))},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(b){var c,d,e,f=a.datepicker._getInst(b.target),g=!0,h=f.dpDiv.is(".ui-datepicker-rtl");if(f._keyEvent=!0,a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker(),g=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",f.dpDiv),e[0]&&a.datepicker._selectDay(b.target,f.selectedMonth,f.selectedYear,e[0]),c=a.datepicker._get(f,"onSelect"),c?(d=a.datepicker._formatDate(f),c.apply(f.input?f.input[0]:null,[d,f])):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target),g=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target),g=b.ctrlKey||b.metaKey;break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?1:-1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D"),g=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?-1:1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D"),g=b.ctrlKey||b.metaKey;break;default:g=!1}else 36===b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):g=!1;g&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(b){var c,d,e=a.datepicker._getInst(b.target);return a.datepicker._get(e,"constrainInput")?(c=a.datepicker._possibleChars(a.datepicker._get(e,"dateFormat")),d=String.fromCharCode(null==b.charCode?b.keyCode:b.charCode),b.ctrlKey||b.metaKey||" ">d||!c||c.indexOf(d)>-1):void 0},_doKeyUp:function(b){var c,d=a.datepicker._getInst(b.target);if(d.input.val()!==d.lastVal)try{c=a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,a.datepicker._getFormatConfig(d)),c&&(a.datepicker._setDateFromField(d),a.datepicker._updateAlternate(d),a.datepicker._updateDatepicker(d))}catch(a){}return!0},_showDatepicker:function(c){if(c=c.target||c,"input"!==c.nodeName.toLowerCase()&&(c=a("input",c.parentNode)[0]),!a.datepicker._isDisabledDatepicker(c)&&a.datepicker._lastInput!==c){var d,e,g,h,i,j,k;d=a.datepicker._getInst(c),a.datepicker._curInst&&a.datepicker._curInst!==d&&(a.datepicker._curInst.dpDiv.stop(!0,!0),d&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0])),e=a.datepicker._get(d,"beforeShow"),g=e?e.apply(c,[c,d]):{},g!==!1&&(f(d.settings,g),d.lastVal=null,a.datepicker._lastInput=c,a.datepicker._setDateFromField(d),a.datepicker._inDialog&&(c.value=""),a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(c),a.datepicker._pos[1]+=c.offsetHeight),h=!1,a(c).parents().each(function(){return h|="fixed"===a(this).css("position"),!h}),i={left:a.datepicker._pos[0],top:a.datepicker._pos[1]},a.datepicker._pos=null,d.dpDiv.empty(),d.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),a.datepicker._updateDatepicker(d),i=a.datepicker._checkOffset(d,i,h),d.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":h?"fixed":"absolute",display:"none",left:i.left+"px",top:i.top+"px"}),d.inline||(j=a.datepicker._get(d,"showAnim"),k=a.datepicker._get(d,"duration"),d.dpDiv.css("z-index",b(a(c))+1),a.datepicker._datepickerShowing=!0,a.effects&&a.effects.effect[j]?d.dpDiv.show(j,a.datepicker._get(d,"showOptions"),k):d.dpDiv[j||"show"](j?k:null),a.datepicker._shouldFocusInput(d)&&d.input.focus(),a.datepicker._curInst=d))}},_updateDatepicker:function(b){this.maxRows=4,g=b,b.dpDiv.empty().append(this._generateHTML(b)),this._attachHandlers(b);var c,d=this._getNumberOfMonths(b),f=d[1],h=17,i=b.dpDiv.find("."+this._dayOverClass+" a");i.length>0&&e.apply(i.get(0)),b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),f>1&&b.dpDiv.addClass("ui-datepicker-multi-"+f).css("width",h*f+"em"),b.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),b===a.datepicker._curInst&&a.datepicker._datepickerShowing&&a.datepicker._shouldFocusInput(b)&&b.input.focus(),b.yearshtml&&(c=b.yearshtml,setTimeout(function(){c===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml),c=b.yearshtml=null},0))},_shouldFocusInput:function(a){return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(b,c,d){var e=b.dpDiv.outerWidth(),f=b.dpDiv.outerHeight(),g=b.input?b.input.outerWidth():0,h=b.input?b.input.outerHeight():0,i=document.documentElement.clientWidth+(d?0:a(document).scrollLeft()),j=document.documentElement.clientHeight+(d?0:a(document).scrollTop());return c.left-=this._get(b,"isRTL")?e-g:0,c.left-=d&&c.left===b.input.offset().left?a(document).scrollLeft():0,c.top-=d&&c.top===b.input.offset().top+h?a(document).scrollTop():0,c.left-=Math.min(c.left,c.left+e>i&&i>e?Math.abs(c.left+e-i):0),c.top-=Math.min(c.top,c.top+f>j&&j>f?Math.abs(f+h):0),c},_findPos:function(b){for(var c,d=this._getInst(b),e=this._get(d,"isRTL");b&&("hidden"===b.type||1!==b.nodeType||a.expr.filters.hidden(b));)b=b[e?"previousSibling":"nextSibling"];return c=a(b).offset(),[c.left,c.top]},_hideDatepicker:function(b){var c,d,e,f,g=this._curInst;!g||b&&g!==a.data(b,"datepicker")||this._datepickerShowing&&(c=this._get(g,"showAnim"),d=this._get(g,"duration"),e=function(){a.datepicker._tidyDialog(g)},a.effects&&(a.effects.effect[c]||a.effects[c])?g.dpDiv.hide(c,a.datepicker._get(g,"showOptions"),d,e):g.dpDiv["slideDown"===c?"slideUp":"fadeIn"===c?"fadeOut":"hide"](c?d:null,e),c||e(),this._datepickerShowing=!1,f=this._get(g,"onClose"),f&&f.apply(g.input?g.input[0]:null,[g.input?g.input.val():"",g]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){var c=a(b.target),d=a.datepicker._getInst(c[0]);(c[0].id===a.datepicker._mainDivId||0!==c.parents("#"+a.datepicker._mainDivId).length||c.hasClass(a.datepicker.markerClassName)||c.closest("."+a.datepicker._triggerClass).length||!a.datepicker._datepickerShowing||a.datepicker._inDialog&&a.blockUI)&&(!c.hasClass(a.datepicker.markerClassName)||a.datepicker._curInst===d)||a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,d){var e=a(b),f=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(f,c+("M"===d?this._get(f,"showCurrentAtPos"):0),d),this._updateDatepicker(f))},_gotoToday:function(b){var c,d=a(b),e=this._getInst(d[0]);this._get(e,"gotoCurrent")&&e.currentDay?(e.selectedDay=e.currentDay,e.drawMonth=e.selectedMonth=e.currentMonth,e.drawYear=e.selectedYear=e.currentYear):(c=new Date,e.selectedDay=c.getDate(),e.drawMonth=e.selectedMonth=c.getMonth(),e.drawYear=e.selectedYear=c.getFullYear()),this._notifyChange(e),this._adjustDate(d)},_selectMonthYear:function(b,c,d){var e=a(b),f=this._getInst(e[0]);f["selected"+("M"===d?"Month":"Year")]=f["draw"+("M"===d?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10),this._notifyChange(f),this._adjustDate(e)},_selectDay:function(b,c,d,e){var f,g=a(b);a(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(g[0])||(f=this._getInst(g[0]),f.selectedDay=f.currentDay=a("a",e).html(),f.selectedMonth=f.currentMonth=c,f.selectedYear=f.currentYear=d,this._selectDate(b,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(b){var c=a(b);this._selectDate(c,"")},_selectDate:function(b,c){var d,e=a(b),f=this._getInst(e[0]);c=null!=c?c:this._formatDate(f),f.input&&f.input.val(c),this._updateAlternate(f),d=this._get(f,"onSelect"),d?d.apply(f.input?f.input[0]:null,[c,f]):f.input&&f.input.trigger("change"),f.inline?this._updateDatepicker(f):(this._hideDatepicker(),this._lastInput=f.input[0],"object"!=typeof f.input[0]&&f.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c,d,e,f=this._get(b,"altField");f&&(c=this._get(b,"altFormat")||this._get(b,"dateFormat"),d=this._getDate(b),e=this.formatDate(c,d,this._getFormatConfig(b)),a(f).each(function(){a(this).val(e)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},iso8601Week:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},parseDate:function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(c="object"==typeof c?c.toString():c+"",""===c)return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=-1,q=-1,r=-1,s=-1,t=!1,u=function(a){var c=e+1<b.length&&b.charAt(e+1)===a;return c&&e++,c},v=function(a){var b=u(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e="y"===a?d:1,f=new RegExp("^\\d{"+e+","+d+"}"),g=c.substring(i).match(f);if(!g)throw"Missing number at position "+i;return i+=g[0].length,parseInt(g[0],10)},w=function(b,d,e){var f=-1,g=a.map(u(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];return c.substr(i,d.length).toLowerCase()===d.toLowerCase()?(f=b[0],i+=d.length,!1):void 0}),-1!==f)return f+1;throw"Unknown name at position "+i},x=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;e<b.length;e++)if(t)"'"!==b.charAt(e)||u("'")?x():t=!1;else switch(b.charAt(e)){case"d":r=v("d");break;case"D":w("D",l,m);break;case"o":s=v("o");break;case"m":q=v("m");break;case"M":q=w("M",n,o);break;case"y":p=v("y");break;case"@":h=new Date(v("@")),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"!":h=new Date((v("!")-this._ticksTo1970)/1e4),p=h.getFullYear(),q=h.getMonth()+1,r=h.getDate();break;case"'":u("'")?x():t=!0;break;default:x()}if(i<c.length&&(g=c.substr(i),
!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===p?p=(new Date).getFullYear():100>p&&(p+=(new Date).getFullYear()-(new Date).getFullYear()%100+(k>=p?0:-100)),s>-1)for(q=1,r=s;;){if(f=this._getDaysInMonth(p,q-1),f>=r)break;q++,r-=f}if(h=this._daylightSavingAdjust(new Date(p,q-1,r)),h.getFullYear()!==p||h.getMonth()+1!==q||h.getDate()!==r)throw"Invalid date";return h},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(a,b,c){if(!b)return"";var d,e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=function(b){var c=d+1<a.length&&a.charAt(d+1)===b;return c&&d++,c},j=function(a,b,c){var d=""+b;if(i(a))for(;d.length<c;)d="0"+d;return d},k=function(a,b,c,d){return i(a)?d[b]:c[b]},l="",m=!1;if(b)for(d=0;d<a.length;d++)if(m)"'"!==a.charAt(d)||i("'")?l+=a.charAt(d):m=!1;else switch(a.charAt(d)){case"d":l+=j("d",b.getDate(),2);break;case"D":l+=k("D",b.getDay(),e,f);break;case"o":l+=j("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);break;case"m":l+=j("m",b.getMonth()+1,2);break;case"M":l+=k("M",b.getMonth(),g,h);break;case"y":l+=i("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":l+=b.getTime();break;case"!":l+=1e4*b.getTime()+this._ticksTo1970;break;case"'":i("'")?l+="'":m=!0;break;default:l+=a.charAt(d)}return l},_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=b+1<a.length&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;b<a.length;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":c+="0123456789";break;case"D":case"M":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_get:function(a,b){return void 0!==a.settings[b]?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!==a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e=this._getDefaultDate(a),f=e,g=this._getFormatConfig(a);try{f=this.parseDate(c,d,g)||e}catch(a){d=b?"":d}a.selectedDay=f.getDate(),a.drawMonth=a.selectedMonth=f.getMonth(),a.drawYear=a.selectedYear=f.getFullYear(),a.currentDay=d?f.getDate():0,a.currentMonth=d?f.getMonth():0,a.currentYear=d?f.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,d){var e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(c){try{return a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),c,a.datepicker._getFormatConfig(b))}catch(a){}for(var d=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,e=d.getFullYear(),f=d.getMonth(),g=d.getDate(),h=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,i=h.exec(c);i;){switch(i[2]||"d"){case"d":case"D":g+=parseInt(i[1],10);break;case"w":case"W":g+=7*parseInt(i[1],10);break;case"m":case"M":f+=parseInt(i[1],10),g=Math.min(g,a.datepicker._getDaysInMonth(e,f));break;case"y":case"Y":e+=parseInt(i[1],10),g=Math.min(g,a.datepicker._getDaysInMonth(e,f))}i=h.exec(c)}return new Date(e,f,g)},g=null==c||""===c?d:"string"==typeof c?f(c):"number"==typeof c?isNaN(c)?d:e(c):new Date(c.getTime());return g=g&&"Invalid Date"===g.toString()?d:g,g&&(g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),this._daylightSavingAdjust(g)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),e===a.selectedMonth&&f===a.selectedYear||c||this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&""===a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_attachHandlers:function(b){var c=this._get(b,"stepMonths"),d="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){var b={prev:function(){a.datepicker._adjustDate(d,-c,"M")},next:function(){a.datepicker._adjustDate(d,+c,"M")},hide:function(){a.datepicker._hideDatepicker()},today:function(){a.datepicker._gotoToday(d)},selectDay:function(){return a.datepicker._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return a.datepicker._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a.datepicker._selectMonthYear(d,this,"Y"),!1}};a(this).bind(this.getAttribute("data-event"),b[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=new Date,P=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth(),O.getDate())),Q=this._get(a,"isRTL"),R=this._get(a,"showButtonPanel"),S=this._get(a,"hideIfNoPrevNext"),T=this._get(a,"navigationAsDateFormat"),U=this._getNumberOfMonths(a),V=this._get(a,"showCurrentAtPos"),W=this._get(a,"stepMonths"),X=1!==U[0]||1!==U[1],Y=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(a,"min"),$=this._getMinMaxDate(a,"max"),_=a.drawMonth-V,aa=a.drawYear;if(0>_&&(_+=12,aa--),$)for(b=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-U[0]*U[1]+1,$.getDate())),b=Z&&Z>b?Z:b;this._daylightSavingAdjust(new Date(aa,_,1))>b;)_--,0>_&&(_=11,aa--);for(a.drawMonth=_,a.drawYear=aa,c=this._get(a,"prevText"),c=T?this.formatDate(c,this._daylightSavingAdjust(new Date(aa,_-W,1)),this._getFormatConfig(a)):c,d=this._canAdjustMonth(a,-1,aa,_)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>":S?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>",e=this._get(a,"nextText"),e=T?this.formatDate(e,this._daylightSavingAdjust(new Date(aa,_+W,1)),this._getFormatConfig(a)):e,f=this._canAdjustMonth(a,1,aa,_)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>":S?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>",g=this._get(a,"currentText"),h=this._get(a,"gotoCurrent")&&a.currentDay?Y:P,g=T?this.formatDate(g,h,this._getFormatConfig(a)):g,i=a.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(a,"closeText")+"</button>",j=R?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Q?i:"")+(this._isInRange(a,h)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+g+"</button>":"")+(Q?"":i)+"</div>":"",k=parseInt(this._get(a,"firstDay"),10),k=isNaN(k)?0:k,l=this._get(a,"showWeek"),m=this._get(a,"dayNames"),n=this._get(a,"dayNamesMin"),o=this._get(a,"monthNames"),p=this._get(a,"monthNamesShort"),q=this._get(a,"beforeShowDay"),r=this._get(a,"showOtherMonths"),s=this._get(a,"selectOtherMonths"),t=this._getDefaultDate(a),u="",w=0;w<U[0];w++){for(x="",this.maxRows=4,y=0;y<U[1];y++){if(z=this._daylightSavingAdjust(new Date(aa,_,a.selectedDay)),A=" ui-corner-all",B="",X){if(B+="<div class='ui-datepicker-group",U[1]>1)switch(y){case 0:B+=" ui-datepicker-group-first",A=" ui-corner-"+(Q?"right":"left");break;case U[1]-1:B+=" ui-datepicker-group-last",A=" ui-corner-"+(Q?"left":"right");break;default:B+=" ui-datepicker-group-middle",A=""}B+="'>"}for(B+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?Q?f:d:"")+(/all|right/.test(A)&&0===w?Q?d:f:"")+this._generateMonthYearHeader(a,_,aa,Z,$,w>0||y>0,o,p)+"</div><table class='ui-datepicker-calendar'><thead><tr>",C=l?"<th class='ui-datepicker-week-col'>"+this._get(a,"weekHeader")+"</th>":"",v=0;7>v;v++)D=(v+k)%7,C+="<th scope='col'"+((v+k+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+m[D]+"'>"+n[D]+"</span></th>";for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(aa,_),aa===a.selectedYear&&_===a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,E)),F=(this._getFirstDayOfMonth(aa,_)-k+7)%7,G=Math.ceil((F+E)/7),H=X&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=this._daylightSavingAdjust(new Date(aa,_,1-F)),J=0;H>J;J++){for(B+="<tr>",K=l?"<td class='ui-datepicker-week-col'>"+this._get(a,"calculateWeek")(I)+"</td>":"",v=0;7>v;v++)L=q?q.apply(a.input?a.input[0]:null,[I]):[!0,""],M=I.getMonth()!==_,N=M&&!s||!L[0]||Z&&Z>I||$&&I>$,K+="<td class='"+((v+k+6)%7>=5?" ui-datepicker-week-end":"")+(M?" ui-datepicker-other-month":"")+(I.getTime()===z.getTime()&&_===a.selectedMonth&&a._keyEvent||t.getTime()===I.getTime()&&t.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" ui-state-disabled":"")+(M&&!r?"":" "+L[1]+(I.getTime()===Y.getTime()?" "+this._currentClass:"")+(I.getTime()===P.getTime()?" ui-datepicker-today":""))+"'"+(M&&!r||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='click' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!r?"&#xa0;":N?"<span class='ui-state-default'>"+I.getDate()+"</span>":"<a class='ui-state-default"+(I.getTime()===P.getTime()?" ui-state-highlight":"")+(I.getTime()===Y.getTime()?" ui-state-active":"")+(M?" ui-priority-secondary":"")+"' href='#'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I);B+=K+"</tr>"}_++,_>11&&(_=0,aa++),B+="</tbody></table>"+(X?"</div>"+(U[0]>0&&y===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=B}u+=x}return u+=j,a._keyEvent=!1,u},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this._get(a,"changeMonth"),r=this._get(a,"changeYear"),s=this._get(a,"showMonthAfterYear"),t="<div class='ui-datepicker-title'>",u="";if(f||!q)u+="<span class='ui-datepicker-month'>"+g[b]+"</span>";else{for(i=d&&d.getFullYear()===c,j=e&&e.getFullYear()===c,u+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=d.getMonth())&&(!j||k<=e.getMonth())&&(u+="<option value='"+k+"'"+(k===b?" selected='selected'":"")+">"+h[k]+"</option>");u+="</select>"}if(s||(t+=u+(!f&&q&&r?"":"&#xa0;")),!a.yearshtml)if(a.yearshtml="",f||!r)t+="<span class='ui-datepicker-year'>"+c+"</span>";else{for(l=this._get(a,"yearRange").split(":"),m=(new Date).getFullYear(),n=function(a){var b=a.match(/c[+\-].*/)?c+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(b)?m:b},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=d?Math.max(o,d.getFullYear()):o,p=e?Math.min(p,e.getFullYear()):p,a.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)a.yearshtml+="<option value='"+o+"'"+(o===c?" selected='selected'":"")+">"+o+"</option>";a.yearshtml+="</select>",t+=a.yearshtml,a.yearshtml=null}return t+=this._get(a,"yearSuffix"),s&&(t+=(!f&&q&&r?"":"&#xa0;")+u),t+="</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"===c?b:0),e=a.drawMonth+("M"===c?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+("D"===c?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),"M"!==c&&"Y"!==c||this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&c>b?c:b;return d&&e>d?d:e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(0>b?b:e[0]*e[1]),1));return 0>b&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c,d,e=this._getMinMaxDate(a,"min"),f=this._getMinMaxDate(a,"max"),g=null,h=null,i=this._get(a,"yearRange");return i&&(c=i.split(":"),d=(new Date).getFullYear(),g=parseInt(c[0],10),h=parseInt(c[1],10),c[0].match(/[+\-].*/)&&(g+=d),c[1].match(/[+\-].*/)&&(h+=d)),(!e||b.getTime()>=e.getTime())&&(!f||b.getTime()<=f.getTime())&&(!g||b.getFullYear()>=g)&&(!h||b.getFullYear()<=h)},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick),a.datepicker.initialized=!0),0===a("#"+a.datepicker._mainDivId).length&&a("body").append(a.datepicker.dpDiv);var c=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!==b&&"getDate"!==b&&"widget"!==b?"option"===b&&2===arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c))},a.datepicker=new c,a.datepicker.initialized=!1,a.datepicker.uuid=(new Date).getTime(),a.datepicker.version="1.11.4",a.datepicker}),define("modules/types/edition/slick_grid/slick.editors.custom",["src/util/util","lodash","components/spectrum/spectrum","jquery","jquery-ui/datepicker"],function(a,b){function c(a,b){a[b.module.view.idPropertyName]||Object.defineProperty(a,b.module.view.idPropertyName,{value:"id_"+b.module.view.getNextIncrementalId(),enumerable:!1,writable:!1,configurable:!1})}function d(){if(this.args.column.validator){var a=this.args.column.validator(this.serializeValue());if(!a.valid)return a}return{valid:!0,msg:null}}function e(){return!(""==this.$input.val()&&null==this.defaultValue)&&this.$input.val()!=this.defaultValue}function f(a,d,e){var f,g=b.isEmpty(a);return DataObject.check(a,!0),f=e?{type:e,value:d}:d,g?(c(a,this.args.grid),a.setChildSync(this.args.column.jpath,f),this.args.grid.module.view.slick.data.addItem(a),f):void this.args.grid.module.model.dataSetChildSync(a,this.args.column.jpath,f)}function g(){return this.$input.val()}function h(a){this.defaultValue=a.getChildSync(this.args.column.jpath),this.defaultValue=this.defaultValue?this.defaultValue.get()||"":"",this.$input.val(this.defaultValue),this.$input[0].defaultValue=this.defaultValue,this.$input.select()}function i(a){this.$input.val(a)}function j(){return this.$input.val()}function k(){var a=this,b=this.args.container;this.initOptions=this.initOptions||{},this.initOptions.textarea?(b=$("<div>").appendTo(this.args.container),this.$input=$('<textarea  class="editor-text" rows="10" cols="60" style="z-index:10000; position: relative;"/>')):this.$input=$('<INPUT type="text" class="editor-text" />'),this.$input.appendTo(this.args.container).bind("keydown.nav",function(a){a.keyCode!==$.ui.keyCode.LEFT&&a.keyCode!==$.ui.keyCode.RIGHT||a.stopImmediatePropagation()}).focus().select().focusout(function(){a.args.grid.module.view.slick.options.autoEdit?a.args.commitChanges("none"):a.args.commitChanges("next")})}function l(){this.$input.remove()}function m(){this.$input.focus().select()}function n(){return+this.$input.val()}function o(a,c,d){return c=+c,f.call(this,a,b.isNaN(c)?"NaN":c,d)}function p(){var a=this;this.$input=$('<input type="checkbox" value="true" class="editor-checkbox" hideFocus>'),this.$input.appendTo(this.args.container),this.$input.focus(),this.$input.change(function(){a.args.commitChanges("next")})}function q(a){if(this.defaultValue=a.getChildSync(this.args.column.jpath),this.defaultValue)var b=this.defaultValue.get();b?b instanceof DataBoolean&&!b.get()?this.$input.removeAttr("checked"):this.$input.attr("checked","checked"):this.$input.removeAttr("checked")}function r(){return!!this.$input[0].checked}function s(){return this.serializeValue!==this.defaultValue}function t(a,b,c){b=!!b,f.call(this,a,b,c)}function u(){var a=this;this.$container=$("body"),this.$wrapper=$('<DIV style="z-index:10000; position:absolute;background:white; padding:5px;border:3px solid gray; -moz-border-radius:10px; border-radius:10px;"/>').appendTo(this.$container),this.$input=$('<textarea hidefocus rows=5 style="backround:white; width:250px; height:80px;border:0; outline:0">').appendTo(this.$wrapper),$('<div style="text-align:right"><button>Save</button><button>Cancel</button></div>').appendTo(this.$wrapper),this.$wrapper.find("button:first").bind("click",this.save),this.$wrapper.find("button:last").bind("click",this.cancel),this.$input.bind("keydown",function(b){b.which==$.ui.keyCode.ENTER&&b.ctrlKey?a.save():b.which==$.ui.keyCode.ESCAPE?(b.preventDefault(),a.cancel()):b.which==$.ui.keyCode.TAB&&b.shiftKey?(b.preventDefault(),a.args.grid.navigatePrev()):b.which==$.ui.keyCode.TAB&&(b.preventDefault(),a.args.grid.navigateNext())}),this.position(this.args.position),this.$input.focus().select().focusout(function(){a.args.grid.module.view.slick.options.autoEdit||a.args.commitChanges("next")})}function v(){this.args.commitChanges()}function w(){this.$input.val(this.defaultValue),this.args.cancelChanges()}function x(){this.$wrapper.hide()}function y(){this.$wrapper.show()}function z(a){this.$wrapper.css("top",a.top-5).css("left",a.left-5)}function A(){this.$wrapper.remove()}function B(){this.$wrapper.show(),this.position(this.args.position),this.$input.focus()}function C(a){this.args=a,this.init=u,this.destroy=A,this.focus=B,this.getValue=j,this.setValue=i,this.loadValue=h,this.serializeValue=g,this.applyValue=function(a,b){f.call(this,a,b,this.args.column.dataType)},this.isValueChanged=e,this.validate=d,this.hide=x,this.show=y,this.position=z,this.save=v.bind(this),this.cancel=w.bind(this),this.init()}function D(a){this.args=a,this.initOptions={textarea:!0},this.init=k,this.destroy=l,this.focus=m,this.getValue=j,this.setValue=i,this.loadValue=h,this.serializeValue=g,this.isValueChanged=e,this.validate=d,this.applyValue=function(a,b){f.call(this,a,b,this.args.column.dataType)},this.init()}a.loadCss("./components/spectrum/spectrum.css"),function(a){function b(b){this.args=b;var c,d,e=!1;this.init=function(){c=a('<INPUT type="text" class="editor-text" />'),c.appendTo(b.container),c.focus().select(),c.datepicker({showOn:"button",buttonImageOnly:!0,buttonImage:require.toUrl("components/slickgrid/images/calendar.gif"),beforeShow:function(){e=!0},onClose:function(){e=!1}}),c.width(c.width()-18)},this.destroy=function(){a.datepicker.dpDiv.stop(!0,!0),c.datepicker("hide"),c.datepicker("destroy"),c.remove()},this.show=function(){e&&a.datepicker.dpDiv.stop(!0,!0).show()},this.hide=function(){e&&a.datepicker.dpDiv.stop(!0,!0).hide()},this.position=function(b){e&&a.datepicker.dpDiv.css("top",b.top+30).css("left",b.left)},this.focus=function(){c.focus()},this.loadValue=function(a){d=a.getChildSync(b.column.jpath),d=d?d.value||"01/01/2000":"01/01/2000",c.val(d),c[0].defaultValue=d,c.select()},this.serializeValue=function(){return c.val()},this.applyValue=function(a,b){f.call(this,a,b,this.args.column.dataType)},this.isValueChanged=function(){return!(""==c.val()&&null==d)&&c.val()!=d},this.validate=function(){return{valid:!0,msg:null}},this.init()}function c(b){this.args=b;var c;this.init=function(){var c=this;this.$input=a('<input type="text">');var d=b.container.getBoundingClientRect();this.$div=a("<div>").css({position:"fixed",left:d.left,top:d.top}),a("body").append(this.$div),this.$input.appendTo(this.$div).bind("keydown.nav",function(b){b.keyCode!==a.ui.keyCode.LEFT&&b.keyCode!==a.ui.keyCode.RIGHT||b.stopImmediatePropagation()}).focus().select(),this.$input.spectrum({color:b.item&&b.item.getChildSync&&b.item.getChildSync(b.column.jpath)?b.item.getChildSync(b.column.jpath).get():void 0,appendTo:"body",showInitial:!0,showInput:!0,clickoutFiresChange:!1,showAlpha:!0,showPalette:!0,showSelectionPalette:!0,palette:[["rgba(152,  0,  0, 1)","rgba(255,  0,  0, 1)","rgba(255,  153,  0, 1)","rgba(255,  255,  0, 1)","rgba(0,  255,  0, 1)","rgba(0,  255,  255, 1)","rgba(74,  134,  232, 1)","rgba(0,  0,  255, 1)","rgba(153,  0,  255, 1)","rgba(255,  0,  255, 1)"],["rgba(230,  184,  175, 1)","rgba(244,  204,  204, 1)","rgba(252,  229,  205, 1)","rgba(255,  242,  204, 1)","rgba(217,  234,  211, 1)","rgba(208,  224,  227, 1)","rgba(201,  218,  248, 1)","rgba(207,  226,  243, 1)","rgba(217,  210,  233, 1)","rgba(234,  209,  220, 1)"],["rgba(221,  126,  107, 1)","rgba(234,  153,  153, 1)","rgba(249,  203,  156, 1)","rgba(255,  229,  153, 1)","rgba(182,  215,  168, 1)","rgba(162,  196,  201, 1)","rgba(164,  194,  244, 1)","rgba(159,  197,  232, 1)","rgba(180,  167,  214, 1)","rgba(213,  166,  189, 1)"],["rgba(204,  65,  37, 1)","rgba(224,  102,  102, 1)","rgba(246,  178,  107, 1)","rgba(255,  217,  102, 1)","rgba(147,  196,  125, 1)","rgba(118,  165,  175, 1)","rgba(109,  158,  235, 1)","rgba(111,  168,  220, 1)","rgba(142,  124,  195, 1)","rgba(194,  123,  160, 1)"],["rgba(166,  28,  0, 1)","rgba(204,  0,  0, 1)","rgba(230,  145,  56, 1)","rgba(241,  194,  50, 1)","rgba(106,  168,  79, 1)","rgba(69,  129,  142, 1)","rgba(60,  120,  216, 1)","rgba(61,  133,  198, 1)","rgba(103,  78,  167, 1)","rgba(166,  77,  121, 1)"],["rgba(133,  32,  12, 1)","rgba(153,  0,  0, 1)","rgba(180,  95,  6, 1)","rgba(191,  144,  0, 1)","rgba(56,  118,  29, 1)","rgba(19,  79,  92, 1)","rgba(17,  85,  204, 1)","rgba(11,  83,  148, 1)","rgba(53,  28,  117, 1)","rgba(116,  27,  71, 1)"],["rgba(91,  15,  0, 1)","rgba(102,  0,  0, 1)","rgba(120,  63,  4, 1)","rgba(127,  96,  0, 1)","rgba(39,  78,  19, 1)","rgba(12,  52,  61, 1)","rgba(28,  69,  135, 1)","rgba(7,  55,  99, 1)","rgba(32,  18,  77, 1)","rgba(76,  17,  48, 1)"]],preferredFormat:"rgba",change:function(a){c.color=a,c.changed=!0,b.commitChanges("next")},move:function(a){},show:function(){},hide:function(){c.changed||b.cancelChanges()},localStorageKey:"visualizer-spectrum"}),this.$input.next().first().click()},this.destroy=function(){var a=this.$input.data();void 0===a["spectrum.id"],this.$input.spectrum("destroy"),this.$div.remove()},this.focus=function(){this.$input.focus()},this.getValue=function(){this.$input.val()},this.setValue=function(a){this.$input.val(a)},this.loadValue=function(a){c=a.getChildSync(b.column.jpath),c=c?String(c.get())||"#000000":"#000000",this.$input.val(c),this.$input.spectrum("set",c),this.$input[0].defaultValue=c,this.$input.select()},this.serializeValue=function(){return this.color?this.color.toRgbString():this.$input.val()},this.applyValue=function(a,b){f.call(this,a,b,this.args.column.dataType)},this.isValueChanged=function(){return!(""==this.$input.val()&&null==c)&&this.$input.val()!=c},this.validate=function(){if(b.column.validator){var a=b.column.validator(this.$input.val());if(!a.valid)return a}return{valid:!0,msg:null}},this.init()}function u(a,b){this.args=a,this.initOptions=b,this.init=k,this.destroy=l,this.focus=m,this.getValue=j,this.setValue=i,this.loadValue=h,this.serializeValue=g,this.isValueChanged=e,this.validate=d,this.applyValue=function(a,b){f.call(this,a,b,this.args.column.dataType)},this.init()}function v(a){this.args=a,this.init=k,this.destroy=l,this.focus=m,this.getValue=n,this.setValue=i,this.loadValue=h,this.serializeValue=g,this.isValueChanged=e,this.validate=d,this.applyValue=function(a,b){o.call(this,a,b,this.args.column.dataType)},this.init()}function w(a){this.args=a,this.init=p,this.destroy=l,this.focus=m,this.getValue=n,this.setValue=i,this.loadValue=q,this.serializeValue=r,this.isValueChanged=s,this.validate=d,this.applyValue=function(a,b){t.call(this,a,b,this.args.column.dataType)},this.init()}a.extend(!0,window,{Slick:{CustomEditors:{TextValue:u,NumberValue:v,BooleanValue:w,ColorValue:c,Text:u,Date:b,LongText:C,SimpleLongText:D}}})}(jQuery)}),function(a){function b(a,b,c,d,e){return null==c||""===c?"-":50>c?'<span style="color:red;font-weight:bold;">'+c+"%</span>":'<span style="color:green">'+c+"%</span>"}function c(a,b,c,d,e){if(null==c||""===c)return"";var f;return f=30>c?"red":70>c?"silver":"green",'<span class="percent-complete-bar" style="background:'+f+";width:"+c+'%"></span>'}function d(a,b,c,d,e){return c?"Yes":"No"}function e(a,b,c,d,e){return c?'<span style="color: green;">&#10004;</span>':'<span style="color: red;">&#10008;</span>'}a.extend(!0,window,{Slick:{Formatters:{PercentComplete:b,PercentCompleteBar:c,YesNo:d,Checkmark:e}}})}(jQuery),define("modules/types/edition/slick_grid/slick.formatters.custom",function(){}),function(a){function b(b){function c(a){l=a,m.subscribe(l.onSelectedRowsChanged,e).subscribe(l.onClick,g).subscribe(l.onHeaderClick,i).subscribe(l.onKeyDown,f)}function d(){m.unsubscribeAll()}function e(a,b){var c,d,e=l.getSelectedRows(),f={};for(d=0;d<e.length;d++)c=e[d],f[c]=!0,f[c]!==n[c]&&(l.invalidateRow(c),delete n[c]);for(d in n)l.invalidateRow(d);n=f,l.render(),e.length&&e.length==l.getDataLength()?l.updateColumnHeader(p.columnId,"<input type='checkbox' checked='checked'>",p.toolTip):l.updateColumnHeader(p.columnId,"<input type='checkbox'>",p.toolTip)}function f(a,b){32==a.which&&l.getColumns()[b.cell].id===p.columnId&&(l.getEditorLock().isActive()&&!l.getEditorLock().commitCurrentEdit()||h(b.row),a.preventDefault(),a.stopImmediatePropagation())}function g(b,c){if(l.getColumns()[c.cell].id===p.columnId&&a(b.target).is(":checkbox")){if(l.getEditorLock().isActive()&&!l.getEditorLock().commitCurrentEdit())return b.preventDefault(),void b.stopImmediatePropagation();h(c.row),b.stopPropagation(),b.stopImmediatePropagation()}}function h(b){n[b]?l.setSelectedRows(a.grep(l.getSelectedRows(),function(a){return a!=b})):l.setSelectedRows(l.getSelectedRows().concat(b))}function i(b,c){if(c.column.id==p.columnId&&a(b.target).is(":checkbox")){if(l.getEditorLock().isActive()&&!l.getEditorLock().commitCurrentEdit())return b.preventDefault(),void b.stopImmediatePropagation();if(a(b.target).is(":checked")){for(var d=[],e=0;e<l.getDataLength();e++)d.push(e);l.setSelectedRows(d)}else l.setSelectedRows([]);b.stopPropagation(),b.stopImmediatePropagation()}}function j(){return{id:p.columnId,name:"<input type='checkbox'>",toolTip:p.toolTip,field:"sel",width:p.width,resizable:!1,sortable:!1,cssClass:p.cssClass,formatter:k}}function k(a,b,c,d,e){return e?n[a]?"<input type='checkbox' checked='checked'>":"<input type='checkbox'>":null}var l,m=new Slick.EventHandler,n={},o={columnId:"_checkbox_selector",cssClass:null,toolTip:"Select/Deselect All",width:30},p=a.extend(!0,{},o,b);a.extend(this,{init:c,destroy:d,getColumnDefinition:j})}a.extend(!0,window,{Slick:{CheckboxSelectColumn:b}})}(jQuery),define("components/slickgrid/plugins/slick.checkboxselectcolumn",function(){}),function(a){function b(b,c,d){function e(){c.onHeaderContextMenu.subscribe(g),c.onColumnsReordered.subscribe(h),d=a.extend({},m,d),k=a("<span class='slick-columnpicker' style='display:none;position:absolute;z-index:20;' />").appendTo(document.body),k.bind("mouseleave",function(b){a(this).fadeOut(d.fadeSpeed)}),k.bind("click",i)}function f(){c.onHeaderContextMenu.unsubscribe(g),c.onColumnsReordered.unsubscribe(h),k.remove()}function g(e,f){e.preventDefault(),k.empty(),h(),l=[];for(var g,i,j=0;j<b.length;j++)g=a("<li />").appendTo(k),i=a("<input type='checkbox' />").data("column-id",b[j].id),l.push(i),null!=c.getColumnIndex(b[j].id)&&i.attr("checked","checked"),a("<label />").text(b[j].name).prepend(i).appendTo(g);a("<hr/>").appendTo(k),g=a("<li />").appendTo(k),i=a("<input type='checkbox' />").data("option","autoresize"),a("<label />").text("Force fit columns").prepend(i).appendTo(g),c.getOptions().forceFitColumns&&i.attr("checked","checked"),g=a("<li />").appendTo(k),i=a("<input type='checkbox' />").data("option","syncresize"),a("<label />").text("Synchronous resize").prepend(i).appendTo(g),c.getOptions().syncColumnCellResize&&i.attr("checked","checked"),k.css("top",e.pageY-10).css("left",e.pageX-10).fadeIn(d.fadeSpeed)}function h(){for(var a=c.getColumns().slice(0),d=new Array(b.length),e=0;e<d.length;e++)void 0===c.getColumnIndex(b[e].id)?d[e]=b[e]:d[e]=a.shift();b=d}function i(d){if("autoresize"==a(d.target).data("option"))return void(d.target.checked?(c.setOptions({forceFitColumns:!0}),c.autosizeColumns()):c.setOptions({forceFitColumns:!1}));if("syncresize"==a(d.target).data("option"))return void(d.target.checked?c.setOptions({syncColumnCellResize:!0}):c.setOptions({syncColumnCellResize:!1}));if(a(d.target).is(":checkbox")){var e=[];if(a.each(l,function(c,d){a(this).is(":checked")&&e.push(b[c])}),!e.length)return void a(d.target).attr("checked","checked");c.setColumns(e)}}function j(){return b}var k,l,m={fadeSpeed:250};return e(),{getAllColumns:j,destroy:f}}a.extend(!0,window,{Slick:{Controls:{ColumnPicker:b}}})}(jQuery),define("components/slickgrid/controls/slick.columnpicker",function(){}),function(a){function b(b,c,d){function e(b){var d=c[b],e=a(d).offset(),f=a(d).width(),g=a(d).height();return{top:e.top,left:e.left,bottom:e.top+g,right:e.left+f,width:f,height:g,visible:!0}}function f(f){function h(){var d={},g=b.map(function(a){return a.compositeEditor||a.editor?1:0}).reduce(function(a,b){return a+b}),h=g;for(j=new Array(g);h--;){var k=b[h].compositeEditor||b[h].editor;k&&(d=a.extend({},f),d.container=c[h],d.column=b[h],d.position=e(h),d.commitChanges=i,d.cancelChanges=i,j[h]=new k(d))}}var j=[];this.destroy=function(){for(var a=j.length;a--;)j[a].destroy();d.destroy&&d.destroy()},this.focus=function(){(g||j[0]).focus()},this.isValueChanged=function(){for(var a=j.length;a--;)if(j[a].isValueChanged())return!0;return!1},this.serializeValue=function(){for(var a=[],b=j.length;b--;)a[b]=j[b].serializeValue();return a},this.applyValue=function(a,b){for(var c=j.length;c--;)j[c].applyValue(a,b[c])},this.loadValue=function(a){for(var b=j.length;b--;)j[b].loadValue(a)},this.validate=function(){var a,b=[];g=null;for(var e=j.length;e--;)a=j[e].validate(),a.valid||(g=j[e],b.push({index:e,editor:j[e],container:c[e],msg:a.msg}));return b.length?{valid:!1,msg:d.validationFailedMsg,errors:b}:{valid:!0,msg:""}},this.hide=function(){for(var a=j.length;a--;)j[a].hide&&j[a].hide();d.hide&&d.hide()},this.show=function(){
for(var a=j.length;a--;)j[a].show&&j[a].show();d.show&&d.show()},this.position=function(a){d.position&&d.position(a)},h()}var g,h={validationFailedMsg:"Some of the fields have failed validation",show:null,hide:null,position:null,destroy:null},i=function(){};return d=a.extend({},h,d),f.prototype=this,f}a.extend(!0,window,{Slick:{CompositeEditor:b}})}(jQuery),define("components/slickgrid/examples/slick.compositeeditor",function(){}),"undefined"==typeof jQuery)throw"SlickGrid requires jquery module to be loaded";if(!jQuery.fn.drag)throw"SlickGrid requires jquery.event.drag module to be loaded";if("undefined"==typeof Slick)throw"slick.core.js not loaded";!function($){function SlickGrid(container,data,columns,options){function init(){if($container=$(container),$container.length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");cacheCssForHiddenInit(),maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),options=$.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,columnsById={};for(var a=0;a<columns.length;a++){var b=columns[a]=$.extend({},columnDefaults,columns[a]);columnsById[b.id]=a,b.minWidth&&b.width<b.minWidth&&(b.width=b.minWidth),b.maxWidth&&b.width>b.maxWidth&&(b.width=b.maxWidth)}if(options.enableColumnReorder&&!$.fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=$("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$headerScroller=$("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headers=$("<div class='slick-header-columns' style='left:-1000px' />").appendTo($headerScroller),$headers.width(getHeadersWidth()),$headerRowScroller=$("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headerRow=$("<div class='slick-headerrow-columns' />").appendTo($headerRowScroller),$headerRowSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($headerRowScroller),$topPanelScroller=$("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$topPanel=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScroller),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewport=$("<div class='slick-viewport' style='width:100%;overflow:auto;outline:0;position:relative;;'>").appendTo($container),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),$canvas=$("<div class='grid-canvas' />").appendTo($viewport),options.createFooterRow&&($footerRowScroller=$("<div class='slick-footerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$footerRow=$("<div class='slick-footerrow-columns' />").appendTo($footerRowScroller),$footerRowSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($footerRowScroller),options.showFooterRow||$footerRowScroller.hide()),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,viewportW=parseFloat($.css($container[0],"width",!0)),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.bind("selectstart.ui",function(a){return $(a.target).is("input,textarea")}),updateColumnCaches(),createColumnHeaders(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.bind("resize.slickgrid",resizeCanvas),$viewport.bind("scroll",handleScroll),$headerScroller.bind("contextmenu",handleHeaderContextMenu).bind("click",handleHeaderClick).delegate(".slick-header-column","mouseenter",handleHeaderMouseEnter).delegate(".slick-header-column","mouseleave",handleHeaderMouseLeave),$headerRowScroller.bind("scroll",handleHeaderRowScroll),options.createFooterRow&&$footerRowScroller.bind("scroll",handleFooterRowScroll),$focusSink.add($focusSink2).bind("keydown",handleKeyDown),$canvas.bind("keydown",handleKeyDown).bind("click",handleClick).bind("dblclick",handleDblClick).bind("contextmenu",handleContextMenu).bind("draginit",handleDragInit).bind("dragstart",{distance:3},handleDragStart).bind("drag",handleDrag).bind("dragend",handleDragEnd).delegate(".slick-cell","mouseenter",handleMouseEnter).delegate(".slick-cell","mouseleave",handleMouseLeave),navigator.userAgent.toLowerCase().match(/webkit/)&&navigator.userAgent.toLowerCase().match(/macintosh/)&&$canvas.bind("mousewheel",handleMouseWheel),restoreCssFromHiddenInit())}function cacheCssForHiddenInit(){$hiddenParents=$container.parents().andSelf().not(":visible"),$hiddenParents.each(function(){var a={};for(var b in cssShow)a[b]=this.style[b],this.style[b]=cssShow[b];oldProps.push(a)})}function restoreCssFromHiddenInit(){$hiddenParents.each(function(a){var b=oldProps[a];for(var c in cssShow)this.style[c]=b[c]})}function registerPlugin(a){plugins.unshift(a),a.init(self)}function unregisterPlugin(a){for(var b=plugins.length;b>=0;b--)if(plugins[b]===a){plugins[b].destroy&&plugins[b].destroy(),plugins.splice(b,1);break}}function setSelectionModel(a){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),selectionModel=a,selectionModel&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var a=$("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),b={width:a.width()-a[0].clientWidth,height:a.height()-a[0].clientHeight};return a.remove(),b}function getHeadersWidth(){for(var a=0,b=0,c=columns.length;c>b;b++){var d=columns[b].width;a+=d}return a+=scrollbarDimensions.width,Math.max(a,viewportW)+1e3}function getCanvasWidth(){for(var a=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,b=0,c=columns.length;c--;)b+=columns[c].width;return options.fullWidthRows?Math.max(b,a):b}function updateCanvasWidth(a){var b=canvasWidth;canvasWidth=getCanvasWidth(),canvasWidth!=b&&($canvas.width(canvasWidth),$headerRow.width(canvasWidth),options.createFooterRow&&$footerRow.width(canvasWidth),$headers.width(getHeadersWidth()),viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width);var c=canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0);$headerRowSpacer.width(c),options.createFooterRow&&$footerRowSpacer.width(c),(canvasWidth!=b||a)&&applyColumnWidths()}function disableSelection(a){a&&a.jquery&&a.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function getMaxSupportedCssHeight(){for(var a=1e6,b=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,c=$("<div style='display:none' />").appendTo(document.body);;){var d=2*a;if(c.css("height",d),d>b||c.height()!==d)break;a=d}return c.remove(),a}function bindAncestorScrollEvents(){for(var a=$canvas[0];(a=a.parentNode)!=document.body&&null!=a;)if(a==$viewport[0]||a.scrollWidth!=a.clientWidth||a.scrollHeight!=a.clientHeight){var b=$(a);$boundAncestors=$boundAncestors?$boundAncestors.add(b):b,b.bind("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.unbind("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(a,b,c){if(initialized){var d=getColumnIndex(a);if(null!=d){var e=columns[d],f=$headers.children().eq(d);f&&(void 0!==b&&(columns[d].name=b),void 0!==c&&(columns[d].toolTip=c),trigger(self.onBeforeHeaderCellDestroy,{node:f[0],column:e,grid:self}),f.attr("title",c||"").children().eq(0).html(b),trigger(self.onHeaderCellRendered,{node:f[0],column:e,grid:self}))}}}function getHeaderRow(){return $headerRow[0]}function getFooterRow(){return $footerRow[0]}function getHeaderRowColumn(a){var b=getColumnIndex(a),c=$headerRow.children().eq(b);return c&&c[0]}function getFooterRowColumn(a){var b=getColumnIndex(a),c=$footerRow.children().eq(b);return c&&c[0]}function createColumnHeaders(){function a(){$(this).addClass("ui-state-hover")}function b(){$(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each(function(){var a=$(this).data("column");a&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:a,grid:self})}),$headers.empty(),$headers.width(getHeadersWidth()),$headerRow.find(".slick-headerrow-column").each(function(){var a=$(this).data("column");a&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:a,grid:self})}),$headerRow.empty(),options.createFooterRow&&($footerRow.find(".slick-footerrow-column").each(function(){var a=$(this).data("column");a&&trigger(self.onBeforeFooterRowCellDestroy,{node:this,column:a})}),$footerRow.empty());for(var c=0;c<columns.length;c++){var d=columns[c],e=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+d.name+"</span>").width(d.width-headerColumnWidthDiff).attr("id",""+uid+d.id).attr("title",d.toolTip||"").data("column",d).addClass(d.headerCssClass||"").appendTo($headers);if((options.enableColumnReorder||d.sortable)&&e.on("mouseenter",a).on("mouseleave",b),d.sortable&&(e.addClass("slick-header-sortable"),e.append("<span class='slick-sort-indicator' />")),trigger(self.onHeaderCellRendered,{node:e[0],column:d,grid:self}),options.showHeaderRow){var f=$("<div class='ui-state-default slick-headerrow-column l"+c+" r"+c+"'></div>").data("column",d).appendTo($headerRow);trigger(self.onHeaderRowCellRendered,{node:f[0],column:d,grid:self})}if(options.createFooterRow&&options.showFooterRow){var g=$("<div class='ui-state-default slick-footerrow-column l"+c+" r"+c+"'></div>").data("column",d).appendTo($footerRow);trigger(self.onFooterRowCellRendered,{node:g[0],column:d})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&setupColumnReorder()}function setupColumnSort(){$headers.click(function(a){if(a.metaKey=a.metaKey||a.ctrlKey,!$(a.target).hasClass("slick-resizable-handle")){var b=$(a.target).closest(".slick-header-column");if(b.length){var c=b.data("column");if(c.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var d=null,e=0;e<sortColumns.length;e++)if(sortColumns[e].columnId==c.id){d=sortColumns[e],d.sortAsc=!d.sortAsc;break}a.metaKey&&options.multiColumnSort?d&&sortColumns.splice(e,1):((a.shiftKey||a.metaKey)&&options.multiColumnSort||(sortColumns=[]),d?0==sortColumns.length&&sortColumns.push(d):(d={columnId:c.id,sortAsc:c.defaultSortAsc},sortColumns.push(d))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:$.map(sortColumns,function(a){return{sortCol:columns[getColumnIndex(a.columnId)],sortAsc:a.sortAsc}}),grid:self},a):trigger(self.onSort,{multiColumnSort:!1,sortCol:c,sortAsc:d.sortAsc,grid:self},a)}}}})}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy"),$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,start:function(a,b){b.placeholder.width(b.helper.outerWidth()-headerColumnWidthDiff),$(b.helper).addClass("slick-header-column-active")},beforeStop:function(a,b){$(b.helper).removeClass("slick-header-column-active")},stop:function(a){if(!getEditorLock().commitCurrentEdit())return void $(this).sortable("cancel");for(var b=$headers.sortable("toArray"),c=[],d=0;d<b.length;d++)c.push(columns[getColumnIndex(b[d].replace(uid,""))]);setColumns(c),trigger(self.onColumnsReordered,{grid:self}),a.stopPropagation(),setupColumnResize()}})}function setupColumnResize(){var a,b,c,d,e,f,g,h,i;e=$headers.children(),e.find(".slick-resizable-handle").remove(),e.each(function(a,b){columns[a].resizable&&(void 0===h&&(h=a),i=a)}),void 0!==h&&e.each(function(j,k){h>j||options.forceFitColumns&&j>=i||(a=$(k),$("<div class='slick-resizable-handle' />").appendTo(k).bind("dragstart",function(a,h){if(!getEditorLock().commitCurrentEdit())return!1;d=a.pageX,$(this).parent().addClass("slick-header-column-active");var i=null,k=null;if(e.each(function(a,b){columns[a].previousWidth=$(b).outerWidth()}),options.forceFitColumns)for(i=0,k=0,b=j+1;b<e.length;b++)c=columns[b],c.resizable&&(null!==k&&(c.maxWidth?k+=c.maxWidth-c.previousWidth:k=null),i+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth));var l=0,m=0;for(b=0;j>=b;b++)c=columns[b],c.resizable&&(null!==m&&(c.maxWidth?m+=c.maxWidth-c.previousWidth:m=null),l+=c.previousWidth-Math.max(c.minWidth||0,absoluteColumnMinWidth));null===i&&(i=1e5),null===l&&(l=1e5),null===k&&(k=1e5),null===m&&(m=1e5),g=d+Math.min(i,m),f=d-Math.min(l,k)}).bind("drag",function(a,h){var i,k,l=Math.min(g,Math.max(f,a.pageX))-d;if(0>l){for(k=l,b=j;b>=0;b--)c=columns[b],c.resizable&&(i=Math.max(c.minWidth||0,absoluteColumnMinWidth),k&&c.previousWidth+k<i?(k+=c.previousWidth-i,c.width=i):(c.width=c.previousWidth+k,k=0));if(options.forceFitColumns)for(k=-l,b=j+1;b<e.length;b++)c=columns[b],c.resizable&&(k&&c.maxWidth&&c.maxWidth-c.previousWidth<k?(k-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+k,k=0))}else{for(k=l,b=j;b>=0;b--)c=columns[b],c.resizable&&(k&&c.maxWidth&&c.maxWidth-c.previousWidth<k?(k-=c.maxWidth-c.previousWidth,c.width=c.maxWidth):(c.width=c.previousWidth+k,k=0));if(options.forceFitColumns)for(k=-l,b=j+1;b<e.length;b++)c=columns[b],c.resizable&&(i=Math.max(c.minWidth||0,absoluteColumnMinWidth),k&&c.previousWidth+k<i?(k+=c.previousWidth-i,c.width=i):(c.width=c.previousWidth+k,k=0))}applyColumnHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths()}).bind("dragend",function(a,d){var f;for($(this).parent().removeClass("slick-header-column-active"),b=0;b<e.length;b++)c=columns[b],f=$(e[b]).outerWidth(),c.previousWidth!==f&&c.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{grid:self})}))})}function getVBoxDelta(a){var b=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=0;return $.each(b,function(b,d){c+=parseFloat(a.css(d))||0}),c}function measureCellPaddingAndBorder(){var a,b=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],c=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],d=$.fn.jquery.split(".");jQueryNewWidthBehaviour=1==d[0]&&d[1]>=8||d[0]>=2,a=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=a.css("box-sizing")&&"border-box"!=a.css("-moz-box-sizing")&&"border-box"!=a.css("-webkit-box-sizing")&&($.each(b,function(b,c){headerColumnWidthDiff+=parseFloat(a.css(c))||0}),$.each(c,function(b,c){headerColumnHeightDiff+=parseFloat(a.css(c))||0})),a.remove();var e=$("<div class='slick-row' />").appendTo($canvas);a=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(e),cellWidthDiff=cellHeightDiff=0,"border-box"!=a.css("box-sizing")&&"border-box"!=a.css("-moz-box-sizing")&&"border-box"!=a.css("-webkit-box-sizing")&&($.each(b,function(b,c){cellWidthDiff+=parseFloat(a.css(c))||0}),$.each(c,function(b,c){cellHeightDiff+=parseFloat(a.css(c))||0})),e.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));var a=options.rowHeight-cellHeightDiff;$style[0].styleSheet?$style[0].styleSheet.cssText="":$style[0].appendChild(document.createTextNode(""));var b=$style[0].sheet,c=0;addCSSRule(b,"."+uid+" .slick-header-column","left: 1000px;",c++),addCSSRule(b,"."+uid+" .slick-top-panel","height:"+options.topPanelHeight+"px;",c++),addCSSRule(b,"."+uid+" .slick-headerrow-columns","height:"+options.headerRowHeight+"px;",c++),addCSSRule(b,"."+uid+" .slick-footerrow-columns","height:"+options.footerRowHeight+"px;",c++),addCSSRule(b,"."+uid+" .slick-cell","height:"+a+"px;",c++),addCSSRule(b,"."+uid+" .slick-row","height:"+options.rowHeight+"px;",c++);for(var d=0;d<columns.length;d++)addCSSRule(b,"."+uid+" .l"+d,"",c++),addCSSRule(b,"."+uid+" .r"+d,"",c++)}function addCSSRule(a,b,c,d){a.insertRule?a.insertRule(b+"{"+c+"}",d):a.addRule(b,c,d)}function getColumnCssRules(a){if(!stylesheet){for(var b=document.styleSheets,c=0;c<b.length;c++)if((b[c].ownerNode||b[c].owningElement)==$style[0]){stylesheet=b[c];break}if(!stylesheet)throw new Error("Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];for(var d,e,f=stylesheet.cssRules||stylesheet.rules,c=0;c<f.length;c++){var g=f[c].selectorText;(d=/\.l\d+/.exec(g))?(e=parseInt(d[0].substr(2,d[0].length-2),10),columnCssRulesL[e]=f[c]):(d=/\.r\d+/.exec(g))&&(e=parseInt(d[0].substr(2,d[0].length-2),10),columnCssRulesR[e]=f[c])}}return{left:columnCssRulesL[a],right:columnCssRulesR[a]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{grid:self});for(var a=plugins.length;a--;)unregisterPlugin(plugins[a]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.unbind(".slickgrid"),removeCssRules(),$canvas.unbind("draginit dragstart dragend drag"),$container.empty().removeClass(uid)}function trigger(a,b,c){return c=c||new Slick.EventData,b=b||{},b.grid=self,a.notify(b,c,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(a){return columnsById[a]}function autosizeColumns(){var a,b,c,d=[],e=0,f=0,g=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(a=0;a<columns.length;a++)b=columns[a],d.push(b.width),f+=b.width,b.resizable&&(e+=b.width-Math.max(b.minWidth,absoluteColumnMinWidth));for(c=f;f>g&&e;){var h=(f-g)/e;for(a=0;a<columns.length&&f>g;a++){b=columns[a];var i=d[a];if(!(!b.resizable||i<=b.minWidth||absoluteColumnMinWidth>=i)){var j=Math.max(b.minWidth,absoluteColumnMinWidth),k=Math.floor(h*(i-j))||1;k=Math.min(k,i-j),f-=k,e-=k,d[a]-=k}}if(f>=c)break;c=f}for(c=f;g>f;){var l=g/f;for(a=0;a<columns.length&&g>f;a++){b=columns[a];var m,n=d[a];m=!b.resizable||b.maxWidth<=n?0:Math.min(Math.floor(l*n)-n,b.maxWidth-n||1e6)||1,f+=m,d[a]+=g>=f?m:0}if(c>=f)break;c=f}var o=!1;for(a=0;a<columns.length;a++)columns[a].rerenderOnResize&&columns[a].width!=d[a]&&(o=!0),columns[a].width=d[a];applyColumnHeaderWidths(),updateCanvasWidth(!0),o&&(invalidateAllRows(),render())}function applyColumnHeaderWidths(){if(initialized){for(var a,b=0,c=$headers.children(),d=c.length;d>b;b++)a=$(c[b]),jQueryNewWidthBehaviour?a.outerWidth()!==columns[b].width&&a.outerWidth(columns[b].width):a.width()!==columns[b].width-headerColumnWidthDiff&&a.width(columns[b].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var a,b,c=0,d=0;d<columns.length;d++)a=columns[d].width,b=getColumnCssRules(d),b.left.style.left=c+"px",b.right.style.right=canvasWidth-c-a+"px",c+=columns[d].width}function setSortColumn(a,b){setSortColumns([{columnId:a,sortAsc:b}])}function setSortColumns(a){sortColumns=a;var b=$headers.children();b.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"),$.each(sortColumns,function(a,c){null==c.sortAsc&&(c.sortAsc=!0);var d=getColumnIndex(c.columnId);null!=d&&b.eq(d).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(c.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc")})}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(a,b){selectedRows=[];for(var c={},d=0;d<b.length;d++)for(var e=b[d].fromRow;e<=b[d].toRow;e++){c[e]||(selectedRows.push(e),c[e]={});for(var f=b[d].fromCell;f<=b[d].toCell;f++)canCellBeSelected(e,f)&&(c[e][columns[f].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,c),trigger(self.onSelectedRowsChanged,{rows:getSelectedRows(),grid:self},a)}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var a=0,b=0,c=columns.length;c>b;b++)columnPosLeft[b]=a,columnPosRight[b]=a+columns[b].width,a+=columns[b].width}function setColumns(a){columns=a,columnsById={};for(var b=0;b<columns.length;b++){var c=columns[b]=$.extend({},columnDefaults,columns[b]);columnsById[c.id]=b,c.minWidth&&c.width<c.minWidth&&(c.width=c.minWidth),c.maxWidth&&c.width>c.maxWidth&&(c.width=c.maxWidth)}updateColumnCaches(),initialized&&(invalidateAllRows(),createColumnHeaders(),removeCssRules(),createCssRules(),resizeCanvas(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(a){getEditorLock().commitCurrentEdit()&&(makeActiveCellNormal(),options.enableAddRow!==a.enableAddRow&&invalidateRow(getDataLength()),options=$.extend(options,a),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),render())}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1)}function setData(a,b){data=a,invalidateAllRows(),updateRowCount(),b&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data.length}function getDataLengthIncludingAddNew(){return getDataLength()+(options.enableAddRow?1:0)}function getDataItem(a){return data.getItem?data.getItem(a):data[a]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(a){options.showTopPanel!=a&&(options.showTopPanel=a,a?$topPanelScroller.slideDown("fast",resizeCanvas):$topPanelScroller.slideUp("fast",resizeCanvas))}function setHeaderRowVisibility(a){options.showHeaderRow!=a&&(options.showHeaderRow=a,a?$headerRowScroller.slideDown("fast",resizeCanvas):$headerRowScroller.slideUp("fast",resizeCanvas))}function setFooterRowVisibility(a){options.showFooterRow!=a&&(options.showFooterRow=a,a?$footerRowScroller.slideDown("fast",resizeCanvas):$footerRowScroller.slideUp("fast",resizeCanvas))}function getContainerNode(){return $container.get(0)}function getRowTop(a){return options.rowHeight*a-offset}function getRowFromPosition(a){return Math.floor((a+offset)/options.rowHeight)}function scrollTo(a){a=Math.max(a,0),a=Math.min(a,th-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0));var b=offset;page=Math.min(n-1,Math.floor(a/ph)),offset=Math.round(page*cj);var c=a-offset;if(offset!=b){var d=getVisibleRange(c);cleanupRows(d),updateRowPositions()}prevScrollTop!=c&&(vScrollDir=c+offset>prevScrollTop+b?1:-1,$viewport[0].scrollTop=lastRenderedScrollTop=scrollTop=prevScrollTop=c,trigger(self.onViewportChanged,{grid:self}))}function defaultFormatter(a,b,c,d,e){return null==c?"":(c+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(a,b){var c=data.getItemMetadata&&data.getItemMetadata(a),d=c&&c.columns&&(c.columns[b.id]||c.columns[getColumnIndex(b.id)]);return d&&d.formatter||c&&c.formatter||b.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(b)||options.defaultFormatter}function getEditor(a,b){var c=columns[b],d=data.getItemMetadata&&data.getItemMetadata(a),e=d&&d.columns;return e&&e[c.id]&&void 0!==e[c.id].editor?e[c.id].editor:e&&e[b]&&void 0!==e[b].editor?e[b].editor:c.editor||options.editorFactory&&options.editorFactory.getEditor(c)}function getDataItemValueForColumn(a,b){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(a,b):a[b.field]}function appendRowHtml(a,b,c,d){var e=getDataItem(b),f=d>b&&!e,g="slick-row"+(f?" loading":"")+(b===activeRow?" active":"")+(b%2==1?" odd":" even");e||(g+=" "+options.addNewRowCssClass);var h=data.getItemMetadata&&data.getItemMetadata(b);h&&h.cssClasses&&(g+=" "+h.cssClasses),a.push("<div class='ui-widget-content "+g+"' style='top:"+getRowTop(b)+"px'>");for(var i,j,k=0,l=columns.length;l>k;k++){if(j=columns[k],i=1,h&&h.columns){var m=h.columns[j.id]||h.columns[k];i=m&&m.colspan||1,"*"===i&&(i=l-k)}if(columnPosRight[Math.min(l-1,k+i-1)]>c.leftPx){if(columnPosLeft[k]>c.rightPx)break;appendCellHtml(a,b,k,i,e)}i>1&&(k+=i-1)}a.push("</div>")}function appendCellHtml(a,b,c,d,e){var f=columns[c],g="slick-cell l"+c+" r"+Math.min(columns.length-1,c+d-1)+(f.cssClass?" "+f.cssClass:"");b===activeRow&&c===activeCell&&(g+=" active");for(var h in cellCssClasses)cellCssClasses[h][b]&&cellCssClasses[h][b][f.id]&&(g+=" "+cellCssClasses[h][b][f.id]);if(a.push("<div class='"+g+"'>"),e){var i=getDataItemValueForColumn(e,f);a.push(getFormatter(b,f)(b,c,i,f,e))}a.push("</div>"),rowsCache[b].cellRenderQueue.push(c),rowsCache[b].cellColSpans[c]=d}function cleanupRows(a){for(var b in rowsCache)(b=parseInt(b,10))!==activeRow&&(b<a.top||b>a.bottom)&&removeRowFromCache(b);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){currentEditor&&makeActiveCellNormal();for(var a in rowsCache)removeRowFromCache(a);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}function queuePostProcessedRowForCleanup(a,b,c){postProcessgroupId++;for(var d in b)b.hasOwnProperty(d)&&postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:a.cellNodesByColumnIdx[0|d],columnIdx:0|d,rowIdx:c});postProcessedCleanupQueue.push({actionType:"R",groupId:postProcessgroupId,node:a.rowNode}),$(a.rowNode).detach()}function queuePostProcessedCellForCleanup(a,b,c){postProcessedCleanupQueue.push({actionType:"C",groupId:postProcessgroupId,node:a,columnIdx:b,rowIdx:c}),$(a).detach()}function removeRowFromCache(a){var b=rowsCache[a];b&&(rowNodeFromLastMouseWheelEvent===b.rowNode?(b.rowNode.style.display="none",zombieRowNodeFromLastMouseWheelEvent=rowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent=b,zombieRowPostProcessedFromLastMouseWheelEvent=postProcessedRows[a]):options.enableAsyncPostRenderCleanup&&postProcessedRows[a]?queuePostProcessedRowForCleanup(b,postProcessedRows[a],a):$canvas[0].removeChild(b.rowNode),delete rowsCache[a],delete postProcessedRows[a],renderedRows--,counter_rows_removed++)}function invalidateRows(a){var b,c;if(a&&a.length){for(vScrollDir=0,b=0,c=a.length;c>b;b++)currentEditor&&activeRow===a[b]&&makeActiveCellNormal(),rowsCache[a[b]]&&removeRowFromCache(a[b]);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()}}function invalidateRow(a){invalidateRows([a])}function updateCell(a,b){var c=getCellNode(a,b);if(c){var d=columns[b],e=getDataItem(a);currentEditor&&activeRow===a&&activeCell===b?currentEditor.loadValue(e):(c.innerHTML=e?getFormatter(a,d)(a,b,getDataItemValueForColumn(e,d),d,e):"",invalidatePostProcessingResults(a))}}function updateRow(a){var b=rowsCache[a];if(b){ensureCellNodesInRowsCache(a);var c=getDataItem(a);for(var d in b.cellNodesByColumnIdx)if(b.cellNodesByColumnIdx.hasOwnProperty(d)){d=0|d;var e=columns[d],f=b.cellNodesByColumnIdx[d];a===activeRow&&d===activeCell&&currentEditor?currentEditor.loadValue(c):c?f.innerHTML=getFormatter(a,e)(a,d,getDataItemValueForColumn(c,e),e,c):f.innerHTML=""}invalidatePostProcessingResults(a)}}function getViewportHeight(){return parseFloat($.css($container[0],"height",!0))-parseFloat($.css($container[0],"paddingTop",!0))-parseFloat($.css($container[0],"paddingBottom",!0))-parseFloat($.css($headerScroller[0],"height"))-getVBoxDelta($headerScroller)-(options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0)-(options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0)-(options.createFooterRow&&options.showFooterRow?options.footerRowHeight+getVBoxDelta($footerRowScroller):0)}function resizeCanvas(){initialized&&(viewportH=options.autoHeight?options.rowHeight*getDataLengthIncludingAddNew():getViewportHeight(),numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportW=parseFloat($.css($container[0],"width",!0)),options.autoHeight||$viewport.height(viewportH),options.forceFitColumns&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render(),trigger(self.onViewportChanged,{}))}function updateRowCount(){if(initialized){var a=getDataLengthIncludingAddNew(),b=a+(options.leaveSpaceForNewRows?numVisibleRows-1:0),c=viewportHasVScroll;viewportHasVScroll=!options.autoHeight&&b*options.rowHeight>viewportH,viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width,makeActiveCellNormal();var d=a-1;for(var e in rowsCache)e>d&&removeRowFromCache(e);options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup(),activeCellNode&&activeRow>d&&resetActiveCell();var f=h;th=Math.max(options.rowHeight*b,viewportH-scrollbarDimensions.height),maxSupportedCssHeight>th?(h=ph=th,n=1,cj=0):(h=maxSupportedCssHeight,ph=h/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==f&&($canvas.css("height",h),scrollTop=$viewport[0].scrollTop);var g=th-viewportH>=scrollTop+offset;0==th||0==scrollTop?page=offset=0:scrollTo(g?scrollTop+offset:th-viewportH),h!=f&&options.autoHeight&&resizeCanvas(),options.forceFitColumns&&c!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(a,b){return null==a&&(a=scrollTop),null==b&&(b=scrollLeft),{top:getRowFromPosition(a),bottom:getRowFromPosition(a+viewportH)+1,leftPx:b,rightPx:b+viewportW}}function getRenderedRange(a,b){var c=getVisibleRange(a,b),d=Math.round(viewportH/options.rowHeight),e=3;return-1==vScrollDir?(c.top-=d,c.bottom+=e):1==vScrollDir?(c.top-=e,c.bottom+=d):(c.top-=e,c.bottom+=e),c.top=Math.max(0,c.top),c.bottom=Math.min(getDataLengthIncludingAddNew()-1,c.bottom),c.leftPx-=viewportW,c.rightPx+=viewportW,c.leftPx=Math.max(0,c.leftPx),c.rightPx=Math.min(canvasWidth,c.rightPx),c}function ensureCellNodesInRowsCache(a){var b=rowsCache[a];if(b&&b.cellRenderQueue.length)for(var c=b.rowNode.lastChild;b.cellRenderQueue.length;){var d=b.cellRenderQueue.pop();b.cellNodesByColumnIdx[d]=c,c=c.previousSibling}}function cleanUpCells(a,b){var c=0,d=rowsCache[b],e=[];for(var f in d.cellNodesByColumnIdx)if(d.cellNodesByColumnIdx.hasOwnProperty(f)){f=0|f;var g=d.cellColSpans[f];(columnPosLeft[f]>a.rightPx||columnPosRight[Math.min(columns.length-1,f+g-1)]<a.leftPx)&&(b==activeRow&&f==activeCell||e.push(f))}var h,i;for(postProcessgroupId++;null!=(h=e.pop());)i=d.cellNodesByColumnIdx[h],options.enableAsyncPostRenderCleanup&&postProcessedRows[b]&&postProcessedRows[b][h]?queuePostProcessedCellForCleanup(i,h,b):d.rowNode.removeChild(i),delete d.cellColSpans[h],delete d.cellNodesByColumnIdx[h],postProcessedRows[b]&&delete postProcessedRows[b][h],c++}function cleanUpAndRenderCells(a){for(var b,c,d,e=[],f=[],g=0,h=a.top,i=a.bottom;i>=h;h++)if(b=rowsCache[h]){ensureCellNodesInRowsCache(h),cleanUpCells(a,h),c=0;var j=data.getItemMetadata&&data.getItemMetadata(h);j=j&&j.columns;for(var k=getDataItem(h),l=0,m=columns.length;m>l&&!(columnPosLeft[l]>a.rightPx);l++)if(null==(d=b.cellColSpans[l])){if(d=1,j){var n=j[columns[l].id]||j[l];d=n&&n.colspan||1,"*"===d&&(d=m-l)}columnPosRight[Math.min(m-1,l+d-1)]>a.leftPx&&(appendCellHtml(e,h,l,d,k),c++),l+=d>1?d-1:0}else l+=d>1?d-1:0;c&&(g+=c,f.push(h))}if(e.length){var o=document.createElement("div");o.innerHTML=e.join("");
for(var p,q;null!=(p=f.pop());){b=rowsCache[p];for(var r;null!=(r=b.cellRenderQueue.pop());)q=o.lastChild,b.rowNode.appendChild(q),b.cellNodesByColumnIdx[r]=q}}}function renderRows(a){for(var b=$canvas[0],c=[],d=[],e=!1,f=getDataLength(),g=a.top,h=a.bottom;h>=g;g++)rowsCache[g]||(renderedRows++,d.push(g),rowsCache[g]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(c,g,a,f),activeCellNode&&activeRow===g&&(e=!0),counter_rows_rendered++);if(d.length){var i=document.createElement("div");i.innerHTML=c.join("");for(var g=0,h=d.length;h>g;g++)rowsCache[d[g]].rowNode=b.appendChild(i.firstChild);e&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearImmediate(h_postrender),h_postrender=setImmediate(asyncPostProcessRows))}function startPostProcessingCleanup(){options.enableAsyncPostRenderCleanup&&(clearTimeout(h_postrenderCleanup),h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay))}function invalidatePostProcessingResults(a){for(var b in postProcessedRows[a])postProcessedRows[a].hasOwnProperty(b)&&(postProcessedRows[a][b]="C");postProcessFromRow=Math.min(postProcessFromRow,a),postProcessToRow=Math.max(postProcessToRow,a),startPostProcessing()}function updateRowPositions(){for(var a in rowsCache)rowsCache[a].rowNode.style.top=getRowTop(a)+"px"}function render(){if(initialized){var a=getVisibleRange(),b=getRenderedRange();cleanupRows(b),lastRenderedScrollLeft!=scrollLeft&&cleanUpAndRenderCells(b),renderRows(b),trigger(self.onRenderCompleted,{}),postProcessFromRow=a.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,a.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null}}function handleHeaderRowScroll(){var a=$headerRowScroller[0].scrollLeft;a!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=a)}function handleFooterRowScroll(){var a=$footerRowScroller[0].scrollLeft;a!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=a)}function handleScroll(){scrollTop=$viewport[0].scrollTop,scrollLeft=$viewport[0].scrollLeft;var a=Math.abs(scrollTop-prevScrollTop),b=Math.abs(scrollLeft-prevScrollLeft);if(b&&(prevScrollLeft=scrollLeft,$headerScroller[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScroller[0].scrollLeft=scrollLeft,options.createFooterRow&&($footerRowScroller[0].scrollLeft=scrollLeft)),a)if(vScrollDir=scrollTop>prevScrollTop?1:-1,prevScrollTop=scrollTop,viewportH>a)scrollTo(scrollTop+offset);else{var c=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),offset=Math.round(page*cj),c!=offset&&invalidateAllRows()}(b||a)&&(h_render&&clearTimeout(h_render),(Math.abs(lastRenderedScrollTop-scrollTop)>20||Math.abs(lastRenderedScrollLeft-scrollLeft)>20)&&(options.forceSyncScrolling||Math.abs(lastRenderedScrollTop-scrollTop)<viewportH&&Math.abs(lastRenderedScrollLeft-scrollLeft)<viewportW?render():h_render=setTimeout(render,50),trigger(self.onViewportChanged,{grid:self}))),trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop,grid:self})}function asyncPostProcessRows(){for(;postProcessToRow>=postProcessFromRow;){var a=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,b=rowsCache[a];if(b&&!(a>=getDataLength())){postProcessedRows[a]||(postProcessedRows[a]={}),ensureCellNodesInRowsCache(a);for(var c in b.cellNodesByColumnIdx)if(b.cellNodesByColumnIdx.hasOwnProperty(c)){c=0|c;var d=columns[c],e=postProcessedRows[a][c];if(d.asyncPostRender&&"R"!==e){var f=b.cellNodesByColumnIdx[c];f&&d.asyncPostRender(f,a,getDataItem(a),d,"C"===e),postProcessedRows[a][c]="R"}}return void(h_postrender=setImmediate(asyncPostProcessRows))}}}function asyncPostProcessCleanupRows(){if(postProcessedCleanupQueue.length>0){for(var a=postProcessedCleanupQueue[0].groupId;postProcessedCleanupQueue.length>0&&postProcessedCleanupQueue[0].groupId==a;){var b=postProcessedCleanupQueue.shift();if("R"==b.actionType&&$(b.node).remove(),"C"==b.actionType){var c=columns[b.columnIdx];c.asyncPostRenderCleanup&&b.node&&c.asyncPostRenderCleanup(b.node,b.rowIdx,c)}}h_postrenderCleanup=setTimeout(asyncPostProcessCleanupRows,options.asyncPostRenderCleanupDelay)}}function updateCellCssStylesOnRenderedRows(a,b){var c,d,e,f;for(var g in rowsCache){if(f=b&&b[g],e=a&&a[g],f)for(d in f)e&&f[d]==e[d]||(c=getCellNode(g,getColumnIndex(d)),c&&$(c).removeClass(f[d]));if(e)for(d in e)f&&f[d]==e[d]||(c=getCellNode(g,getColumnIndex(d)),c&&$(c).addClass(e[d]))}}function addCellCssStyles(a,b){if(cellCssClasses[a])throw"addCellCssStyles: cell CSS hash with key '"+a+"' already exists.";cellCssClasses[a]=b,updateCellCssStylesOnRenderedRows(b,null),trigger(self.onCellCssStylesChanged,{key:a,hash:b,grid:self})}function removeCellCssStyles(a){cellCssClasses[a]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[a]),delete cellCssClasses[a],trigger(self.onCellCssStylesChanged,{key:a,hash:null,grid:self}))}function setCellCssStyles(a,b){var c=cellCssClasses[a];cellCssClasses[a]=b,updateCellCssStylesOnRenderedRows(b,c),trigger(self.onCellCssStylesChanged,{key:a,hash:b,grid:self})}function getCellCssStyles(a){return cellCssClasses[a]}function flashCell(a,b,c){function d(a){a&&setTimeout(function(){e.queue(function(){e.toggleClass(options.cellFlashingCssClass).dequeue(),d(a-1)})},c)}if(c=c||100,rowsCache[a]){var e=$(getCellNode(a,b));d(4)}}function handleMouseWheel(a){var b=$(a.target).closest(".slick-row")[0];b!=rowNodeFromLastMouseWheelEvent&&(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent!=b&&(options.enableAsyncPostRenderCleanup&&zombieRowPostProcessedFromLastMouseWheelEvent?queuePostProcessedRowForCleanup(zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent):$canvas[0].removeChild(zombieRowNodeFromLastMouseWheelEvent),zombieRowNodeFromLastMouseWheelEvent=null,zombieRowCacheFromLastMouseWheelEvent=null,zombieRowPostProcessedFromLastMouseWheelEvent=null,options.enableAsyncPostRenderCleanup&&startPostProcessingCleanup()),rowNodeFromLastMouseWheelEvent=b)}function handleDragInit(a,b){var c=getCellFromEvent(a);if(!c||!cellExists(c.row,c.cell))return!1;var d=trigger(self.onDragInit,b,a);return a.isImmediatePropagationStopped()?d:!1}function handleDragStart(a,b){var c=getCellFromEvent(a);if(!c||!cellExists(c.row,c.cell))return!1;var d=trigger(self.onDragStart,b,a);return a.isImmediatePropagationStopped()?d:!1}function handleDrag(a,b){return trigger(self.onDrag,b,a)}function handleDragEnd(a,b){trigger(self.onDragEnd,b,a)}function handleKeyDown(a){trigger(self.onKeyDown,{row:activeRow,cell:activeCell,grid:self},a);var b=a.isImmediatePropagationStopped(),c=Slick.keyCode;if(!b)if(a.shiftKey||a.altKey||a.ctrlKey)a.which!=c.TAB||!a.shiftKey||a.ctrlKey||a.altKey||(b=navigatePrev());else if(a.which==c.ESCAPE){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else a.which==c.PAGE_DOWN?(navigatePageDown(),b=!0):a.which==c.PAGE_UP?(navigatePageUp(),b=!0):a.which==c.LEFT?b=navigateLeft():a.which==c.RIGHT?b=navigateRight():a.which==c.UP?b=navigateUp():a.which==c.DOWN?b=navigateDown():a.which==c.TAB?b=navigateNext():a.which==c.ENTER&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable()),b=!0);if(b){a.stopPropagation(),a.preventDefault();try{a.originalEvent.keyCode=0}catch(a){}}}function handleClick(a){currentEditor||(a.target!=document.activeElement||$(a.target).hasClass("slick-cell"))&&setFocus();var b=getCellFromEvent(a);!b||null!==currentEditor&&activeRow==b.row&&activeCell==b.cell||(trigger(self.onClick,{row:b.row,cell:b.cell,grid:self},a),a.isImmediatePropagationStopped()||activeCell==b.cell&&activeRow==b.row||!canCellBeActive(b.row,b.cell)||getEditorLock().isActive()&&!getEditorLock().commitCurrentEdit()||(scrollRowIntoView(b.row,!1),setActiveCellInternal(getCellNode(b.row,b.cell),b.row===getDataLength()||options.autoEdit)))}function handleContextMenu(a){var b=$(a.target).closest(".slick-cell",$canvas);0!==b.length&&(activeCellNode===b[0]&&null!==currentEditor||trigger(self.onContextMenu,{grid:self},a))}function handleDblClick(a){var b=getCellFromEvent(a);!b||null!==currentEditor&&activeRow==b.row&&activeCell==b.cell||(trigger(self.onDblClick,{row:b.row,cell:b.cell,grid:self},a),a.isImmediatePropagationStopped()||options.editable&&gotoCell(b.row,b.cell,!0))}function handleHeaderMouseEnter(a){trigger(self.onHeaderMouseEnter,{column:$(this).data("column"),grid:self},a)}function handleHeaderMouseLeave(a){trigger(self.onHeaderMouseLeave,{column:$(this).data("column"),grid:self},a)}function handleHeaderContextMenu(a){var b=$(a.target).closest(".slick-header-column",".slick-header-columns"),c=b&&b.data("column");trigger(self.onHeaderContextMenu,{column:c,grid:self},a)}function handleHeaderClick(a){var b=$(a.target).closest(".slick-header-column",".slick-header-columns"),c=b&&b.data("column");c&&trigger(self.onHeaderClick,{column:c,grid:self},a)}function handleMouseEnter(a){trigger(self.onMouseEnter,{grid:self},a)}function handleMouseLeave(a){trigger(self.onMouseLeave,{grid:self},a)}function cellExists(a,b){return!(0>a||a>=getDataLength()||0>b||b>=columns.length)}function getCellFromPoint(a,b){for(var c=getRowFromPosition(b),d=0,e=0,f=0;f<columns.length&&a>e;f++)e+=columns[f].width,d++;return 0>d&&(d=0),{row:c,cell:d-1}}function getCellFromNode(a){var b=/l\d+/.exec(a.className);if(!b)throw"getCellFromNode: cannot get cell - "+a.className;return parseInt(b[0].substr(1,b[0].length-1),10)}function getRowFromNode(a){for(var b in rowsCache)if(rowsCache[b].rowNode===a)return 0|b;return null}function getCellFromEvent(a){var b=$(a.target).closest(".slick-cell",$canvas);if(!b.length)return null;var c=getRowFromNode(b[0].parentNode),d=getCellFromNode(b[0]);return null==c||null==d?null:{row:c,cell:d}}function getCellNodeBox(a,b){if(!cellExists(a,b))return null;for(var c=getRowTop(a),d=c+options.rowHeight-1,e=0,f=0;b>f;f++)e+=columns[f].width;var g=e+columns[b].width;return{top:c,left:e,bottom:d,right:g}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(a,b,c){scrollRowIntoView(a,c);var d=getColspan(a,b),e=columnPosLeft[b],f=columnPosRight[b+(d>1?d-1:0)],g=scrollLeft+viewportW;scrollLeft>e?($viewport.scrollLeft(e),handleScroll(),render()):f>g&&($viewport.scrollLeft(Math.min(e,f-$viewport[0].clientWidth)),handleScroll(),render())}function setActiveCellInternal(a,b){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass("active"),rowsCache[activeRow]&&$(rowsCache[activeRow].rowNode).removeClass("active"));var c=activeCellNode!==a;activeCellNode=a,null!=activeCellNode?(activeRow=getRowFromNode(activeCellNode.parentNode),activeCell=activePosX=getCellFromNode(activeCellNode),null==b&&(b=activeRow==getDataLength()||options.autoEdit),$(activeCellNode).addClass("active"),$(rowsCache[activeRow].rowNode).addClass("active"),options.editable&&b&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout(function(){makeActiveCellEditable()},options.asyncEditorLoadDelay):makeActiveCellEditable())):activeRow=activeCell=null,c&&trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(a){}else if(window.getSelection){var a=window.getSelection();a&&a.removeAllRanges&&a.removeAllRanges()}}function isCellPotentiallyEditable(a,b){getDataLength();return a<getDataLength()&&!getDataItem(a)?!1:columns[b].cannotTriggerInsert&&a>=getDataLength()?!1:!!getEditor(a,b)}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor,grid:self}),currentEditor.destroy(),currentEditor=null,activeCellNode){var a=getDataItem(activeRow);if($(activeCellNode).removeClass("editable invalid"),a){var b=columns[activeCell],c=getFormatter(activeRow,b);activeCellNode.innerHTML=c(activeRow,activeCell,getDataItemValueForColumn(a,b),b,a,self),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(a){if(activeCellNode){if(!options.editable)throw"Grid : makeActiveCellEditable : should never get called when options.editable is false";if(clearTimeout(h_editorLoader),(isCellPotentiallyEditable(activeRow,activeCell)||a)&&(!a||columns.some(function(a){return a.editor}))){var b=columns[activeCell],c=getDataItem(activeRow);if(trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:c,column:b,grid:self})===!1)return void setFocus();getEditorLock().activate(editController),$(activeCellNode).addClass("editable");var d=a||getEditor(activeRow,activeCell);return a||d.suppressClearOnEdit||(activeCellNode.innerHTML=""),currentEditor=new d({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:b,item:c||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),c&&currentEditor.loadValue(c),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange(),!0}}}function commitEditAndSetFocus(a){getEditorLock().commitCurrentEdit()&&(setFocus(),a=a||"down",options.autoEdit&&tabbingDirections[a]&&navigate(a))}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(a){var b={top:a.offsetTop,left:a.offsetLeft,bottom:0,right:0,width:$(a).outerWidth(),height:$(a).outerHeight(),visible:!0};b.bottom=b.top+b.height,b.right=b.left+b.width;for(var c=a.offsetParent;(a=a.parentNode)!=document.body&&null!=a;)b.visible&&a.scrollHeight!=a.offsetHeight&&"visible"!=$(a).css("overflowY")&&(b.visible=b.bottom>a.scrollTop&&b.top<a.scrollTop+a.clientHeight),b.visible&&a.scrollWidth!=a.offsetWidth&&"visible"!=$(a).css("overflowX")&&(b.visible=b.right>a.scrollLeft&&b.left<a.scrollLeft+a.clientWidth),b.left-=a.scrollLeft,b.top-=a.scrollTop,a===c&&(b.left+=a.offsetLeft,b.top+=a.offsetTop,c=a.offsetParent),b.bottom=b.top+b.height,b.right=b.left+b.width;return b}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{grid:self}),currentEditor)){var a=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(a.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(a)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell,grid:self}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(a,b){var c=a*options.rowHeight,d=(a+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);(a+1)*options.rowHeight>scrollTop+viewportH+offset?(scrollTo(b?c:d),render()):a*options.rowHeight<scrollTop+offset&&(scrollTo(b?d:c),render())}function scrollRowToTop(a){scrollTo(a*options.rowHeight),render()}function scrollPage(a){var b=a*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop)+b)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var c=activeRow+b,d=getDataLengthIncludingAddNew();c>=d&&(c=d-1),0>c&&(c=0);for(var e=0,f=null,g=activePosX;activePosX>=e;)canCellBeActive(c,e)&&(f=e),e+=getColspan(c,e);null!==f?(setActiveCellInternal(getCellNode(c,f)),activePosX=g):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function getColspan(a,b){var c=data.getItemMetadata&&data.getItemMetadata(a);if(!c||!c.columns)return 1;var d=c.columns[columns[b].id]||c.columns[b],e=d&&d.colspan;return e="*"===e?columns.length-b:e||1}function findFirstFocusableCell(a){for(var b=0;b<columns.length;){if(canCellBeActive(a,b))return b;b+=getColspan(a,b)}return null}function findLastFocusableCell(a){for(var b=0,c=null;b<columns.length;)canCellBeActive(a,b)&&(c=b),b+=getColspan(a,b);return c}function gotoRight(a,b,c){if(b>=columns.length)return null;do b+=getColspan(a,b);while(b<columns.length&&!canCellBeActive(a,b));return b<columns.length?{row:a,cell:b,posX:b}:null}function gotoLeft(a,b,c){if(0>=b)return null;var d=findFirstFocusableCell(a);if(null===d||d>=b)return null;for(var e,f={row:a,cell:d,posX:d};;){if(e=gotoRight(f.row,f.cell,f.posX),!e)return null;if(e.cell>=b)return f;f=e}}function gotoDown(a,b,c){for(var d,e=getDataLengthIncludingAddNew();;){if(++a>=e)return null;for(d=b=0;c>=b;)d=b,b+=getColspan(a,b);if(canCellBeActive(a,d))return{row:a,cell:d,posX:c}}}function gotoUp(a,b,c){for(var d;;){if(--a<0)return null;for(d=b=0;c>=b;)d=b,b+=getColspan(a,b);if(canCellBeActive(a,d))return{row:a,cell:d,posX:c}}}function gotoNext(a,b,c){if(null==a&&null==b&&(a=b=c=0,canCellBeActive(a,b)))return{row:a,cell:b,posX:b};var d=gotoRight(a,b,c);if(d)return d;for(var e=null,f=getDataLengthIncludingAddNew();++a<f;)if(e=findFirstFocusableCell(a),null!==e)return{row:a,cell:e,posX:e};return null}function gotoPrev(a,b,c){if(null==a&&null==b&&(a=getDataLengthIncludingAddNew()-1,b=c=columns.length-1,canCellBeActive(a,b)))return{row:a,cell:b,posX:b};for(var d,e;!d&&!(d=gotoLeft(a,b,c));){if(--a<0)return null;b=0,e=findLastFocusableCell(a),null!==e&&(d={row:a,cell:e,posX:e})}return d}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigate(a){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=a&&"next"!=a)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus(),tabbingDirection=tabbingDirections[a];var b={up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext},c=b[a],d=c(activeRow,activeCell,activePosX);if(d){var e=d.row==getDataLength();return scrollCellIntoView(d.row,d.cell,!e),setActiveCellInternal(getCellNode(d.row,d.cell),e||options.autoEdit),activePosX=d.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell),activeRow==getDataLength()||options.autoEdit),!1}function getCellNode(a,b){return rowsCache[a]?(ensureCellNodesInRowsCache(a),rowsCache[a].cellNodesByColumnIdx[b]):null}function setActiveCell(a,b){initialized&&(a>getDataLength()||0>a||b>=columns.length||0>b||options.enableCellNavigation&&(scrollCellIntoView(a,b,!1),setActiveCellInternal(getCellNode(a,b),!1)))}function canCellBeActive(a,b){if(!options.enableCellNavigation||a>=getDataLengthIncludingAddNew()||0>a||b>=columns.length||0>b)return!1;var c=data.getItemMetadata&&data.getItemMetadata(a);if(c&&"boolean"==typeof c.focusable)return c.focusable;var d=c&&c.columns;return d&&d[columns[b].id]&&"boolean"==typeof d[columns[b].id].focusable?d[columns[b].id].focusable:d&&d[b]&&"boolean"==typeof d[b].focusable?d[b].focusable:columns[b].focusable}function canCellBeSelected(a,b){if(a>=getDataLength()||0>a||b>=columns.length||0>b)return!1;var c=data.getItemMetadata&&data.getItemMetadata(a);if(c&&"boolean"==typeof c.selectable)return c.selectable;var d=c&&c.columns&&(c.columns[columns[b].id]||c.columns[b]);return d&&"boolean"==typeof d.selectable?d.selectable:columns[b].selectable}function gotoCell(a,b,c,d){if(initialized&&canCellBeActive(a,b)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(a,b,!1);var e=getCellNode(a,b);setActiveCellInternal(e,c||a===getDataLength()||options.autoEdit),currentEditor||d||setFocus()}}function commitCurrentEdit(){var a=getDataItem(activeRow),b=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var c=currentEditor.validate();if(c.valid){if(activeRow<getDataLength()){var d={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(a,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:a,grid:self})},undo:function(){this.editor.applyValue(a,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:a,grid:self})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(a,b,d)):(d.execute(),makeActiveCellNormal())}else{var e=currentEditor.applyValue({},currentEditor.serializeValue());makeActiveCellNormal(),trigger(self.onAddNewRow,{item:e,column:b,grid:self})}return!getEditorLock().isActive()}return $(activeCellNode).removeClass("invalid"),$(activeCellNode).width(),$(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:c,row:activeRow,cell:activeCell,column:b,grid:self}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(a){for(var b=[],c=columns.length-1,d=0;d<a.length;d++)b.push(new Slick.Range(a[d],0,a[d],c));return b}function getSelectedRows(){if(!selectionModel)throw"Selection model is not set";return selectedRows}function setSelectedRows(a){if(!selectionModel)throw"Selection model is not set";selectionModel.setSelectedRanges(rowsToRanges(a))}var defaults={explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,fullWidthRows:!1,multiColumnSort:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row"},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacer,$footerRow,$footerRowScroller,$footerRowSpacer,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,jQueryNewWidthBehaviour=!1,absoluteColumnMinWidth,numberOfRows=0,tabbingDirection=1,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],h_editorLoader=null,h_render=null,h_postrender=null,h_postrenderCleanup=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,postProcessedCleanupQueue=[],postProcessgroupId=0,counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent,zombieRowCacheFromLastMouseWheelEvent,zombieRowPostProcessedFromLastMouseWheelEvent,cssShow={position:"absolute",visibility:"hidden",display:"block"},$hiddenParents,oldProps=[],tabbingDirections={up:-1,down:1,left:-1,right:1,prev:-1,next:1};this.debug=function(){var a="";a+="\ncounter_rows_rendered:  "+counter_rows_rendered,a+="\ncounter_rows_removed:  "+counter_rows_removed,a+="\nrenderedRows:  "+renderedRows,a+="\nnumVisibleRows:  "+numVisibleRows,a+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,a+="\nn(umber of pages):  "+n,a+="\n(current) page:  "+page,a+="\npage height (ph):  "+ph,a+="\nvScrollDir:  "+vScrollDir,alert(a)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:"2.2.4",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onFooterRowCellRendered:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onBeforeFooterRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,onRenderCompleted:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,getCanvasNode:getCanvasNode,focus:setFocus,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,navigatePageUp:navigatePageUp,navigatePageDown:navigatePageDown,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,setFooterRowVisibility:setFooterRowVisibility,getFooterRow:getFooterRow,getFooterRowColumn:getFooterRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}$.extend(!0,window,{Slick:{Grid:SlickGrid}});var scrollbarDimensions,maxSupportedCssHeight}(jQuery),define("slickgrid",["slickgrid_core","components/slickgrid/slick.groupitemmetadataprovider","components/slickgrid/slick.groupitemmetadataprovider","components/slickgrid/slick.dataview","components/slickgrid/lib/jquery.event.drop-2.2","components/slickgrid/lib/jquery.event.drag-2.2","components/slickgrid/plugins/slick.cellrangedecorator","components/slickgrid/plugins/slick.cellrangeselector","components/slickgrid/plugins/slick.cellselectionmodel","components/slickgrid/plugins/slick.rowselectionmodel","components/slickgrid/plugins/slick.rowmovemanager","components/slickgrid/slick.editors","modules/types/edition/slick_grid/slick.editors.custom","modules/types/edition/slick_grid/slick.formatters.custom","components/slickgrid/plugins/slick.checkboxselectcolumn","components/slickgrid/controls/slick.columnpicker","components/slickgrid/examples/slick.compositeeditor"],function(a){return function(){var b;return b||a.Slick}}(this)),define("forms/title",["src/util/util"],function(a){function b(a){return a?a.getUrl():void 0}var c=function(a,b){this.labels={},this.icon,a&&this.setLabel(a),b&&this.setIcon(b)};return c.prototype={setIcon:function(a){var b=this;require(["form/icon"],function(c){a instanceof c||(a=new c(a)),b.icon})},setLabel:function(b,c){c||(c=a.getCurrentLang()),this.labels[c]=b},getIconTag:function(){return this.icon?['<img src="',b(this.icon),'" alt="',this.getLabel(),'" />'].join(""):void 0},getLabel:function(b){return b||(b=a.getCurrentLang()),this.labels[b]||""},duplicate:function(){var a=new a;for(var b in this.labels)a.setLabel(this.labels[b],b);return a.setIcon(this.icon),a},getIconUrl:b},c}),define("forms/button",["require","jquery","forms/title"],function(a,b,c){var d=0,e={};b(document).on("click",".form-button",function(a){var c=e[b(this).data("id")];c&&!c.isDisabled()&&c.doClick(a,b(this))});var f=function(a,b,f){this.title=new c(a),this.onclick=b,this.id=++d,this.options=f||{},this.options.value?this.value=this.options.value:this.value=!1,this.color=this.options.color,e[this.id]=this};return f.prototype={getTitle:function(){return this.title},setTitle:function(a){return a instanceof c||(a=new c(a)),this.title=a,this.applyStyle(),this},getId:function(){return this.id},setOnClick:function(a){this.onclick=a},setColor:function(a){this.oldColor=this.color,this.color=a,this.applyStyle()},setColorCss:function(a){return this.dom.css("color",a),this},setValue:function(a){return this.value=a,this},setIcon:function(a){return this.icon=a,this},setTooltip:function(a){return this.tooltip=a,this.applyStyle(),this},getTooltip:function(){return this.tooltip},render:function(){var a="";return a+='<div class="form-button',a+='" data-id="',a+=this.id,a+='" id="button-'+this.id+'"><span /><span />',a+="</div>",this.dom=b(a),this.applyStyle(),this.dom},applyStyle:function(){this.dom&&(this.tooltip?this.dom.attr("title",this.tooltip):this.dom.attr("title"),this.color&&(this.dom.removeClass(this.oldColor),this.dom.addClass(this.color)),this.options.disabled?this.dom.addClass("disabled"):this.dom.removeClass("disabled"),this.options.checkbox&&(this.value?this.dom.addClass("bi-active"):this.dom.removeClass("bi-active")),this.dom.children().eq(1).html(this.title.getLabel()),this.icon&&this.dom.children().eq(0).html('<img src="'+a.toUrl("./images/"+this.icon+".png")+'" />'))},doClick:function(a,b){this.value=!this.value,this.applyStyle(),this.onclick&&this.onclick(a,this.value,b)},getDom:function(){return this.dom?this.dom:void console.warn("The button dom has not been created yet")},disable:function(){this.options.disabled=!0,this.applyStyle()},enable:function(){this.options.disabled=!1,this.applyStyle()},isDisabled:function(){return this.options.disabled}},f}),function(a){function b(a){var b=a.split("/");return"_design"==b[0]?(b.shift(),"_design/"+encodeURIComponent(b.join("/"))):encodeURIComponent(a);
}function c(b,c,d,e){var f,h={contentType:"application/json",headers:{Accept:"application/json"}};return c=a.extend({successStatus:200},c),e=a.extend(h,e),d=d||"Unknown error",f=(new Date).getTime(),a.ajax(a.extend(a.extend({type:"GET",dataType:"json",cache:g(),beforeSend:function(a){if(e&&e.headers)for(var b in e.headers)a.setRequestHeader(b,e.headers[b])},complete:function(b){var e=(new Date).getTime()-f;try{var g=a.parseJSON(b.responseText)}catch(a){if(!c.error)throw d+": "+a;return void c.error(b.status,b,a)}if(c.ajaxStart&&c.ajaxStart(g),b.status==c.successStatus)c.beforeSuccess&&c.beforeSuccess(b,g,e),c.success&&c.success(g,e);else{if(!c.error)throw d+": "+g.reason;c.error(b.status,g&&g.error||d,g&&g.reason||"no response",e)}},crossDomain:!0,xhrFields:{withCredentials:!0}},b),e))}function d(a){var a=a||{};if("undefined"!=typeof a.ensure_full_commit){var b=a.ensure_full_commit;return delete a.ensure_full_commit,function(a){a.setRequestHeader("Accept","application/json"),a.setRequestHeader("X-Couch-Full-Commit",b.toString())}}}function e(b){var c=[];if("object"==typeof b&&null!==b)for(var d in b)if(!(a.inArray(d,["error","success","beforeSuccess","ajaxStart"])>=0)){var e=b[d];a.inArray(d,["key","startkey","endkey"])>=0&&(e=f(e)),c.push(encodeURIComponent(d)+"="+encodeURIComponent(e))}return c.length?"?"+c.join("&"):""}function f(a){return null!==a?JSON.stringify(a):null}function g(){return navigator?!/(MSIE|Trident)/.test(navigator.userAgent):!0}a.couch=a.couch||{};var h=[];a.extend(a.couch,{urlPrefix:"",activeTasks:function(a){return c({url:this.urlPrefix+"/_active_tasks"},a,"Active task status could not be retrieved")},allDbs:function(a){return c({url:this.urlPrefix+"/_all_dbs"},a,"An error occurred retrieving the list of all databases")},config:function(a,b,d,e){var g={url:this.urlPrefix+"/_config/"};return b&&(g.url+=encodeURIComponent(b)+"/",d&&(g.url+=encodeURIComponent(d))),null===e?g.type="DELETE":void 0!==e&&(g.type="PUT",g.data=f(e),g.contentType="application/json",g.processData=!1),c(g,a,"An error occurred retrieving/updating the server configuration")},session:function(b){return b=b||{},c({type:"GET",url:this.urlPrefix+"/_session",beforeSend:function(a){a.setRequestHeader("Accept","application/json")},complete:function(c){var d=a.parseJSON(c.responseText);if(200==c.status)b.success&&b.success(d);else{if(!b.error)throw"An error occurred getting session info: "+d.reason;b.error(c.status,d.error,d.reason)}}})},userDb:function(b){return a.couch.session({success:function(c){var d=a.couch.db(c.info.authentication_db);b(d)}})},signup:function(b,c,d){d=d||{},b.password=c,b.roles=b.roles||[],b.type="user";var e="org.couchdb.user:";return b._id=b._id||e+b.name,a.couch.userDb(function(a){a.saveDoc(b,d)})},login:function(b){return b=b||{},a.ajax({type:"POST",url:this.urlPrefix+"/_session",dataType:"json",data:{name:b.name,password:b.password},beforeSend:function(a){a.setRequestHeader("Accept","application/json")},complete:function(c){var d=a.parseJSON(c.responseText);if(200==c.status)b.success&&b.success(d);else{if(!b.error)throw"An error occurred logging in: "+d.reason;b.error(c.status,d.error,d.reason)}b.complete&&b.complete()},crossDomain:!0,xhrFields:{withCredentials:!0}})},logout:function(b){return b=b||{},a.ajax({type:"DELETE",url:this.urlPrefix+"/_session",dataType:"json",username:"_",password:"_",beforeSend:function(a){a.setRequestHeader("Accept","application/json")},complete:function(c){var d=a.parseJSON(c.responseText);if(200==c.status)b.success&&b.success(d);else{if(!b.error)throw"An error occurred logging out: "+d.reason;b.error(c.status,d.error,d.reason)}b.complete&&b.complete()},crossDomain:!0,xhrFields:{withCredentials:!0}})},db:function(g,h){function i(a){if(a._id&&a._rev&&j[a._id]&&j[a._id].rev==a._rev){if("undefined"==typeof Base64)throw"Base64 support not found.";return a._attachments=a._attachments||{},a._attachments["rev-"+a._rev.split("-")[0]]={content_type:"application/json",data:Base64.encode(j[a._id].raw)},!0}}h=h||{};var j={};return{name:g,uri:this.urlPrefix+"/"+encodeURIComponent(g)+"/",compact:function(b){return a.extend(b,{successStatus:202}),c({type:"POST",url:this.uri+"_compact",data:"",processData:!1},b,"The database could not be compacted")},viewCleanup:function(b){return a.extend(b,{successStatus:202}),c({type:"POST",url:this.uri+"_view_cleanup",data:"",processData:!1},b,"The views could not be cleaned up")},compactView:function(b,d){return a.extend(d,{successStatus:202}),c({type:"POST",url:this.uri+"_compact/"+b,data:"",processData:!1},d,"The view could not be compacted")},create:function(b){return a.extend(b,{successStatus:201}),c({type:"PUT",url:this.uri,contentType:"application/json",data:"",processData:!1},b,"The database could not be created")},drop:function(a){return c({type:"DELETE",url:this.uri},a,"The database could not be deleted")},info:function(a){return c({url:this.uri},a,"Database information could not be retrieved")},changes:function(b,d){function f(b){a.each(k,function(){this(b)})}function g(){var f=a.extend({heartbeat:1e4},d,{feed:"longpoll",since:b});l=c({url:i.uri+"_changes"+e(f)},d,"Error connecting to "+i.uri+"/_changes.")}d=d||{};var h=100,i=this,j=!0,k=[],l=null,m={onChange:function(a){k.push(a)},stop:function(){j=!1,l&&l.abort()}};return d.success=function(a){h=100,j&&(b=a.last_seq,f(a),g())},d.error=function(){j&&(setTimeout(g,h),h=2*h)},b?g():i.info({success:function(a){b=a.update_seq,g()}}),m},allDocs:function(a){var b="GET",d=null;if(a.keys){b="POST";var g=a.keys;delete a.keys,d=f({keys:g})}return c({type:b,data:d,url:this.uri+"_all_docs"+e(a)},a,"An error occurred retrieving a list of all documents")},allDesignDocs:function(b){return this.allDocs(a.extend({startkey:"_design",endkey:"_design0"},b))},allApps:function(b){b=b||{};var c=this;if(b.eachApp)return this.allDesignDocs({success:function(d){a.each(d.rows,function(){c.openDoc(this.id,{success:function(a){var c,d,e=a._id.split("/");e.shift(),e=e.join("/"),c=a.couchapp&&a.couchapp.index,c?d=["",g,a._id,c].join("/"):a._attachments&&a._attachments["index.html"]&&(d=["",g,a._id,"index.html"].join("/")),d&&b.eachApp(e,d,a)}})})}});throw"Please provide an eachApp function for allApps()"},openDoc:function(d,f,g){return f=f||{},h.attachPrevRev||f.attachPrevRev?a.extend(f,{beforeSuccess:function(a,b){j[b._id]={rev:b._rev,raw:a.responseText}}}):a.extend(f,{beforeSuccess:function(a,b){b["jquery.couch.attachPrevRev"]&&(j[b._id]={rev:b._rev,raw:a.responseText})}}),c({url:this.uri+b(d)+e(f)},f,"The document could not be retrieved",g)},saveDoc:function(c,g){g=g||{};var h=this,j=d(g);if(void 0===c._id)var k="POST",l=this.uri;else var k="PUT",l=this.uri+b(c._id);var m=i(c);return a.ajax({type:k,url:l+e(g),contentType:"application/json",dataType:"json",data:f(c),beforeSend:j,complete:function(b){var d=a.parseJSON(b.responseText);if(200==b.status||201==b.status||202==b.status)c._id=d.id,c._rev=d.rev,m?h.openDoc(c._id,{attachPrevRev:!0,success:function(a){c._attachments=a._attachments,g.success&&g.success(d)}}):g.success&&g.success(d);else{if(!g.error)throw"The document could not be saved: "+d.reason;g.error(b.status,d.error,d.reason)}},crossDomain:!0,xhrFields:{withCredentials:!0}})},bulkSave:function(b,g){var h=d(g);return a.extend(g,{successStatus:201,beforeSend:h}),c({type:"POST",url:this.uri+"_bulk_docs"+e(g),contentType:"application/json",data:f(b)},g,"The documents could not be saved")},removeDoc:function(a,d){return c({type:"DELETE",url:this.uri+b(a._id)+e({rev:a._rev})},d,"The document could not be deleted")},bulkRemove:function(b,d){return b.docs=a.each(b.docs,function(a,b){b._deleted=!0}),a.extend(d,{successStatus:201}),c({type:"POST",url:this.uri+"_bulk_docs"+e(d),data:f(b)},d,"The documents could not be deleted")},copyDoc:function(d,e,f){return f=a.extend(f,{beforeSend:function(a){if(!e||!e.docid)throw"Target docid required";var b=e.docid;e.rev&&(b+="?rev="+e.rev),a.setRequestHeader("Destination",b)},complete:function(b){var c=a.parseJSON(b.responseText);if(201==b.status)e.success&&e.success(c);else{if(!e.error)throw"The document could not be copied: "+c.reason;e.error(b.status,c.error,c.reason)}}}),c({type:"COPY",url:this.uri+b(d)},e,"The document could not be copied",f)},query:function(a,b,d,g){d=d||"javascript","string"!=typeof a&&(a=a.toSource?a.toSource():"("+a.toString()+")");var h={language:d,map:a};if(null!=b&&("string"!=typeof b&&(b=b.toSource?b.toSource():"("+b.toString()+")"),h.reduce=b),g.keys){var i=g.keys;delete g.keys,h.keys=i}return c({type:"POST",url:this.uri+"_temp_view"+e(g),contentType:"application/json",data:f(h)},g,"An error occurred querying the database")},list:function(a,b,d,g){var a=a.split("/"),d=d||{},h="GET",i=null;if(d.keys){h="POST";var j=d.keys;delete d.keys,i=f({keys:j})}return c({type:h,data:i,url:this.uri+"_design/"+a[0]+"/_list/"+a[1]+"/"+b+e(d)},g,"An error occurred accessing the list")},view:function(a,b){var a=a.split("/"),b=b||{},d="GET",g=null;if(b.keys){d="POST";var h=b.keys;delete b.keys,g=f({keys:h})}return c({type:d,data:g,url:this.uri+"_design/"+a[0]+"/_view/"+a[1]+e(b)},b,"An error occurred accessing the view")},getDbProperty:function(a,b,d){return c({url:this.uri+a+e(b)},b,"The property could not be retrieved",d)},setDbProperty:function(a,b,d,f){return c({type:"PUT",url:this.uri+a+e(d),data:JSON.stringify(b)},d,"The property could not be updated",f)}}},encodeDocId:b,info:function(a){return c({url:this.urlPrefix+"/"},a,"Server information could not be retrieved")},replicate:function(b,d,e,f){return f=a.extend({source:b,target:d},f),f.continuous&&!f.cancel&&(e.successStatus=202),c({type:"POST",url:this.urlPrefix+"/_replicate",data:JSON.stringify(f),contentType:"application/json"},e,"Replication failed")},newUUID:function(a){return void 0===a&&(a=1),h.length||c({url:this.urlPrefix+"/_uuids",data:{count:a},async:!1},{success:function(a){h=a.uuids}},"Failed to retrieve UUID batch."),h.shift()}})}(jQuery),define("lib/couchdb/jquery.couch",["jquery"],function(){}),define("src/util/couchshare",["src/util/versioning","lib/couchdb/jquery.couch"],function(a){function b(b){return new Promise(function(d,e){var f=(b.couchUrl||window.location.origin).replace(/\/$/,""),g=b.database||"x",h=(b.tinyUrl||window.location.origin+"/x/_design/x/_show/x").replace(/\/$/,"")+"/";$.couch.urlPrefix=f;var i=$.couch.db(g),j=a.getView(),k=btoa(unescape(encodeURIComponent(JSON.stringify(j)))),l=btoa(unescape(encodeURIComponent(a.getDataJSON()))),m=c(),n={_id:m,_attachments:{"view.json":{content_type:"application/json",data:k},"data.json":{content_type:"application/json",data:l}},version:j.version,visualizer:window.location.origin+window.location.pathname,couchdb:f+"/"+g+"/"};i.saveDoc(n,{success:function(){var a=h+m;return d(a)},error:function(a){return e(a)}})})}function c(){for(var a="",b=0;20>b;b++)a+=d[Math.floor(62*Math.random())];return a}var d="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return{share:b}}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/button",["jquery","./core","./widget"],a):a(jQuery)}(function(a){var b,c="ui-button ui-widget ui-state-default ui-corner-all",d="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",e=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},f=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"'][type=radio]"):a("[name='"+c+"'][type=radio]",b.ownerDocument).filter(function(){return!this.form})),e};return a.widget("ui.button",{version:"1.11.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,e),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var d=this,g=this.options,h="checkbox"===this.type||"radio"===this.type,i=h?"":"ui-state-active";null===g.label&&(g.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(c).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){g.disabled||this===b&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){g.disabled||a(this).removeClass(i)}).bind("click"+this.eventNamespace,function(a){g.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),h&&this.element.bind("change"+this.eventNamespace,function(){d.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return g.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(g.disabled)return!1;a(this).addClass("ui-state-active"),d.buttonElement.attr("aria-pressed","true");var b=d.element[0];f(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return g.disabled?!1:(a(this).addClass("ui-state-active"),b=this,void d.document.one("mouseup",function(){b=null}))}).bind("mouseup"+this.eventNamespace,function(){return g.disabled?!1:void a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){return g.disabled?!1:void(b.keyCode!==a.ui.keyCode.SPACE&&b.keyCode!==a.ui.keyCode.ENTER||a(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",g.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(c+" ui-state-active "+d).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(this.widget().toggleClass("ui-state-disabled",!!b),this.element.prop("disabled",!!b),void(b&&("checkbox"===this.type||"radio"===this.type?this.buttonElement.removeClass("ui-state-focus"):this.buttonElement.removeClass("ui-state-focus ui-state-active")))):void this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?f(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var b=this.buttonElement.removeClass(d),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),e=this.options.icons,f=e.primary&&e.secondary,g=[];e.primary||e.secondary?(this.options.text&&g.push("ui-button-text-icon"+(f?"s":e.primary?"-primary":"-secondary")),e.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+e.primary+"'></span>"),e.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+e.secondary+"'></span>"),this.options.text||(g.push(f?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):g.push("ui-button-text-only"),b.addClass(g.join(" "))}}),a.widget("ui.buttonset",{version:"1.11.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction"),c=this.element.find(this.options.items),d=c.filter(":ui-button");c.not(":ui-button").button(),d.button("refresh"),this.buttons=c.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}}),a.ui.button}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/draggable",["jquery","./core","./mouse","./widget"],a):a(jQuery)}(function(a){return a.widget("ui.draggable",a.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(a,b){this._super(a,b),"handle"===a&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(b){var c=this.options;return this._blurActiveElement(b),this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(this._blockFrames(c.iframeFix===!0?"iframe":c.iframeFix),!0):!1)},_blockFrames:function(b){this.iframeBlocks=this.document.find(b).map(function(){var b=a(this);return a("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(b){var c=this.document[0];if(this.handleElement.is(b.target))try{c.activeElement&&"body"!==c.activeElement.nodeName.toLowerCase()&&a(c.activeElement).blur()}catch(a){}},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===a(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(b),this.originalPosition=this.position=this._generatePosition(b,!1),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._normalizeRightBottom(),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_refreshOffsets:function(a){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:a.pageX-this.offset.left,top:a.pageY-this.offset.top}},_mouseDrag:function(b,c){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b,!0),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1},_mouseUp:function(b){return this._unblockFrames(),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),this.handleElement.is(b.target)&&this.element.focus(),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper),e=d?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return e.parents("body").length||e.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d&&e[0]===this.element[0]&&this._setPositionRelative(),e[0]===this.element[0]||/(fixed|absolute)/.test(e.css("position"))||e.css("position","absolute"),e},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_isRootNode:function(a){return/(html|body)/i.test(a.tagName)||a===this.document[0]},_getParentOffset:function(){var b=this.offsetParent.offset(),c=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==c&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var a=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:a.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options,f=this.document[0];return this.relativeContainer=null,e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(f).width()-this.helperProportions.width-this.margins.left,(a(f).height()||f.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(a,b){b||(b=this.position);var c="absolute"===a?1:-1,d=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*c+this.offset.parent.top*c-("fixed"===this.cssPosition?-this.offset.scroll.top:d?0:this.offset.scroll.top)*c,left:b.left+this.offset.relative.left*c+this.offset.parent.left*c-("fixed"===this.cssPosition?-this.offset.scroll.left:d?0:this.offset.scroll.left)*c}},_generatePosition:function(a,b){var c,d,e,f,g=this.options,h=this._isRootNode(this.scrollParent[0]),i=a.pageX,j=a.pageY;return h&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(d=this.relativeContainer.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,a.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),a.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),a.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),a.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f),"y"===g.axis&&(i=this.originalPageX),"x"===g.axis&&(j=this.originalPageY)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:h?0:this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:h?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d,this],!0),/^(drag|start|stop)/.test(b)&&(this.positionAbs=this._convertPositionTo("absolute"),d.offset=this.positionAbs),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c,d){var e=a.extend({},c,{item:d.element});d.sortables=[],a(d.options.connectToSortable).each(function(){var c=a(this).sortable("instance");c&&!c.options.disabled&&(d.sortables.push(c),c.refreshPositions(),c._trigger("activate",b,e))})},stop:function(b,c,d){var e=a.extend({},c,{item:d.element});d.cancelHelperRemoval=!1,a.each(d.sortables,function(){var a=this;a.isOver?(a.isOver=0,d.cancelHelperRemoval=!0,a.cancelHelperRemoval=!1,a._storedCSS={position:a.placeholder.css("position"),top:a.placeholder.css("top"),left:a.placeholder.css("left")},a._mouseStop(b),a.options.helper=a.options._helper):(a.cancelHelperRemoval=!0,a._trigger("deactivate",b,e))})},drag:function(b,c,d){a.each(d.sortables,function(){var e=!1,f=this;f.positionAbs=d.positionAbs,f.helperProportions=d.helperProportions,f.offset.click=d.offset.click,f._intersectsWith(f.containerCache)&&(e=!0,a.each(d.sortables,function(){return this.positionAbs=d.positionAbs,this.helperProportions=d.helperProportions,this.offset.click=d.offset.click,this!==f&&this._intersectsWith(this.containerCache)&&a.contains(f.element[0],this.element[0])&&(e=!1),e})),e?(f.isOver||(f.isOver=1,d._parent=c.helper.parent(),f.currentItem=c.helper.appendTo(f.element).data("ui-sortable-item",!0),f.options._helper=f.options.helper,f.options.helper=function(){return c.helper[0]},b.target=f.currentItem[0],f._mouseCapture(b,!0),f._mouseStart(b,!0,!0),f.offset.click.top=d.offset.click.top,f.offset.click.left=d.offset.click.left,f.offset.parent.left-=d.offset.parent.left-f.offset.parent.left,f.offset.parent.top-=d.offset.parent.top-f.offset.parent.top,d._trigger("toSortable",b),d.dropped=f.element,a.each(d.sortables,function(){this.refreshPositions()}),d.currentItem=d.element,f.fromOutside=d),f.currentItem&&(f._mouseDrag(b),c.position=f.position)):f.isOver&&(f.isOver=0,f.cancelHelperRemoval=!0,f.options._revert=f.options.revert,f.options.revert=!1,f._trigger("out",b,f._uiHash(f)),f._mouseStop(b,!0),f.options.revert=f.options._revert,f.options.helper=f.options._helper,f.placeholder&&f.placeholder.remove(),c.helper.appendTo(d._parent),d._refreshOffsets(b),
c.position=d._generatePosition(b,!0),d._trigger("fromSortable",b),d.dropped=!1,a.each(d.sortables,function(){this.refreshPositions()}))})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c,d){var e=a("body"),f=d.options;e.css("cursor")&&(f._cursor=e.css("cursor")),e.css("cursor",f.cursor)},stop:function(b,c,d){var e=d.options;e._cursor&&a("body").css("cursor",e._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("opacity")&&(f._opacity=e.css("opacity")),e.css("opacity",f.opacity)},stop:function(b,c,d){var e=d.options;e._opacity&&a(c.helper).css("opacity",e._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(a,b,c){c.scrollParentNotHidden||(c.scrollParentNotHidden=c.helper.scrollParent(!1)),c.scrollParentNotHidden[0]!==c.document[0]&&"HTML"!==c.scrollParentNotHidden[0].tagName&&(c.overflowOffset=c.scrollParentNotHidden.offset())},drag:function(b,c,d){var e=d.options,f=!1,g=d.scrollParentNotHidden[0],h=d.document[0];g!==h&&"HTML"!==g.tagName?(e.axis&&"x"===e.axis||(d.overflowOffset.top+g.offsetHeight-b.pageY<e.scrollSensitivity?g.scrollTop=f=g.scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(g.scrollTop=f=g.scrollTop-e.scrollSpeed)),e.axis&&"y"===e.axis||(d.overflowOffset.left+g.offsetWidth-b.pageX<e.scrollSensitivity?g.scrollLeft=f=g.scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(g.scrollLeft=f=g.scrollLeft-e.scrollSpeed))):(e.axis&&"x"===e.axis||(b.pageY-a(h).scrollTop()<e.scrollSensitivity?f=a(h).scrollTop(a(h).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(h).scrollTop())<e.scrollSensitivity&&(f=a(h).scrollTop(a(h).scrollTop()+e.scrollSpeed))),e.axis&&"y"===e.axis||(b.pageX-a(h).scrollLeft()<e.scrollSensitivity?f=a(h).scrollLeft(a(h).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(h).scrollLeft())<e.scrollSensitivity&&(f=a(h).scrollLeft(a(h).scrollLeft()+e.scrollSpeed)))),f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c,d){var e=d.options;d.snapElements=[],a(e.snap.constructor!==String?e.snap.items||":data(ui-draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!==d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o=d.options,p=o.snapTolerance,q=c.offset.left,r=q+d.helperProportions.width,s=c.offset.top,t=s+d.helperProportions.height;for(m=d.snapElements.length-1;m>=0;m--)i=d.snapElements[m].left-d.margins.left,j=i+d.snapElements[m].width,k=d.snapElements[m].top-d.margins.top,l=k+d.snapElements[m].height,i-p>r||q>j+p||k-p>t||s>l+p||!a.contains(d.snapElements[m].item.ownerDocument,d.snapElements[m].item)?(d.snapElements[m].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=!1):("inner"!==o.snapMode&&(e=Math.abs(k-t)<=p,f=Math.abs(l-s)<=p,g=Math.abs(i-r)<=p,h=Math.abs(j-q)<=p,e&&(c.position.top=d._convertPositionTo("relative",{top:k-d.helperProportions.height,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i-d.helperProportions.width}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j}).left)),n=e||f||g||h,"outer"!==o.snapMode&&(e=Math.abs(k-s)<=p,f=Math.abs(l-t)<=p,g=Math.abs(i-q)<=p,h=Math.abs(j-r)<=p,e&&(c.position.top=d._convertPositionTo("relative",{top:k,left:0}).top),f&&(c.position.top=d._convertPositionTo("relative",{top:l-d.helperProportions.height,left:0}).top),g&&(c.position.left=d._convertPositionTo("relative",{top:0,left:i}).left),h&&(c.position.left=d._convertPositionTo("relative",{top:0,left:j-d.helperProportions.width}).left)),!d.snapElements[m].snapping&&(e||f||g||h||n)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[m].item})),d.snapElements[m].snapping=e||f||g||h||n)}}),a.ui.plugin.add("draggable","stack",{start:function(b,c,d){var e,f=d.options,g=a.makeArray(a(f.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});g.length&&(e=parseInt(a(g[0]).css("zIndex"),10)||0,a(g).each(function(b){a(this).css("zIndex",e+b)}),this.css("zIndex",e+g.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c,d){var e=a(c.helper),f=d.options;e.css("zIndex")&&(f._zIndex=e.css("zIndex")),e.css("zIndex",f.zIndex)},stop:function(b,c,d){var e=d.options;e._zIndex&&a(c.helper).css("zIndex",e._zIndex)}}),a.ui.draggable}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/position",["jquery"],a):a(jQuery)}(function(a){return function(){function b(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function c(b,c){return parseInt(a.css(b,c),10)||0}function d(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var e,f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(void 0!==e)return e;var b,c,d=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),f=d.children()[0];return a("body").append(d),b=f.offsetWidth,d.css("overflow","scroll"),c=f.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),e=b-c},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d||e?c.width():c.outerWidth(),height:d||e?c.height():c.outerHeight()}}},a.fn.position=function(e){if(!e||!e.of)return o.apply(this,arguments);e=a.extend({},e);var n,p,q,r,s,t,u=a(e.of),v=a.position.getWithinInfo(e.within),w=a.position.getScrollInfo(v),x=(e.collision||"flip").split(" "),y={};return t=d(u),u[0].preventDefault&&(e.at="left top"),p=t.width,q=t.height,r=t.offset,s=a.extend({},r),a.each(["my","at"],function(){var a,b,c=(e[this]||"").split(" ");1===c.length&&(c=j.test(c[0])?c.concat(["center"]):k.test(c[0])?["center"].concat(c):["center","center"]),c[0]=j.test(c[0])?c[0]:"center",c[1]=k.test(c[1])?c[1]:"center",a=l.exec(c[0]),b=l.exec(c[1]),y[this]=[a?a[0]:0,b?b[0]:0],e[this]=[m.exec(c[0])[0],m.exec(c[1])[0]]}),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?s.left+=p:"center"===e.at[0]&&(s.left+=p/2),"bottom"===e.at[1]?s.top+=q:"center"===e.at[1]&&(s.top+=q/2),n=b(y.at,p,q),s.left+=n[0],s.top+=n[1],this.each(function(){var d,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=c(this,"marginLeft"),t=c(this,"marginTop"),z=l+o+c(this,"marginRight")+w.width,A=m+t+c(this,"marginBottom")+w.height,B=a.extend({},s),C=b(y.my,k.outerWidth(),k.outerHeight());"right"===e.my[0]?B.left-=l:"center"===e.my[0]&&(B.left-=l/2),"bottom"===e.my[1]?B.top-=m:"center"===e.my[1]&&(B.top-=m/2),B.left+=C[0],B.top+=C[1],f||(B.left=i(B.left),B.top=i(B.top)),d={marginLeft:o,marginTop:t},a.each(["left","top"],function(b,c){a.ui.position[x[b]]&&a.ui.position[x[b]][c](B,{targetWidth:p,targetHeight:q,elemWidth:l,elemHeight:m,collisionPosition:d,collisionWidth:z,collisionHeight:A,offset:[n[0]+C[0],n[1]+C[1]],my:e.my,at:e.at,within:v,elem:k})}),e.using&&(j=function(a){var b=r.left-B.left,c=b+p-l,d=r.top-B.top,f=d+q-m,i={target:{element:u,left:r.left,top:r.top,width:p,height:q},element:{element:k,left:B.left,top:B.top,width:l,height:m},horizontal:0>c?"left":b>0?"right":"center",vertical:0>f?"top":d>0?"bottom":"middle"};l>p&&h(b+c)<p&&(i.horizontal="center"),m>q&&h(d+f)<q&&(i.vertical="middle"),g(h(b),h(c))>g(h(d),h(f))?i.important="horizontal":i.important="vertical",e.using.call(this,a,i)}),k.offset(a.extend(B,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):j>0&&0>=i?a.left=e:i>j?a.left=e+f-b.collisionWidth:a.left=e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):j>0&&0>=i?a.top=e:i>j?a.top=e+f-b.collisionHeight:a.top=e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||c<h(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||h(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,(0>d||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,g,h=document.getElementsByTagName("body")[0],i=document.createElement("div");b=document.createElement(h?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},h&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(g in d)b.style[g]=d[g];b.appendChild(i),c=h||document.documentElement,c.insertBefore(b,c.firstChild),i.style.cssText="position: absolute; left: 10.7432222px;",e=a(i).offset().left,f=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(),a.ui.position}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/resizable",["jquery","./core","./mouse","./widget"],a):a(jQuery)}(function(a){return a.widget("ui.resizable",a.ui.mouse,{version:"1.11.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(a){return parseInt(a,10)||0},_isNumber:function(a){return!isNaN(parseInt(a,10))},_hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=a(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;c<b.length;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String?this.handles[c]=this.element.children(this.handles[c]).first().show():(this.handles[c].jquery||this.handles[c].nodeType)&&(this.handles[c]=a(this.handles[c]),this._on(this.handles[c],{mousedown:g._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),this._handles=this._handles.add(this.handles[c])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(b){var c,d,e,f=this.options,g=this.element;return this.resizing=!0,this._renderProxy(),c=this._num(this.helper.css("left")),d=this._num(this.helper.css("top")),f.containment&&(c+=a(f.containment).scrollLeft()||0,d+=a(f.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:c,top:d},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:g.width(),height:g.height()},this.originalSize=this._helper?{width:g.outerWidth(),height:g.outerHeight()}:{width:g.width(),height:g.height()},this.sizeDiff={width:g.outerWidth()-g.width(),height:g.outerHeight()-g.height()},this.originalPosition={left:c,top:d},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio="number"==typeof f.aspectRatio?f.aspectRatio:this.originalSize.width/this.originalSize.height||1,e=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===e?this.axis+"-resize":e),g.addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c,d,e=this.originalMousePosition,f=this.axis,g=b.pageX-e.left||0,h=b.pageY-e.top||0,i=this._change[f];return this._updatePrevProperties(),i?(c=i.apply(this,[b,g,h]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),d=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(d)||(this._updatePrevProperties(),this._trigger("resize",b,this.ui()),this._applyChanges()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&this._hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var a={};return this.position.top!==this.prevPosition.top&&(a.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(a.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(a.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(a.height=this.size.height+"px"),this.helper.css(a),a},_updateVirtualBoundaries:function(a){var b,c,d,e,f,g=this.options;f={minWidth:this._isNumber(g.minWidth)?g.minWidth:0,maxWidth:this._isNumber(g.maxWidth)?g.maxWidth:1/0,minHeight:this._isNumber(g.minHeight)?g.minHeight:0,maxHeight:this._isNumber(g.maxHeight)?g.maxHeight:1/0},(this._aspectRatio||a)&&(b=f.minHeight*this.aspectRatio,d=f.minWidth/this.aspectRatio,c=f.maxHeight*this.aspectRatio,e=f.maxWidth/this.aspectRatio,b>f.minWidth&&(f.minWidth=b),d>f.minHeight&&(f.minHeight=d),c<f.maxWidth&&(f.maxWidth=c),e<f.maxHeight&&(f.maxHeight=e)),this._vBoundaries=f},_updateCache:function(a){this.offset=this.helper.offset(),this._isNumber(a.left)&&(this.position.left=a.left),this._isNumber(a.top)&&(this.position.top=a.top),this._isNumber(a.height)&&(this.size.height=a.height),this._isNumber(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,c=this.size,d=this.axis;return this._isNumber(a.height)?a.width=a.height*this.aspectRatio:this._isNumber(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===d&&(a.left=b.left+(c.width-a.width),a.top=null),"nw"===d&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,c=this.axis,d=this._isNumber(a.width)&&b.maxWidth&&b.maxWidth<a.width,e=this._isNumber(a.height)&&b.maxHeight&&b.maxHeight<a.height,f=this._isNumber(a.width)&&b.minWidth&&b.minWidth>a.width,g=this._isNumber(a.height)&&b.minHeight&&b.minHeight>a.height,h=this.originalPosition.left+this.originalSize.width,i=this.position.top+this.size.height,j=/sw|nw|w/.test(c),k=/nw|ne|n/.test(c);return f&&(a.width=b.minWidth),g&&(a.height=b.minHeight),d&&(a.width=b.maxWidth),e&&(a.height=b.maxHeight),f&&j&&(a.left=h-b.minWidth),d&&j&&(a.left=h-b.maxWidth),g&&k&&(a.top=i-b.minHeight),e&&k&&(a.top=i-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_getPaddingPlusBorderDimensions:function(a){for(var b=0,c=[],d=[a.css("borderTopWidth"),a.css("borderRightWidth"),a.css("borderBottomWidth"),a.css("borderLeftWidth")],e=[a.css("paddingTop"),a.css("paddingRight"),a.css("paddingBottom"),a.css("paddingLeft")];4>b;b++)c[b]=parseInt(d[b],10)||0,c[b]+=parseInt(e[b],10)||0;return{height:c[0]+c[2],width:c[1]+c[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var a,b=0,c=this.helper||this.element;b<this._proportionallyResizeElements.length;b++)a=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(a)),a.css({height:c.height()-this.outerDimensions.height||0,width:c.width()-this.outerDimensions.width||0})},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).resizable("instance"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&c._hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var b,c,d,e,f,g,h,i=a(this).resizable("instance"),j=i.options,k=i.element,l=j.containment,m=l instanceof a?l.get(0):/parent/.test(l)?k.parent().get(0):l;m&&(i.containerElement=a(m),/document/.test(l)||l===document?(i.containerOffset={left:0,top:0},i.containerPosition={left:0,top:0},i.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(b=a(m),c=[],a(["Top","Right","Left","Bottom"]).each(function(a,d){c[a]=i._num(b.css("padding"+d))}),i.containerOffset=b.offset(),i.containerPosition=b.position(),i.containerSize={height:b.innerHeight()-c[3],width:b.innerWidth()-c[1]},d=i.containerOffset,e=i.containerSize.height,f=i.containerSize.width,g=i._hasScroll(m,"left")?m.scrollWidth:f,h=i._hasScroll(m)?m.scrollHeight:e,i.parentData={element:m,left:d.left,top:d.top,width:g,height:h}))},resize:function(b){var c,d,e,f,g=a(this).resizable("instance"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement,n=!0;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio,n=!1),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio,n=!1),g.position.top=g._helper?i.top:0),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f?(g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top):(g.offset.left=g.element.offset().left,g.offset.top=g.element.offset().top),c=Math.abs(g.sizeDiff.width+(g._helper?g.offset.left-l.left:g.offset.left-i.left)),d=Math.abs(g.sizeDiff.height+(g._helper?g.offset.top-l.top:g.offset.top-i.top)),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio,n=!1)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio,n=!1)),n||(g.position.left=g.prevPosition.left,g.position.top=g.prevPosition.top,g.size.width=g.prevSize.width,g.size.height=g.prevSize.height)},stop:function(){var b=a(this).resizable("instance"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).resizable("instance"),c=b.options;a(c.alsoResize).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})},resize:function(b,c){var d=a(this).resizable("instance"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0};a(e.alsoResize).each(function(){var b=a(this),d=a(this).data("ui-resizable-alsoresize"),e={},f=b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(f,function(a,b){var c=(d[b]||0)+(h[b]||0);c&&c>=0&&(e[b]=c||null)}),b.css(e)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).resizable("instance"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).resizable("instance");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).resizable("instance");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b,c=a(this).resizable("instance"),d=c.options,e=c.size,f=c.originalSize,g=c.originalPosition,h=c.axis,i="number"==typeof d.grid?[d.grid,d.grid]:d.grid,j=i[0]||1,k=i[1]||1,l=Math.round((e.width-f.width)/j)*j,m=Math.round((e.height-f.height)/k)*k,n=f.width+l,o=f.height+m,p=d.maxWidth&&d.maxWidth<n,q=d.maxHeight&&d.maxHeight<o,r=d.minWidth&&d.minWidth>n,s=d.minHeight&&d.minHeight>o;d.grid=i,r&&(n+=j),s&&(o+=k),p&&(n-=j),q&&(o-=k),/^(se|s|e)$/.test(h)?(c.size.width=n,c.size.height=o):/^(ne)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.top=g.top-m):/^(sw)$/.test(h)?(c.size.width=n,c.size.height=o,c.position.left=g.left-l):((0>=o-k||0>=n-j)&&(b=c._getPaddingPlusBorderDimensions(this)),o-k>0?(c.size.height=o,c.position.top=g.top-m):(o=k-b.height,c.size.height=o,c.position.top=g.top+f.height-o),n-j>0?(c.size.width=n,c.position.left=g.left-l):(n=j-b.width,c.size.width=n,c.position.left=g.left+f.width-n))}}),a.ui.resizable}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/dialog",["jquery","./core","./widget","./button","./draggable","./mouse","./position","./resizable"],a):a(jQuery)}(function(a){return a.widget("ui.dialog",{version:"1.11.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"Close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c,d=this;if(this._isOpen&&this._trigger("beforeClose",b)!==!1){if(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),!this.opener.filter(":focusable").focus().length)try{c=this.document[0].activeElement,c&&"body"!==c.nodeName.toLowerCase()&&a(c).blur()}catch(a){}this._hide(this.uiDialog,this.options.hide,function(){
d._trigger("close",b)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(b,c){var d=!1,e=this.uiDialog.siblings(".ui-front:visible").map(function(){return+a(this).css("z-index")}).get(),f=Math.max.apply(null,e);return f>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",f+1),d=!0),d&&!c&&this._trigger("focus",b),d},open:function(){var b=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),this._makeFocusTarget(),void this._trigger("open"))},_focusTabbable:function(){var a=this._focusedElement;a||(a=this.element.find("[autofocus]")),a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement,c=this.uiDialog[0]===b||a.contains(this.uiDialog[0],b);c||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),void this.close(b);if(b.keyCode===a.ui.keyCode.TAB&&!b.isDefaultPrevented()){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(this._delay(function(){e.focus()}),b.preventDefault()):(this._delay(function(){d.focus()}),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){var g=f.offset.left-c.document.scrollLeft(),h=f.offset.top-c.document.scrollTop();d.position={my:"left top",at:"left"+(g>=0?"+":"")+g+" top"+(h>=0?"+":"")+h,of:c.window},a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){var g=c.uiDialog.offset(),h=g.left-c.document.scrollLeft(),i=g.top-c.document.scrollTop();d.height=c.uiDialog.height(),d.width=c.uiDialog.width(),d.position={my:"left top",at:"left"+(h>=0?"+":"")+h+" top"+(i>=0?"+":"")+i,of:c.window},a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_trackFocus:function(){this._on(this.widget(),{focusin:function(b){this._makeFocusTarget(),this._focusedElement=a(b.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var b=this._trackingInstances(),c=a.inArray(this,b);-1!==c&&b.splice(c,1)},_trackingInstances:function(){var a=this.document.data("ui-dialog-instances");return a||(a=[],this.document.data("ui-dialog-instances",a)),a},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(b){var c=this,d=!1,e={};a.each(b,function(a,b){c._setOption(a,b),a in c.sizeRelatedOptions&&(d=!0),a in c.resizableRelatedOptions&&(e[a]=b)}),d&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",e)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return a(b.target).closest(".ui-dialog").length?!0:!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=!0;this._delay(function(){b=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(a){b||this._allowInteraction(a)||(a.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var a=this.document.data("ui-dialog-overlays")-1;a?this.document.data("ui-dialog-overlays",a):this.document.unbind("focusin").removeData("ui-dialog-overlays"),this.overlay.remove(),this.overlay=null}}})});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/util/ui",["src/util/util","src/util/debug","lodash","jquery","src/util/typerenderer","src/util/versioning","slickgrid","forms/button","src/util/couchshare","jquery-ui/dialog"],function(a,b,c,d,e,f,g,h,i){var j,k={};k.enterValue=function(a){a=a||{};var b={description:"",label:"Enter a value",buttonLabel:"Submit",validationMessage:"What you entered is not valid",value:""};return a=Object.assign({},b,a),new Promise(function(b){var c=d("<div>"+a.description+"<div>"+a.label+": </div></div>"),e=d('<input type="text" value="'+a.value+'"/>').appendTo(c.find("div")).on("keypress",function(a){13===a.keyCode&&f()}),f=function(){var c=e.val();return a.validation&&"function"==typeof a.validation&&!a.validation(c)?void k.showNotification(a.validationMessage,"error"):(b(c),void h.dialog("destroy"))},g={buttons:{},close:function(){b(),h.dialog("destroy")}};g.buttons[a.buttonLabel]=f;var h=k.dialog(c,g)})},k.choose=function(b,f){function h(){return"..."}function i(a,b,c,d){a&&e.render(a,c[d.field],d.rendererOptions)}function j(){u.html("\n                <table><tr><td>\n                "+(t?t+" sources left":"Sources loaded."+(y?" ("+y+" failed)":""))+'\n                </td>\n                <td id="abc">\n                </td></tr>\n                ');var b=d(u.find("td")[1]);b.append(a.getLoadingAnimation(16,"blue")),t||b.remove()}function l(a){return v.then(function(b){b.data.beginUpdate();for(var c=0;c<a.length;c++)b.data.addItem(a[c]);b.data.endUpdate(),b.grid.invalidateAllRows(),b.grid.render(),b.grid.resizeCanvas(),t--,j()})}f=f||{},f=c.defaults(f,{slick:{}});var m,n,o,p,q,r,s,t,u,v=new Promise(function(a){m=a}),w={editable:!0,enableAddRow:!1,enableTextSelectionOnCells:!0,forceFitColumns:!0,explicitInitialization:!0,rowHeight:20,enableAsyncPostRender:!0},x={formatter:h,asyncPostRender:i},y=0,z=Array.isArray(b);if(f.asynchronous){if(!z)throw new Error("Invalid arguments");t=b.length;for(var A=new Array(b.length),B=0;B<b.length;B++)A[B]=b[B].promise.then(l).catch(function(a){t--,y++,j()})}else{if(A=[],z)r=b;else{var C=Object.keys(b);r=new Array(C.length);for(var B=0;B<r.length;B++)r[B]={key:C[B],description:b[C[B]]}}l(r)}var D=c.defaults(f.slick,w);s=f.columns?f.columns:[{id:"key",name:"key",field:"key"},{id:"description",name:"description",field:"description"}];for(var B=0;B<s.length;B++)s[B]=c.defaults(s[B],x);return new Promise(function(b,c){a.loadCss("components/slickgrid/slick.grid.css").then(function(){var a=d("<div>"),c=d("<div>"),e=d("<div>").css("height",410);Promise.all(A).then(function(){var c=o.getLength();if(1===c&&f.autoSelect){var d=o.mapRowsToIds([0])[0];b(d),a.dialog("close")}}),q=f.noConfirmation?{}:{Cancel:function(){d(this).dialog("close")},Select:function(){b(p),d(this).dialog("close")}},k.dialog(a,{noWrap:!0,buttons:q,close:function(){b()},resize:function(){n.resizeCanvas()},open:function(){var h=this;e.addClass("flex-main-container"),c.addClass("flex-1"),u=d("<div>"),e.append(u),e.append(c),a.append(e),o=new g.Data.DataView,o.setItems([],f.idField||"key"),n=new g.Grid(c,o,s,D),n.setSelectionModel(new g.RowSelectionModel),n.onClick.subscribe(function(a,c){p=o.mapRowsToIds([c.row])[0],f.noConfirmation&&(b(p),d(h).dialog("close"))}),n.init(),m({data:o,grid:n}),j()},closeOnEscape:!1,width:700,height:500})})}).then(function(a){return f.returnRow?o.getItemById(a):f.returnColumn?o.getItemById(a)[f.returnColumn]:a})},k.confirm=function(a,b,e){return c.isUndefined(b)&&(b="Ok"),c.isUndefined(e)&&(e="Cancel"),new Promise(function(c){j||(j=d("<div/>"),d("body").append(j)),a&&j.html(a);var f={modal:!0,buttons:{},close:function(){c(!1)},width:400};null!==b&&""!==b&&(f.buttons[b]=function(){c(!0),d(this).dialog("close")}),null!==e&&""!==e&&(f.buttons[e]=function(){c(!1),d(this).dialog("close")}),j.dialog(f)})};var l={appendTo:"#ci-visualizer",modal:!0,autoDestroy:!0,autoPosition:!1,noHeader:!1,noWrap:!1};return k.dialog=function(a,b){"object"!==("undefined"==typeof a?"undefined":_typeof(a))||a.jquery||(b=a,a=null),b=d.extend({},l,b);var c;return c=b.noWrap?d(a||"<div>"):d("<div>").html(a||""),b.autoDestroy&&!b.close&&(b.close=function(){d(this).dialog("destroy")}),b.autoPosition&&(b.position={my:"top+50",at:"center top",of:"#ci-visualizer"}),c.dialog(b),b.noHeader&&c.prev().remove(),c},k.copyToClipboard=function(a){var b=a.length,c=d("<textarea/>").text(a).css({width:0,height:0,position:"fixed"});d("body").append(c);var e=c.get(0);e.selectionStart=0,e.selectionEnd=b,e.focus();var f=document.execCommand("copy");f?k.showNotification("Copy success","success"):k.showNotification("Copy failure","error"),c.remove()},k.copyview=function(){var a=f.getViewJSON("  "),b=a.length,c=d("<textarea/>").text(a).css({width:"100%",height:"95%"});k.dialog(c,{width:"80%",height:.7*d("#ci-visualizer").height()});var e=c.get(0);e.selectionStart=0,e.selectionEnd=b,e.focus()},k.copyData=function(){var a=f.getDataJSON("  "),b=a.length,c=d("<textarea/>").text(a).css({width:"100%",height:"200px"});k.dialog(c,{width:"80%"});var e=c.get(0);e.selectionStart=0,e.selectionEnd=b,e.focus()},k.pasteData=function(){var a,b,c=d("<textarea></textarea>").css({width:"100%",height:"200px"}),e=new h("Paste",function(){try{a=JSON.parse(c.val()),b=Object.keys(a);for(var d=0,e=b.length;e>d;d++)"_"===b[d].charAt(0)&&delete a[b[d]];f.setDataJSON(a)}catch(a){}g.dialog("close")}),g=k.dialog(c,{width:"80%"}).append(e.render())},k.pasteView=function(){var a,b,c=d("<textarea></textarea>").css({width:"100%",height:"200px"}),e=new h("Paste",function(){try{a=JSON.parse(c.val()),b=Object.keys(a);for(var d=0,e=b.length;e>d;d++)"_"===b[d].charAt(0)&&delete a[b[d]];f.setViewJSON(a)}catch(a){}g.dialog("close")}),g=k.dialog(c,{width:"80%"}).append(e.render())},k.feedback=function(a,b){a=a||{},b=b||{},b=c.defaults(b,{couchUrl:"http://visualizer.epfl.ch",database:"x",tinyUrl:"http://visualizer.epfl.ch/tiny"}),a.disabled||i.share(b).then(function(a){var b="\n\nTestcase: "+a+" ([Original URL]("+document.location.href+"))",c="https://github.com/NPellet/visualizer/issues/new?body="+encodeURIComponent(b),d=window.open(c,"_blank");d.focus()}).catch(function(a){k.showNotification("Error with Feedback, maybe pop-up was blocked","error")})},k.couchShare=function(b,c){var e=a.getNextUniqueId(),f=d("<div>").html("<h3>Click the share button to make a snapshot of your view and generate a tiny URL</h3><br>").append(new h("Share",function(){var a=this;b.disabled||i.share(b).then(function(b){d("#"+e).val(b).focus().select(),a.disable()},function(){d("#"+e).val("error")})},{color:"blue"}).render()).append(d('<input type="text" id="'+e+'" />').css("width","400px"));k.dialog(f,c)},k.showNotification=function(){var a=arguments;a[1]&&"string"==typeof a[1]?a[1]={className:a[1],autoHide:"error"!==a[1]}:a[1]&&"error"===a[1].className&&(a[1]=Object.assign({autoHide:!1},a[1])),require(["notifyjs"],function(){d.notify.apply(d.notify,a)})},k.getSafeElement=function(a){return k.makeElementSafe("<"+a+">")},k.makeElementSafe=function(a){return d(a).css({width:"100%",height:"100%",margin:0,padding:0,border:"none"})},k}),function(a){"function"==typeof define&&define.amd?define("jquery-ui/menu",["jquery","./core","./widget","./position"],a):a(jQuery)}(function(a){return a.widget("ui.menu",{version:"1.11.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},items:"> *",menus:"ul",position:{my:"left-1 top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item":function(a){a.preventDefault()},"click .ui-menu-item":function(b){var c=a(b.target);!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.select(b),b.isPropagationStopped()||(this.mouseHandled=!0),c.has(".ui-menu").length?this.expand(b):!this.element.is(":focus")&&a(this.document[0].activeElement).closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){if(!this.previousFilter){var c=a(b.currentTarget);c.siblings(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.find(this.options.items).eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(a){this._closeOnDocumentClick(a)&&this.collapseAll(a),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){var c,d,e,f,g=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:g=!1,d=this.previousFilter||"",e=String.fromCharCode(b.keyCode),f=!1,clearTimeout(this.filterTimer),e===d?f=!0:e=d+e,c=this._filterMenuItems(e),c=f&&-1!==c.index(this.active.next())?this.active.nextAll(".ui-menu-item"):c,c.length||(e=String.fromCharCode(b.keyCode),c=this._filterMenuItems(e)),c.length?(this.focus(b,c),this.previousFilter=e,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}g&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.is("[aria-haspopup='true']")?this.expand(a):this.select(a))},refresh:function(){var b,c,d=this,e=this.options.icons.submenu,f=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length),f.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),c=b.parent(),d=a("<span>").addClass("ui-menu-icon ui-icon "+e).data("ui-menu-submenu-carat",!0);c.attr("aria-haspopup","true").prepend(d),b.attr("aria-labelledby",c.attr("id"))}),b=f.add(this.element),c=b.find(this.options.items),c.not(".ui-menu-item").each(function(){var b=a(this);d._isDivider(b)&&b.addClass("ui-widget-content ui-menu-divider")}),c.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),c.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),"disabled"===a&&this.element.toggleClass("ui-state-disabled",!!b).attr("aria-disabled",b),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.addClass("ui-state-focus").removeClass("ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&a&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.outerHeight(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active")},_closeOnDocumentClick:function(b){return!a(b.target).closest(".ui-menu").length},_isDivider:function(a){return!/[^\-\u2014\u2013\s]/.test(a.text())},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.find(this.options.items)[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d-e<0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.find(this.options.items).first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)},_filterMenuItems:function(b){var c=b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),d=new RegExp("^"+c,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return d.test(a.trim(a(this).text()))})}})}),define("src/util/context",["jquery","src/util/config","src/util/versioning","jquery-ui/menu"],function(a,b,c){var d;return{listen:function(c,e,f,g){Array.isArray(e[0])||(e=[e]),c.addEventListener("contextmenu",function(c){f&&f(d);for(var h=0,i=e.length;i>h;h++)!function(a,e,f){-1===b.contextMenu().indexOf("all")&&-1===b.contextMenu().indexOf(a.attr("name")||"undefined")||((f&&f(c,a)||!f)&&d.append(a),a.bind("click",function(a){e&&e.call(this,c,a)}))}(a(e[h][0]),e[h][1],e[h][2]);g&&g(d)},!0)},unlisten:function(a){a.removeEventListener("contextmenu")},getRootDom:function(){return this.dom},init:function(b){this.dom=b;var c,e;b.addEventListener("contextmenu",function(b){d&&(d.hasClass("ui-menu")&&d.menu("destroy"),d.remove()),d=null,c=b.clientY,e=b.clientX;var f=a('<ul class="ci-contextmenu"></ul>').css({position:"fixed",left:e,top:c,"z-index":1e4}).appendTo(a("body"));d=f;var g=function b(){d&&(d.hasClass("ui-menu")&&d.menu("destroy"),d.remove()),d=null,a(document).unbind("click",b)};a(document).bind("click",g)},!0),b.parentNode.addEventListener("contextmenu",function(a){if(d.children().length>0){d.menu({select:function(a,b){b.item.attr("name")}}),a.preventDefault(),a.stopPropagation();var b=d.height(),f=d.width(),g=document.documentElement.clientHeight,h=document.documentElement.clientWidth;return c+b>g&&d.css("top",Math.max(0,g-b-10)),e+f>h&&d.css("left",Math.max(0,h-f-10)),!1}},!1)}}}),define("src/util/fullscreen",["src/util/ui"],function(a){function b(){var a=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement,b=c.view;a?(e=a.getAttribute("style"),a.setAttribute("style","height:100%; width:100%; background-color:white;"),d=a,f={height:b.height,width:b.width},b.height=c.getDomContent().height(),b.width=c.getDomContent().width()):(d.setAttribute("style",e),b.height=f.height,b.width=f.width,e=f=d=null),c.view.onResize(b.width,b.height)}var c,d,e,f;return document.addEventListener("fullscreenchange",b),document.addEventListener("webkitfullscreenchange",b),document.addEventListener("mozfullscreenchange",b),document.addEventListener("MSFullscreenChange",b),{requestFullscreen:function(b){if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){c=b;var d=b.getDomContent()[0];d.requestFullscreen?d.requestFullscreen():d.webkitRequestFullscreen?d.webkitRequestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.msRequestFullscreen&&d.msRequestFullscreen()}else a.showNotification("Sorry, fullscreen not available in this context","info")}}}),define("forms/sectionelement",["require","jquery"],function(a,b){var c=function(){};return c.defaultOptions={},b.extend(c.prototype,{init:function(a){this.options=b.extend({},c.defaultOptions,a),this.splice=Array.prototype.splice,this.groupElements={},this.sectionElements={},this.fieldElements=[],this.readyDef=b.Deferred(),this.done=0},fill:function(a,b){return this._fillGroups(a.groups,b),this._fillSections(a.sections,b),0==this.done&&this.readyDef.resolve(),this.readyDef},_fillGroups:function(a,b){var c=this.section.getGroups();this._fill(c,this.getGroupElement,a,b)},_fillSections:function(a,b){var c=this.section.getSections();this._fill(c,this.getSectionElement,a,b)},_fill:function(a,b,c,d){var e=this;c||(c={});var f,g,h;for(f in a)for(c[f]||(c[f]={}),c[f]instanceof Array||(c[f]=[c[f]]),g=0,h=c[f].length,0==h&&(c[f][0]={},h++);h>g;g++)e.done++,b.call(this,f,g).fill(c[f][g],d).done(function(){e.done--,0==e.done&&e.readyDef.resolve()})},visible:function(){this.eachElements(function(a){a.visible()})},condDisplay:function(a,b,c){var d,e,f=0;switch(b){case"section":d=this.sectionElements[a];break;case"group":d=this.groupElements[a]}for(e=d.length;e>f;f++)c?d[f].show():d[f].hide()},eachGroupElements:function(a,b){if(this.groupElements[a])for(var c=0,d=this.groupElements[a].length;d>c;c++)b.call(this,this.groupElements[a][c])},inDom:function(){this.eachElements(function(a){a.inDom()})},eachElements:function(a){var b=this;this.section.eachGroups(function(c){b.eachGroupElements(c.getName(),function(b){a(b,"group",c.getName())})}),this.section.eachSections(function(c){b.eachSectionElements(c.getName(),function(b){a(b,"section",c.getName())})})},redoTabIndices:function(){this.eachElements(function(a){a.redoTabIndices()})},addFieldElement:function(a){this.fieldElements.push(a)},removeFieldElement:function(a){this.fieldElements.splice(this.fieldElements.indexOf(a),1)},eachSectionElements:function(a,b){if(this.sectionElements[a])for(var c=0,d=this.sectionElements[a].length;d>c;c++)b.call(this,this.sectionElements[a][c])},getGroupElement:function(a,b){return this._getElement(this.groupElements,this.section.getGroup,this.section,a,b)},getSectionElement:function(a,b){return this._getElement(this.sectionElements,this.section.getSection,this.section,a,b)},_getElement:function(a,b,c,d,e){var f;return a[d]=a[d]||[],a[d][e]||(f=b.call(c,d).makeElement(),f.sectionElement=this,a[d][e]=f),a[d][e]},getSectionElements:function(){return this.sectionElements},getGroupElements:function(){return this.groupElements},getValue:function(){var a=this.getGroupElements(),b=this.getSectionElements(),c={sections:{},groups:{}};return this._getValue(b,c.sections),this._getValue(a,c.groups),c},_getValue:function(a,b){var c,d,e;for(c in a)for(d=0,e=a[c].length,b[c]=[];e>d;d++)b[c].push(a[c][d].getValue());return b},getTitle:function(){return this.section.options.title||!1},getTitleIcon:function(){var b="",c=this.getTitle();return this.section.options.icon&&(b+='<img src="'+a.toUrl("./images/"+this.section.options.icon+".png")+'" />'),c&&(b+="<div>"+c+"</div>"),b},makeDom:function(){var a,c,d,e=b("<div />");switch(this.section.form.tplMode){case 1:1==this.section.sectionLevel?(this.section.form.sectionLvl1Buttons.append('<div data-section-name="'+this.section.getName()+'" class="form-section-select">'+this.getTitleIcon()+"</div>"),e.hide()):this.stdTitle(e);break;default:this.stdTitle(e)}for(a in this.groupElements)for(d=this.groupElements[a].length,c=0;d>c;c++)e.append(this.groupElements[a][c].makeDom());for(a in this.sectionElements)for(d=this.sectionElements[a].length,
c=0;d>c;c++)e.append(this.sectionElements[a][c].makeDom());return this.dom=e},stdTitle:function(a){var c=this.getTitle(),d=this.section.sectionLevel;if(c||this.section.options.multiple){var e=b("<h"+d+">"+c+"</h"+d+">");this.section.options.multiple&&e.append(this.makeDuplicator()),a.append(e)}},makeDuplicator:function(){var a=this;return b('<div class="form-duplicator-wrapper"><span class="form-duplicator form-duplicator-add">duplicate</span> - <span class="form-duplicator form-duplicator-remove">remove</span></div>').on("click","span",function(){var c=b(this).hasClass("form-duplicator-add");a.sectionElement[c?"duplicateSectionElement":"removeSectionElement"](a)})},show:function(){this.dom.show()},hide:function(){this.dom.hide()},getSectionIndex:function(a){var b=a.section.getName();if(!this.sectionElements[b])return this.form.throwError("Cannot get section index. Section name "+b+" doesn't exist");var c=this.sectionElements[b].indexOf(a);return 0>c?this.form.throwError("Cannot get section index. Cannot find section element"):c},removeSectionElement:function(a){var b=a.section.getName(),c=this.getSectionIndex(a);c!==!1&&(1==this.sectionElements[b].length&&this.duplicateSectionElement(a),this.sectionElements[b].splice(c,1),a.dom.remove(),a.dom=null,a=null)},duplicateSectionElement:function(a){var b=this,c=a.section.getName(),d=this.getSectionIndex(a);if(d!==!1){var e=this.section.getSection(c).makeElement();return e.sectionElement=this,this.sectionElements[c].splice(d+1,0,e),e.fill({}),e.readyDef.then(function(){a&&a.dom?a.dom.after(e.makeDom()):b.dom.append(e.makeDom());for(var c=0,d=e.fieldElements.length;d>c;c++)b.section.form.conditionalDisplayer.changed(e.fieldElements[c]);e.inDom()}),e}},ready:function(){return b.when.apply(b.when,this.deferreds)},makeDomTpl:function(){return this._makeDomTpl()},_makeDomTpl:function(){this.dom=this.section._tplClean.clone();var a,b,c;for(a in this.sectionElements)for(b=0,c=this.sectionElements[a].length;c>b;b++)this.dom.find(".form-section-section-container").append(this.sectionElements[a][b].makeDomTpl());for(a in this.groupElements)for(b=0,c=this.groupElements[a].length;c>b;b++)this.dom.find(".form-section-group-container").append(this.groupElements[a][b].makeDomTpl());return this.dom}}),c}),define("forms/field",["require","jquery"],function(a,b){var c=function(a){this.name=a};return c.defaultOptions={},b.extend(c.prototype,{init:function(a){this.options=b.extend({},c.defaultOptions,a),this.elements=[],this.initimpl()},initimpl:function(){},getTitle:function(){return this.options.title||"Title"},getType:function(){return this.options.type},getName:function(){return this.name||""},isHidden:function(){return this.options.hidden},isDisplayed:function(){return this.options.displayed===!0||void 0===this.options.displayed},makeElement:function(){var c=this,d=this.group.options.type,e=this.options.type,f=b.Deferred();return a(["./types/"+e+"/"+d],function(a){var d=new a;d.init(c.options),d.field=c,c.elements.push(d),b.when(d.ready).then(function(){f.resolve(d)})}),this.group.form.addFieldElement(f),f},removeElement:function(a){this.elements.splice(this.elements.indexOf(a),1)},showExpander:function(a){this._showExpander(a)},_showExpander:function(a){var b=a.domExpander||this.domExpander;this.fieldElementExpanded=a,this.form.setExpander(b,a)},getElementExpanded:function(){return this.fieldElementExpanded},changed:function(a){this.options.onChange&&this.options.onChange.call(this,a)},getOptions:function(a){return a.getOptions()||this.options.options},validate:function(a,b){var c,d=0;if(this.options.validation&&this.options.validation.rules)for(c=this.options.validation.rules.length;c>d;d++){if(this.options.validation.rules[d].pattern){if(!(this.options.validation.rules[d].orEmpty&&!b||new RegExp(this.options.validation.rules[d].pattern).test(b))){a.validation.error=!0,a.validation.feedback=this.options.validation.rules[d].feedback;break}a.validation.error=!1}if("undefined"!=typeof this.options.validation.rules[d].nonEmpty){if(this.options.validation.rules[d].nonEmpty&&!b){a.validation.error=!0,a.validation.feedback=this.options.validation.rules[d].feedback;break}a.validation.error=!1}}}}),Object.defineProperty(c.prototype,"form",{enumerable:!0,configurable:!1,get:function(){return this._form||this.group.form},set:function(a){this._form=a}}),c}),define("forms/groupelement",["jquery"],function(a){var b=function(){};return b.defaultOptions={},a.extend(b.prototype,{init:function(c){this.options=a.extend({},b.defaultOptions,c),this.splice=Array.prototype.splice,this.readyDef=a.Deferred(),this.fieldElements={}},set section(a){this._section=a},get section(){return this._section},set sectionElement(a){this._sectionElement=a},get sectionElement(){return this._sectionElement},set group(a){this._group=a},get group(){return this._group},_fill:function(a,b){var c,d,e,f=this,g=0;a._title&&this.setTitle(a._title),this.group.eachFields(function(b){f.getFieldElement(b.getName(),0),a[b.getName()]||(a[b.getName()]=[])});for(c in a)for(a[c]instanceof Array||(a[c]=[a[c]]),d=0,e=a[c].length,0==e&&(a[c][0]=null,e=1);e>d;d++)g++,this.fillElement(c,d,a[c][d],b).then(function(){g--,0==g&&f.readyDef.resolve()});return f.readyDef},fill:function(a,b){return this._fill(a,b)},fillElement:function(b,c,d,e){return a.when(this.getFieldElement(b,c)).then(function(a){a&&a.setDefaultOr(d)})},inDom:function(){var a=this;this.group.eachFields(function(b){a.eachFieldElements(b.getName(),function(a){a._inDom=!0,a.inDom(),a._validate(a._value)})})},visible:function(){},show:function(){this.dom.show()},hide:function(){this.dom.hide()},getFieldElement:function(a,b){var c,d=this;if(this.group.getField(a))return this.fieldElements[a]=this.fieldElements[a]||[],this.fieldElements[a][b]?this.fieldElements[a][b]:c=this.group.getField(a).makeElement().done(function(c){c.group=d.group,c.groupElement=d,d.sectionElement.addFieldElement(c),d.fieldElements[a][b]=c})},_getElement:function(a,b,c,d){return a[c]=a[c]||[],a[c][d]},getFieldElements:function(){return this.fieldElements},eachFieldElements:function(a,b){var c,d,e=this.getFieldElements()[a];if(!e)return this.form.throwError("Cannot iterate over field. Field "+a+" does not exist");for(c=0,d=e.length;d>c;c++)b.call(this,e[c])},makeDomTpl:function(){return this._makeDomTpl()},getTitle:function(){return this._title||this.group.getTitle()},setTitle:function(a){this._title=a}}),b}),define("forms/grouplistelement",["jquery","./groupelement"],function(a,b){var c=function(){};return c.prototype=new b,c.prototype.makeDom=function(b){!b&&this.dom&&this.updateDom();var c,d,e,f=this,g=a("<div />").addClass("form-group-list");return this.group.getTitle()&&g.append('<div class="form-groupelement-title">'+this.getTitle()+"</div>"),f.fieldElementsDom=f.fieldElementsDom||{},this.group.eachFields(function(b){b.isDisplayed()&&(c=a("<div />").addClass("form-field-list-"+b.getType()),d=a("<label />").html(b.getTitle(!0)),c.append(d),e=a("<div />").addClass("form-field-list-elements"),c.append(e),g.append(c),f.fieldElementsDom[b.getName()]=e)}),this.updateDom(),this.dom=g,this.dom},c.prototype.updateDom=function(){var a=this;return a.fieldElementsDom=a.fieldElementsDom||{},this.group.eachFields(function(b){a.fieldElementsDom[b.getName()]&&(a.fieldElementsDom[b.getName()].children().detach(),a.eachFieldElements(b.getName(),function(c){a.fieldElementsDom[b.getName()].append(c.getDom())}))}),this.group.form.redoTabIndices(),this.dom},c.prototype._makeDomTpl=function(){var b=this;return this.dom=this.group._tplClean.clone(),b.fieldElementsDom=b.fieldElementsDom||{},this.dom.find(".form-dyn").each(function(c,d){d=a(d);var e=d.attr("data-form-content").split(":");switch(e[0]){case"field":if(b.fieldElements[e[1]])switch(e[2]){case"dom":b.fieldElementsDom[e[1]]=d;break;case"label":d.html(b.group.fields[e[1]].options.title||b.group.fields[e[1]].name)}}}),this.updateDom(),this.dom},c.prototype.condDisplay=function(a,b){this.eachFieldElements(a,function(c){b?this.fieldElementsDom[a].parent().show():this.fieldElementsDom[a].parent().hide()})},c.prototype.getFieldIndex=function(a){var b=a.field.getName();if(!this.fieldElements[b])return this.form.throwError("Cannot get field index. Field name "+b+" doesn't exist");var c=this.fieldElements[b].indexOf(a);return 0>c?this.form.throwError("Cannot get field index. Cannot find field element"):c},c.prototype.getValue=function(a,b){var c,d,e,b={};for(c in this.fieldElements)for(d=0,e=this.fieldElements[c].length,b[c]=[];e>d;d++)b[c].push(this.fieldElements[c][d].extractValue());return b},c.prototype.duplicateFieldElement=function(a){var b=this,c=a.field.getName(),d=this.getFieldIndex(a);if(d!==!1){var e=this.group.getField(c).makeElement().done(function(a){a.setDefaultOr(),a.group=b.group,a.groupElement=b,b.fieldElements[c].splice(d+1,0,a)});return e}},c.prototype.removeFieldElement=function(a){var b=a.field.getName(),c=this.getFieldIndex(a);c!==!1&&(a.field.removeElement(a),this.fieldElements[b].splice(c,1))},c.prototype.getExpanderInfosFor=function(a){var b=(a.name,a._dom.position()),c=this.group.form.dom.find(".form-sections-wrapper").position();return{width:a._dom.innerWidth(),left:b.left+c.left,top:b.top+c.top+a._dom.height()-1}},c.prototype.redoTabIndices=function(){var a=this;this.group.eachFields(function(b){a.eachFieldElements(b.getName(),function(a){a.redoTabIndices()})})},c}),define("forms/grouptableelement",["jquery","./groupelement"],function(a,b){var c=function(){this.duplicators=[]};return c.prototype=new b,c.prototype.makeDom=function(b){var c,d,e,f,g,h=this,i=a("<div />").addClass("form-group-table");return this.getTitle()&&i.append('<div class="form-groupelement-title">'+this.getTitle()+"</div>"),c=a("<table />",{cellpadding:0,cellspacing:0}).css({width:"100%"}),d=a("<thead />"),e=a("<tbody />"),f=a("<tr />").appendTo(d),f.append("<th />"),this.group.eachFields(function(b){b.isDisplayed()&&(g=a("<th />").html(b.getTitle(!0)),f.append(g))}),this.options.multiple&&f.append("<th />"),c.append(d).append(e),this.dom=i,this.domHead=d,this.domBody=e,this.options.multiple&&c.on("click",".form-duplicator",function(){var b=a(this).hasClass("form-duplicator-add"),c=parseInt(a(this).parent().attr("data-rowid"));b?h.duplicate(c):h.remove(c)}),this.updateDom(),this.dom.append(c),this.dom},c.prototype._makeDomTpl=function(){return this.makeDom()},c.prototype.visible=function(){var b,c=this.domBody.width(),d=this;c-=20,this.options.multiple&&(c-=30),c/=this.group.nbFields,this.domHead.children().children().each(function(e,f){return b=a(f),0==e?void b.css("width",20):d.group.options.multiple&&e==d.group.nbFields+1?void b.css("width",30):void b.css("width",c)})},c.prototype.updateDom=function(){var b,c,d,e=this,f=[],g=0,h=0,i=[];for(this.domBody.children().detach(),this.group.eachFields(function(b){var d=b.getName();e.getFieldElement(d,0),g=0,e.eachFieldElements(d,function(b){c=a("<td />").html(b.getDom()),f[g]=f[g]||[],f[g][h]=c,g++}),h++,i[h]=b}),g=0,d=f.length;d>g;g++){b=a("<tr />"),b.append("<td>"+(g+1)+"</td>");for(var h=0,j=f[g].length;j>h;h++)b.append(f[g][h]);this.options.multiple&&b.append(this.makeDuplicator(g)),this.domBody.append(b)}return this.group.form.redoTabIndices(),this.dom},c.prototype.makeDuplicator=function(b){if(this.duplicators[b])return this.duplicators[b];var c=a("<td></td>",{"data-rowid":b}).addClass("form-table-duplicator");return c.append('<span class="form-duplicator form-duplicator-add">+</span>'),c.append('<span class="form-duplicator form-duplicator-remove">-</span>'),this.duplicators[b]=c,c},c.prototype.duplicate=function(b){var c=this,d=[];this.group.eachFields(function(a){var e=a.makeElement().done(function(d){d.group=c.group,d.groupElement=c,c.fieldElements[a.getName()].splice(b+1,0,d)});d.push(e)}),a.when.apply(a.when,d).then(function(){c.updateDom();for(var a=0,b=arguments.length;b>a;a++)arguments[a].setDefaultOr(),arguments[a].inDom()})},c.prototype.remove=function(a){var b,c=this;this.group.eachFields(function(d){d.removeElement(c.fieldElements[d.getName()][a]),c.fieldElements[d.getName()].splice(a,1),b=c.fieldElements[d.getName()].length}),0==b?this.duplicate(-1):c.updateDom()},c.prototype.fill=function(a,b){if(!(a instanceof Array))return this.fillOld(a,b);for(var c,d=0,e=a.length,f={},g={},h=this.group.fields;e>d;d++)for(c in h)f[c]=f[c]||[],f[c][d]=a[d][c],g[c]=!0;for(c in h)for(d=0;e>d;d++)f[c][d]=f[c][d]||null;return this._fill(f,b)},c.prototype.fillOld=function(a,b){var c,d,e=0;this.group.eachFields(function(b){a[b.getName()]=a[b.getName()]||[],e=Math.max(e,a[b.getName()].length)});for(c in a)for(d=a[c].length;e>d;d++)a[c][d]=null;return this._fill(a,b)},c.prototype.getValue=function(a,b){var c,d,e,b=[];for(c in this.fieldElements)for(d=0,e=this.fieldElements[c].length;e>d;d++)b[d]=b[d]||{},b[d][c]=this.fieldElements[c][d].extractValue();return b},c.prototype.getExpanderInfosFor=function(a){var b,c=a.getName(),d=0;this.eachFieldElements(c,function(c){c==a&&(b=d),d++});var e=this.group.form.dom.find(".form-sections-wrapper").position(),f=a.dom.position(),g=this.domBody.children("tr:eq("+b+")"),h=this.domBody.position();return{width:g.outerWidth()-f.left+h.left+2,left:f.left+e.left-1,top:f.top+e.top+this.domBody.children("tr:eq("+b+")").innerHeight()-1}},c.prototype.redoTabIndices=function(){var a,b=this,c=0,d=this.group.nbFields,e=0,f=[],g=0;for(this.group.eachFields(function(a){c=0,b.eachFieldElements(a.getName(),function(a){f[c*d+e]=a,c++}),e++}),a=f.length;a>g;g++)this.group.form.incrementTabIndex(f[g])},c.prototype.getFieldElementCorrespondingTo=function(a,b){var c;return this.fieldElements[b]&&(c=this.fieldElements[b][this.fieldElements[a.getName()].indexOf(a)])?c:void 0},c}),define("forms/grouptextelement",["jquery","./groupelement"],function(a,b){var c=function(){this.duplicators=[]};return c.prototype=new b,c.prototype.fill=function(b,c){return this.value=b,this.dom&&this.dom.html(this.value),a.Deferred().resolve()},c.prototype.inDom=function(){},c.prototype.getFieldElement=function(a,b){},c.prototype._getElement=function(a,b,c,d){},c.prototype.getFieldElements=function(){},c.prototype.eachFieldElements=function(a,b){},c.prototype.makeDom=function(b){return this.dom=a("<div />"),this.value&&this.dom.html(this.value),this.dom},c.prototype._makeDomTpl=function(){},c.prototype.visible=function(){},c.prototype.updateDom=function(){return this.dom},c.prototype.makeDuplicator=function(a){},c.prototype.duplicate=function(a){},c.prototype.remove=function(a){},c.prototype.getValue=function(a,b){},c.prototype.redoTabIndices=function(){},c}),define("forms/group",["require","jquery","./field","./grouplistelement","./grouptableelement","./grouptextelement"],function(a,b,c,d,e,f){var g=function(a){this.name=a};return g.defaultOptions={},b.extend(g.prototype,{init:function(a){this.options=b.extend({},g.defaultOptions,a),this.fields={},this.deferreds={},this.elements=[],this.nbFields=0},getName:function(){return this.name},getTitle:function(){return this.options.title},setStructure:function(a){var b;a=a.fields;for(b in a)this.addField(a[b],b)},addField:function(d,e){var f=e||d.name,g=this;if(this.fields[f])return this.form.throwError('Field "'+sectionobj.getName()+'" already exists');if(this.nbFields++,d instanceof c)return this.sections[d.getName()]=d,d;var h=d.type,i=b.Deferred();return a(["./types/"+h+"/field"],function(a){var b=new a(f);b.init(d),b.group=g,g.fields[f]=b,(b.options.displaySource||b.options.displayTarget)&&g.form.conditionalDisplayer.init(b,b.options.displaySource,b.options.displayTarget),i.resolve(b)}),this.form.addField(i),this.deferreds[f]=i,this.fields[f]=!1,i},_setTpl:function(a){this.tpl=a,this._tplClean=a},fieldExists:function(a){return!!this.fields[a]},getField:function(a,b){return void 0!==b?this.getFieldElement(a,b):this.fields[a]||"_title"==a?this.fields[a]:this.form.throwError('Cannot return field "'+a+'". Field does not exist')},eachFields:function(a){var b;for(b in this.fields)a.call(this,this.fields[b])},makeElement:function(){var a;switch(this.options.type){case"table":a=new e;break;case"text":a=new f;break;case"list":default:a=new d}return a.init(this.options),a.group=this,this.elements.push(a),a},ready:function(){return b.when(this.deferreds)}}),Object.defineProperty(g.prototype,"section",{enumerable:!1,configurable:!1,get:function(){return this._section},set:function(a){this._section=a}}),Object.defineProperty(g.prototype,"form",{enumerable:!0,configurable:!1,get:function(){return this._form||this.section.form},set:function(a){this._form=a}}),Object.defineProperty(g.prototype,"name",{enumerable:!0,configurable:!1,get:function(){return this._name},set:function(a){this._name=a}}),g}),define("forms/section",["jquery","./sectionelement","./group"],function(a,b,c){var d=function(a){this.name=a};return d.defaultOptions={},a.extend(d.prototype,{init:function(b){this.options=a.extend({},d.defaultOptions,b),this.splice=Array.prototype.splice,this.sections={},this.groups={},this.sub=[]},getName:function(){return this.name},setStructure:function(a){a.sections&&this._addSections(a.sections),a.groups&&this._addGroups(a.groups)},_addSections:function(a){this._addElements(a,this.sections,d)},_addGroups:function(a){this._addElements(a,this.groups,c)},_addElements:function(a,b,c){var d;for(d in a)this._addElement(a[d],b,c,d)},_addElement:function(a,b,c,d){if(!(a instanceof c)){var e=new c(d);e.init(a.options),e.sectionLevel=this.sectionLevel+1,e.section=this,e.form=this.form,e.setStructure(a),a=e}return b[a.getName()]?this.form.throwError('Cannot add Section / Group. "'+a.getName()+'" already exists'):void(b[a.getName()]=a)},eachGroups:function(a){var b;for(b in this.groups)a.call(this,this.groups[b])},eachSections:function(a){var b;for(b in this.sections)a.call(this,this.sections[b])},getValue:function(){var a={};return this.eachSubSections(function(b){a.push(b.getValue())}),a},getSection:function(a,b){var c=this.sections[a];return void 0==b?c:c.getSectionElement(b)},getSections:function(){return this.sections},getGroups:function(){return this.groups},sectionExists:function(a){return!!this.sections[a]},getGroup:function(a){return this.groups[a]||this.form.throwError("Cannot find group "+a+".")},groupExists:function(a){return!!this.groups[a]},makeElement:function(a){var c=new b;return c.init(a),c.section=this,this.sub.push(c),c},_setTpl:function(a){this._tpl=a,this.eachSections(function(a){a._setTpl(this._tpl.find('.form-section[data-form-sectionname="'+a.name+'"]'))}),this.eachGroups(function(a){a._setTpl(this._tpl.find('.form-group[data-form-groupname="'+a.name+'"]'))}),this._tplClean=this._tpl.clone(),this._tplClean.find(".form-section-group-container:eq(0)").empty(),this._tplClean.find(".form-section-section-container:eq(0)").empty()}}),Object.defineProperty(d.prototype,"form",{enumerable:!0,configurable:!1,get:function(){return this._form},set:function(a){this._form=a}}),Object.defineProperty(d.prototype,"name",{enumerable:!0,configurable:!1,get:function(){return this._name},set:function(a){this._name=a}}),Object.defineProperty(d.prototype,"section",{enumerable:!0,configurable:!1,get:function(){return this._section},set:function(a){this._section=a}}),d}),define("forms/conditionalelementdisplayer",["jquery"],function(a){var b=function(){this.targets={}};return b.prototype={init:function(a,b,c){},changed:function(a,b){var c=a.field.options.displaySource,d=a.value;if(c){for(var e in c)e!==d&&this.triggerValue(a,c[e],!1);"undefined"!=typeof c[d]&&this.triggerValue(a,c[d],!0)}},triggerValue:function(a,b,c){var d=a.groupElement;this.lookForField(d,b,c)},lookForField:function(a,b,c){var d,e,f;for(e in a.fieldElements)d=a.group.fields[e],d.options&&d.options.displayTarget&&d.options.displayTarget.indexOf(b)>-1&&a.condDisplay(e,c);f=a.sectionElement,this.lookForGroupOrSection(f,b,c)},lookForGroupOrSection:function(a,b,c){a.section.eachSections(function(d){d.options.displayTarget&&d.options.displayTarget.indexOf(b)>-1&&a.condDisplay(d.getName(),"section",c)}),a.section.eachGroups(function(d){d.options.displayTarget&&d.options.displayTarget.indexOf(b)>-1&&a.condDisplay(d.getName(),"group",c)}),a=a.sectionElement,a.eachElements&&this.lookForGroupOrSection(a,b,c)}},b}),define("forms/form",["jquery","./section","./sectionelement","./conditionalelementdisplayer"],function(a,b,c,d){var e=function(){};return e.defaultOptions={},e.prototype=new b,a.extend(e.prototype,{init:function(b){this.options=a.extend({},e.defaultOptions,b),this.splice=Array.prototype.splice,this.section=this,this.sections={},this.sectionElements={},this.allFields=[],this.allFieldElements=[],this._onStructureLoaded=a.Deferred(),this._onValueLoaded=a.Deferred(),this.sectionLevel=0,this.expander={},this.form=this,this.conditionalDisplayer=new d,this.buttons=[],this.buttonsDom=a("<div />").addClass("form-buttonzone"),this.buttonsDom.append(a("<div />").addClass("cleaner"))},triggerAction:function(){if(arguments[0]){var a=arguments[0];if("function"==typeof this.options[a]){this.splice.call(arguments,0,1);this.options[a].apply(this,arguments)}}},addFieldElement:function(a){this.allFieldElements.push(a)},fieldElementValueChanged:function(a,b,c){this.doneDom&&this.triggerAction("onValueChanged",a,this.getValue())},addField:function(a){this.allFields.push(a)},eachFields:function(a){return this._each(this.allFields,a)},eachFieldsElements:function(a){return this._each(this.allFieldElements,a)},_each:function(b,c){var d=this,e=0,f=b.length;a.when.apply(a.when,b).then(function(){for(;f>e;e++)c.call(d,arguments[e])})},setTpl:function(b){b=a(b),this._setTpl(b)},makeDomTpl:function(){this.doneDom=!0;var a=this._makeDomTpl();return this.dom.find(".buttons").html(this.buttonsDom),a},_makeDomTpl:c.prototype._makeDomTpl,makeDom:function(b,c){c=c||0;var d,e,f,g=this,h=a('<form class="forms" tabindex="1" />'),i=a("<div />").addClass("form-sections-wrapper");switch(this.tplMode=b||1,this.tplMode){case 1:this.sectionLvl1Buttons=a("<div />").addClass("form-section-select-wrapper").appendTo(h),this.sectionLvl1Buttons.on("click",".form-section-select",function(){a(this).siblings().removeClass("selected"),a(this).addClass("selected"),i.children().hide().eq(a(this).index()).show();for(var b=0,c=g.sectionElements[a(this).attr("data-section-name")],d=c.length;d>b;b++)c[b].visible()})}this.bindEvents(h);for(d in this.sectionElements)for(e=0,f=this.sectionElements[d].length;f>e;e++)i.append(this.sectionElements[d][e].makeDom());switch(this.doneDom=!0,h.append(i),this.tplMode){case 1:this.sectionLvl1Buttons.children().eq(c).trigger("click")}return h.append(this.buttonsDom),a.when.apply(a,this.allFieldElements).then(function(){for(var a=0,b=arguments.length;b>a;a++)g.conditionalDisplayer.changed(arguments[a])}),this.dom=h},bindEvents:function(a){var b=this;a.get(0).addEventListener("click",function(){b.hideExpander(),b._unselectField()},!1),a.get(0).addEventListener("submit",function(a){b.formSubmitted(a)},!1),a.get(0).addEventListener("keydown",function(a){b.tabPressed(a)},!1)},_unselectField:function(){this.selectedFieldElement&&this.selectedFieldElement.unSelect()},selectFieldElement:function(a){this._unselectField(),this.selectedFieldElement=a,this.hideExpander()},unSelectFieldElement:function(a){this.selectedFieldElement=!1},getValue:function(){var a={sections:{}};return this._getValue(this.sectionElements,a.sections),a},_getValue:c.prototype._getValue,fill:function(b,c){var d=this;b=b||{},this._fillSections(b.sections,c),a.when.apply(a.when,this.allFieldElements).then(function(){d._onValueLoaded.resolve()})},_fillSections:c.prototype._fillSections,_fill:c.prototype._fill,getSectionElement:c.prototype.getSectionElement,_getElement:c.prototype._getElement,getSection:function(a){return this.sections[a]},eachSectionElements:function(a){var b,c,d;for(b in this.sectionElements)for(c=0,d=this.sectionElements[b].length;d>c;c++)a.call(this,this.sectionElements[b][c])},tabPressed:function(a,b){if(9==a.keyCode){if(a.preventDefault(),a.stopPropagation(),!b){if(!this.selectedFieldElement)return;b=this.selectedFieldElement}b.unSelect();var c=this.tabIndexed.indexOf(b);return this.tabIndexed[c+(a.shiftKey?-1:1)].focus(),!0}},incrementTabIndex:function(a){return this.tabIndexed[++this.lastIndex]=a},redoTabIndices:function(){this.lastIndex=1,this.tabIndexed=[],this.eachSectionElements(function(a){a.redoTabIndices()})},inDom:function(){this.eachSectionElements(function(a){a.inDom()});var a,b,c=0;for(a in this.sectionElements)for(b=this.sectionElements[a].length;b>c;c++)this.sectionElements[a][c].visible();this.dom.focus(),this.redoTabIndices()},onReady:function(a){return this._onValueLoaded},onLoaded:function(a){return this.onReady(a)},setStructure:function(a){a.sections&&this._addSections(a.sections),this.structureIsSet()},structureIsSet:function(){var b=this;a.when.apply(a,this.allFields).then(function(){b._onStructureLoaded.resolve()})},onStructureLoaded:function(){return this._onStructureLoaded},getExpanderDom:function(){return this.expander.dom||(this.expander.dom=a("<div />").addClass("form-expander").appendTo(this.dom).on("click",function(a){a.stopPropagation(),a.preventDefault()}))},setExpander:function(a,b){var c=this;this.expander.open?this.hideExpander(!0):this.getExpanderDom().hide(),this.getExpanderDom().children().detach(),this.getExpanderDom().html(a),this.getExpanderDom().stop(!0).show(),c.expander.open=!0},hideExpander:function(a){this.expander.open&&(this.getExpanderDom().stop(!0).hide(),this.expander.open=!1)},addButton:function(a,b,c,d){var e=this;require(["forms/button"],function(f){var g=new f(a,c,b);e.buttons.push(g),g.clickOnSubmit=d,e.onReady().done(function(){e.buttonsDom.prepend(g.render())})})},throwError:function(a){return console.error(a),!1},formSubmitted:function(a){a.preventDefault();for(var b=0,c=this.buttons.length;c>b;b++)this.buttons[b].clickOnSubmit&&this.buttons[b].doClick()}}),e}),define("modules/module",["jquery","lodash","src/util/context","src/util/api","src/util/util","src/util/fullscreen","src/util/debug","src/main/variables","src/util/ui","version","forms/form","src/main/grid"],function(a,b,c,d,e,f,g,h,i,j,k){function l(b){var c=String(b.definition.getChildSync(["url"],!0).get()),d=e.rewriteRequirePath(c);return"/"!==d[d.length-1]&&(d+="/"),b.viewReady=new Promise(function(a,c){b._resolveView=a}),b.controllerReady=new Promise(function(a,c){b._resolveController=a}),b.modelReady=new Promise(function(a,c){b._resolveModel=a}),b._onReady=Promise.all([b.viewReady,b.controllerReady,b.modelReady]),b._onReady.then(function(){b.updateAllView()},function(a){g.error("Caught error in module ready state",a)}).catch(function(a){g.error("Caught error while updating module",a)}),new Promise(function(f,g){return d?(j.includedModuleCss.indexOf(e.moduleIdFromUrl(c))>-1?b._cssLoaded=Promise.resolve():b._cssLoaded=e.loadCss(d+"style.css"),void require([d+"model",d+"view",d+"controller"],function(c,d,e){b.model=new c,b.view=new d,b.controller=new e,b.controller.moduleInformation&&(b.dom=a(b.buildDom()),b.bindToolbar(),b.domContent=b.dom.children().children(".ci-module-content"),b.domHeader=b.dom.children().children(".ci-module-header"),b.domLoading=b.dom.children().children(".ci-module-loading"),b.domWrapper=b.dom,b.view.setModule(b),b.controller.setModule(b),b.model.setModule(b),b.view.initDefault(),b.view.init(),b.controller.init(),b.model.init(),f(b))},function(a){return g(a)})):void g()})}function m(a,b){for(var c,d=b.length,e=0;d>e;e++)if(c=b[e],"string"==typeof c)a=a[c];else{if(e===d-1){if(a.options){if("table"===a.options.type){var f=n(a.fields);return a.options.multiple&&(f=[f]),f}return o(a)}return o(a)}a.fields&&(a=a.fields)}}function n(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=o(a[c]));return b}function o(a){switch(a.type){case"checkbox":var b=[];for(var c in a.options)b.push(c);return b;case"color":case"spectrum":return[0,0,0,1];case"combo":var d=a.options[0];return d=d?d.key:"",a.extractValue&&(d=a.extractValue(d)),d;case"float":return a.default||0;case"jscode":case"text":case"textarea":case"wysiwyg":return a.default||"";case"slider":case"textstyle":default:return g.error("Unknow field type: "+a.type),a.default||""}}var p=function(a){this.definition=DataObject.recursiveTransform(a),this.definition.configuration=this.definition.configuration||new DataObject,this.definition.layers=this.definition.layers||new DataObject,this.ready=l(this),this.ready.catch(function(a){g.error("Caught error in module initialization.",a)})};return p.prototype={buildDom:function(){var a="";return a+='<div class="ci-module-wrapper ci-module-displaywrapper ci-module-',a+=this.controller.moduleInformation.cssClass,a+='" data-module-id="',a+=this.definition.id,a+='"',a+=' style="z-index: ',a+=this.definition.zindex||0,a+='"',a+='><div class="ci-module"><div class="ci-module-header',a+='"><div class="ci-module-header-title">',a+=this.definition.title,a+="</div>",a+='<div class="ci-module-header-toolbar">',a+="<ul>",a+="</ul>",a+="</div>",a+='</div><div class="ci-module-content">',a+="</div>",a+='<div class="ci-module-loading">Loading ...</div>',a+="</div>"},drawToolbar:function(){for(var a=d.isViewLocked(),b=this.dom.find(".ci-module-header-toolbar ul"),c=this.controller.getToolbar(),e="",f=0;f<c.length;f++)!c[f].ifLocked&&a||(e+='<li title="'+(c[f].title||"")+'">',c[f].icon&&(e+='<img src="'+c[f].icon+'"/>'),c[f].cssClass&&(e+='<span style="color: rgba(170, 170, 170, 0.9);" class="'+c[f].cssClass+'"/>'),e+="</li>");b.html(e)},bindToolbar:function(){var c=this;this.dom.find(".ci-module-header-toolbar ul").on("click","li",function(d){var e=c.controller.getToolbar(),f=a(d.target).parent("li").attr("title"),g=b.find(e,function(a){return a.title===f});g&&g.onClick&&g.onClick.apply(c)})},onReady:function(){return this._onReady},updateView:function(a){this.onReady().then(function(){var b=d.getVariable(this.getNameFromRel(a));b&&this.view.update&&this.view.update[a]&&this.view.update[a].call(this.view,b[1],b[0][0])},function(a){g.error("Error during view update",a)})},updateAllView:function(){if(this.view.update&&this.definition)for(var a=this.vars_in(),b=0;b<a.length;b++){var c=d.getVar(a[b].name);c.isDefined()&&this.model.onVarChange(c)}},getDomContent:function(){if("undefined"!=typeof this.domContent)return this.domContent;throw"The module has not been loaded yet"},getDomWrapper:function(){if("undefined"!=typeof this.domWrapper)return this.domWrapper;throw"The module has not been loaded yet"},getDomView:function(){if("function"==typeof this.view.getDom)return this.view.getDom();throw"The module's view doest not implement the getDom function"},getDomHeader:function(){if("undefined"!=typeof this.domHeader)return this.domHeader;throw"The module has not been loaded yet"},getAcceptedTypes:function(a){var b=this.controller.references;return b?b[a]:!1},getDataFromRel:function(a){if(this.model&&this.model.data){var b=this.model.data[a];return b?b[Object.keys(b)[0]]:!1}},getVariableFromRel:function(a){var b=this.getNameFromRel(a);return d.getVar(b)},getNameFromRel:function(a){for(var b=this.vars_in(),c=0;c<b.length;c++)if(b[c].rel==a)return b[c].name;return!1},getData:function(){return this.model.data},getDataRelFromName:function(a){for(var b=this.vars_in(),c=[],d=0;d<b.length;d++)b[d].name==a&&c.push(b[d].rel);return c},getActionRelFromName:function(a){for(var b=this.actions_in(),c=0;c<b.length;c++)if(b[c].name==a)return b[c].rel;return!1},inDom:function(){this.drawToolbar(),this.view.inDom(),this.controller.inDom(),this.model.inDom();var a=this;d.isViewLocked()||c.listen(this.getDomWrapper().get(0),[['<li name="fullscreen"><a><span class="ui-icon ui-icon-arrow-4-diag"></span> Fullscreen</a></li>',function(){a.enableFullscreen()}],['<li name="export"><a><span class="ui-icon ui-icon-suitcase"></span> Export</a></li>',function(){a.exportData()}],['<li name="config-example"><a><span class="ui-icon ui-icon-suitcase"></span> Config example</a></li>',function(){a.exportConfigExample();
}],['<li name="print"><a><span class="ui-icon ui-icon-print"></span> Print</a></li>',function(){a.printView()}],['<li name="configuration"><a><span class="ui-icon ui-icon-gear"></span> Parameters</a></li>',function(){a.doConfig()}]])},enableFullscreen:function(){f.requestFullscreen(this)},toggleLayer:function(a,b){var c;if(c=this.getLayer(a)){if(!c.display)return void this.hide();this.show(),this.setTitle(c.title),this.setDisplayWrapper(c.wrapper),this.setBackgroundColor(c.bgColor||[255,255,255,1]),this.activeLayerName=a;var d=require("src/main/grid");return d.setModuleSize(this),d.moduleResize(this),c}},eachLayer:function(a){for(var b in this.definition.layers)a(this.definition.layers[b],b)},setLayers:function(b,c,d,e,f){if(this.definition.layers=this.definition.layers||new DataObject,d)d.remove?delete this.definition.layers[d.remove]:d.rename&&(this.definition.layers[d.rename.new]=this.definition.layers[d.rename.old],delete this.definition.layers[d.rename.old]);else for(var g in b)this.definition.layers[g]||(this.definition.layers[g]=new DataObject,c?(a.extend(!0,this.definition.layers[g],p.prototype.emptyConfig),this.definition.layers[g].name=g,g!==f&&(this.definition.layers[g].display=!1)):(a.extend(!0,this.definition.layers[g],this.getLayer(this.getActiveLayerName())),e&&(this.definition.layers[g].display=!1)),this.definition.layers[g]=this.definition.layers[g].duplicate())},getActiveLayerName:function(){return this.activeLayerName},getLayer:function(a){return a?this.definition.layers[a]:!1},hide:function(){this.getDomWrapper().hide()},show:function(){this.getDomWrapper().show()},doConfig:function(b){function c(a){if(a){var b=[];if(Array.isArray(a))for(var d=0;d<a.length;d++)b.push({key:a[d].file||"",title:a[d].name,children:c(a[d].children)});return b}}function f(a,b){if(!q[a])return{};var c;switch(b){case"event":c=q[a].refVariable||[];break;case"action":c=q[a].refAction||[]}for(var d=[],e=0;e<c.length;e++)d.push({key:c[e],title:p[c[e]].label});return d}var g,j,l,m,n=this,o=i.dialog({autoPosition:!0,noHeader:!0,width:"80%"}),p=this.controller.references,q=this.controller.events,r=d.getAllFilters();m=c(r);var s=[];for(l=h.getNames(),g=0;g<l.length;g++)s.push({title:l[g],label:l[g]});var t=[];for(l=d.getRepositoryActions().getKeys(),g=0;g<l.length;g++)t.push({title:l[g],label:l[g]});var u=n.controller.variablesIn,v=[];for(g=0,j=u.length;j>g;g++)p[u[g]]&&v.push({key:u[g],title:p[u[g]].label});var w=[];for(g in p)w[g]=n.model.getjPath(g);var x=[],y=[];for(g in q)q[g].refVariable&&x.push({title:q[g].label,key:g}),q[g].refAction&&y.push({title:q[g].label,key:g});var z=this.controller.actionsIn||{},A=[];for(g in z)A.push({title:z[g],key:g});var B={};n.eachLayer(function(a,b){B[b]=b});var C=new k({});C.init({onValueChanged:function(a){}});var D={sections:{module_infos:{options:{title:"Module informations",icon:"info_rhombus"},groups:{group:{options:{type:"text"}}}},module_config:{options:{title:"General configuration",icon:"page_white_paint"},groups:{layerDisplay:{options:{title:"Display on layers",type:"list"},fields:{displayOn:{type:"checkbox",title:"Display on layers",options:B}}},commonToolbar:{options:{title:"Common toolbar options",type:"list"},fields:{toolbar:{type:"checkbox",title:"Common toolbar options",options:{"Open Preferences":"Open Preferences","Show fullscreen":"Show fullscreen","Export Data":"Export Data",Print:"Print"},default:["Open Preferences"]}}},customToolbar:{options:{title:"Custom toolbar options",type:"table",multiple:!0},fields:{title:{type:"text",title:"Title",default:""},icon:{title:"Icon",type:"text",default:""},action:{title:"Action",type:"text",default:""},position:{title:"Position",type:"combo",options:[{key:"begin",title:"Begin"},{key:"end",title:"End"}],default:"begin"}}}},sections:{layer:{options:{title:"Shown on layers"},groups:{group:{options:{type:"list",multiple:!0,title:!0},fields:{layerName:{type:"text",multiple:!1,title:"Layer name",displayed:!1},moduletitle:{type:"text",multiple:!1,title:"Module title"},bgcolor:{type:"spectrum",multiple:!1,title:"Background color"},modulewrapper:{type:"checkbox",title:"Module boundaries",options:{display:""}}}}}}}}}},E=n.controller.configurationStructure();E&&(D.sections.module_specific_config=a.extend(E,{options:{title:"Module configuration",icon:"page_white_wrench"}})),v.length>0&&(D.sections.vars_in={options:{title:"Variables in",icon:"basket_put"},groups:{group:{options:{type:"table",multiple:!0},fields:{rel:{type:"combo",title:"Reference",options:v},name:{type:"text",title:"From variable",options:s},filter:{type:"combo",title:"Filter variable",options:m}}}}}),x.length>0&&(D.sections.vars_out={options:{title:"Variables out",icon:"basket_remove"},groups:{group:{options:{type:"table",multiple:!0},fields:{event:{type:"combo",title:"Event",options:x},rel:{type:"combo",title:"Reference"},jpath:{type:"combo",title:"jPath",options:{},extractValue:e.jpathToArray,insertValue:e.jpathToString},filter:{type:"combo",title:"Filter variable",options:m},name:{type:"text",title:"To variable"}}}}}),A.length>0&&(D.sections.actions_in={options:{title:"Actions in",icon:"door_in"},groups:{group:{options:{type:"table",multiple:!0},fields:{rel:{type:"combo",title:"Reference",options:A},name:{type:"text",title:"Action name",options:t}}}}}),y.length>0&&(D.sections.actions_out={options:{title:"Actions out",icon:"door_out"},groups:{group:{options:{type:"table",multiple:!0},fields:{event:{type:"combo",title:"On event",options:y},rel:{type:"combo",title:"Reference"},jpath:{type:"combo",title:"jPath",options:{},extractValue:e.jpathToArray,insertValue:e.jpathToString},name:{type:"text",title:"Action name"}}}}}),C.setStructure(D),C.onStructureLoaded().done(function(){C.getSection("vars_out")&&(C.getSection("vars_out").getGroup("group").getField("event").options.onChange=function(b){b.groupElement&&a.when(b.groupElement.getFieldElementCorrespondingTo(b,"rel")).then(function(a){a&&a.setOptions(f(b.value,"event"))})},C.getSection("vars_out").getGroup("group").getField("rel").options.onChange=function(b){b.groupElement&&a.when(b.groupElement.getFieldElementCorrespondingTo(b,"jpath")).then(function(a){a&&a.setOptions(w[b.value])})}),C.getSection("actions_out")&&(C.getSection("actions_out").getGroup("group").getField("event").options.onChange=function(b){b.groupElement&&a.when(b.groupElement.getFieldElementCorrespondingTo(b,"rel")).then(function(a){a&&a.setOptions(f(b.value,"action"))})},C.getSection("actions_out").getGroup("group").getField("rel").options.onChange=function(b){b.groupElement&&a.when(b.groupElement.getFieldElementCorrespondingTo(b,"jpath")).then(function(a){a&&a.setOptions(w[b.value])})});var b='<table class="moduleInformation"><tr><td>Module name</td><td>'+n.controller.moduleInformation.name+"</td></tr><tr><td></td><td><small>"+n.controller.moduleInformation.description+"</small></td></tr><tr><td>Module author</td><td>"+n.controller.moduleInformation.author+"</td></tr><tr><td>Creation date</td><td>"+n.controller.moduleInformation.date+"</td></tr><tr><td>Released under</td><td>"+n.controller.moduleInformation.license+"</td></tr></table>",c=[],d=[];if(n.definition.toolbar)var e=n.definition.toolbar.common,g=n.definition.toolbar.custom;n.eachLayer(function(a,b){a.display&&d.push(b),c.push({_title:b,layerName:[b],moduletitle:[a.title],bgcolor:[a.bgColor||[255,255,255,0]],modulewrapper:[a.wrapper===!0||void 0===a.wrapper?"display":""]})});var h={sections:{module_config:[{groups:{layerDisplay:[{displayOn:[d]}],commonToolbar:e,customToolbar:g},sections:{layer:[{groups:{group:c}}]}}],module_infos:[{groups:{group:[b]}}],module_specific_config:[n.definition.configuration||{}],vars_out:[{groups:{group:[n.vars_out()]}}],vars_in:[{groups:{group:[n.vars_in()]}}],actions_in:[{groups:{group:[n.actions_in()]}}],actions_out:[{groups:{group:[n.actions_out()]}}]}};C.fill(h)}),C.addButton("Cancel",{color:"blue"},function(){o.dialog("close")}),C.addButton("Save",{color:"green"},function(){var a=C.getValue().sections;n.definition.layers=n.definition.layers||{};for(var b=a.module_config[0].sections.layer[0].groups.group,c=a.module_config[0].groups.layerDisplay[0].displayOn[0],d=0,e=b.length;e>d;d++)n.definition.layers[b[d].layerName[0]].display=c.indexOf(b[d].layerName[0])>-1,n.definition.layers[b[d].layerName[0]].title=b[d].moduletitle[0],n.definition.layers[b[d].layerName[0]].bgColor=b[d].bgcolor[0],n.definition.layers[b[d].layerName[0]].wrapper=b[d].modulewrapper[0].indexOf("display")>-1;n.definition.toolbar={},n.definition.toolbar.custom=a.module_config[0].groups.customToolbar,n.definition.toolbar.common=a.module_config[0].groups.commonToolbar,a.vars_out&&n.setSendVars(a.vars_out[0].groups.group[0]),a.vars_in&&n.setSourceVars(a.vars_in[0].groups.group[0]),a.actions_in&&n.setActionsIn(a.actions_in[0].groups.group[0]),a.actions_out&&n.setActionsOut(a.actions_out[0].groups.group[0]),a.module_specific_config&&(n.definition.configuration=a.module_specific_config[0]),n.reload(),o.dialog("close")}),C.onLoaded().done(function(){o.html(C.makeDom(1,b||2)),C.inDom()})},resetReady:function(){var a=this;a.viewReady=new Promise(function(b){a._resolveView=b}),a.controllerReady=new Promise(function(b){a._resolveController=b}),a._onReady=Promise.all([a.viewReady,a.controllerReady])},getConfiguration:function(a,b){var c,d=this.definition.configuration,e=this.controller.configAliases[a];if(e){for(var f=0,h=e.length;h>f;f++)if(d=d[e[f]],"undefined"==typeof d){c=this._getConfigurationDefault(e,a);break}}else g.warn("Alias "+a+" not defined ");return void 0==c&&(c=this._doConfigurationFunction(d,a)),void 0==c&&(c=b),c},getConfigurationCheckbox:function(a,b){var c=this.getConfiguration(a);return Array.isArray(c)?c.indexOf(b)>-1:!1},_getConfigurationDefault:function(a,b){this._cfgStructure=this._cfgStructure||this.controller.configurationStructure();for(var c=this._cfgStructure,d=0,e=a.length;e>d;d++)if("number"!=typeof a[d])if(c.fields)d--,c=c.fields;else if(c=c[a[d]],!c)return g.warn("Error in configuration file - Alias is not a correct jPath"),!1;return this._doConfigurationFunction(c.default,b)},_doConfigurationFunction:function(a,b){if(this.controller.configFunctions[b])try{return this.controller.configFunctions[b](a)}catch(b){return a}return a},getValue:function(){return"function"==typeof this.model.getValue?this.model.getValue():void 0},getPosition:function(a){var b=this.getLayer(a);return b.position},getSize:function(a){var b=this.getLayer(a);return b.size},getWidthPx:function(){return this.getDomContent().innerWidth()},getHeightPx:function(){return this.getDomContent().innerHeight()},getId:function(){return DataObject.resurrect(this.definition.id)},setId:function(a){this.definition.set("id",a)},setSourceVars:function(a){this.definition.set("vars_in",a,!0)},setSendVars:function(a){this.definition.set("vars_out",a,!0)},setActionsIn:function(a){this.definition.set("actions_in",a,!0)},setActionsOut:function(a){this.definition.set("actions_out",a,!0)},vars_in:function(){return!this.definition.vars_in&&this.definition.dataSource&&(this.definition.vars_in=this.definition.dataSource,delete this.definition.dataSource),this.definition.vars_in=this.definition.vars_in||new DataArray,this.definition.vars_in.filter(function(a){return a?!(!a.name||!a.rel):!1})},vars_out:function(){return!this.definition.vars_out&&this.definition.dataSend&&(this.definition.vars_out=this.definition.dataSend,delete this.definition.dataSend),this.definition.vars_out=this.definition.vars_out||new DataArray},actions_in:function(){return!this.definition.actions_in&&this.definition.actionsIn&&(this.definition.actions_in=this.definition.actionsIn,delete this.definition.actionsIn),this.definition.actions_in=this.definition.actions_in||new DataArray},actions_out:function(){return!this.definition.actions_out&&this.definition.actionsOut&&(this.definition.actions_out=this.definition.actionsOut,delete this.definition.actionsOut),this.definition.actions_out=this.definition.actions_out||new DataArray},getDefinition:function(){return this.definition},getTitle:function(){return this.definition.title},setTitle:function(a){this.definition.set("title",a),this.domHeader.find(".ci-module-header-title").text(a)},exportData:function(){var a=this;i.dialog('<div class="ci-module-export"><textarea></textarea></div>',{title:"Export data from module "+a.getTitle(),width:"70%",height:500,noWrap:!0}).children("textarea").text(a.controller.export())},printView:function(){var a=this.controller.print(),b=window.open("","","");b.document.write(a),b.document.close(),b.focus()},setBackgroundColor:function(a){this.domContent.get(0).style.backgroundColor="rgba("+a.join(",")+")"},setDisplayWrapper:function(a){this.getDomWrapper()[a===!0||void 0==a?"addClass":"removeClass"]("ci-module-displaywrapper");try{this.getDomWrapper().resizable(a===!0||void 0==a?"enable":"disable")}catch(a){}},blankVariable:function(a){for(var b=this.getDataRelFromName(a),c=0;c<b.length;c++)this.view.blank[b[c]]?this.view.blank[b[c]].call(this.view,a):e.warnOnce("missing-blank-"+this.controller.moduleInformation.name+"_"+b[c],"Module "+this.controller.moduleInformation.name+": no blank method defined for rel "+b[c])},startLoading:function(a){for(var b=this.getDataRelFromName(a),c=0;c<b.length;c++)this.view.startLoading(b[c])},endLoading:function(a){for(var b=this.getDataRelFromName(a),c=0;c<b.length;c++)this.view.endLoading(b[c])},get emptyConfig(){return new DataObject({position:{left:0,top:0},size:{width:20,height:20},zIndex:0,display:!0,title:"",bgColor:[255,255,255,0],wrapper:!0,created:!0})},reload:function(){this.view.unload&&this.view.unload(),this.resetReady(),this.controller.init(),this.view.init(),this.drawToolbar(),this.view.inDom(),this.toggleLayer(this.getActiveLayerName()),this.model.resetListeners(),this.updateAllView()},getConfigExample:function(){var a=this.controller.configAliases,b=this.controller.configurationStructure(),c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=m(b,a[d]));return c},exportConfigExample:function(){var a=this;i.dialog('<div class="ci-module-export"><textarea></textarea></div>',{title:"Config example",width:"70%",height:500,noWrap:!0}).children("textarea").text(JSON.stringify(a.getConfigExample(),null,4))}},p});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("modules/modulefactory",["jquery","modules/module","src/util/debug","src/util/util"],function(a,b,c,d){function e(b){return new Promise(function(d){var f={folders:{}};a.getJSON(require.toUrl(b+"/folder.json")).then(function(a){if(f.name=a.name,f.modules=a.modules,a.folders&&Array.isArray(a.folders)){for(var g=[],h=0;h<a.folders.length;h++)g.push(e(b+"/"+a.folders[h]));Promise.all(g).then(function(a){for(var b=0;b<a.length;b++){var c=a[b];f.folders[c.name]=c}d(f)},function(a){c.error("Caught error in ModuleFactory",a)})}else"object"===_typeof(a.folders)&&(f.folders=a.folders),d(f)})})}var f=0,g=[],h=new DataArray,i={};return{getTypes:function(){return i},traverseModules:function(a,b){b=b||i;var c;if(b.modules)for(c=0;c<b.modules.length;c++)a(b.modules[c]);if(b.folders)for(var d in b.folders)this.traverseModules(a,b.folders[d])},setModules:function(b){var f=this,g=[];if(Array.isArray(b))throw new Error('Module configuration error : list of folders must be defined in a "folders" array.');if(Array.isArray(b.folders)){var h=i;b.modules&&(h.modules=b.modules),h.folders=h.folders||{};for(var j=0;j<b.folders.length;j++)if("object"===_typeof(b.folders[j])){var k=b.folders[j];a.extend(!0,h.folders,k.folders)}else g.push(e(b.folders[j]).then(function(b){a.extend(!0,h,b)},function(a){c.error("Caught error in ModuleFactory",a)}));i=h}else i=b;return Promise.all(g).then(function(){f.traverseModules(function(a){var b;(b=d.moduleIdFromUrl(a.url))&&(a.id=b),a.url=a.url.replace(/\/$/,"")+"/"})})},newModule:function(a){var d=new b(a);return d.setId(++f),g.push(d),h.push(a),d.ready.catch(function(){c.error("Initialization of module failed")}),d},removeModule:function(a){g.splice(g.indexOf(a),1),h.splice(h.indexOf(a.definition),1)},empty:function(){h=new DataArray,g=[]},getModules:function(){return g},getDefinitions:function(){return h},getModulesById:function(){var a={};return this.traverseModules(function(b){a[b.id]=b}),a}}}),!function(){function a(a){return a&&(a.ownerDocument||a.document||a).documentElement}function b(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}function c(a,b){return b>a?-1:a>b?1:a>=b?0:NaN}function d(a){return null===a?NaN:+a}function e(a){return!isNaN(a)}function f(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function g(a){return a.length}function h(a){for(var b=1;a*b%1;)b*=10;return b}function i(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function j(){this._=Object.create(null)}function k(a){return(a+="")===sg||a[0]===tg?tg+a:a}function l(a){return(a+="")[0]===tg?a.slice(1):a}function m(a){return k(a)in this._}function n(a){return(a=k(a))in this._&&delete this._[a]}function o(){var a=[];for(var b in this._)a.push(l(b));return a}function p(){var a=0;for(var b in this._)++a;return a}function q(){for(var a in this._)return!1;return!0}function r(){this._=Object.create(null)}function s(a){return a}function t(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function u(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(var c=0,d=ug.length;d>c;++c){var e=ug[c]+b;if(e in a)return e}}function v(){}function w(){}function x(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new j;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function y(){hg.event.preventDefault()}function z(){for(var a,b=hg.event;a=b.sourceEvent;)b=a;return b}function A(a){for(var b=new w,c=0,d=arguments.length;++c<d;)b[arguments[c]]=x(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=hg.event;e.target=a,hg.event=e,b[e.type].apply(c,d)}finally{hg.event=f}}},b}function B(a){return wg(a,Ag),a}function C(a){return"function"==typeof a?a:function(){return xg(a,this)}}function D(a){return"function"==typeof a?a:function(){return yg(a,this)}}function E(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=hg.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function F(a){return a.trim().replace(/\s+/g," ")}function G(a){return new RegExp("(?:^|\\s+)"+hg.requote(a)+"(?:\\s+|$)","g")}function H(a){return(a+"").trim().split(/^|\s+/)}function I(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=H(a).map(J);var e=a.length;return"function"==typeof b?d:c}function J(a){var b=G(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",F(e+" "+a))):c.setAttribute("class",F(e.replace(b," ")))}}function K(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function L(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function M(a){function b(){var b=this.ownerDocument,c=this.namespaceURI;return c===Bg&&b.documentElement.namespaceURI===Bg?b.createElement(a):b.createElementNS(c,a)}function c(){return this.ownerDocument.createElementNS(a.space,a.local)}return"function"==typeof a?a:(a=hg.ns.qualify(a)).local?c:b}function N(){var a=this.parentNode;a&&a.removeChild(this)}function O(a){return{__data__:a}}function P(a){return function(){return zg(this,a)}}function Q(a){return arguments.length||(a=c),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function R(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,f=a[c],g=0,h=f.length;h>g;g++)(e=f[g])&&b(e,g,c);return a}function S(a){return wg(a,Dg),a}function T(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function U(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,jg(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+hg.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=V;h>0&&(a=a.slice(0,h));var j=Eg.get(a);return j&&(a=j,i=W),h?b?e:d:b?v:f}function V(a,b){return function(c){var d=hg.event;hg.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{hg.event=d}}}function W(a,b){var c=V(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function X(c){var d=".dragsuppress-"+ ++Gg,e="click"+d,f=hg.select(b(c)).on("touchmove"+d,y).on("dragstart"+d,y).on("selectstart"+d,y);if(null==Fg&&(Fg="onselectstart"in c?!1:u(c.style,"userSelect")),Fg){var g=a(c).style,h=g[Fg];g[Fg]="none"}return function(a){if(f.on(d,null),Fg&&(g[Fg]=h),a){var b=function(){f.on(e,null)};f.on(e,function(){y(),b()},!0),setTimeout(b,0)}}}function Y(a,c){c.changedTouches&&(c=c.changedTouches[0]);var d=a.ownerSVGElement||a;if(d.createSVGPoint){var e=d.createSVGPoint();if(0>Hg){var f=b(a);if(f.scrollX||f.scrollY){d=hg.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var g=d[0][0].getScreenCTM();Hg=!(g.f||g.e),d.remove()}}return Hg?(e.x=c.pageX,e.y=c.pageY):(e.x=c.clientX,e.y=c.clientY),e=e.matrixTransform(a.getScreenCTM().inverse()),[e.x,e.y]}var h=a.getBoundingClientRect();return[c.clientX-h.left-a.clientLeft,c.clientY-h.top-a.clientTop]}function Z(){return hg.event.changedTouches[0].identifier}function $(a){return a>0?1:0>a?-1:0}function _(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function aa(a){return a>1?0:-1>a?Kg:Math.acos(a)}function ba(a){return a>1?Ng:-1>a?-Ng:Math.asin(a)}function ca(a){return((a=Math.exp(a))-1/a)/2}function da(a){return((a=Math.exp(a))+1/a)/2}function ea(a){return((a=Math.exp(2*a))-1)/(a+1)}function fa(a){return(a=Math.sin(a/2))*a}function ga(){}function ha(a,b,c){return this instanceof ha?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof ha?new ha(a.h,a.s,a.l):va(""+a,wa,ha):new ha(a,b,c)}function ia(a,b,c){function d(a){return a>360?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:0>b?0:b>1?1:b,c=0>c?0:c>1?1:c,g=.5>=c?c*(1+b):c+b-c*b,f=2*c-g,new ra(e(a+120),e(a),e(a-120))}function ja(a,b,c){return this instanceof ja?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof ja?new ja(a.h,a.c,a.l):a instanceof la?na(a.l,a.a,a.b):na((a=xa((a=hg.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new ja(a,b,c)}function ka(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new la(c,Math.cos(a*=Og)*b,Math.sin(a)*b)}function la(a,b,c){return this instanceof la?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof la?new la(a.l,a.a,a.b):a instanceof ja?ka(a.h,a.c,a.l):xa((a=ra(a)).r,a.g,a.b):new la(a,b,c)}function ma(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=oa(e)*Zg,d=oa(d)*$g,f=oa(f)*_g,new ra(qa(3.2404542*e-1.5371385*d-.4985314*f),qa(-.969266*e+1.8760108*d+.041556*f),qa(.0556434*e-.2040259*d+1.0572252*f))}function na(a,b,c){return a>0?new ja(Math.atan2(c,b)*Pg,Math.sqrt(b*b+c*c),a):new ja(NaN,NaN,a)}function oa(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function pa(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function qa(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function ra(a,b,c){return this instanceof ra?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof ra?new ra(a.r,a.g,a.b):va(""+a,ra,ia):new ra(a,b,c)}function sa(a){return new ra(a>>16,a>>8&255,255&a)}function ta(a){return sa(a)+""}function ua(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function va(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/.exec(a=a.toLowerCase()))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(za(e[0]),za(e[1]),za(e[2]))}return(f=ch.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.slice(1),16))||(4===a.length?(g=(3840&f)>>4,g=g>>4|g,h=240&f,h=h>>4|h,i=15&f,i=i<<4|i):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function wa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=.5>i?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(c>b?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&1>i?0:d),new ha(d,e,i)}function xa(a,b,c){a=ya(a),b=ya(b),c=ya(c);var d=pa((.4124564*a+.3575761*b+.1804375*c)/Zg),e=pa((.2126729*a+.7151522*b+.072175*c)/$g),f=pa((.0193339*a+.119192*b+.9503041*c)/_g);return la(116*e-16,500*(d-e),200*(e-f))}function ya(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function za(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function Aa(a){return"function"==typeof a?a:function(){return a}}function Ba(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),Ca(b,c,a,d)}}function Ca(a,b,c,d){function e(){var a,b=i.status;if(!b&&Ea(i)||b>=200&&300>b||304===b){try{a=c.call(f,i)}catch(a){return void g.error.call(f,a)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=hg.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!this.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=hg.event;hg.event=a;try{g.progress.call(f,i)}finally{hg.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(jg(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},hg.rebind(f,g,"on"),null==d?f:f.get(Da(d))}function Da(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Ea(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}function Fa(a,b,c){var d=arguments.length;2>d&&(b=0),3>d&&(c=Date.now());var e=c+b,f={c:a,t:e,n:null};return eh?eh.n=f:dh=f,eh=f,fh||(gh=clearTimeout(gh),fh=1,hh(Ga)),f}function Ga(){var a=Ha(),b=Ia()-a;b>24?(isFinite(b)&&(clearTimeout(gh),gh=setTimeout(Ga,b)),fh=0):(fh=1,hh(Ga))}function Ha(){for(var a=Date.now(),b=dh;b;)a>=b.t&&b.c(a-b.t)&&(b.c=null),b=b.n;return a}function Ia(){for(var a,b=dh,c=1/0;b;)b.c?(b.t<c&&(c=b.t),b=(a=b).n):b=a?a.n=b.n:dh=b.n;return eh=a,c}function Ja(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Ka(a,b){var c=Math.pow(10,3*rg(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function La(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d&&c?function(a,b){for(var e=a.length,f=[],g=0,h=d[0],i=0;e>0&&h>0&&(i+h+1>b&&(h=Math.max(1,b-i)),f.push(a.substring(e-=h,e+h)),!((i+=h+1)>b));)h=d[g=(g+1)%d.length];return f.reverse().join(c)}:s;return function(a){var c=jh.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"-",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1,s=!0;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="="),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":s=!1;case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):("e"==n||"f"==n)&&(m=Math.max(0,Math.min(20,m)))),n=kh.get(n)||Ma;var t=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=0>a||0===a&&0>1/a?(a=-a,"-"):"-"===h?"":h;if(0>o){var i=hg.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var u,v,w=a.lastIndexOf(".");if(0>w){var x=s?a.lastIndexOf("e"):-1;0>x?(u=a,v=""):(u=a.substring(0,x),v=a.substring(x))}else u=a.substring(0,w),v=b+a.substring(w+1);!j&&l&&(u=f(u,1/0));var y=p.length+u.length+v.length+(t?0:e.length),z=k>y?new Array(y=k-y+1).join(d):"";return t&&(u=f(z+u,z.length?k-v.length:1/0)),e+=p,a=u+v,("<"===g?e+a+z:">"===g?z+e+a:"^"===g?z.substring(0,y>>=1)+e+a+z.substring(y):e+(t?a:z+a))+c}}}function Ma(a){return a+""}function Na(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Oa(a,b,c){function d(b){var c=a(b),d=f(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new mh(c-1)),1),c}function f(a,c){return b(a=new mh(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;d>g;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;d>g;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{mh=Na;var d=new Na;return d._=a,g(d,b,c)}finally{mh=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Pa(a);return i.floor=i,i.round=Pa(d),i.ceil=Pa(e),i.offset=Pa(f),i.range=h,a}function Pa(a){return function(b,c){try{mh=Na;var d=new Na;return d._=b,a(d,c)._}finally{mh=Date}}}function Qa(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=oh[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.slice(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=c(d,a,b,0);if(e!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var f=null!=d.Z&&mh!==Na,g=new(f?Na:mh);return"j"in d?g.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),g.setFullYear(d.y,0,1),g.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(g.getDay()+5)%7:d.w+7*d.U-(g.getDay()+6)%7)):g.setFullYear(d.y,d.m,d.d),g.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),f?g._:g},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;i>h;){if(d>=j)return-1;if(e=b.charCodeAt(h++),37===e){if(g=b.charAt(h++),f=D[g in oh?b.charAt(h++):g],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.slice(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.slice(c));
return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.slice(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.slice(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.slice(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{mh=Na;var b=new mh;return b._=a,d(b)}finally{mh=Date}}var d=b(a);return c.parse=function(a){try{mh=Na;var b=d.parse(a);return b&&b._}finally{mh=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=ib;var t=hg.map(),u=Sa(p),v=Ta(p),w=Sa(q),x=Ta(q),y=Sa(r),z=Ta(r),A=Sa(s),B=Ta(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Ra(a.getDate(),b,2)},e:function(a,b){return Ra(a.getDate(),b,2)},H:function(a,b){return Ra(a.getHours(),b,2)},I:function(a,b){return Ra(a.getHours()%12||12,b,2)},j:function(a,b){return Ra(1+lh.dayOfYear(a),b,3)},L:function(a,b){return Ra(a.getMilliseconds(),b,3)},m:function(a,b){return Ra(a.getMonth()+1,b,2)},M:function(a,b){return Ra(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Ra(a.getSeconds(),b,2)},U:function(a,b){return Ra(lh.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Ra(lh.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Ra(a.getFullYear()%100,b,2)},Y:function(a,b){return Ra(a.getFullYear()%1e4,b,4)},Z:gb,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:ab,e:ab,H:cb,I:cb,j:bb,L:fb,m:_a,M:db,p:k,S:eb,U:Va,w:Ua,W:Wa,x:i,X:j,y:Ya,Y:Xa,Z:Za,"%":hb};return b}function Ra(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function Sa(a){return new RegExp("^(?:"+a.map(hg.requote).join("|")+")","i")}function Ta(a){for(var b=new j,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Ua(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Va(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function Wa(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function Xa(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Ya(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.y=$a(+d[0]),c+d[0].length):-1}function Za(a,b,c){return/^[+-]\d{4}$/.test(b=b.slice(c,c+5))?(a.Z=-b,c+5):-1}function $a(a){return a+(a>68?1900:2e3)}function _a(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function ab(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function bb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function cb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function db(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function eb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function fb(a,b,c){ph.lastIndex=0;var d=ph.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function gb(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=rg(b)/60|0,e=rg(b)%60;return c+Ra(d,"0",2)+Ra(e,"0",2)}function hb(a,b,c){qh.lastIndex=0;var d=qh.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function ib(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function jb(){}function kb(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function lb(a,b){a&&uh.hasOwnProperty(a.type)&&uh[a.type](a,b)}function mb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function nb(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)mb(a[c],b,1);b.polygonEnd()}function ob(){function a(a,b){a*=Og,b=b*Og/2+Kg/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);wh.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;xh.point=function(g,h){xh.point=a,d=(b=g)*Og,e=Math.cos(h=(c=h)*Og/2+Kg/4),f=Math.sin(h)},xh.lineEnd=function(){a(b,c)}}function pb(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function qb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function rb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function sb(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function tb(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function ub(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function vb(a){return[Math.atan2(a[1],a[0]),ba(a[2])]}function wb(a,b){return rg(a[0]-b[0])<Ig&&rg(a[1]-b[1])<Ig}function xb(a,b){a*=Og;var c=Math.cos(b*=Og);yb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function yb(a,b,c){++yh,Ah+=(a-Ah)/yh,Bh+=(b-Bh)/yh,Ch+=(c-Ch)/yh}function zb(){function a(a,e){a*=Og;var f=Math.cos(e*=Og),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);zh+=j,Dh+=j*(b+(b=g)),Eh+=j*(c+(c=h)),Fh+=j*(d+(d=i)),yb(b,c,d)}var b,c,d;Jh.point=function(e,f){e*=Og;var g=Math.cos(f*=Og);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),Jh.point=a,yb(b,c,d)}}function Ab(){Jh.point=xb}function Bb(){function a(a,b){a*=Og;var c=Math.cos(b*=Og),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-aa(n)/m,p=Math.atan2(m,n);Gh+=o*j,Hh+=o*k,Ih+=o*l,zh+=p,Dh+=p*(d+(d=g)),Eh+=p*(e+(e=h)),Fh+=p*(f+(f=i)),yb(d,e,f)}var b,c,d,e,f;Jh.point=function(g,h){b=g,c=h,Jh.point=a,g*=Og;var i=Math.cos(h*=Og);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),yb(d,e,f)},Jh.lineEnd=function(){a(b,c),Jh.lineEnd=Ab,Jh.point=xb}}function Cb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return c=b.invert(c,d),c&&a.invert(c[0],c[1])}),c}function Db(){return!0}function Eb(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(wb(c,d)){e.lineStart();for(var h=0;b>h;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Gb(c,a,null,!0),j=new Gb(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Gb(d,a,null,!1),j=new Gb(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),Fb(f),Fb(g),f.length){for(var h=0,i=c,j=g.length;j>h;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;j>h;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function Fb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Gb(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Hb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){a=c[0];var e,d=a.length-1,g=-1;if(d>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Ib))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=hg.merge(n);var a=Ob(r,o);n.length?(v||(f.polygonStart(),v=!0),Eb(n,Kb,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Jb(),u=b(t),v=!1;return s}}function Ib(a){return a.length>1}function Jb(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:v,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Kb(a,b){return((a=a.x)[0]<0?a[1]-Ng-Ig:Ng-a[1])-((b=b.x)[0]<0?b[1]-Ng-Ig:Ng-b[1])}function Lb(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?Kg:-Kg,i=rg(f-c);rg(i-Kg)<Ig?(a.point(c,d=(d+g)/2>0?Ng:-Ng),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=Kg&&(rg(c-e)<Ig&&(c-=e*Ig),rg(f-h)<Ig&&(f-=h*Ig),d=Mb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function Mb(a,b,c,d){var e,f,g=Math.sin(a-c);return rg(g)>Ig?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Nb(a,b,c,d){var e;if(null==a)e=c*Ng,d.point(-Kg,e),d.point(0,e),d.point(Kg,e),d.point(Kg,0),d.point(Kg,-e),d.point(0,-e),d.point(-Kg,-e),d.point(-Kg,0),d.point(-Kg,e);else if(rg(a[0]-b[0])>Ig){var f=a[0]<b[0]?Kg:-Kg;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Ob(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;wh.reset();for(var h=0,i=b.length;i>h;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+Kg/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+Kg/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>Kg,z=o*t;if(wh.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*Lg:v,y^m>=c^r>=c){var A=rb(pb(l),pb(a));ub(A);var B=rb(e,A);ub(B);var C=(y^v>=0?-1:1)*ba(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(-Ig>f||Ig>f&&0>wh)^1&g}function Pb(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(0>l?Kg:-Kg),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(wb(c,n)||wb(o,n))&&(o[0]+=Ig,o[1]+=Ig,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&wb(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=pb(a),e=pb(b),g=[1,0,0],h=rb(d,e),i=qb(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=rb(g,h),o=tb(g,l),p=tb(h,m);sb(o,p);var q=n,r=qb(o,q),s=qb(q,q),t=r*r-s*(qb(o,o)-1);if(!(0>t)){var u=Math.sqrt(t),v=tb(q,(-r-u)/s);if(sb(v,o),v=vb(v),!c)return v;var w,x=a[0],y=b[0],z=a[1],A=b[1];x>y&&(w=x,x=y,y=w);var B=y-x,C=rg(B-Kg)<Ig,D=C||Ig>B;if(!C&&z>A&&(w=z,z=A,A=w),D?C?z+A>0^v[1]<(rg(v[0]-x)<Ig?z:A):z<=v[1]&&v[1]<=A:B>Kg^(x<=v[0]&&v[0]<=y)){var E=tb(q,(-r+u)/s);return sb(E,o),[v,vb(E)]}}}function e(b,c){var d=g?a:Kg-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=rg(f)>Ig,i=oc(a,6*Og);return Hb(b,c,i,g?[0,-a]:[-Kg,a-Kg])}function Qb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Rb(a,b,c,d){function e(d,e){return rg(d[0]-a)<Ig?e>0?0:3:rg(d[0]-c)<Ig?e>0?2:1:rg(d[1]-b)<Ig?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;c>e;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];i>g;++g)f=h[g],j[1]<=d?f[1]>d&&_(j,f,a)>0&&++b:f[1]<=d&&_(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0)do j.point(0===k||3===k?a:c,k>1?d:b);while((k=(k+i+4)%4)!==l);else j.point(h[0],h[1])}function k(e,f){return e>=a&&c>=e&&f>=b&&d>=f}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=NaN}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-Lh,Math.min(Lh,a)),b=Math.max(-Lh,Math.min(Lh,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Jb(),C=Qb(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=hg.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&Eb(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Sb(a){var b=0,c=Kg/3,d=gc(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*Kg/180,c=a[1]*Kg/180):[b/Kg*180,c/Kg*180]},e}function Tb(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,ba((f-(a*a+c*c)*e*e)/(2*e))]},c}function Ub(){function a(a,b){Nh+=e*a-d*b,d=a,e=b}var b,c,d,e;Sh.point=function(f,g){Sh.point=a,b=d=f,c=e=g},Sh.lineEnd=function(){a(b,c)}}function Vb(a,b){Oh>a&&(Oh=a),a>Qh&&(Qh=a),Ph>b&&(Ph=b),b>Rh&&(Rh=b)}function Wb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Xb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Xb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Xb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Yb(a,b){Ah+=a,Bh+=b,++Ch}function Zb(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);Dh+=g*(b+a)/2,Eh+=g*(c+d)/2,Fh+=g,Yb(b=a,c=d)}var b,c;Uh.point=function(d,e){Uh.point=a,Yb(b=d,c=e)}}function $b(){Uh.point=Yb}function _b(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);Dh+=g*(d+a)/2,Eh+=g*(e+b)/2,Fh+=g,g=e*a-d*b,Gh+=g*(d+a),Hh+=g*(e+b),Ih+=3*g,Yb(d=a,e=b)}var b,c,d,e;Uh.point=function(f,g){Uh.point=a,Yb(b=d=f,c=e=g)},Uh.lineEnd=function(){a(b,c)}}function ac(a){function b(b,c){a.moveTo(b+g,c),a.arc(b,c,g,0,Lg)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:v};return h}function bc(a){function b(a){return(h?d:c)(a)}function c(b){return ec(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=pb([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=rg(rg(x)-1)<Ig||rg(d-m)<Ig?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||rg((s*E+t*F)/u-.5)>.3||g>h*n+i*o+j*p)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Og),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function cc(a){var b=bc(function(b,c){return a([b*Pg,c*Pg])});return function(a){return hc(b(a))}}function dc(a){this.stream=a}function ec(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function fc(a){return gc(function(){return a})()}function gc(a){function b(a){return a=h(a[0]*Og,a[1]*Og),[a[0]*m+i,j-a[1]*m]}function c(a){return a=h.invert((a[0]-i)/m,(j-a[1])/m),a&&[a[0]*Pg,a[1]*Pg]}function d(){h=Cb(g=kc(r,t,u),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=bc(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,t=0,u=0,v=Kh,w=s,x=null,y=null;return b.stream=function(a){return k&&(k.valid=!1),k=hc(v(g,l(w(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(v=null==a?(x=a,Kh):Pb((x=+a)*Og),e()):x},b.clipExtent=function(a){return arguments.length?(y=a,w=a?Rb(a[0][0],a[0][1],a[1][0],a[1][1]):s,e()):y},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Og,q=a[1]%360*Og,d()):[p*Pg,q*Pg]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Og,t=a[1]%360*Og,u=a.length>2?a[2]%360*Og:0,d()):[r*Pg,t*Pg,u*Pg]},hg.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function hc(a){return ec(a,function(b,c){a.point(b*Og,c*Og)})}function ic(a,b){return[a,b]}function jc(a,b){return[a>Kg?a-Lg:-Kg>a?a+Lg:a,b]}function kc(a,b,c){return a?b||c?Cb(mc(a),nc(b,c)):mc(a):b||c?nc(b,c):jc}function lc(a){return function(b,c){return b+=a,[b>Kg?b-Lg:-Kg>b?b+Lg:b,c]}}function mc(a){var b=lc(a);return b.invert=lc(-a),b}function nc(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),ba(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),ba(k*d-h*e)]},c}function oc(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=pc(c,e),f=pc(c,f),(g>0?f>e:e>f)&&(e+=g*Lg)):(e=a+g*Lg,f=a-.5*i);for(var j,k=e;g>0?k>f:f>k;k-=i)h.point((j=vb([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function pc(a,b){var c=pb(b);c[0]-=a,ub(c);var d=aa(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-Ig)%(2*Math.PI)}function qc(a,b,c){var d=hg.range(a,b-Ig,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function rc(a,b,c){var d=hg.range(a,b-Ig,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function sc(a){return a.source}function tc(a){return a.target}function uc(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(fa(d-b)+e*g*fa(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Pg,Math.atan2(g,Math.sqrt(d*d+e*e))*Pg]}:function(){return[a*Pg,b*Pg]};return o.distance=m,o}function vc(){function a(a,e){var f=Math.sin(e*=Og),g=Math.cos(e),h=rg((a*=Og)-b),i=Math.cos(h);Vh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Wh.point=function(e,f){b=e*Og,c=Math.sin(f*=Og),d=Math.cos(f),Wh.point=a},Wh.lineEnd=function(){Wh.point=Wh.lineEnd=v}}function wc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function xc(a,b){function c(a,b){g>0?-Ng+Ig>b&&(b=-Ng+Ig):b>Ng-Ig&&(b=Ng-Ig);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(Kg/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=$(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Ng]},c):zc}function yc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return rg(e)<Ig?ic:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-$(e)*Math.sqrt(a*a+c*c)]},c)}function zc(a,b){return[a,Math.log(Math.tan(Kg/4+b/2))]}function Ac(a){var b,c=fc(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=Kg*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function Bc(a,b){return[Math.log(Math.tan(Kg/4+b/2)),-a]}function Cc(a){return a[0]}function Dc(a){return a[1]}function Ec(a){for(var b=a.length,c=[0,1],d=2,e=2;b>e;e++){for(;d>1&&_(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Fc(a,b){return a[0]-b[0]||a[1]-b[1]}function Gc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Hc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Ic(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Jc(){cd(this),this.edge=this.site=this.circle=null}function Kc(a){var b=gi.pop()||new Jc;return b.site=a,b}function Lc(a){Vc(a),di.remove(a),gi.push(a),cd(a)}function Mc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Lc(a);for(var i=f;i.circle&&rg(c-i.circle.x)<Ig&&rg(d-i.circle.cy)<Ig;)f=i.P,h.unshift(i),Lc(i),i=f;h.unshift(i),Vc(i);for(var j=g;j.circle&&rg(c-j.circle.x)<Ig&&rg(d-j.circle.cy)<Ig;)g=j.N,h.push(j),Lc(j),j=g;h.push(j),Vc(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],_c(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Zc(i.site,j.site,null,e),Uc(i),Uc(j)}function Nc(a){for(var b,c,d,e,f=a.x,g=a.y,h=di._;h;)if(d=Oc(h,g)-f,d>Ig)h=h.L;else{if(e=f-Pc(h,g),!(e>Ig)){d>-Ig?(b=h.P,c=h):e>-Ig?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Kc(a);if(di.insert(b,i),b||c){if(b===c)return Vc(b),c=Kc(b.site),di.insert(i,c),i.edge=c.edge=Zc(b.site,i.site),Uc(b),void Uc(c);if(!c)return void(i.edge=Zc(b.site,i.site));Vc(b),Vc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};_c(c.edge,j,o,u),i.edge=Zc(j,a,null,u),c.edge=Zc(a,o,null,u),Uc(b),Uc(c)}}function Oc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Pc(a,b){var c=a.N;if(c)return Oc(c,b);var d=a.site;return d.y===b?d.x:1/0}function Qc(a){this.site=a,this.edges=[]}function Rc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=ci,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(rg(d-b)>Ig||rg(e-c)>Ig)&&(h.splice(g,0,new ad($c(f.site,k,rg(d-l)<Ig&&o-e>Ig?{x:l,y:rg(b-l)<Ig?c:o}:rg(e-o)<Ig&&m-d>Ig?{x:rg(c-o)<Ig?b:m,y:o}:rg(d-m)<Ig&&e-n>Ig?{x:m,y:rg(b-m)<Ig?c:n}:rg(e-n)<Ig&&d-l>Ig?{x:rg(c-n)<Ig?b:l,y:n}:null),f.site,null)),++i)}function Sc(a,b){return b.angle-a.angle}function Tc(){cd(this),this.x=this.y=this.arc=this.site=this.cy=null}function Uc(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Jg)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=hi.pop()||new Tc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=fi._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}fi.insert(s,r),s||(ei=r)}}}}function Vc(a){var b=a.circle;b&&(b.P||(ei=b.N),fi.remove(b),hi.push(b),cd(b),a.circle=null)}function Wc(a){for(var b,c=bi,d=Qb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Xc(b,a)||!d(b)||rg(b.a.x-b.b.x)<Ig&&rg(b.a.y-b.b.y)<Ig)&&(b.a=b.b=null,c.splice(e,1))}function Xc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Yc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Zc(a,b,c,d){var e=new Yc(a,b);return bi.push(e),c&&_c(e,a,b,c),d&&_c(e,b,a,d),ci[a.i].edges.push(new ad(e,a,b)),ci[b.i].edges.push(new ad(e,b,a)),e}function $c(a,b,c){var d=new Yc(a,null);return d.a=b,d.b=c,bi.push(d),d}function _c(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function ad(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function bd(){this._=null}function cd(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function dd(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function ed(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function fd(a){for(;a.L;)a=a.L;return a}function gd(a,b){var c,d,e,f=a.sort(hd).pop();for(bi=[],ci=new Array(a.length),di=new bd,fi=new bd;;)if(e=ei,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))(f.x!==c||f.y!==d)&&(ci[f.i]=new Qc(f),Nc(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Mc(e.arc)}b&&(Wc(b),Rc(b));var g={cells:ci,edges:bi};return di=fi=bi=ci=null,g}function hd(a,b){return b.y-a.y||b.x-a.x}function id(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function jd(a){return a.x}function kd(a){return a.y}function ld(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function md(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&md(a,i[0],c,d,g,h),i[1]&&md(a,i[1],g,d,e,h),i[2]&&md(a,i[2],c,h,g,f),i[3]&&md(a,i[3],g,h,e,f)}}function nd(a,b,c,d,e,f,g){var h,i=1/0;return function a(j,k,l,m,n){if(!(k>f||l>g||d>m||e>n)){if(o=j.point){var o,p=b-j.x,q=c-j.y,r=p*p+q*q;if(i>r){var s=Math.sqrt(i=r);d=b-s,e=c-s,f=b+s,g=c+s,h=o}}for(var t=j.nodes,u=.5*(k+m),v=.5*(l+n),w=b>=u,x=c>=v,y=x<<1|w,z=y+4;z>y;++y)if(j=t[3&y])switch(3&y){case 0:a(j,k,l,u,v);break;case 1:a(j,u,l,m,v);break;case 2:a(j,k,v,u,n);break;case 3:a(j,u,v,m,n)}}}(a,d,e,f,g),h}function od(a,b){a=hg.rgb(a),b=hg.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+ua(Math.round(c+f*a))+ua(Math.round(d+g*a))+ua(Math.round(e+h*a))}}function pd(a,b){var c,d={},e={};for(c in a)c in b?d[c]=sd(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function qd(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function rd(a,b){var c,d,e,f=ji.lastIndex=ki.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=ji.exec(a))&&(d=ki.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:qd(c,d)})),f=ki.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;b>d;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function sd(a,b){for(var c,d=hg.interpolators.length;--d>=0&&!(c=hg.interpolators[d](a,b)););return c}function td(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(sd(a[c],b[c]));for(;f>c;++c)e[c]=a[c];for(;g>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function ud(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function vd(a){return function(b){return 1-a(1-b)}}function wd(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function xd(a){return a*a}function yd(a){return a*a*a}function zd(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function Ad(a){return function(b){return Math.pow(b,a)}}function Bd(a){return 1-Math.cos(a*Ng)}function Cd(a){return Math.pow(2,10*(a-1))}function Dd(a){return 1-Math.sqrt(1-a*a)}function Ed(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/Lg*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Lg/b)}}function Fd(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Gd(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Hd(a,b){a=hg.hcl(a),b=hg.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ka(c+f*a,d+g*a,e+h*a)+""}}function Id(a,b){a=hg.hsl(a),b=hg.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ia(c+f*a,d+g*a,e+h*a)+""}}function Jd(a,b){a=hg.lab(a),b=hg.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ma(c+f*a,d+g*a,e+h*a)+""}}function Kd(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Ld(a){var b=[a.a,a.b],c=[a.c,a.d],d=Nd(b),e=Md(b,c),f=Nd(Od(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Pg,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Pg:0}function Md(a,b){return a[0]*b[0]+a[1]*b[1]}function Nd(a){var b=Math.sqrt(Md(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Od(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Pd(a){return a.length?a.pop()+",":""}function Qd(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push("translate(",null,",",null,")");d.push({i:e-4,x:qd(a[0],b[0])},{i:e-2,x:qd(a[1],b[1])})}else(b[0]||b[1])&&c.push("translate("+b+")")}function Rd(a,b,c,d){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),d.push({i:c.push(Pd(c)+"rotate(",null,")")-2,x:qd(a,b)})):b&&c.push(Pd(c)+"rotate("+b+")")}function Sd(a,b,c,d){a!==b?d.push({i:c.push(Pd(c)+"skewX(",null,")")-2,x:qd(a,b)}):b&&c.push(Pd(c)+"skewX("+b+")");
}function Td(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push(Pd(c)+"scale(",null,",",null,")");d.push({i:e-4,x:qd(a[0],b[0])},{i:e-2,x:qd(a[1],b[1])})}else(1!==b[0]||1!==b[1])&&c.push(Pd(c)+"scale("+b+")")}function Ud(a,b){var c=[],d=[];return a=hg.transform(a),b=hg.transform(b),Qd(a.translate,b.translate,c,d),Rd(a.rotate,b.rotate,c,d),Sd(a.skew,b.skew,c,d),Td(a.scale,b.scale,c,d),a=b=null,function(a){for(var b,e=-1,f=d.length;++e<f;)c[(b=d[e]).i]=b.x(a);return c.join("")}}function Vd(a,b){return b=(b-=a=+a)||1/b,function(c){return(c-a)/b}}function Wd(a,b){return b=(b-=a=+a)||1/b,function(c){return Math.max(0,Math.min(1,(c-a)/b))}}function Xd(a){for(var b=a.source,c=a.target,d=Zd(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Yd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Zd(a,b){if(a===b)return a;for(var c=Yd(a),d=Yd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function $d(a){a.fixed|=2}function _d(a){a.fixed&=-7}function ae(a){a.fixed|=4,a.px=a.x,a.py=a.y}function be(a){a.fixed&=-5}function ce(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],null!=f&&(ce(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function de(a,b){return hg.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=je,a}function ee(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function fe(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function ge(a){return a.children}function he(a){return a.value}function ie(a,b){return b.value-a.value}function je(a){return hg.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function ke(a){return a.x}function le(a){return a.y}function me(a,b,c){a.y0=b,a.y=c}function ne(a){return hg.range(a.length)}function oe(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function pe(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;f>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function qe(a){return a.reduce(re,0)}function re(a,b){return a+b[1]}function se(a,b){return te(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function te(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function ue(a){return[hg.min(a),hg.max(a)]}function ve(a,b){return a.value-b.value}function we(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function xe(a,b){a._pack_next=b,b._pack_prev=a}function ye(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function ze(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-(1/0),m=1/0,n=-(1/0);if(c.forEach(Ae),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],De(d,e,f),b(f),we(d,f),d._pack_prev=f,we(f,e),e=d._pack_next,g=3;j>g;g++){De(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(ye(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!ye(i,f);i=i._pack_prev,q++);o?(q>p||p==q&&e.r<d.r?xe(d,e=h):xe(d=i,e),g--):(we(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;j>g;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(Be)}}function Ae(a){a._pack_next=a._pack_prev=a}function Be(a){delete a._pack_next,delete a._pack_prev}function Ce(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)Ce(e[f],b,c,d)}function De(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function Ee(a,b){return a.parent==b.parent?1:2}function Fe(a){var b=a.children;return b.length?b[0]:a.t}function Ge(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function He(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function Ie(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f],b.z+=c,b.m+=c,c+=b.s+(d+=b.c)}function Je(a,b,c){return a.a.parent===b.parent?a.a:c}function Ke(a){return 1+hg.max(a,function(a){return a.y})}function Le(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Me(a){var b=a.children;return b&&b.length?Me(b[0]):a}function Ne(a){var b,c=a.children;return c&&(b=c.length)?Ne(c[b-1]):a}function Oe(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Pe(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>f&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Qe(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function Re(a){return a.rangeExtent?a.rangeExtent():Qe(a.range())}function Se(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Te(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Ue(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:vi}function Ve(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=hg.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function We(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Ve:Se,i=d?Wd:Vd;return g=e(a,b,i,c),h=e(b,a,i,sd),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Kd)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return $e(a,b)},f.tickFormat=function(b,c){return _e(a,b,c)},f.nice=function(b){return Ye(a,b),e()},f.copy=function(){return We(a,b,c,d)},e()}function Xe(a,b){return hg.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Ye(a,b){return Te(a,Ue(Ze(a,b)[2])),Te(a,Ue(Ze(a,b)[2])),a}function Ze(a,b){null==b&&(b=10);var c=Qe(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return.15>=f?e*=10:.35>=f?e*=5:.75>=f&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function $e(a,b){return hg.range.apply(hg,Ze(a,b))}function _e(a,b,c){var d=Ze(a,b);if(c){var e=jh.exec(c);if(e.shift(),"s"===e[8]){var f=hg.formatPrefix(Math.max(rg(d[0]),rg(d[1])));return e[7]||(e[7]="."+af(f.scale(d[2]))),e[8]="f",c=hg.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+bf(e[8],d)),c=e.join("")}else c=",."+af(d[2])+"f";return hg.format(c)}function af(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function bf(a,b){var c=af(b[2]);return a in wi?Math.abs(c-af(Math.max(rg(b[0]),rg(b[1]))))+ +("e"!==a):c-2*("%"===a)}function cf(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Te(d.map(e),c?Math:yi);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Qe(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;k>j;j++)for(var m=1;l>m;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,c){if(!arguments.length)return xi;arguments.length<2?c=xi:"function"!=typeof c&&(c=hg.format(c));var d=Math.max(1,b*a/g.ticks().length);return function(a){var g=a/f(Math.round(e(a)));return b-.5>g*b&&(g*=b),d>=g?c(a):""}},g.copy=function(){return cf(a.copy(),b,c,d)},Xe(g,a)}function df(a,b,c){function d(b){return a(e(b))}var e=ef(b),f=ef(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return $e(c,a)},d.tickFormat=function(a,b){return _e(c,a,b)},d.nice=function(a){return d.domain(Ye(c,a))},d.exponent=function(g){return arguments.length?(e=ef(b=g),f=ef(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return df(a.copy(),b,c)},Xe(d,a)}function ef(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function ff(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):NaN))-1)%f.length]}function d(b,c){return hg.range(a.length).map(function(a){return b+c*a})}var e,f,g;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new j;for(var f,g=-1,h=d.length;++g<h;)e.has(f=d[g])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,g=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=(i+j)/2,0):(j-i)/(a.length-1+h);return f=d(i+k*h/2,k),g=0,b={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=j=Math.round((i+j)/2),0):(j-i)/(a.length-1+h)|0;return f=d(i+Math.round(k*h/2+(j-i-(a.length-1+h)*k)/2),k),g=0,b={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-h+2*i);return f=d(k+m*i,m),j&&f.reverse(),g=m*(1-h),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-h+2*i));return f=d(k+Math.round((l-k-(a.length-h)*m)/2),m),j&&f.reverse(),g=Math.round(m*(1-h)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return g},c.rangeExtent=function(){return Qe(b.a[0])},c.copy=function(){return ff(a,b)},c.domain(a)}function gf(a,b){function f(){var c=0,d=b.length;for(h=[];++c<d;)h[c-1]=hg.quantile(a,c/d);return g}function g(a){return isNaN(a=+a)?void 0:b[hg.bisect(h,a)]}var h;return g.domain=function(b){return arguments.length?(a=b.map(d).filter(e).sort(c),f()):a},g.range=function(a){return arguments.length?(b=a,f()):b},g.quantiles=function(){return h},g.invertExtent=function(c){return c=b.indexOf(c),0>c?[NaN,NaN]:[c>0?h[c-1]:a[0],c<h.length?h[c]:a[a.length-1]]},g.copy=function(){return gf(a,b)},f()}function hf(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return hf(a,b,c)},e()}function jf(a,b){function c(c){return c>=c?b[hg.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return jf(a,b)},c}function kf(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return $e(a,b)},b.tickFormat=function(b,c){return _e(a,b,c)},b.copy=function(){return kf(a)},b}function lf(){return 0}function mf(a){return a.innerRadius}function nf(a){return a.outerRadius}function of(a){return a.startAngle}function pf(a){return a.endAngle}function qf(a){return a&&a.padAngle}function rf(a,b,c,d){return(a-c)*b-(b-d)*a>0?0:1}function sf(a,b,c,d,e){var f=a[0]-b[0],g=a[1]-b[1],h=(e?d:-d)/Math.sqrt(f*f+g*g),i=h*g,j=-h*f,k=a[0]+i,l=a[1]+j,m=b[0]+i,n=b[1]+j,o=(k+m)/2,p=(l+n)/2,q=m-k,r=n-l,s=q*q+r*r,t=c-d,u=k*n-m*l,v=(0>r?-1:1)*Math.sqrt(Math.max(0,t*t*s-u*u)),w=(u*r-q*v)/s,x=(-u*q-r*v)/s,y=(u*r+q*v)/s,z=(-u*q+r*v)/s,A=w-o,B=x-p,C=y-o,D=z-p;return A*A+B*B>C*C+D*D&&(w=y,x=z),[[w-i,x-j],[w*c/t,x*c/t]]}function tf(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=Aa(c),o=Aa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=Cc,d=Dc,e=Db,f=uf,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=Ei.get(a)||uf).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function uf(a){return a.length>1?a.join("L"):a+"Z"}function vf(a){return a.join("L")+"Z"}function wf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function xf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function yf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function zf(a,b){return a.length<4?uf(a):a[1]+Cf(a.slice(1,-1),Df(a,b))}function Af(a,b){return a.length<3?vf(a):a[0]+Cf((a.push(a[0]),a),Df([a[a.length-2]].concat(a,[a[1]]),b))}function Bf(a,b){return a.length<3?uf(a):a[0]+Cf(a,Df(a,b))}function Cf(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return uf(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function Df(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function Ef(a){if(a.length<3)return uf(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",If(Hi,g),",",If(Hi,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Jf(i,g,h);return a.pop(),i.push("L",d),i.join("")}function Ff(a){if(a.length<4)return uf(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(If(Hi,f)+","+If(Hi,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Jf(c,f,g);return c.join("")}function Gf(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[If(Hi,g),",",If(Hi,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Jf(b,g,h);return b.join("")}function Hf(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return Ef(a)}function If(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Jf(a,b,c){a.push("C",If(Fi,b),",",If(Fi,c),",",If(Gi,b),",",If(Gi,c),",",If(Hi,b),",",If(Hi,c))}function Kf(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Lf(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Kf(e,f);++b<c;)d[b]=(g+(g=Kf(e=f,f=a[b+1])))/2;return d[b]=g,d}function Mf(a){for(var b,c,d,e,f=[],g=Lf(a),h=-1,i=a.length-1;++h<i;)b=Kf(a[h],a[h+1]),rg(b)<Ig?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,e=c*c+d*d,e>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function Nf(a){return a.length<3?uf(a):a[0]+Cf(a,Mf(a))}function Of(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]-Ng,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Pf(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=Aa(c),v=Aa(e),w=c===d?function(){return n}:Aa(d),x=e===f?function(){return o}:Aa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=Cc,d=Cc,e=0,f=Dc,g=Db,h=uf,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=Ei.get(a)||uf).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Qf(a){return a.radius}function Rf(a){return[a.x,a.y]}function Sf(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]-Ng;return[c*Math.cos(d),c*Math.sin(d)]}}function Tf(){return 64}function Uf(){return"circle"}function Vf(a){var b=Math.sqrt(a/Kg);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Wf(a){return function(){var b,c,d;(b=this[a])&&(d=b[c=b.active])&&(d.timer.c=null,d.timer.t=NaN,--b.count?delete b[c]:delete this[a],b.active+=.5,d.event&&d.event.interrupt.call(this,this.__data__,d.index))}}function Xf(a,b,c){return wg(a,Oi),a.namespace=b,a.id=c,a}function Yf(a,b,c,d){var e=a.id,f=a.namespace;return R(a,"function"==typeof c?function(a,g,h){a[f][e].tween.set(b,d(c.call(a,a.__data__,g,h)))}:(c=d(c),function(a){a[f][e].tween.set(b,c)}))}function Zf(a){return null==a&&(a=""),function(){this.textContent=a}}function $f(a){return null==a?"__transition__":"__transition_"+a+"__"}function _f(a,b,c,d,e){function f(a){var b=p.delay;return k.t=b+i,a>=b?g(a-b):void(k.c=g)}function g(c){var e=o.active,f=o[e];f&&(f.timer.c=null,f.timer.t=NaN,--o.count,delete o[e],f.event&&f.event.interrupt.call(a,a.__data__,f.index));for(var g in o)if(d>+g){var j=o[g];j.timer.c=null,j.timer.t=NaN,--o.count,delete o[g]}k.c=h,Fa(function(){return k.c&&h(c||1)&&(k.c=null,k.t=NaN),1},0,i),o.active=d,p.event&&p.event.start.call(a,a.__data__,b),n=[],p.tween.forEach(function(c,d){(d=d.call(a,a.__data__,b))&&n.push(d)}),m=p.ease,l=p.duration}function h(e){for(var f=e/l,g=m(f),h=n.length;h>0;)n[--h].call(a,g);return f>=1?(p.event&&p.event.end.call(a,a.__data__,b),--o.count?delete o[d]:delete a[c],1):void 0}var i,k,l,m,n,o=a[c]||(a[c]={active:0,count:0}),p=o[d];p||(i=e.time,k=Fa(f,0,i),p=o[d]={tween:new j,time:i,timer:k,delay:e.delay,duration:e.duration,ease:e.ease,index:b},e=null,++o.count)}function ag(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function bg(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}function cg(a){return a.toISOString()}function dg(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=hg.bisect(Xi,e);return f==Xi.length?[b.year,Ze(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Xi[f-1]<Xi[f]/e?f-1:f]:[$i,Ze(a,c)[2]]}return d.invert=function(b){return eg(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(eg)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,eg(+c+1),b).length}var f=d.domain(),g=Qe(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Te(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=eg(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=eg(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Qe(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],eg(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return dg(a.copy(),b,c)},Xe(d,a)}function eg(a){return new Date(a)}function fg(a){return JSON.parse(a.responseText)}function gg(a){var b=kg.createRange();return b.selectNode(kg.body),b.createContextualFragment(a.responseText)}var hg={version:"3.5.16"},ig=[].slice,jg=function(a){return ig.call(a)},kg=this.document;if(kg)try{jg(kg.documentElement.childNodes)[0].nodeType}catch(a){jg=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}if(Date.now||(Date.now=function(){return+new Date}),kg)try{kg.createElement("DIV").style.setProperty("opacity",0,"")}catch(a){var lg=this.Element.prototype,mg=lg.setAttribute,ng=lg.setAttributeNS,og=this.CSSStyleDeclaration.prototype,pg=og.setProperty;lg.setAttribute=function(a,b){mg.call(this,a,b+"")},lg.setAttributeNS=function(a,b,c){ng.call(this,a,b,c+"")},og.setProperty=function(a,b,c){pg.call(this,a,b+"",c)}}hg.ascending=c,hg.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:NaN},hg.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},hg.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},hg.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g;)if(null!=(d=b.call(a,a[f],f))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},hg.sum=function(a,b){var c,d=0,f=a.length,g=-1;if(1===arguments.length)for(;++g<f;)e(c=+a[g])&&(d+=c);else for(;++g<f;)e(c=+b.call(a,a[g],g))&&(d+=c);return d},hg.mean=function(a,b){var c,f=0,g=a.length,h=-1,i=g;if(1===arguments.length)for(;++h<g;)e(c=d(a[h]))?f+=c:--i;else for(;++h<g;)e(c=d(b.call(a,a[h],h)))?f+=c:--i;return i?f/i:void 0},hg.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},hg.median=function(a,b){var f,g=[],h=a.length,i=-1;if(1===arguments.length)for(;++i<h;)e(f=d(a[i]))&&g.push(f);else for(;++i<h;)e(f=d(b.call(a,a[i],i)))&&g.push(f);return g.length?hg.quantile(g.sort(c),.5):void 0},hg.variance=function(a,b){var c,f,g=a.length,h=0,i=0,j=-1,k=0;if(1===arguments.length)for(;++j<g;)e(c=d(a[j]))&&(f=c-h,h+=f/++k,i+=f*(c-h));else for(;++j<g;)e(c=d(b.call(a,a[j],j)))&&(f=c-h,h+=f/++k,i+=f*(c-h));return k>1?i/(k-1):void 0},hg.deviation=function(){var a=hg.variance.apply(this,arguments);return a?Math.sqrt(a):a};var qg=f(c);hg.bisectLeft=qg.left,hg.bisect=hg.bisectRight=qg.right,hg.bisector=function(a){return f(1===a.length?function(b,d){return c(a(b),d)}:a)},hg.shuffle=function(a,b,c){(f=arguments.length)<3&&(c=a.length,2>f&&(b=0));for(var d,e,f=c-b;f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},hg.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},hg.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},hg.transpose=function(a){if(!(e=a.length))return[];for(var b=-1,c=hg.min(a,g),d=new Array(c);++b<c;)for(var e,f=-1,h=d[b]=new Array(e);++f<e;)h[f]=a[f][b];return d},hg.zip=function(){return hg.transpose(arguments)},hg.keys=function(a){var b=[];for(var c in a)b.push(c);return b},hg.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},hg.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},hg.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var rg=Math.abs;hg.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,e=[],f=h(rg(c)),g=-1;if(a*=f,b*=f,c*=f,0>c)for(;(d=a+c*++g)>b;)e.push(d/f);else for(;(d=a+c*++g)<b;)e.push(d/f);return e},hg.map=function(a,b){var c=new j;if(a instanceof j)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,f=a.length;if(1===arguments.length)for(;++e<f;)c.set(e,a[e]);else for(;++e<f;)c.set(b.call(a,d=a[e],e),d)}else for(var g in a)c.set(g,a[g]);return c};var sg="__proto__",tg="\x00";i(j,{has:m,get:function(a){return this._[k(a)]},set:function(a,b){return this._[k(a)]=b},remove:n,keys:o,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:l(b),value:this._[b]});return a},size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b),this._[b])}}),hg.nest=function(){function a(b,g,h){if(h>=f.length)return d?d.call(e,g):c?g.sort(c):g;for(var i,k,l,m,n=-1,o=g.length,p=f[h++],q=new j;++n<o;)(m=q.get(i=p(k=g[n])))?m.push(k):q.set(i,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,h))}):(k={},l=function(c,d){k[c]=a(b,d,h)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=g[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],g=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(hg.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return g[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},hg.set=function(a){var b=new r;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},i(r,{has:m,add:function(a){return this._[k(a+="")]=!0,a},remove:n,values:o,size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b))}}),hg.behavior={},hg.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=t(a,b,b[c]);return a};var ug=["webkit","ms","moz","Moz","o","O"];hg.dispatch=function(){for(var a=new w,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=x(a);return a},w.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.slice(c+1),a=a.slice(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},hg.event=null,hg.requote=function(a){return a.replace(vg,"\\$&")};var vg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,wg={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},xg=function(a,b){return b.querySelector(a)},yg=function(a,b){return b.querySelectorAll(a)},zg=function(a,b){var c=a.matches||a[u(a,"matchesSelector")];return(zg=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(xg=function(a,b){return Sizzle(a,b)[0]||null},yg=Sizzle,zg=Sizzle.matchesSelector),hg.selection=function(){return hg.select(kg.documentElement)};var Ag=hg.selection.prototype=[];Ag.select=function(a){var b,c,d,e,f=[];a=C(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return B(f)},Ag.selectAll=function(a){var b,c,d=[];a=D(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=jg(a.call(c,c.__data__,h,e))),b.parentNode=c);return B(d)};var Bg="http://www.w3.org/1999/xhtml",Cg={svg:"http://www.w3.org/2000/svg",xhtml:Bg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};hg.ns={prefix:Cg,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&"xmlns"!==(c=a.slice(0,b))&&(a=a.slice(b+1)),Cg.hasOwnProperty(c)?{space:Cg[c],local:a}:a}},Ag.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=hg.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(E(b,a[b]));return this}return this.each(E(a,b))},Ag.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=H(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!G(a[e]).test(b))return!1;return!0}for(b in a)this.each(I(b,a[b]));return this}return this.each(I(a,b))},Ag.style=function(a,c,d){var e=arguments.length;if(3>e){if("string"!=typeof a){2>e&&(c="");for(d in a)this.each(K(d,a[d],c));return this}if(2>e){var f=this.node();return b(f).getComputedStyle(f,null).getPropertyValue(a)}d=""}return this.each(K(a,c,d))},Ag.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(L(b,a[b]));return this}return this.each(L(a,b))},Ag.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},Ag.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},Ag.append=function(a){return a=M(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},Ag.insert=function(a,b){return a=M(a),b=C(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},Ag.remove=function(){return this.each(N)},Ag.data=function(a,b){function c(a,c){var d,e,f,g=a.length,l=c.length,m=Math.min(g,l),n=new Array(l),o=new Array(l),p=new Array(g);if(b){var q,r=new j,s=new Array(g);for(d=-1;++d<g;)(e=a[d])&&(r.has(q=b.call(e,e.__data__,d))?p[d]=e:r.set(q,e),s[d]=q);for(d=-1;++d<l;)(e=r.get(q=b.call(c,f=c[d],d)))?e!==!0&&(n[d]=e,e.__data__=f):o[d]=O(f),r.set(q,!0);for(d=-1;++d<g;)d in s&&r.get(s[d])!==!0&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=O(f);for(;l>d;++d)o[d]=O(c[d]);for(;g>d;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,h.push(o),i.push(n),k.push(p)}var d,e,f=-1,g=this.length;if(!arguments.length){for(a=new Array(g=(d=this[0]).length);++f<g;)(e=d[f])&&(a[f]=e.__data__);return a}var h=S([]),i=B([]),k=B([]);if("function"==typeof a)for(;++f<g;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<g;)c(d=this[f],a);return i.enter=function(){return h},i.exit=function(){return k},i},Ag.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},Ag.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return B(e)},Ag.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},Ag.sort=function(a){a=Q.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},Ag.each=function(a){return R(this,function(b,c,d){a.call(b,b.__data__,c,d)})},Ag.call=function(a){var b=jg(arguments);return a.apply(b[0]=this,b),this},Ag.empty=function(){return!this.node()},Ag.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var f=c[d];if(f)return f}return null},Ag.size=function(){var a=0;return R(this,function(){++a}),a};var Dg=[];hg.selection.enter=S,hg.selection.enter.prototype=Dg,Dg.append=Ag.append,Dg.empty=Ag.empty,Dg.node=Ag.node,Dg.call=Ag.call,Dg.size=Ag.size,
Dg.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return B(g)},Dg.insert=function(a,b){return arguments.length<2&&(b=T(this)),Ag.insert.call(this,a,b)},hg.select=function(b){var c;return"string"==typeof b?(c=[xg(b,kg)],c.parentNode=kg.documentElement):(c=[b],c.parentNode=a(b)),B([c])},hg.selectAll=function(a){var b;return"string"==typeof a?(b=jg(yg(a,kg)),b.parentNode=kg.documentElement):(b=jg(a),b.parentNode=null),B([b])},Ag.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(U(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(U(a,b,c))};var Eg=hg.map({mouseenter:"mouseover",mouseleave:"mouseout"});kg&&Eg.forEach(function(a){"on"+a in kg&&Eg.remove(a)});var Fg,Gg=0;hg.mouse=function(a){return Y(a,z())};var Hg=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;hg.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=z().changedTouches),b)for(var d,e=0,f=b.length;f>e;++e)if((d=b[e]).identifier===c)return Y(a,d)},hg.behavior.drag=function(){function a(){this.on("mousedown.drag",f).on("touchstart.drag",g)}function c(a,b,c,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o),n({type:"dragend"}))}var j,k=this,l=hg.event.target.correspondingElement||hg.event.target,m=k.parentNode,n=d.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=hg.select(c(l)).on(f+q,h).on(g+q,i),s=X(l),t=b(m,p);e?(j=e.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var d=A(a,"drag","dragstart","dragend"),e=null,f=c(v,hg.mouse,b,"mousemove","mouseup"),g=c(Z,hg.touch,s,"touchmove","touchend");return a.origin=function(b){return arguments.length?(e=b,a):e},hg.rebind(a,d,"on")},hg.touches=function(a,b){return arguments.length<2&&(b=z().touches),b?jg(b).map(function(b){var c=Y(a,b);return c.identifier=b.identifier,c}):[]};var Ig=1e-6,Jg=Ig*Ig,Kg=Math.PI,Lg=2*Kg,Mg=Lg-Ig,Ng=Kg/2,Og=Kg/180,Pg=180/Kg,Qg=Math.SQRT2,Rg=2,Sg=4;hg.interpolateZoom=function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(Jg>m)d=Math.log(j/g)/Qg,c=function(a){return[e+a*k,f+a*l,g*Math.exp(Qg*a*d)]};else{var n=Math.sqrt(m),o=(j*j-g*g+Sg*m)/(2*g*Rg*n),p=(j*j-g*g-Sg*m)/(2*j*Rg*n),q=Math.log(Math.sqrt(o*o+1)-o),r=Math.log(Math.sqrt(p*p+1)-p);d=(r-q)/Qg,c=function(a){var b=a*d,c=da(q),h=g/(Rg*n)*(c*ea(Qg*b+q)-ca(q));return[e+h*k,f+h*l,g*c/da(Qg*b+q)]}}return c.duration=1e3*d,c},hg.behavior.zoom=function(){function a(a){a.on(F,l).on(Ug+".zoom",n).on("dblclick.zoom",o).on(I,m)}function c(a){return[(a[0]-z.x)/z.k,(a[1]-z.y)/z.k]}function d(a){return[a[0]*z.k+z.x,a[1]*z.k+z.y]}function e(a){z.k=Math.max(C[0],Math.min(C[1],a))}function f(a,b){b=d(b),z.x+=a[0]-b[0],z.y+=a[1]-b[1]}function g(b,c,d,g){b.__chart__={x:z.x,y:z.y,k:z.k},e(Math.pow(2,g)),f(q=c,d),b=hg.select(b),D>0&&(b=b.transition().duration(D)),b.call(a.event)}function h(){v&&v.domain(u.range().map(function(a){return(a-z.x)/z.k}).map(u.invert)),x&&x.domain(w.range().map(function(a){return(a-z.y)/z.k}).map(w.invert))}function i(a){E++||a({type:"zoomstart"})}function j(a){h(),a({type:"zoom",scale:z.k,translate:[z.x,z.y]})}function k(a){--E||(a({type:"zoomend"}),q=null)}function l(){function a(){h=1,f(hg.mouse(e),m),j(g)}function d(){l.on(G,null).on(H,null),n(h),k(g)}var e=this,g=J.of(e,arguments),h=0,l=hg.select(b(e)).on(G,a).on(H,d),m=c(hg.mouse(e)),n=X(e);Ni.call(e),i(g)}function m(){function a(){var a=hg.touches(o);return n=z.k,a.forEach(function(a){a.identifier in q&&(q[a.identifier]=c(a))}),a}function b(){var b=hg.event.target;hg.select(b).on(u,d).on(v,h),w.push(b);for(var c=hg.event.changedTouches,e=0,f=c.length;f>e;++e)q[c[e].identifier]=null;var i=a(),j=Date.now();if(1===i.length){if(500>j-t){var k=i[0];g(o,k,q[k.identifier],Math.floor(Math.log(z.k)/Math.LN2)+1),y()}t=j}else if(i.length>1){var k=i[0],l=i[1],m=k[0]-l[0],n=k[1]-l[1];r=m*m+n*n}}function d(){var a,b,c,d,g=hg.touches(o);Ni.call(o);for(var h=0,i=g.length;i>h;++h,d=null)if(c=g[h],d=q[c.identifier]){if(b)break;a=c,b=d}if(d){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=r&&Math.sqrt(k/r);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+d[0])/2,(b[1]+d[1])/2],e(l*n)}t=null,f(a,b),j(p)}function h(){if(hg.event.touches.length){for(var b=hg.event.changedTouches,c=0,d=b.length;d>c;++c)delete q[b[c].identifier];for(var e in q)return void a()}hg.selectAll(w).on(s,null),x.on(F,l).on(I,m),A(),k(p)}var n,o=this,p=J.of(o,arguments),q={},r=0,s=".zoom-"+hg.event.changedTouches[0].identifier,u="touchmove"+s,v="touchend"+s,w=[],x=hg.select(o),A=X(o);b(),i(p),x.on(F,null).on(I,b)}function n(){var a=J.of(this,arguments);s?clearTimeout(s):(Ni.call(this),p=c(q=r||hg.mouse(this)),i(a)),s=setTimeout(function(){s=null,k(a)},50),y(),e(Math.pow(2,.002*Tg())*z.k),f(q,p),j(a)}function o(){var a=hg.mouse(this),b=Math.log(z.k)/Math.LN2;g(this,a,c(a),hg.event.shiftKey?Math.ceil(b)-1:Math.floor(b)+1)}var p,q,r,s,t,u,v,w,x,z={x:0,y:0,k:1},B=[960,500],C=Vg,D=250,E=0,F="mousedown.zoom",G="mousemove.zoom",H="mouseup.zoom",I="touchstart.zoom",J=A(a,"zoomstart","zoom","zoomend");return Ug||(Ug="onwheel"in kg?(Tg=function(){return-hg.event.deltaY*(hg.event.deltaMode?120:1)},"wheel"):"onmousewheel"in kg?(Tg=function(){return hg.event.wheelDelta},"mousewheel"):(Tg=function(){return-hg.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=J.of(this,arguments),b=z;Li?hg.select(this).transition().each("start.zoom",function(){z=this.__chart__||{x:0,y:0,k:1},i(a)}).tween("zoom:zoom",function(){var c=B[0],d=B[1],e=q?q[0]:c/2,f=q?q[1]:d/2,g=hg.interpolateZoom([(e-z.x)/z.k,(f-z.y)/z.k,c/z.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),h=c/d[2];this.__chart__=z={x:e-d[0]*h,y:f-d[1]*h,k:h},j(a)}}).each("interrupt.zoom",function(){k(a)}).each("end.zoom",function(){k(a)}):(this.__chart__=z,i(a),j(a),k(a))})},a.translate=function(b){return arguments.length?(z={x:+b[0],y:+b[1],k:z.k},h(),a):[z.x,z.y]},a.scale=function(b){return arguments.length?(z={x:z.x,y:z.y,k:null},e(+b),h(),a):z.k},a.scaleExtent=function(b){return arguments.length?(C=null==b?Vg:[+b[0],+b[1]],a):C},a.center=function(b){return arguments.length?(r=b&&[+b[0],+b[1]],a):r},a.size=function(b){return arguments.length?(B=b&&[+b[0],+b[1]],a):B},a.duration=function(b){return arguments.length?(D=+b,a):D},a.x=function(b){return arguments.length?(v=b,u=b.copy(),z={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),z={x:0,y:0,k:1},a):x},hg.rebind(a,J,"on")};var Tg,Ug,Vg=[0,1/0];hg.color=ga,ga.prototype.toString=function(){return this.rgb()+""},hg.hsl=ha;var Wg=ha.prototype=new ga;Wg.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,this.l/a)},Wg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,a*this.l)},Wg.rgb=function(){return ia(this.h,this.s,this.l)},hg.hcl=ja;var Xg=ja.prototype=new ga;Xg.brighter=function(a){return new ja(this.h,this.c,Math.min(100,this.l+Yg*(arguments.length?a:1)))},Xg.darker=function(a){return new ja(this.h,this.c,Math.max(0,this.l-Yg*(arguments.length?a:1)))},Xg.rgb=function(){return ka(this.h,this.c,this.l).rgb()},hg.lab=la;var Yg=18,Zg=.95047,$g=1,_g=1.08883,ah=la.prototype=new ga;ah.brighter=function(a){return new la(Math.min(100,this.l+Yg*(arguments.length?a:1)),this.a,this.b)},ah.darker=function(a){return new la(Math.max(0,this.l-Yg*(arguments.length?a:1)),this.a,this.b)},ah.rgb=function(){return ma(this.l,this.a,this.b)},hg.rgb=ra;var bh=ra.prototype=new ga;bh.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),new ra(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new ra(e,e,e)},bh.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ra(a*this.r,a*this.g,a*this.b)},bh.hsl=function(){return wa(this.r,this.g,this.b)},bh.toString=function(){return"#"+ua(this.r)+ua(this.g)+ua(this.b)};var ch=hg.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ch.forEach(function(a,b){ch.set(a,sa(b))}),hg.functor=Aa,hg.xhr=Ba(s),hg.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=Ca(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.slice(b+1,c).replace(/""/g,'"')}for(;j>k;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.slice(b,k-h)}return a.slice(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&null==(m=b(m,l++))||h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new r,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},hg.csv=hg.dsv(",","text/csv"),hg.tsv=hg.dsv("	","text/tab-separated-values");var dh,eh,fh,gh,hh=this[u(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};hg.timer=function(){Fa.apply(this,arguments)},hg.timer.flush=function(){Ha(),Ia()},hg.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var ih=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Ka);hg.formatPrefix=function(a,b){var c=0;return(a=+a)&&(0>a&&(a*=-1),b&&(a=hg.round(a,Ja(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),ih[8+c/3]};var jh=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,kh=hg.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=hg.round(a,Ja(a,b))).toFixed(Math.max(0,Math.min(20,Ja(a*(1+1e-15),b))))}}),lh=hg.time={},mh=Date;Na.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){nh.setUTCDate.apply(this._,arguments)},setDay:function(){nh.setUTCDay.apply(this._,arguments)},setFullYear:function(){nh.setUTCFullYear.apply(this._,arguments)},setHours:function(){nh.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){nh.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){nh.setUTCMinutes.apply(this._,arguments)},setMonth:function(){nh.setUTCMonth.apply(this._,arguments)},setSeconds:function(){nh.setUTCSeconds.apply(this._,arguments)},setTime:function(){nh.setTime.apply(this._,arguments)}};var nh=Date.prototype;lh.year=Oa(function(a){return a=lh.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),lh.years=lh.year.range,lh.years.utc=lh.year.utc.range,lh.day=Oa(function(a){var b=new mh(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),lh.days=lh.day.range,lh.days.utc=lh.day.utc.range,lh.dayOfYear=function(a){var b=lh.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=lh[a]=Oa(function(a){return(a=lh.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=lh.year(a).getDay();return Math.floor((lh.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});lh[a+"s"]=c.range,lh[a+"s"].utc=c.utc.range,lh[a+"OfYear"]=function(a){var c=lh.year(a).getDay();return Math.floor((lh.dayOfYear(a)+(c+b)%7)/7)}}),lh.week=lh.sunday,lh.weeks=lh.sunday.range,lh.weeks.utc=lh.sunday.utc.range,lh.weekOfYear=lh.sundayOfYear;var oh={"-":"",_:" ",0:"0"},ph=/^\s*\d+/,qh=/^%/;hg.locale=function(a){return{numberFormat:La(a),timeFormat:Qa(a)}};var rh=hg.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});hg.format=rh.numberFormat,hg.geo={},jb.prototype={s:0,t:0,add:function(a){kb(a,this.t,sh),kb(sh.s,this.s,this),this.s?this.t+=sh.t:this.s=sh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var sh=new jb;hg.geo.stream=function(a,b){a&&th.hasOwnProperty(a.type)?th[a.type](a,b):lb(a,b)};var th={Feature:function(a,b){lb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)lb(c[d].geometry,b)}},uh={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){mb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)mb(c[d],b,0)},Polygon:function(a,b){nb(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)nb(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)lb(c[d],b)}};hg.geo.area=function(a){return vh=0,hg.geo.stream(a,xh),vh};var vh,wh=new jb,xh={sphere:function(){vh+=4*Kg},point:v,lineStart:v,lineEnd:v,polygonStart:function(){wh.reset(),xh.lineStart=ob},polygonEnd:function(){var a=2*wh;vh+=0>a?4*Kg+a:a,xh.lineStart=xh.lineEnd=xh.point=v}};hg.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),l>b&&(l=b),b>n&&(n=b)}function b(b,c){var d=pb([b*Og,c*Og]);if(r){var e=rb(r,d),f=[e[1],-e[0],0],g=rb(f,e);ub(g),g=vb(g);var i=b-o,j=i>0?1:-1,p=g[0]*Pg*j,q=rg(i)>180;if(q^(p>j*o&&j*b>p)){var s=g[1]*Pg;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(p>j*o&&j*b>p)){var s=-g[1]*Pg;l>s&&(l=s)}else l>c&&(l=c),c>n&&(n=c);q?o>b?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(k>b&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=rg(d)>180?d+(d>0?360:-360):d}else p=a,q=c;xh.point(a,c),b(a,c)}function f(){xh.lineStart()}function g(){e(p,q),xh.lineEnd(),rg(s)>Ig&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,xh.polygonStart()},polygonEnd:function(){xh.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,0>wh?(k=-(m=180),l=-(n=90)):s>Ig?n=90:-Ig>s&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],hg.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];b>d;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-(1/0),b=f.length-1,d=0,e=f[b];b>=d;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),hg.geo.centroid=function(a){yh=zh=Ah=Bh=Ch=Dh=Eh=Fh=Gh=Hh=Ih=0,hg.geo.stream(a,Jh);var b=Gh,c=Hh,d=Ih,e=b*b+c*c+d*d;return Jg>e&&(b=Dh,c=Eh,d=Fh,Ig>zh&&(b=Ah,c=Bh,d=Ch),e=b*b+c*c+d*d,Jg>e)?[NaN,NaN]:[Math.atan2(c,b)*Pg,ba(d/Math.sqrt(e))*Pg]};var yh,zh,Ah,Bh,Ch,Dh,Eh,Fh,Gh,Hh,Ih,Jh={sphere:v,point:xb,lineStart:zb,lineEnd:Ab,polygonStart:function(){Jh.lineStart=Bb},polygonEnd:function(){Jh.lineStart=zb}},Kh=Hb(Db,Lb,Nb,[-Kg,-Kg/2]),Lh=1e9;hg.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Rb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(hg.geo.conicEqualArea=function(){return Sb(Tb)}).raw=Tb,hg.geo.albers=function(){return hg.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},hg.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=hg.geo.albers(),g=hg.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=hg.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&.234>e&&d>=-.425&&-.214>d?g:e>=.166&&.234>e&&d>=-.214&&-.115>d?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+Ig,l+.12*j+Ig],[k-.214*j-Ig,l+.234*j-Ig]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+Ig,l+.166*j+Ig],[k-.115*j-Ig,l+.234*j-Ig]]).stream(i).point,a},a.scale(1070)};var Mh,Nh,Oh,Ph,Qh,Rh,Sh={point:v,lineStart:v,lineEnd:v,polygonStart:function(){Nh=0,Sh.lineStart=Ub},polygonEnd:function(){Sh.lineStart=Sh.lineEnd=Sh.point=v,Mh+=rg(Nh/2)}},Th={point:Vb,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Uh={point:Yb,lineStart:Zb,lineEnd:$b,polygonStart:function(){Uh.lineStart=_b},polygonEnd:function(){Uh.point=Yb,Uh.lineStart=Zb,Uh.lineEnd=$b}};hg.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),hg.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return Mh=0,hg.geo.stream(a,e(Sh)),Mh},a.centroid=function(a){return Ah=Bh=Ch=Dh=Eh=Fh=Gh=Hh=Ih=0,hg.geo.stream(a,e(Uh)),Ih?[Gh/Ih,Hh/Ih]:Fh?[Dh/Fh,Eh/Fh]:Ch?[Ah/Ch,Bh/Ch]:[NaN,NaN]},a.bounds=function(a){return Qh=Rh=-(Oh=Ph=1/0),hg.geo.stream(a,e(Th)),[[Oh,Ph],[Qh,Rh]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||cc(a):s,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Wb:new ac(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(hg.geo.albersUsa()).context(null)},hg.geo.transform=function(a){return{stream:function(b){var c=new dc(b);for(var d in a)c[d]=a[d];return c}}},dc.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},hg.geo.projection=fc,hg.geo.projectionMutator=gc,(hg.geo.equirectangular=function(){return fc(ic)}).raw=ic.invert=ic,hg.geo.rotation=function(a){function b(b){return b=a(b[0]*Og,b[1]*Og),b[0]*=Pg,b[1]*=Pg,b}return a=kc(a[0]%360*Og,a[1]*Og,a.length>2?a[2]*Og:0),b.invert=function(b){return b=a.invert(b[0]*Og,b[1]*Og),b[0]*=Pg,b[1]*=Pg,b},b},jc.invert=ic,hg.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=kc(-a[0]*Og,-a[1]*Og,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Pg,a[1]*=Pg}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=oc((b=+d)*Og,e*Og),a):b},a.precision=function(d){return arguments.length?(c=oc(b*Og,(e=+d)*Og),a):e},a.angle(90)},hg.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Og,e=a[1]*Og,f=b[1]*Og,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},hg.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return hg.range(Math.ceil(f/q)*q,e,q).map(m).concat(hg.range(Math.ceil(j/r)*r,i,r).map(n)).concat(hg.range(Math.ceil(d/o)*o,c,o).filter(function(a){return rg(a%q)>Ig}).map(k)).concat(hg.range(Math.ceil(h/p)*p,g,p).filter(function(a){return rg(a%r)>Ig}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=qc(h,g,90),l=rc(d,c,s),m=qc(j,i,90),n=rc(f,e,s),a):s},a.majorExtent([[-180,-90+Ig],[180,90-Ig]]).minorExtent([[-180,-80-Ig],[180,80+Ig]])},hg.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=sc,e=tc;return a.distance=function(){return hg.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},hg.geo.interpolate=function(a,b){return uc(a[0]*Og,a[1]*Og,b[0]*Og,b[1]*Og)},hg.geo.length=function(a){return Vh=0,hg.geo.stream(a,Wh),Vh};var Vh,Wh={sphere:v,point:v,lineStart:vc,lineEnd:v,polygonStart:v,polygonEnd:v},Xh=wc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(hg.geo.azimuthalEqualArea=function(){return fc(Xh)}).raw=Xh;var Yh=wc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},s);(hg.geo.azimuthalEquidistant=function(){return fc(Yh)}).raw=Yh,(hg.geo.conicConformal=function(){return Sb(xc)}).raw=xc,(hg.geo.conicEquidistant=function(){return Sb(yc)}).raw=yc;var Zh=wc(function(a){return 1/a},Math.atan);(hg.geo.gnomonic=function(){return fc(Zh)}).raw=Zh,zc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Ng]},(hg.geo.mercator=function(){return Ac(zc)}).raw=zc;var $h=wc(function(){return 1},Math.asin);(hg.geo.orthographic=function(){return fc($h)}).raw=$h;var _h=wc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(hg.geo.stereographic=function(){return fc(_h)}).raw=_h,Bc.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Ng]},(hg.geo.transverseMercator=function(){var a=Ac(Bc),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=Bc,hg.geom={},hg.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=Aa(c),f=Aa(d),g=a.length,h=[],i=[];for(b=0;g>b;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Fc),b=0;g>b;b++)i.push([h[b][0],-h[b][1]]);var j=Ec(h),k=Ec(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=Cc,d=Dc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},hg.geom.polygon=function(a){return wg(a,ai),a};var ai=hg.geom.polygon.prototype=[];ai.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},ai.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},ai.clip=function(a){for(var b,c,d,e,f,g,h=Ic(a),i=-1,j=this.length-Ic(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Gc(g,k,e)?(Gc(f,k,e)||a.push(Hc(f,g,k,e)),a.push(g)):Gc(f,k,e)&&a.push(Hc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var bi,ci,di,ei,fi,gi=[],hi=[];Qc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Sc),b.length},ad.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},bd.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=fd(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(dd(this,c),a=c,c=a.U),c.C=!1,d.C=!0,ed(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(ed(this,c),a=c,c=a.U),c.C=!1,d.C=!0,dd(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?fd(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,dd(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,ed(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,dd(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,ed(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,dd(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,ed(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},hg.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return gd(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/Ig)*Ig,y:Math.round(g(a,b)/Ig)*Ig,i:b}})}var d=Cc,e=Dc,f=d,g=e,h=ii;return a?b(a):(b.links=function(a){return gd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return gd(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(Sc),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&id(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=Aa(d=a),
b):d},b.y=function(a){return arguments.length?(g=Aa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?ii:a,b):h===ii?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===ii?null:h&&h[1]},b)};var ii=[[-1e6,-1e6],[1e6,1e6]];hg.geom.delaunay=function(a){return hg.geom.voronoi().triangles(a)},hg.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(rg(i-c)+rg(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=m<<1|l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=ld()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=Aa(h),u=Aa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;o>n;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;o>n;++n){var v=+t(k=a[n],n),w=+u(k,n);p>v&&(p=v),q>w&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=ld();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){md(a,z,p,q,r,s)},z.find=function(a){return nd(z,a[0],a[1],p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=Cc,i=Dc;return(g=arguments.length)?(h=jd,i=kd,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},hg.interpolateRgb=od,hg.interpolateObject=pd,hg.interpolateNumber=qd,hg.interpolateString=rd;var ji=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ki=new RegExp(ji.source,"g");hg.interpolate=sd,hg.interpolators=[function(a,b){var c=typeof b;return("string"===c?ch.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?od:rd:b instanceof ga?od:Array.isArray(b)?td:"object"===c&&isNaN(b)?pd:qd)(a,b)}],hg.interpolateArray=td;var li=function(){return s},mi=hg.map({linear:li,poly:Ad,quad:function(){return xd},cubic:function(){return yd},sin:function(){return Bd},exp:function(){return Cd},circle:function(){return Dd},elastic:Ed,back:Fd,bounce:function(){return Gd}}),ni=hg.map({in:s,out:vd,"in-out":wd,"out-in":function(a){return wd(vd(a))}});hg.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.slice(0,b):a,d=b>=0?a.slice(b+1):"in";return c=mi.get(c)||li,d=ni.get(d)||s,ud(d(c.apply(null,ig.call(arguments,1))))},hg.interpolateHcl=Hd,hg.interpolateHsl=Id,hg.interpolateLab=Jd,hg.interpolateRound=Kd,hg.transform=function(a){var b=kg.createElementNS(hg.ns.prefix.svg,"g");return(hg.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Ld(c?c.matrix:oi)})(a)},Ld.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var oi={a:1,b:0,c:0,d:1,e:0,f:0};hg.interpolateTransform=Ud,hg.layout={},hg.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Xd(a[c]));return b}},hg.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=hg.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(hg.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(Lg-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:p[s]},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},hg.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(i>h*h/r){if(p>i){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&p>i){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=hg.event.x,a.py=hg.event.y,i.resume()}var c,d,e,f,g,h,i={},j=hg.dispatch("start","tick","end"),k=[1,1],l=.9,m=pi,n=qi,o=-30,p=ri,q=.1,r=.64,t=[],u=[];return i.tick=function(){if((e*=.99)<.005)return c=null,j.end({type:"end",alpha:e=0}),!0;var b,d,i,m,n,p,r,s,v,w=t.length,x=u.length;for(d=0;x>d;++d)i=u[d],m=i.source,n=i.target,s=n.x-m.x,v=n.y-m.y,(p=s*s+v*v)&&(p=e*g[d]*((p=Math.sqrt(p))-f[d])/p,s*=p,v*=p,n.x-=s*(r=m.weight+n.weight?m.weight/(m.weight+n.weight):.5),n.y-=v*r,m.x+=s*(r=1-r),m.y+=v*r);if((r=e*q)&&(s=k[0]/2,v=k[1]/2,d=-1,r))for(;++d<w;)i=t[d],i.x+=(s-i.x)*r,i.y+=(v-i.y)*r;if(o)for(ce(b=hg.geom.quadtree(t),e,h),d=-1;++d<w;)(i=t[d]).fixed||b.visit(a(i));for(d=-1;++d<w;)i=t[d],i.fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*l,i.y-=(i.py-(i.py=i.y))*l);j.tick({type:"tick",alpha:e})},i.nodes=function(a){return arguments.length?(t=a,i):t},i.links=function(a){return arguments.length?(u=a,i):u},i.size=function(a){return arguments.length?(k=a,i):k},i.linkDistance=function(a){return arguments.length?(m="function"==typeof a?a:+a,i):m},i.distance=i.linkDistance,i.linkStrength=function(a){return arguments.length?(n="function"==typeof a?a:+a,i):n},i.friction=function(a){return arguments.length?(l=+a,i):l},i.charge=function(a){return arguments.length?(o="function"==typeof a?a:+a,i):o},i.chargeDistance=function(a){return arguments.length?(p=a*a,i):Math.sqrt(p)},i.gravity=function(a){return arguments.length?(q=+a,i):q},i.theta=function(a){return arguments.length?(r=a*a,i):Math.sqrt(r)},i.alpha=function(a){return arguments.length?(a=+a,e?a>0?e=a:(c.c=null,c.t=NaN,c=null,j.end({type:"end",alpha:e=0})):a>0&&(j.start({type:"start",alpha:e=a}),c=Fa(i.tick)),i):e},i.start=function(){function a(a,d){if(!c){for(c=new Array(e),i=0;e>i;++i)c[i]=[];for(i=0;j>i;++i){var f=u[i];c[f.source.index].push(f.target),c[f.target.index].push(f.source)}}for(var g,h=c[b],i=-1,k=h.length;++i<k;)if(!isNaN(g=h[i][a]))return g;return Math.random()*d}var b,c,d,e=t.length,j=u.length,l=k[0],p=k[1];for(b=0;e>b;++b)(d=t[b]).index=b,d.weight=0;for(b=0;j>b;++b)d=u[b],"number"==typeof d.source&&(d.source=t[d.source]),"number"==typeof d.target&&(d.target=t[d.target]),++d.source.weight,++d.target.weight;for(b=0;e>b;++b)d=t[b],isNaN(d.x)&&(d.x=a("x",l)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(f=[],"function"==typeof m)for(b=0;j>b;++b)f[b]=+m.call(this,u[b],b);else for(b=0;j>b;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;j>b;++b)g[b]=+n.call(this,u[b],b);else for(b=0;j>b;++b)g[b]=n;if(h=[],"function"==typeof o)for(b=0;e>b;++b)h[b]=+o.call(this,t[b],b);else for(b=0;e>b;++b)h[b]=o;return i.resume()},i.resume=function(){return i.alpha(.1)},i.stop=function(){return i.alpha(0)},i.drag=function(){return d||(d=hg.behavior.drag().origin(s).on("dragstart.force",$d).on("drag.force",b).on("dragend.force",_d)),arguments.length?void this.on("mouseover.force",ae).on("mouseout.force",be).call(d):d},hg.rebind(i,j,"on")};var pi=20,qi=1,ri=1/0;hg.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return fe(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=ie,c=ge,d=he;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(ee(b,function(a){a.children&&(a.value=0)}),fe(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},hg.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=hg.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},de(c,d)},hg.layout.pie=function(){function a(g){var h,i=g.length,j=g.map(function(c,d){return+b.call(a,c,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),l=("function"==typeof e?e.apply(this,arguments):e)-k,m=Math.min(Math.abs(l)/i,+("function"==typeof f?f.apply(this,arguments):f)),n=m*(0>l?-1:1),o=hg.sum(j),p=o?(l-i*n)/o:0,q=hg.range(i),r=[];return null!=c&&q.sort(c===si?function(a,b){return j[b]-j[a]}:function(a,b){return c(g[a],g[b])}),q.forEach(function(a){r[a]={data:g[a],value:h=j[a],startAngle:k,endAngle:k+=h*p+n,padAngle:m}}),r}var b=Number,c=si,d=0,e=Lg,f=0;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a.padAngle=function(b){return arguments.length?(f=b,a):f},a};var si={};hg.layout.stack=function(){function a(h,i){if(!(m=h.length))return h;var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=hg.permute(j,l),k=hg.permute(k,l);var m,n,o,p,q=d.call(a,k,i),r=j[0].length;for(o=0;r>o;++o)for(e.call(a,j[0][o],p=q[o],k[0][o][1]),n=1;m>n;++n)e.call(a,j[n][o],p+=k[n-1][o][1],k[n][o][1]);return h}var b=s,c=ne,d=oe,e=me,f=ke,g=le;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:ti.get(b)||ne,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:ui.get(b)||oe,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var ti=hg.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(pe),f=a.map(qe),g=hg.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;d>b;++b)c=g[b],i>h?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return hg.range(a.length).reverse()},default:ne}),ui=hg.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;f>c;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;m>c;++c){for(b=0,e=0;k>b;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];k>b;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,j>i&&(j=i)}for(c=0;m>c;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=g}for(c=0;f>c;++c)h[c]=0;return h},zero:oe});hg.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)h=j[f],h>=k[0]&&h<=k[1]&&(g=i[hg.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=ue,e=se;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=Aa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return te(a,b)}:Aa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},hg.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,fe(h,function(a){a.r=+k(a.value)}),fe(h,ze),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;fe(h,function(a){a.r+=l}),fe(h,ze),fe(h,function(a){a.r-=l})}return Ce(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=hg.layout.hierarchy().sort(ve),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},de(a,c)},hg.layout.tree=function(){function a(a,e){var k=g.call(this,a,e),l=k[0],m=b(l);if(fe(m,c),m.parent.m=-m.z,ee(m,d),j)ee(l,f);else{var n=l,o=l,p=l;ee(l,function(a){a.x<n.x&&(n=a),a.x>o.x&&(o=a),a.depth>p.depth&&(p=a)});var q=h(n,o)/2-n.x,r=i[0]/(o.x+h(o,n)/2+q),s=i[1]/(p.depth||1);ee(l,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return k}function b(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;h>g;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}function c(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){Ie(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+h(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+h(a._,d._));a.parent.A=e(a,d,a.parent.A||c[0])}function d(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function e(a,b,c){if(b){for(var d,e=a,f=a,g=b,i=e.parent.children[0],j=e.m,k=f.m,l=g.m,m=i.m;g=Ge(g),e=Fe(e),g&&e;)i=Fe(i),f=Ge(f),f.a=a,d=g.z+l-e.z-j+h(g._,e._),d>0&&(He(Je(g,a,c),a,d),j+=d,k+=d),l+=g.m,j+=e.m,m+=i.m,k+=f.m;g&&!Ge(f)&&(f.t=g,f.m+=l-k),e&&!Fe(i)&&(i.t=e,i.m+=j-m,c=a)}return c}function f(a){a.x*=i[0],a.y=a.depth*i[1]}var g=hg.layout.hierarchy().sort(null).value(null),h=Ee,i=[1,1],j=null;return a.separation=function(b){return arguments.length?(h=b,a):h},a.size=function(b){return arguments.length?(j=null==(i=b)?f:null,a):j?null:i},a.nodeSize=function(b){return arguments.length?(j=null==(i=b)?null:f,a):j?i:null},de(a,g)},hg.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;fe(i,function(a){var b=a.children;b&&b.length?(a.x=Le(b),a.y=Ke(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Me(i),l=Ne(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return fe(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=hg.layout.hierarchy().sort(null).value(null),c=Ee,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},de(a,b)},hg.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(f>c&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=f.y=0,f.value?(f.dx=j[0],f.dy=j[1]):f.dx=f.dy=0,g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=hg.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=Oe,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?Oe(b):Pe(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Pe(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?Oe:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},de(f,h)},hg.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=hg.random.normal.apply(hg,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=hg.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}},hg.scale={};var vi={floor:s,ceil:s};hg.scale.linear=function(){return We([0,1],[0,1],sd,!1)};var wi={s:1,g:1,p:1,r:1,e:1};hg.scale.log=function(){return cf(hg.scale.linear().domain([0,1]),10,!0,[1,10])};var xi=hg.format(".0e"),yi={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};hg.scale.pow=function(){return df(hg.scale.linear(),1,[0,1])},hg.scale.sqrt=function(){return hg.scale.pow().exponent(.5)},hg.scale.ordinal=function(){return ff([],{t:"range",a:[[]]})},hg.scale.category10=function(){return hg.scale.ordinal().range(zi)},hg.scale.category20=function(){return hg.scale.ordinal().range(Ai)},hg.scale.category20b=function(){return hg.scale.ordinal().range(Bi)},hg.scale.category20c=function(){return hg.scale.ordinal().range(Ci)};var zi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ta),Ai=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ta),Bi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ta),Ci=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ta);hg.scale.quantile=function(){return gf([],[])},hg.scale.quantize=function(){return hf(0,1,[0,1])},hg.scale.threshold=function(){return jf([.5],[0,1])},hg.scale.identity=function(){return kf([0,1])},hg.svg={},hg.svg.arc=function(){function a(){var a=Math.max(0,+c.apply(this,arguments)),j=Math.max(0,+d.apply(this,arguments)),k=g.apply(this,arguments)-Ng,l=h.apply(this,arguments)-Ng,m=Math.abs(l-k),n=k>l?0:1;if(a>j&&(o=j,j=a,a=o),m>=Mg)return b(j,n)+(a?b(a,1-n):"")+"Z";var o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=[];if((r=(+i.apply(this,arguments)||0)/2)&&(q=f===Di?Math.sqrt(a*a+j*j):+f.apply(this,arguments),n||(B*=-1),j&&(B=ba(q/j*Math.sin(r))),a&&(A=ba(q/a*Math.sin(r)))),j){s=j*Math.cos(k+B),t=j*Math.sin(k+B),u=j*Math.cos(l-B),v=j*Math.sin(l-B);var D=Math.abs(l-k-2*B)<=Kg?0:1;if(B&&rf(s,t,u,v)===n^D){var E=(k+l)/2;s=j*Math.cos(E),t=j*Math.sin(E),u=v=null}}else s=t=0;if(a){w=a*Math.cos(l-A),x=a*Math.sin(l-A),y=a*Math.cos(k+A),z=a*Math.sin(k+A);var F=Math.abs(k-l+2*A)<=Kg?0:1;if(A&&rf(w,x,y,z)===1-n^F){var G=(k+l)/2;w=a*Math.cos(G),x=a*Math.sin(G),y=z=null}}else w=x=0;if(m>Ig&&(o=Math.min(Math.abs(j-a)/2,+e.apply(this,arguments)))>.001){p=j>a^n?0:1;var H=o,I=o;if(Kg>m){var J=null==y?[w,x]:null==u?[s,t]:Hc([s,t],[y,z],[u,v],[w,x]),K=s-J[0],L=t-J[1],M=u-J[0],N=v-J[1],O=1/Math.sin(Math.acos((K*M+L*N)/(Math.sqrt(K*K+L*L)*Math.sqrt(M*M+N*N)))/2),P=Math.sqrt(J[0]*J[0]+J[1]*J[1]);I=Math.min(o,(a-P)/(O-1)),H=Math.min(o,(j-P)/(O+1))}if(null!=u){var Q=sf(null==y?[w,x]:[y,z],[s,t],j,H,n),R=sf([u,v],[w,x],j,H,n);o===H?C.push("M",Q[0],"A",H,",",H," 0 0,",p," ",Q[1],"A",j,",",j," 0 ",1-n^rf(Q[1][0],Q[1][1],R[1][0],R[1][1]),",",n," ",R[1],"A",H,",",H," 0 0,",p," ",R[0]):C.push("M",Q[0],"A",H,",",H," 0 1,",p," ",R[0])}else C.push("M",s,",",t);if(null!=y){var S=sf([s,t],[y,z],a,-I,n),T=sf([w,x],null==u?[s,t]:[u,v],a,-I,n);o===I?C.push("L",T[0],"A",I,",",I," 0 0,",p," ",T[1],"A",a,",",a," 0 ",n^rf(T[1][0],T[1][1],S[1][0],S[1][1]),",",1-n," ",S[1],"A",I,",",I," 0 0,",p," ",S[0]):C.push("L",T[0],"A",I,",",I," 0 0,",p," ",S[0])}else C.push("L",w,",",x)}else C.push("M",s,",",t),null!=u&&C.push("A",j,",",j," 0 ",D,",",n," ",u,",",v),C.push("L",w,",",x),null!=y&&C.push("A",a,",",a," 0 ",F,",",1-n," ",y,",",z);return C.push("Z"),C.join("")}function b(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+-a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}var c=mf,d=nf,e=lf,f=Di,g=of,h=pf,i=qf;return a.innerRadius=function(b){return arguments.length?(c=Aa(b),a):c},a.outerRadius=function(b){return arguments.length?(d=Aa(b),a):d},a.cornerRadius=function(b){return arguments.length?(e=Aa(b),a):e},a.padRadius=function(b){return arguments.length?(f=b==Di?Di:Aa(b),a):f},a.startAngle=function(b){return arguments.length?(g=Aa(b),a):g},a.endAngle=function(b){return arguments.length?(h=Aa(b),a):h},a.padAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.centroid=function(){var a=(+c.apply(this,arguments)+ +d.apply(this,arguments))/2,b=(+g.apply(this,arguments)+ +h.apply(this,arguments))/2-Ng;return[Math.cos(b)*a,Math.sin(b)*a]},a};var Di="auto";hg.svg.line=function(){return tf(s)};var Ei=hg.map({linear:uf,"linear-closed":vf,step:wf,"step-before":xf,"step-after":yf,basis:Ef,"basis-open":Ff,"basis-closed":Gf,bundle:Hf,cardinal:Bf,"cardinal-open":zf,"cardinal-closed":Af,monotone:Nf});Ei.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var Fi=[0,2/3,1/3,0],Gi=[0,1/3,2/3,0],Hi=[0,1/6,2/3,1/6];hg.svg.line.radial=function(){var a=tf(Of);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},xf.reverse=yf,yf.reverse=xf,hg.svg.area=function(){return Pf(s)},hg.svg.area.radial=function(){var a=Pf(Of);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},hg.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)-Ng,k=j.call(a,e,d)-Ng;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Kg)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=sc,g=tc,h=Qf,i=of,j=pf;return a.radius=function(b){return arguments.length?(h=Aa(b),a):h},a.source=function(b){return arguments.length?(f=Aa(b),a):f},a.target=function(b){return arguments.length?(g=Aa(b),a):g},a.startAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.endAngle=function(b){return arguments.length?(j=Aa(b),a):j},a},hg.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=sc,c=tc,d=Rf;return a.source=function(c){return arguments.length?(b=Aa(c),a):b},a.target=function(b){return arguments.length?(c=Aa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},hg.svg.diagonal.radial=function(){var a=hg.svg.diagonal(),b=Rf,c=a.projection;return a.projection=function(a){return arguments.length?c(Sf(b=a)):b},a},hg.svg.symbol=function(){function a(a,d){return(Ii.get(b.call(this,a,d))||Vf)(c.call(this,a,d))}var b=Uf,c=Tf;return a.type=function(c){return arguments.length?(b=Aa(c),a):b},a.size=function(b){return arguments.length?(c=Aa(b),a):c},a};var Ii=hg.map({circle:Vf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Ki)),c=b*Ki;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Ji),c=b*Ji/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Ji),c=b*Ji/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});hg.svg.symbolTypes=Ii.keys();var Ji=Math.sqrt(3),Ki=Math.tan(30*Og);Ag.transition=function(a){for(var b,c,d=Li||++Pi,e=$f(a),f=[],g=Mi||{time:Date.now(),ease:zd,delay:0,duration:250},h=-1,i=this.length;++h<i;){f.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(c=j[k])&&_f(c,k,e,d,g),b.push(c)}return Xf(f,e,d)},Ag.interrupt=function(a){return this.each(null==a?Ni:Wf($f(a)))};var Li,Mi,Ni=Wf($f()),Oi=[],Pi=0;Oi.call=Ag.call,Oi.empty=Ag.empty,Oi.node=Ag.node,Oi.size=Ag.size,hg.transition=function(a,b){return a&&a.transition?Li?a.transition(b):a:hg.selection().transition(a)},hg.transition.prototype=Oi,Oi.select=function(a){var b,c,d,e=this.id,f=this.namespace,g=[];a=C(a);for(var h=-1,i=this.length;++h<i;){g.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(d=j[k])&&(c=a.call(d,d.__data__,k,h))?("__data__"in d&&(c.__data__=d.__data__),_f(c,k,f,e,d[f][e]),b.push(c)):b.push(null)}return Xf(g,f,e)},Oi.selectAll=function(a){var b,c,d,e,f,g=this.id,h=this.namespace,i=[];a=D(a);for(var j=-1,k=this.length;++j<k;)for(var l=this[j],m=-1,n=l.length;++m<n;)if(d=l[m]){f=d[h][g],c=a.call(d,d.__data__,m,j),i.push(b=[]);for(var o=-1,p=c.length;++o<p;)(e=c[o])&&_f(e,o,h,g,f),b.push(e)}return Xf(i,h,g)},Oi.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Xf(e,this.namespace,this.id)},Oi.tween=function(a,b){var c=this.id,d=this.namespace;return arguments.length<2?this.node()[d][c].tween.get(a):R(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})},Oi.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Ud:sd,h=hg.ns.qualify(a);return Yf(this,"attr."+a,b,h.local?f:e)},Oi.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=hg.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Oi.style=function(a,c,d){function e(){this.style.removeProperty(a)}function f(c){return null==c?e:(c+="",function(){var e,f=b(this).getComputedStyle(this,null).getPropertyValue(a);return f!==c&&(e=sd(f,c),function(b){this.style.setProperty(a,e(b),d)})})}var g=arguments.length;if(3>g){if("string"!=typeof a){2>g&&(c="");for(d in a)this.style(d,a[d],c);return this}d=""}return Yf(this,"style."+a,c,f)},Oi.styleTween=function(a,c,d){function e(e,f){var g=c.call(this,e,f,b(this).getComputedStyle(this,null).getPropertyValue(a));return g&&function(b){this.style.setProperty(a,g(b),d)}}return arguments.length<3&&(d=""),this.tween("style."+a,e)},Oi.text=function(a){return Yf(this,"text",a,Zf)},Oi.remove=function(){var a=this.namespace;return this.each("end.transition",function(){var b;this[a].count<2&&(b=this.parentNode)&&b.removeChild(this)})},Oi.ease=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].ease:("function"!=typeof a&&(a=hg.ease.apply(hg,arguments)),R(this,function(d){d[c][b].ease=a}))},Oi.delay=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].delay:R(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,f)}:(a=+a,function(d){d[c][b].delay=a}))},Oi.duration=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].duration:R(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))},Oi.each=function(a,b){var c=this.id,d=this.namespace;if(arguments.length<2){var e=Mi,f=Li;try{Li=c,R(this,function(b,e,f){Mi=b[d][c],a.call(b,b.__data__,e,f)})}finally{Mi=e,Li=f}}else R(this,function(e){var f=e[d][c];(f.event||(f.event=hg.dispatch("start","end","interrupt"))).on(a,b)});return this},Oi.transition=function(){for(var a,b,c,d,e=this.id,f=++Pi,g=this.namespace,h=[],i=0,j=this.length;j>i;i++){h.push(a=[]);for(var b=this[i],k=0,l=b.length;l>k;k++)(c=b[k])&&(d=c[g][e],_f(c,k,g,f,{time:d.time,ease:d.ease,delay:d.delay+d.duration,duration:d.duration})),a.push(c)}return Xf(h,g,f)},hg.svg.axis=function(){function a(a){a.each(function(){var a,j=hg.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):s:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",Ig),q=hg.transition(o.exit()).style("opacity",Ig).remove(),r=hg.transition(o.order()).style("opacity",1),t=Math.max(e,0)+g,u=Re(l),v=j.selectAll(".domain").data([0]),w=(v.enter().append("path").attr("class","domain"),hg.transition(v));p.append("line"),p.append("text");var x,y,z,A,B=p.select("line"),C=r.select("line"),D=o.select("text").text(n),E=p.select("text"),F=r.select("text"),G="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===d?(a=ag,x="x",z="y",y="x2",A="y2",D.attr("dy",0>G?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+u[0]+","+G*f+"V0H"+u[1]+"V"+G*f)):(a=bg,x="y",z="x",y="y2",A="x2",D.attr("dy",".32em").style("text-anchor",0>G?"end":"start"),w.attr("d","M"+G*f+","+u[0]+"H0V"+u[1]+"H"+G*f)),B.attr(A,G*e),E.attr(z,G*t),C.attr(y,0).attr(A,G*e),F.attr(x,0).attr(z,G*t),l.rangeBand){var H=l,I=H.rangeBand()/2;k=l=function(a){return H(a)+I}}else k.rangeBand?k=l:q.call(a,l,k);p.call(a,k,l),r.call(a,l,l)})}var b,c=hg.scale.linear(),d=Qi,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Ri?b+"":Qi,a):d},a.ticks=function(){return arguments.length?(h=jg(arguments),a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],
a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Qi="bottom",Ri={top:1,right:1,bottom:1,left:1};hg.svg.brush=function(){function a(b){b.each(function(){var b=hg.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",f).on("touchstart.brush",f),g=b.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),b.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=b.selectAll(".resize").data(p,s);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Si[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var i,l=hg.transition(b),m=hg.transition(g);j&&(i=Re(j),m.attr("x",i[0]).attr("width",i[1]-i[0]),d(l)),k&&(i=Re(k),m.attr("y",i[0]).attr("height",i[1]-i[0]),e(l)),c(l)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)]+","+m[+/^s/.test(a)]+")"})}function d(a){a.select(".extent").attr("x",l[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function e(a){a.select(".extent").attr("y",m[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",m[1]-m[0])}function f(){function f(){32==hg.event.keyCode&&(D||(t=null,F[0]-=l[1],F[1]-=m[1],D=2),y())}function p(){32==hg.event.keyCode&&2==D&&(F[0]+=l[1],F[1]+=m[1],D=0,y())}function q(){var a=hg.mouse(v),b=!1;u&&(a[0]+=u[0],a[1]+=u[1]),D||(hg.event.altKey?(t||(t=[(l[0]+l[1])/2,(m[0]+m[1])/2]),F[0]=l[+(a[0]<t[0])],F[1]=m[+(a[1]<t[1])]):t=null),B&&r(a,j,0)&&(d(z),b=!0),C&&r(a,k,1)&&(e(z),b=!0),b&&(c(z),x({type:"brush",mode:D?"move":"resize"}))}function r(a,b,c){var d,e,f=Re(b),i=f[0],j=f[1],k=F[c],p=c?m:l,q=p[1]-p[0];return D&&(i-=k,j-=q+k),d=(c?o:n)?Math.max(i,Math.min(j,a[c])):a[c],D?e=(d+=k)+q:(t&&(k=Math.max(i,Math.min(j,2*t[c]-d))),d>k?(e=d,d=k):e=k),p[0]!=d||p[1]!=e?(c?h=null:g=null,p[0]=d,p[1]=e,!0):void 0}function s(){q(),z.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),hg.select("body").style("cursor",null),G.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),E(),x({type:"brushend"})}var t,u,v=this,w=hg.select(hg.event.target),x=i.of(v,arguments),z=hg.select(v),A=w.datum(),B=!/^(n|s)$/.test(A)&&j,C=!/^(e|w)$/.test(A)&&k,D=w.classed("extent"),E=X(v),F=hg.mouse(v),G=hg.select(b(v)).on("keydown.brush",f).on("keyup.brush",p);if(hg.event.changedTouches?G.on("touchmove.brush",q).on("touchend.brush",s):G.on("mousemove.brush",q).on("mouseup.brush",s),z.interrupt().selectAll("*").interrupt(),D)F[0]=l[0]-F[0],F[1]=m[0]-F[1];else if(A){var H=+/w$/.test(A),I=+/^n/.test(A);u=[l[1-H]-F[0],m[1-I]-F[1]],F[0]=l[H],F[1]=m[I]}else hg.event.altKey&&(t=F.slice());z.style("pointer-events","none").selectAll(".resize").style("display",null),hg.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),q()}var g,h,i=A(a,"brushstart","brush","brushend"),j=null,k=null,l=[0,0],m=[0,0],n=!0,o=!0,p=Ti[0];return a.event=function(a){a.each(function(){var a=i.of(this,arguments),b={x:l,y:m,i:g,j:h},c=this.__chart__||b;this.__chart__=b,Li?hg.select(this).transition().each("start.brush",function(){g=c.i,h=c.j,l=c.x,m=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=td(l,b.x),d=td(m,b.y);return g=h=null,function(e){l=b.x=c(e),m=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i,h=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(j=b,p=Ti[!j<<1|!k],a):j},a.y=function(b){return arguments.length?(k=b,p=Ti[!j<<1|!k],a):k},a.clamp=function(b){return arguments.length?(j&&k?(n=!!b[0],o=!!b[1]):j?n=!!b:k&&(o=!!b),a):j&&k?[n,o]:j?n:k?o:null},a.extent=function(b){var c,d,e,f,i;return arguments.length?(j&&(c=b[0],d=b[1],k&&(c=c[0],d=d[0]),g=[c,d],j.invert&&(c=j(c),d=j(d)),c>d&&(i=c,c=d,d=i),(c!=l[0]||d!=l[1])&&(l=[c,d])),k&&(e=b[0],f=b[1],j&&(e=e[1],f=f[1]),h=[e,f],k.invert&&(e=k(e),f=k(f)),e>f&&(i=e,e=f,f=i),(e!=m[0]||f!=m[1])&&(m=[e,f])),a):(j&&(g?(c=g[0],d=g[1]):(c=l[0],d=l[1],j.invert&&(c=j.invert(c),d=j.invert(d)),c>d&&(i=c,c=d,d=i))),k&&(h?(e=h[0],f=h[1]):(e=m[0],f=m[1],k.invert&&(e=k.invert(e),f=k.invert(f)),e>f&&(i=e,e=f,f=i))),j&&k?[[c,e],[d,f]]:j?[c,d]:k&&[e,f])},a.clear=function(){return a.empty()||(l=[0,0],m=[0,0],g=h=null),a},a.empty=function(){return!!j&&l[0]==l[1]||!!k&&m[0]==m[1]},hg.rebind(a,i,"on")};var Si={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ti=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ui=lh.format=rh.timeFormat,Vi=Ui.utc,Wi=Vi("%Y-%m-%dT%H:%M:%S.%LZ");Ui.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?cg:Wi,cg.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},cg.toString=Wi.toString,lh.second=Oa(function(a){return new mh(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),lh.seconds=lh.second.range,lh.seconds.utc=lh.second.utc.range,lh.minute=Oa(function(a){return new mh(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),lh.minutes=lh.minute.range,lh.minutes.utc=lh.minute.utc.range,lh.hour=Oa(function(a){var b=a.getTimezoneOffset()/60;return new mh(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),lh.hours=lh.hour.range,lh.hours.utc=lh.hour.utc.range,lh.month=Oa(function(a){return a=lh.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),lh.months=lh.month.range,lh.months.utc=lh.month.utc.range;var Xi=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Yi=[[lh.second,1],[lh.second,5],[lh.second,15],[lh.second,30],[lh.minute,1],[lh.minute,5],[lh.minute,15],[lh.minute,30],[lh.hour,1],[lh.hour,3],[lh.hour,6],[lh.hour,12],[lh.day,1],[lh.day,2],[lh.week,1],[lh.month,1],[lh.month,3],[lh.year,1]],Zi=Ui.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",Db]]),$i={range:function(a,b,c){return hg.range(Math.ceil(a/c)*c,+b,c).map(eg)},floor:s,ceil:s};Yi.year=lh.year,lh.scale=function(){return dg(hg.scale.linear(),Yi,Zi)};var _i=Yi.map(function(a){return[a[0].utc,a[1]]}),aj=Vi.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",Db]]);_i.year=lh.year.utc,lh.scale.utc=function(){return dg(hg.scale.linear(),_i,aj)},hg.text=Ba(function(a){return a.responseText}),hg.json=function(a,b){return Ca(a,"application/json",fg,b)},hg.html=function(a,b){return Ca(a,"text/html",gg,b)},hg.xml=Ba(function(a){return a.responseXML}),"function"==typeof define&&define.amd?(this.d3=hg,define("d3",hg)):"object"==typeof module&&module.exports?module.exports=hg:this.d3=hg}(),define("src/util/diagram",["src/util/util","src/util/ui","src/util/debug","lodash","jquery","modules/modulefactory","d3"],function(a,b,c,d,e,f,g){function h(a){var b;if(3===arguments.length?this.init1.apply(this,arguments):4===arguments.length?this.init2.apply(this,arguments):1===arguments.length&&a instanceof Array?3===arguments[0].length?this.init1.apply(this,arguments[0]):4===arguments.length?this.init2.apply(this,arguments[0]):b=!0:b=!0,b)throw new Error("Rectangle construction failed")}function i(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}function j(){var a,b,e=[],g=[],h=[],i=f.getModules();for(a=0;a<i.length;a++){var j=i[a].definition,k=j.vars_in||[];for(b=0;b<k.length;b++){var l=j.vars_in[b];l.name&&g.push({module:i[a],id:DataObject.resurrect(j.id),name:l.name,rel:l.rel})}var m=j.vars_out||[];for(b=0;b<m.length;b++){var n=j.vars_out[b];n.name&&n.event&&e.push({id:DataObject.resurrect(j.id),filter:n.filter,name:n.name,event:n.event,jpath:n.jpath,rel:n.rel,module:i[a]})}}for(a=0;a<g.length;a++){var o=d.filter(e,function(b){return b.name===g[a].name});if(o)for(b=0;b<o.length;b++)h.push({source:{module:o[b].module,id:o[b].id},target:{id:g[a].id,module:g[a].module},type:"normal",filter:o[b].filter||"no filter",event:o[b].event||"no event",name:o[b].name||"no name",jpath:o[b].jpath||[],rel_out:o[b].rel,rel_in:g[b].rel})}for(a=0;a<e.length;a++){var p=d.filter(g,function(b){return b.name===e[a].name});p.length||c.warn("The module "+e[a].id+" has a var_out "+e[a].name+" not used as an input of any other module")}return h}function k(a){var b=1400,c=900,d={};a.forEach(function(a){a.source=d[a.source.id]||(d[a.source.id]={info:a.source}),a.target=d[a.target.id]||(d[a.target.id]={info:a.target})});var e=(Object.keys(d).length,0);for(var f in d)d[f].x=Math.random()*b,d[f].y=Math.random()*c,e++;return d}h.prototype.init1=function(a,b,c){this.minmin=a,this.maxmax={x:this.minmin.x+b,y:this.minmin.y+c},this.minmax={x:this.minmin.x,y:this.maxmax.y},this.maxmin={x:this.maxmax.x,y:this.maxmax.y},this._init()},h.prototype._init=function(){this.minx=this.minmin.x,this.maxx=this.maxmax.x,this.miny=this.minmin.y,this.maxy=this.maxmax.y,this.centerx=(this.minx+this.maxx)/2,this.centery=(this.miny+this.maxy)/2},h.prototype.init2=function(){for(var a=arguments,b=d.map(a,"x"),c=d.map(a,"y"),e=0;e<a.length;e++)if(Math.max.apply(null,b)===a[e].x&&Math.max.apply(null,c)===a[e].y)this.maxmax=a[e];else if(Math.min.apply(null,b)===a[e].x&&Math.max.apply(null,c)===a[e].y)this.minmax=a[e];else if(Math.max.apply(null,b)===a[e].x&&Math.min.apply(null,c)===a[e].y)this.maxmin=a[e];else{if(Math.min.apply(null,b)!==a[e].x||Math.min.apply(null,c)!==a[e].y)throw new Error("Rectangle initialisation failed");this.minmin=a[e]}this._init()},h.prototype.intersection=function(a){var b,c=this;if(a.x!==this.centerx){var e=(a.y-this.centery)/(a.x-this.centerx),f=a.y-e*a.x;b=[{x:(this.miny-f)/e,y:this.miny},{x:(this.maxy-f)/e,y:this.maxy},{x:this.minx,y:e*this.minx+f},{x:this.maxx,y:e*this.maxx+f}],b=d.filter(b,function(a){return c.isInside(a)})}else b=[{x:this.centerx,y:this.miny},{x:this.centerx,y:this.maxy}];var g=d.map(b,function(b){return i(b,a)}),h=g.indexOf(Math.min.apply(null,g));return h>-1?b[h]:null},h.prototype.isInside=function(a){return a.x<=this.maxx&&a.x>=this.minx&&a.y<=this.maxy&&a.y>=this.miny};var l,m={};return m.showVariableDiagram=function(){a.loadCss("src/util/diagram.css").then(function(){function a(){B.attr("transform","translate("+g.event.translate+")scale("+g.event.scale+")")}function c(a){var b=[];return b.push((a.info.module.controller?a.info.module.controller.moduleInformation.name:"unknown")+"<br/>"),b.push(a.info.module.definition.title),b.join("<br/>")}function f(a){var b='Event:&nbsp;<%= event %><br/>\nName:&nbsp;<%= name %><br/>\n<!--<% if(rel_out) { %> Ref out:&nbsp;<%= rel_out %><br/><% } %>-->\n<!--<% if(rel_in) { %> Ref in:&nbsp;<%= rel_in %><br/><% } %>-->\n<% if(jpath.length > 0) { %> <br/>jpath:&nbsp;<% print("[" + jpath.join(",") + "]"); %> <% } %>',c=d.template(b);return c(DataObject.resurrect(a))}function i(){D.attr("d",m),C.attr("transform",n),E.attr("transform",o),F.attr("transform",p)}function m(a){var b=q(a);return"M"+b.from.x+","+b.from.y+"L"+b.to.x+" "+b.to.y}function n(a){return"circ"===s?"translate("+a.x+","+a.y+")":"translate("+(a.x-r.width/2)+","+(a.y-r.height/2)+")"}function o(a){var b=q(a);return"translate("+((b.from.x+b.to.x)/2-y.width/2)+","+((b.from.y+b.to.y)/2-y.height/2)+")"}function p(a){return"translate("+((a.x+a.x)/2-r.width/2)+","+((a.y+a.y)/2-r.height/2)+")"}function q(a){switch(s){case"circ":var b=a.target.x-a.source.x,c=a.target.y-a.source.y,d=Math.sqrt(b*b+c*c),e=1-x/d;return{from:{x:a.target.x-b*e,y:a.target.y-c*e},to:{x:a.source.x+b*e,y:a.source.y+c*e}};case"rect":var f=new h({x:a.source.x-r.width/2,y:a.source.y-r.height/2},r.width,r.height),g=new h({x:a.target.x-r.width/2,y:a.target.y-r.height/2},r.width,r.height);return{from:f.intersection(a.target),to:g.intersection(a.source)}}}var r,s="rect",t=j(),u=k(t),v=1400,w=900,x=50;r="circ"===s?{width:x*Math.sqrt(2),height:x*Math.sqrt(2),padding:"2px 8px 2px 8px"}:{width:140,height:90,padding:"2px 8px 2px 8px"};var y={width:150,height:200},z=g.layout.force().nodes(g.values(u)).links(t).size([v,w]).linkDistance(Math.max(r.width,r.height)+1.7*Math.max(y.width,y.height)).charge(-4e3).on("tick",i).start();l=e('<div class="ci-diagram">');var A=g.behavior.zoom().scaleExtent([.2,10]).on("zoom",a),B=g.select(l[0]).append("svg").attr("viewBox","0 0 "+v+" "+w).attr("width","100%").attr("height","100%");B.append("g").append("rect").attr("width",v).attr("height",w).style("fill","rgba(255,255,255,1").style("stroke-width",0).call(A),B=B.append("g"),B.append("defs").selectAll("marker").data(["normal"]).enter().append("marker").attr("id",function(a){return a}).attr("viewBox","0 -5 10 10").attr("refX",10).attr("refY",0).attr("markerWidth",15).attr("markerHeight",15).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5");var C,D=B.append("g").selectAll("path").data(z.links()).enter().append("path").attr("class",function(a){return"link "+a.type}).attr("marker-end",function(a){return"url(#"+a.type+")"});"circ"===s?C=B.append("g").selectAll("circle").data(z.nodes()).enter().append("circle").attr("r",x).call(z.drag):"rect"===s&&(C=B.append("g").selectAll("rect").data(z.nodes()).enter().append("rect").attr("width",r.width).attr("height",r.height).call(z.drag));var E=B.append("g").selectAll("foreignObject").data(z.links()).enter().append("foreignObject").style("pointer-events","none").attr("width",y.width).attr("height",y.height);E.append("xhtml:div").append("div").style({display:"flex","align-items":"center",height:""+y.height+"px",width:""+y.width+"px"}).attr("class","arrow-text").html(f);var F=B.append("g").selectAll("foreignObject").data(z.nodes()).enter().append("foreignObject").style("pointer-events","none").attr({width:r.width,height:r.height});F.append("xhtml:div").append("div").style({display:"flex",height:""+r.height+"px",width:""+r.width+"px",padding:r.padding,"box-sizing":"border-box"}).attr("class","node-text").html(c);var G,H,I=Math.max(document.documentElement.clientWidth,window.innerWidth||0),J=Math.max(document.documentElement.clientHeight,window.innerHeight||0),K=.94;J/w>I/v?(G=K*I,H=G*w/v):(H=K*J,G=H*v/w),b.dialog(l,{width:G,height:H,noHeader:!1,noWrap:!0})})},m});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};define("src/main/grid",["jquery","src/util/ui","src/util/util","src/util/diagram","modules/modulefactory","src/util/context","src/util/versioning","forms/form","src/main/variables","src/util/debug","version","src/util/config"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(b){var c=e.getModules(),d=0;for(var f in c){var g=c[f].getPosition(O()),h=c[f].getSize(O());g.top&&h.height&&c[f].getLayer(O()).display&&(d=Math.max(d,g.top+h.height))}E.css("height",Math.max(a("#ci-visualizer").height()-a("#header").outerHeight(!0)-5,M.yHeight*d+(b?400:0)))}function n(a){var b=e.newModule(a);return q(b),b}function o(a){var b=DataObject.recursiveTransform(JSON.parse(JSON.stringify(a.definition)));b.layers[O()].position.left+=2,b.layers[O()].position.top+=2,n(b)}function p(a){var b=a.getPosition(O()),c=a.getSize(O());a.getDomWrapper().css({top:Math.round(b.top)*D.yHeight,left:Math.round(b.left)*D.xWidth,width:Math.round(c.width)*D.xWidth,height:Math.round(c.height)*D.yHeight})}function q(b){b.setLayers(D.getChildSync(["layers"],!0),!0,!1,!1,O()),b.ready.then(function(){b.getDomWrapper().appendTo(E),p(b),g.isViewLocked()||f.listen(b.getDomWrapper().get(0),[['<li name="tofront"><a><span class="ui-icon ui-icon-arrowreturn-1-n"></span> Move to front</a></li>',function(){t(b)}],['<li name="toback"><a><span class="ui-icon ui-icon-arrowreturn-1-s"></span> Move to back</a></li>',function(){u(b)}],['<li name="remove"><a><span class="ui-icon ui-icon-close"></span> Remove module</a></li>',function(){v(b)}],['<li name="move"><a><span class="ui-icon ui-icon-arrow-4"></span> Move</a></li>',function(a){var c=b.getDomWrapper().position(),d=a.pageX-c.left,e=a.pageY-c.top;w(b,d,e)}],['<li name="duplicate"><a><span class="ui-icon ui-icon-copy"></span> Duplicate</a></li>',function(){o(b)}],['<li name="copy"><a><span class="ui-icon ui-icon-copy"></span> Copy module</a></li>',function(){window.localStorage.setItem("ci-copy-module",JSON.stringify(b.definition))}]]),b.inDom&&b.inDom(),g.isViewLocked()||b.getDomWrapper().resizable({grid:[D.xWidth,D.yHeight],start:function(){c.maskIframes(),b.resizing=!0},stop:function(){c.unmaskIframes(),r(b),b.resizing=!1,m(!1)},containment:"parent"}).draggable({grid:[D.xWidth,D.yHeight],containment:"parent",handle:".ci-module-header",start:function(){c.maskIframes(),m(!0),b.moving=!0},stop:function(){var d=a(this).position();c.unmaskIframes(),b.getPosition(O()).set("left",d.left/D.xWidth),b.getPosition(O()).set("top",d.top/D.yHeight),b.moving=!1,m(!0)},drag:function(){m(!0)}}).trigger("resize"),b.getDomWrapper().bind("mouseover",function(){b.resizing||b.moving||b.getDomHeader().hasClass("ci-hidden")&&(b.getDomHeader().removeClass("ci-hidden").addClass("ci-hidden-disabled"),r(b))}).bind("mouseout",function(){b.resizing||b.moving||b.getDomHeader().hasClass("ci-hidden-disabled")&&(b.getDomHeader().addClass("ci-hidden").removeClass("ci-hidden-disabled"),r(b))}),b.getDomWrapper().find(".ui-resizable-handle").bind("mousedown",function(){m(!0)}),b.getDomWrapper().on("click",".ci-module-expand",function(){b.getDomWrapper().height(b.getDomContent().outerHeight()+b.getDomHeader().outerHeight(!0)),r(b)}),r(b),b.toggleLayer(O())},function(a){j.error("Error during module dom initialization",a)})}function r(a){var b=a.getDomWrapper();a.getSize(O()).set("width",b.width()/D.xWidth),a.getSize(O()).set("height",b.height()/D.yHeight);var c=b.height()-(a.getDomHeader().is(":visible")?a.getDomHeader().outerHeight(!0):0);a.getDomContent().css({height:c}),a.view.width=a.getDomContent().width(),a.view.height=c,a.view.onResize(a.view.width,a.view.height)}function s(b){var c={},d=function d(){var h=E.position(),i=Math.round((c.left-h.left)/D.xWidth),j=Math.round((c.top-h.top)/D.yHeight),k=Math.round(c.width/D.xWidth),l=Math.round(c.height/D.yHeight);c.div.remove(),c={};var m=e.newModule(new DataObject({url:b}));q(m);var n=m.getLayer(O());n.position.set("left",i),n.position.set("top",j),n.size.set("width",k),n.size.set("height",l),n.wrapper=!0,n.title="",a(document).unbind("mousedown",f).unbind("mousemove",g).unbind("mouseup",d),E.css("cursor","default")},f=function(b){c.left=b.pageX,c.top=b.pageY,c.ileft=b.pageX,c.itop=b.pageY,c.div=a("<div>").css({border:"1px solid red",backgroundColor:"rgba(255, 0, 0, 0.2)",width:0,height:0,left:c.left,top:c.top,position:"absolute"}).appendTo(a("body"))},g=function(a){c.left&&(c.width=Math.abs(a.pageX-c.ileft),c.height=Math.abs(a.pageY-c.itop),c.left=Math.min(c.ileft,a.pageX),c.top=Math.min(c.itop,a.pageY),c.div.css({width:c.width,height:c.height,left:c.left,top:c.top}))};a(document).bind("mousedown",f).bind("mousemove",g).bind("mouseup",d),E.css("cursor","crosshair")}function t(b){var c,d=e.getModules(),f=b.dom,g=b.definition.zindex||1,h=0;for(c in d)d[c].definition.zindex=d[c].definition.zindex||1,d[c].definition.zindex>=g&&d[c].definition.zindex--,d[c].dom.css("zIndex",d[c].definition.zindex),h++;a(f).css("zIndex",h),b.definition.zindex=h}function u(b){var c,d=e.getModules(),f=b.dom,g=b.definition.zindex||1,h=0;for(c in d)d[c].definition.zindex=d[c].definition.zindex||1,d[c].definition.zindex<=g&&d[c].definition.zindex++,d[c].dom.css("zIndex",d[c].definition.zindex),h++;a(f).css("zIndex",1),b.definition.zindex=1}function v(a){if(!a.controller||!a.controller.onBeforeRemove||a.controller.onBeforeRemove()!==!1){try{a.getDomWrapper().remove().unbind()}catch(b){a.onReady().then(function(){a.getDomWrapper().remove().unbind()}).catch(function(a){j.warn("Could not remove module from dom.",a)})}e.removeModule(a),a.controller&&a.controller.onRemove&&a.controller.onRemove(),i.unlisten(a)}}function w(b,d,e){F={module:b,div:b.getDomWrapper()},c.maskIframes();var f=function(a){E.position();F.top=a.pageY-e,F.left=a.pageX-d,F.div.css({top:F.top,left:F.left})},g=function b(d){if(F.left){var e=(E.position(),Math.max(0,Math.round(F.left/D.xWidth))),g=Math.max(0,Math.round(F.top/D.yHeight));F.module.getPosition(O()).top=g,F.module.getPosition(O()).left=e,F.div.css({top:g*D.yHeight,left:e*D.xWidth}),c.unmaskIframes(),F=null,a(document).unbind("click",b).unbind("mousemove",f)}};a(document).bind("click",g).bind("mousemove",f)}function x(c,d){var e=a.Deferred();if(d)return D.layers[d]={name:d};var f=b.dialog({autoPosition:!0,title:"New layer",width:"600px"}),g=new h({});return g.init(),g.setStructure({sections:{layeropts:{options:{},groups:{layeropts:{options:{type:"list",multiple:!0},fields:{layername:{type:"text",title:"Layer name",validation:{rules:[{nonEmpty:!0,feedback:{_class:!0,message:"The layer name cannot be empty"}}]}},blanklayer:{type:"checkbox",title:"Blank layer?",options:{blank:" yes / no"}}}}}}}}),g.onStructureLoaded().done(function(){g.fill({})}),g.addButton("Validate",{color:"green"},function(){f.dialog("close");var a=g.getValue().sections.layeropts[0].groups.layeropts[0],b={name:a.layername[0]};D.layers[b.name]=b,e.resolve(b),0===a.blanklayer[0].length?A(!1,void 0,!1):A(!1,void 0,!0),c&&B(b.name)}),g.onLoaded().done(function(){f.html(g.makeDom(2)),g.inDom()}),e}function y(){var c=a.Deferred(),d=b.dialog({autoPosition:!0,title:"Remove layer",width:"600px"}),e=new h({});return e.init(),e.setStructure({sections:{layeropts:{options:{},groups:{layeropts:{options:{type:"list",multiple:!0},fields:{layername:{type:"text",title:"Layer name",validation:{rules:[{nonEmpty:!0,feedback:{_class:!0,message:"The layer name cannot be empty"}}]}}}}}}}}),e.onStructureLoaded().done(function(){e.fill({})}),e.addButton("Validate",{color:"green"},function(){d.dialog("close");var a=e.getValue().sections.layeropts[0].groups.layeropts[0],c={name:a.layername[0]};D.layers[c.name]&&Object.keys(D.layers).length>1?b.confirm('<p>Are you sure that you want to delete the layer "'+c.name+'"</p>',"Confirm","Cancel").then(function(a){a?(c.name===L&&B(Object.keys(D.layers)[0]),delete D.layers[c.name],b.showNotification('Layer "'+c.name+'" deleted',"success")):b.showNotification("Cancel layer deletion","info")}):b.showNotification('Layer "'+c.name+"\" doesn't exist","error"),A(!1,{remove:c.name})}),e.onLoaded().done(function(){d.html(e.makeDom(2)),e.inDom()}),c}function z(){var c=a.Deferred(),d=b.dialog({autoPosition:!0,title:"Rename layer",width:"600px"}),e=new h({});return e.init(),e.setStructure({sections:{layeropts:{options:{},groups:{layeropts:{options:{type:"list",multiple:!0},fields:{originalname:{type:"text",title:"Original layer name",validation:{rules:[{nonEmpty:!0,feedback:{_class:!0,message:"The layer name cannot be empty"}}]}},newname:{type:"text",title:"New layer name",validation:{rules:[{nonEmpty:!0,feedback:{_class:!0,message:"The layer name cannot be empty"}}]}}}}}}}}),e.onStructureLoaded().done(function(){e.fill({})}),e.addButton("Validate",{color:"green"},function(){d.dialog("close");var a=e.getValue().sections.layeropts[0].groups.layeropts[0],c={old:a.originalname[0],new:a.newname[0]};D.layers[c.old]?D.layers[c.new]?b.showNotification('Layer "'+c.new+'" already exist',"error"):(D.layers[c.new]={name:c.new},delete D.layers[c.old],c.old===L&&B(c.new),b.showNotification('Layer "'+c.old+'" renamed to "'+c.new+'"',"success")):b.showNotification('Layer "'+c.old+"\" doesn't exist","error"),A(!1,{rename:c})}),e.onLoaded().done(function(){d.html(e.makeDom(2)),e.inDom()}),c}function A(a,b,c){N(function(d){d.setLayers(D.layers,a,b,c,O())})}function B(b,c){var d=D.layers[b]?D.layers[b]:x(!1,b);a.when(d).then(function(a){a&&(d=a),L=d.name,N(function(a){var b=a.toggleLayer(d.name);b&&p(a)})})}function C(a){for(var b in D.layers)a(D.layers[b],b)}var D,E,F,G,H,I,J,K=!1,L="Default layer",M={xWidth:10,yHeight:10},N=function(a){for(var b=e.getModules(),c=0,d=b.length;d>c;c++)a(b[c])},O=function(){return L};return{init:function(h,i){function m(b,c){if(b.modules)for(var d=0,e=b.modules.length;e>d;d++)b.modules[d].hidden||c.append('<li class="ci-item-newmodule" data-url="'+encodeURIComponent(b.modules[d].url)+'"><a>'+b.modules[d].moduleName+"</a></li>");if(b.folders)for(var d in b.folders){var f=a("<li><a>"+d+"</a></li>"),g=a("<ul />").appendTo(f);m(b.folders[d],g),c.append(f)}}K||(E=a(i),K=!0,g.isViewLocked()||(f.listen(f.getRootDom(),[['<li name="paste"><a><span class="ui-icon ui-icon-clipboard"></span>Paste module</a></li>',function(){var a=DataObject.recursiveTransform(JSON.parse(window.localStorage.getItem("ci-copy-module")));n(a)}]]),(l.contextMenu().indexOf("all")>-1||l.contextMenu().indexOf("add")>-1)&&f.listen(i,[],function(b){var c=a('<li name="add"><a> Add a module</a></li>'),d=a("<ul />").appendTo(c),f=e.getTypes();a.when(f).then(function(a){if("object"!==("undefined"==typeof a?"undefined":_typeof(a))||Array.isArray(a)||(a=[a]),Array.isArray(a))for(var b=0,c=a.length;c>b;b++)m(a[b],d)}),a(b).append(c),c.bind("click",function(b){var c=a(b.target);"A"===c.prop("tagName")&&(c=c.parent());var d=c.attr("data-url");d&&s(decodeURIComponent(d))})}),H=a("<li><a> Switch to layer</a></li>"),G=a("<ul />").appendTo(H),(l.contextMenu().indexOf("all")>-1||l.contextMenu().indexOf("layers")>-1)&&f.listen(i,[],function(b){G.empty(),C(function(b,c){var d=a('<li data-layer="'+encodeURIComponent(c)+'"><a><span />'+c+"</a></li>").data("layerkey",c).appendTo(G);c==L&&d.find("span").addClass("ui-icon ui-icon-check")}),a('<li data-layer=""><a>+ Add a new layer</a></li>').data("layerkey","-1").appendTo(G),a('<li data-layer=""><a>- Remove a layer</a></li>').data("layerkey","-2").appendTo(G),a('<li data-layer=""><a>= Rename a layer</a></li>').data("layerkey","-3").appendTo(G),a(b).append(H),H.bind("click",function(b){var c=a(b.target);"A"===c.prop("tagName")&&(c=c.parent());var d=c.data("layerkey");"-1"!==d&&"-2"!==d&&"-3"!==d?B(d):"-1"==d?x():"-2"==d?y():"-3"==d&&z()})}),J=a('<li name="utils"><a>Utils</a></li>'),I=a("<ul />").appendTo(J),(l.contextMenu().indexOf("all")>-1||l.contextMenu().indexOf("utils")>-1)&&f.listen(i,[],function(c){I.empty(),I.append(a('<li data-util="copyview"><a><span/>Copy view</a></li>').data("utilkey","copyview")),I.append(a('<li data-util="copydata"><a><span/>Copy data</a></li>').data("utilkey","copydata")),I.append(a('<li data-util="pasteview"><a><span/>Paste view</a></li>').data("utilkey","pasteview")),I.append(a('<li data-util="pastedata"><a><span/>Paste data</a></li>').data("utilkey","pastedata")),I.append(a('<li data-util="blankview"><a><span/>Blank view</a></li>').data("utilkey","blankview")),I.append(a('<li data-util="feedback"><a><span/>Send Feedback</a></li>').data("utilkey","feedback")),a(c).append(J),J.bind("click",function(c){var d=a(c.target.parentNode).data("utilkey");switch(d){case"copyview":b.copyview();break;case"blankview":g.blankView();break;case"copydata":b.copyData();break;case"pasteview":b.pasteView();break;case"pastedata":b.pasteData();break;case"feedback":b.feedback();break;default:j.warn("Unknow util key")}})}),f.listen(f.getRootDom(),[['<li name="diagram"><a><span class="ui-icon ui-icon-zoomin"></span>View Diagram</a></li>',function(){d.showVariableDiagram()}]]),f.listen(f.getRootDom(),[['<li class="ci-item-configureentrypoint" class="ui-state-disabled" id="context-menu-version"><a class="ui-state-disabled"><span class="ui-icon ui-icon-info"></span>'+g.version+" </a></li>",function(){window.open("https://github.com/NPellet/visualizer","_blank")}]],null,function(a){var b=g.originalVersion,c="";"none"!==b&&b!==g.version&&(c=b+"→"),a.find("#context-menu-version a").html('<span class="ui-icon ui-icon-info"></span>'+c+g.version+(k.isRelease?"":" (pre)"))}),k.buildTime&&f.listen(f.getRootDom(),[['<li id="context-menu-build-info"><a class="ui-state-disabled"><span class="ui-icon ui-icon-info"></span>Built '+k.buildTime+"</a></li>",c.noop]],null,function(a){a.find("#context-menu-build-info").insertAfter(a.find("#context-menu-version"))})),this.reset(h))},reset:function(b){D=b,D.layers=D.layers||{},D.xWidth||(D.xWidth=10),D.yHeight||(D.yHeight=10);for(var c=e.getModules();c.length;)v(c[0]);a(E).empty(),m(),B(L)},switchToLayer:function(a){D.layers[a]?B(a):j.warn("Layer "+a+" is not defined")},getLayerNames:function(){return Object.keys(D.layers)},getActiveLayerName:O,addModule:q,newModule:s,removeModule:v,addModuleFromJSON:n,checkDimensions:m,moduleResize:r,setModuleSize:p}}),define("src/util/viewmigration",["src/util/versioning","src/util/debug","lib/semver/semver"],function(a,b,c){function d(a,b,c){var d=a.getChildSync(["vars_in"]),e=a.getChildSync(["vars_out"]),f=a.getChildSync(["actions_out"]);d.forEach(function(a){a&&a.rel&&a.rel===b&&(a.rel=c)}),e.forEach(function(a){a&&a.rel&&a.rel===b&&(a.rel=c)}),f.forEach(function(a){a&&a.rel&&a.rel===b&&(a.rel=c)})}function e(a,b){var c=a.indexOf(b);c>-1&&a.splice(c,1)}function f(a,b){var c=a.indexOf(b);-1===c&&a.push(b)}function g(a,b,c){if(a.modules){"string"==typeof c?c=[c]:Array.isArray(c)||(c=[""]);for(var d,e,f,g=0,h=a.modules.length,i=c.length;h>g;g++)if(d=a.modules[g],e=d.getChildSync(["url"]))for(f=0;i>f;f++)if(String(e).indexOf(c[f])>=0){b(d);break}}}function h(a){return"display_value"===a?"./modules/types/display/single_value/":"jqgrid"===a?"./modules/types/display/jqgrid/":"fasttable"===a?"./modules/types/display/fasttable/":"2d_list"===a?"./modules/types/display/2d_list/":"hashmap"===a?"./modules/types/display/hashmap/":"postit"===a?"./modules/types/display/postit/":"iframe"===a?"./modules/types/display/iframe/":"webservice_search"===a?"./modules/types/server_interaction/webservice_search/":"button_url"===a?"./modules/types/server_interaction/button_url/":"filter"===a?"./modules/types/edition/filter/":"form"===a?"./modules/types/edition/form/":"form_simple"===a?"./modules/types/edition/form_simple/":"var_editor"===a?"./modules/types/edition/var_editor/":"graph_function"===a?"./modules/types/chart/advanced/plot_function/":"canvas_matrix"===a?"./modules/types/chart/advanced/canvas_matrix/":"dendrogram"===a?"./modules/types/chart/statistics/dendrogram/":"loading_plot"===a?"./modules/types/chart/statistics/loading_plot/":"phylogram"===a?"./modules/types/chart/statistics/phylogram/":"spectra_displayer"===a?"./modules/types/science/spectra/spectra_displayer/":"jsme"===a?"./modules/types/science/chemistry/jsme/":"jsmol"===a?"./modules/types/science/chemistry/jsmol/":"jsmol_script"===a?"./modules/types/science/chemistry/jsmol_script/":"mol2d"===a?"./modules/types/science/chemistry/mol2d/":"1dnmr"===a?"./modules/types/science/spectra/nmr/1dnmr/":"2dnmr"===a?"./modules/types/science/spectra/nmr/2dnmr/":"webservice_nmr_spin"===a?"./modules/types/science/spectra/nmr/webservice_nmr_spin/":"gcms"===a?"./modules/types/science/spectra/gcms/":"ivstability"===a?"./modules/types/science/spectra/ivstability/":"array_search"===a?"./modules/types/client_interaction/array_search/":"dragdrop"===a?"./modules/types/client_interaction/dragdrop/":"button_action"===a?"./modules/types/client_interaction/button_action/":"grid_selector"===a?"./modules/types/grid_selector/":"xyzoomnavigator"===a?"./modules/types/xyzoomnavigator/":"webservice_cron"===a?"./modules/types/webservice_cron/":void b.error("viewmigration problem: "+a+" is unknown");
}function i(a){var b=a.getChildSync(["jpath"]);b&&b.split&&a.setChild(["jpath"],b.split(".").slice(1))}function j(d){if(0===Object.keys(d).length)return d.version=a.version,d;if(d._version&&(d.version=d._version,delete d._version),d.version===a.version)return d;switch(d.version){case void 0:d.version="0.0.0";break;case"2.1":d.version="2.1.0";break;case"2.2":d.version="2.2.0";break;case"2.4.0b0":d.version="2.4.0-b0";break;case"2.4.0b1":d.version="2.4.0-b1";break;case"2.4.0b2":d.version="2.4.0-b2"}var e=c.parse(d.version);if(!e)return b.error("View has an invalid version: "+d.version+". It cannot be migrated"),d;var f=c.parse(a.version);if(c.gt(e,f))return d;b.info("Migrating view from version "+d.version+" to "+a.version),e.prerelease.length&&b.warn("Migrating a prerelease view, anything can happen !"),f.prerelease.length&&b.warn("Migrating to a prerelease version of the visualizer, anything can happen !");for(var g=0;g<l.length;g++)c.lt(e,l[g].version)&&(b.debug("applying migration to v"+l[g].version.version),l[g].func(d));return d.version=a.version,d}var k=["2.1.0",function(a){if(a.entryPoint){a.variables=a.entryPoint.variables,delete a.entryPoint;for(var b=a.modules,c=0;c<b.length;c++){var d=b[c];d.position.left*=2,d.position.top*=2,d.size.width*=2,d.size.height*=2}}},"2.2.0",function(a){if(a.modules)for(var b=0;b<a.modules.length;b++){var c=a.modules[b];"grid"!==c.type&&"editable_grid"!==c.type||(c.type="jqgrid")}},"2.2.1",function(a){if(a.modules)for(var b=0;b<a.modules.length;b++){var c=a.modules[b];c.url=h(c.type),delete c.type}},"2.2.2",function(a){g(a,function(a){a.url="./modules/types/array_search/configured_search/"},"types/client_interaction/array_search")},"2.2.3",function(a){a.title&&(a.configuration||(a.configuration=new DataObject),a.configuration.title=a.title,delete a.title),g(a,function(a){var b;for(a.url="modules/types/client_interaction/code_editor/","true"===a.configuration.groups.group[0].iseditable[0][0]&&(a.configuration.groups.group[0].iseditable[0][0]="editable"),delete a.configuration.groups.group[0].padding,a.configuration.groups.group[0].mode=["text"],b=0;b<a.vars_out.length;b++){var c=a.vars_out[b];c.event&&(c.event="onEditorChange",c.rel="value")}for(b=0;b<a.actions_out.length;b++){var d=a.actions_out[b];d.event&&(d.event="onButtonClick",d.rel="value")}},"types/science/chemistry/jsmol_script")},"2.2.4",function(a){g(a,function(a){var b=a.configuration.groups.group[0].url;b[0]&&(b[0]=b[0].replace(/<([a-zA-Z0-9]+)>/g,"{$1}"))},"types/server_interaction/webservice_search")},"2.2.5",function(a){g(a,function(a){for(var b=0;b<a.vars_out.length;b++){var c=a.vars_out[b];c.event="onRead","data"===c.rel?c.jpath=c.jpath+".content":"filename"===c.rel&&(c.rel="data",c.jpath=c.jpath+".filename")}},"types/client_interaction/dragdrop")},"2.3.0-beta1",function(a){a.grid=DataObject.recursiveTransform({layers:{"Default layer":{name:"Default layer"}},xWidth:10,yHeight:10}),g(a,function(a){a.layers||(a.layers=DataObject.recursiveTransform({"Default layer":{position:{left:a.position.left,top:a.position.top,right:0},size:{width:a.size.width,height:a.size.height},zIndex:a.zIndex,display:!0,title:a.title,bgColor:a.bgColor,wrapper:a.displayWrapper,created:!0,name:"Default layer"}}),delete a.title,delete a.position,delete a.size,delete a.zIndex,delete a.displayWrapper,delete a.bgColor)})},"2.4.0-b0",function(a){if(a.variables)for(var b=0;b<a.variables.length;b++)i(a.variables[b]);g(a,function(a){var b;if(a.vars_out)for(b=0;b<a.vars_out.length;b++)i(a.vars_out[b]);if(a.actions_out)for(b=0;b<a.actions_out.length;b++)i(a.actions_out[b])})},"2.4.0-b1",function(a){g(a,function(a){for(var b=a.vars_out,c=0;c<b.length;c++)b[c].setChild(["rel"],"output")},"types/edition/object_editor")},"2.4.0-b2",function(a){g(a,function(a){for(var b=a.vars_out,c=0;c<b.length;c++)b[c].setChild(["rel"],"filteredObject")},"types/edition/filter_editor")},"2.4.1",function(a){g(a,function(a){var b,c=a.configuration.sections.postvariables[0].groups.postvariables[0];for(b=0;b<c.length;b++)c[b].variable?c[b].destination="data":c.splice(b--,1);var d=a.configuration.groups.searchparams[0];for(b=0;b<d.length;b++)d[b].name?d[b].destination="url":d.splice(b--,1);var e=a.vars_in;for(b=0;b<e.length;b++)e[b].rel?"varinput"===e[b].rel?(a.configuration.sections.postvariables[0].groups.postvariables[0].push({name:e[b].name,destination:"url",variable:e[b].name,filter:"none"}),e.splice(b--,1)):"vartrigger"===e[b].rel&&a.configuration.sections.postvariables[0].groups.postvariables[0].push({name:e[b].name,destination:"url",variable:e[b].name,filter:"none"}):e.splice(b--,1)},"types/server_interaction/webservice_search")},"2.4.2",function(a){g(a,function(a){if(a.layers){var b,c=a.layers;for(var d in c)b=c[d],b.bgcolor&&(b.bgColor||(b.bgColor=b.bgcolor),delete b.bgcolor)}})},"2.13.1-b0",function(a){g(a,function(a){Array.isArray(a.actions_in)&&a.actions_in.forEach(function(a){"fromTo"===a.rel&&(a.rel="fromToX")}),Array.isArray(a.actions_out)&&a.actions_out.forEach(function(a){"fromTo"===a.rel&&(a.rel="fromToX")})},"spectra_displayer")},"2.13.1-b1",function(a){g(a,function(a){var b=a.getChildSync(["configuration","groups","plotinfos",0]);b&&b.forEach(function(a){a.plotcontinuous?a.plotcontinuous="continuous"==a.plotcontinuous[0]?"continuous":"discrete":a.plotcontinuous="continuous"})},"spectra_displayer")},"2.13.1-b2",function(a){g(a,function(a){var b=a.getChildSync(["configuration","groups","groupings",0]);if(b)for(var c=0;c<b.length;c++)b[c].getter=[b[c].getter]},"slick_grid")},"2.13.1-b3",function(a){g(a,function(a){for(var b=a.getChildSync(["configuration","groups","cols",0]),c=0;c<b.length;c++)delete b[c].selectable,delete b[c].focusable,delete b[c].sortable,delete b[c].defaultSortOnAsc,delete b[c].resizable;var d=a.getChildSync(["configuration","groups","group",0]);delete d.toggle;var f=d.slickCheck[0];f instanceof Array&&(e(f,"multiColumnSort"),e(f,"enableColumnReorder"),e(f,"enableTextSelectionOnCells")),delete d.filterRow},"slick_grid")},"2.15.1",function(a){g(a,function(a){var b=a.actions_in;b&&b.length&&b.forEach(function(a){a&&"fromTo"===a.rel&&(a.rel="fromToX")})},"spectra_displayer")},"2.16.1-1",function(a){g(a,function(a){var b=a.getChildSync(["configuration","groups","group",0,"slickCheck",0]);b instanceof Array&&f(b,"highlightScroll")},"slick_grid")},"2.22.3-1",function(a){g(a,function(a){d(a,"value","data")},"code_editor")},"2.23.1-1",function(a){g(a,function(a){var b=a.getChildSync(["configuration","groups","plotinfos",0]);b&&b.forEach(function(a){a.markerShape="1",a.markerSize=2})},"spectra_displayer")},"2.35.2-1",function(a){g(a,function(a){function b(a){return d.getChildSync(["groups","group",0,a])}var c=a.getChildSync(["configuration","groups","group",0,"legend"]);if(c)switch(String(c[0])){case"topright":c[0]="top";break;case"bottomright":c[0]="right";break;case"bottomleft":c[0]="bottom";break;case"topleft":c[0]="left"}var d=a.getChildSync(["configuration"]),e=[],f=[],g=b("displayAxis");Array.isArray(g)&&Array.isArray(g[0])&&(g[0].indexOf("x")>-1&&e.push("display"),g[0].indexOf("y")>-1&&f.push("display"));var h=b("flip");Array.isArray(h)&&Array.isArray(h[0])&&(h[0].indexOf("flipX")>-1&&e.push("flip"),h[0].indexOf("flipY")>-1&&f.push("flip"));var i=b("grids");Array.isArray(i)&&Array.isArray(i[0])&&(i[0].indexOf("vmain")>-1&&e.push("main"),i[0].indexOf("vsec")>-1&&e.push("sec"),i[0].indexOf("hmain")>-1&&f.push("main"),i[0].indexOf("hsec")>-1&&f.push("sec")),a.configuration={sections:{axis:[{groups:{xAxis:[{afterSpacing:b("xRightSpacing"),axismodification:b("xaxismodification"),beforeSpacing:b("xLeftSpacing"),checkboxes:[e],label:b("xLabel"),max:b("maxX"),min:b("minX")}],yAxis:[{afterSpacing:b("yTopSpacing"),beforeSpacing:b("yBottomSpacing"),checkboxes:[f],fitToAxisOnFromTo:b("FitYToAxisOnFromTo"),label:b("yLabel"),max:b("maxY"),min:b("minY")}]}}],graph:[{groups:{graph:[{fullOut:b("fullOut"),legend:b("legend"),mouseTracking:b("mouseTracking"),selectScatter:b("selectScatter"),url:b("graphurl"),wheelAction:b("wheelAction"),wheelbaseline:b("wheelbaseline"),zoom:b("zoom")}]}}],variables:[{groups:{variables:d.getChildSync(["groups","plotinfos"])}}]}}},"spectra_displayer")},"2.47.3-1",function(a){g(a,function(a){var b=a.getChildSync(["configuration","groups","string",0]);if(b&&b.length)for(var c=0;c<b.length;c++){var d=b.getChildSync([c,"filter"]);a.setChildSync(["configuration","groups","string",0,c,"extension"],d),a.setChildSync(["configuration","groups","string",0,c,"filter"],"mime")}},"dragdrop")},"2.49.1-1",function(a){g(a,function(a){a.toolbar||(a.toolbar={custom:[[{title:"",icon:"",action:"",position:"begin"}]],common:[{toolbar:[["Open Preferences"]]}]})})}],l=[];if(k.length%2==1)throw new Error("Invalid length of the migrators array.");for(var m=0;m<k.length;m+=2){var n=c.parse(k[m]);if(!n)throw new Error("invalid semver for migration function: "+k[m]);var o=k[m+1];if("function"!=typeof o)throw new Error("object passed for migration "+k[m]+" has to be a function");l.push({version:n,func:o})}return l.sort(function(a,b){return a.version.compare(b.version)}),j}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("pouchdb",[],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.PouchDB=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";function c(a,b){for(var c=0;c<a.length;c++)if(b(a[c],c)===!0)return a[c];return!1}function d(a){return function(b,c){b||c[0]&&c[0].error?a(b||c[0]):a(null,c.length?c[0]:c)}}function e(a){var b={},c=[];return i.traverseRevTree(a,function(a,d,e,f){var g=d+"-"+e;return a&&(b[g]=0),void 0!==f&&c.push({from:f,to:g}),g}),c.reverse(),c.forEach(function(a){b[a.from]=void 0===b[a.from]?1+b[a.to]:Math.min(b[a.from],1+b[a.to])}),b}function f(a,b,c){var d="limit"in b?b.keys.slice(b.skip,b.limit+b.skip):b.skip>0?b.keys.slice(b.skip):b.keys;if(b.descending&&d.reverse(),!d.length)return a._allDocs({limit:0},c);var e={offset:b.skip};return n.all(d.map(function(c){var d=h.extend(!0,{key:c,deleted:"ok"},b);return["limit","skip","keys"].forEach(function(a){delete d[a]}),new n(function(b,f){a._allDocs(d,function(a,d){return a?f(a):(e.total_rows=d.total_rows,void b(d.rows[0]||{key:c,error:"not_found"}))})})})).then(function(a){return e.rows=a,e})}function g(){var a=this;k.call(this);var b,c=0,d=["change","delete","create","update"];this.on("newListener",function(e){if(~d.indexOf(e)){if(c)return void c++;c++;var f=0;b=this.changes({conflicts:!0,include_docs:!0,continuous:!0,since:"now",onChange:function(b){b.seq<=f||(f=b.seq,a.emit("change",b),b.doc._deleted?a.emit("delete",b):"1"===b.doc._rev.split("-")[0]?a.emit("create",b):a.emit("update",b))}})}}),this.on("removeListener",function(a){~d.indexOf(a)&&(c--,c||b.cancel())})}var h=a(34),i=a(29),j=a(19),k=a(38).EventEmitter,l=a(25),m=a(13),n=h.Promise;h.inherits(g,k),b.exports=g,g.prototype.post=h.adapterFun("post",function(a,b,c){return"function"==typeof b&&(c=b,b={}),"object"!=typeof a||Array.isArray(a)?c(j.error(j.NOT_AN_OBJECT)):void this.bulkDocs({docs:[a]},b,d(c))}),g.prototype.put=h.adapterFun("put",h.getArguments(function(a){var b,c,e,f,g=a.shift(),i="_id"in g;if("object"!=typeof g||Array.isArray(g))return(f=a.pop())(j.error(j.NOT_AN_OBJECT));for(g=h.clone(g);b=a.shift(),c=typeof b,"string"!==c||i?"string"!==c||!i||"_rev"in g?"object"===c?e=b:"function"===c&&(f=b):g._rev=b:(g._id=b,i=!0),a.length;);e=e||{};var k=h.invalidIdError(g._id);return k?f(k):h.isLocalId(g._id)&&"function"==typeof this._putLocal?g._deleted?this._removeLocal(g,f):this._putLocal(g,f):void this.bulkDocs({docs:[g]},e,d(f))})),g.prototype.putAttachment=h.adapterFun("putAttachment",function(a,b,c,d,e,f){function g(a){return a._attachments=a._attachments||{},a._attachments[b]={content_type:e,data:d},h.put(a)}var h=this;return"function"==typeof e&&(f=e,e=d,d=c,c=null),"undefined"==typeof e&&(e=d,d=c,c=null),h.get(a).then(function(a){if(a._rev!==c)throw j.error(j.REV_CONFLICT);return g(a)},function(b){if(b.reason===j.MISSING_DOC.message)return g({_id:a});throw b})}),g.prototype.removeAttachment=h.adapterFun("removeAttachment",function(a,b,c,d){var e=this;e.get(a,function(a,f){return a?void d(a):f._rev!==c?void d(j.error(j.REV_CONFLICT)):f._attachments?(delete f._attachments[b],0===Object.keys(f._attachments).length&&delete f._attachments,void e.put(f,d)):d()})}),g.prototype.remove=h.adapterFun("remove",function(a,b,c,e){var f;"string"==typeof b?(f={_id:a,_rev:b},"function"==typeof c&&(e=c,c={})):(f=a,"function"==typeof b?(e=b,c={}):(e=c,c=b)),c=h.clone(c||{}),c.was_delete=!0;var g={_id:f._id,_rev:f._rev||c.rev};return g._deleted=!0,h.isLocalId(g._id)&&"function"==typeof this._removeLocal?this._removeLocal(f,e):void this.bulkDocs({docs:[g]},c,d(e))}),g.prototype.revsDiff=h.adapterFun("revsDiff",function(a,b,c){function d(a,b){j.has(a)||j.set(a,{missing:[]}),j.get(a).missing.push(b)}function e(b,c){var e=a[b].slice(0);i.traverseRevTree(c,function(a,c,f,g,h){var i=c+"-"+f,j=e.indexOf(i);-1!==j&&(e.splice(j,1),"available"!==h.status&&d(b,i))}),e.forEach(function(a){d(b,a)})}"function"==typeof b&&(c=b,b={}),b=h.clone(b);var f=Object.keys(a);if(!f.length)return c(null,{});var g=0,j=new h.Map;f.map(function(b){this._getRevisionTree(b,function(d,h){if(d&&404===d.status&&"missing"===d.message)j.set(b,{missing:a[b]});else{if(d)return c(d);e(b,h)}if(++g===f.length){var i={};return j.forEach(function(a,b){i[b]=a}),c(null,i)}})},this)}),g.prototype.compactDocument=h.adapterFun("compactDocument",function(a,b,c){var d=this;this._getRevisionTree(a,function(f,g){if(f)return c(f);var h=e(g),j=[],k=[];Object.keys(h).forEach(function(a){h[a]>b&&j.push(a)}),i.traverseRevTree(g,function(a,b,c,d,e){var f=b+"-"+c;"available"===e.status&&-1!==j.indexOf(f)&&k.push(f)}),d._doCompaction(a,k,c)})}),g.prototype.compact=h.adapterFun("compact",function(a,b){"function"==typeof a&&(b=a,a={});var c=this;a=h.clone(a||{}),c.get("_local/compaction").catch(function(){return!1}).then(function(d){return"function"==typeof c._compact?(d&&d.last_seq&&(a.last_seq=d.last_seq),c._compact(a,b)):void 0})}),g.prototype._compact=function(a,b){function c(a){g.push(e.compactDocument(a.id,0))}function d(a){var c=a.last_seq;n.all(g).then(function(){return l(e,"_local/compaction",function(a){return!a.last_seq||a.last_seq<c?(a.last_seq=c,a):!1})}).then(function(){b(null,{ok:!0})}).catch(b)}var e=this,f={returnDocs:!1,last_seq:a.last_seq||0},g=[];e.changes(f).on("change",c).on("complete",d).on("error",b)},g.prototype.get=h.adapterFun("get",function(a,b,d){function e(){var c=[],e=f.length;return e?void f.forEach(function(f){g.get(a,{rev:f,revs:b.revs,attachments:b.attachments},function(a,b){c.push(a?{missing:f}:{ok:b}),e--,e||d(null,c)})}):d(null,c)}if("function"==typeof b&&(d=b,b={}),"string"!=typeof a)return d(j.error(j.INVALID_ID));if(h.isLocalId(a)&&"function"==typeof this._getLocal)return this._getLocal(a,d);var f=[],g=this;if(!b.open_revs)return this._get(a,b,function(a,e){if(b=h.clone(b),a)return d(a);var f=e.doc,j=e.metadata,k=e.ctx;if(b.conflicts){var l=i.collectConflicts(j);l.length&&(f._conflicts=l)}if(h.isDeleted(j,f._rev)&&(f._deleted=!0),b.revs||b.revs_info){var m=i.rootToLeaf(j.rev_tree),n=c(m,function(a){return-1!==a.ids.map(function(a){return a.id}).indexOf(f._rev.split("-")[1])}),o=n.ids.map(function(a){return a.id}).indexOf(f._rev.split("-")[1])+1,p=n.ids.length-o;if(n.ids.splice(o,p),n.ids.reverse(),b.revs&&(f._revisions={start:n.pos+n.ids.length-1,ids:n.ids.map(function(a){return a.id})}),b.revs_info){var q=n.pos+n.ids.length;f._revs_info=n.ids.map(function(a){return q--,{rev:q+"-"+a.id,status:a.opts.status}})}}if(b.local_seq&&(h.info('The "local_seq" option is deprecated and will be removed'),f._local_seq=e.metadata.seq),b.attachments&&f._attachments){var r=f._attachments,s=Object.keys(r).length;if(0===s)return d(null,f);Object.keys(r).forEach(function(a){this._getAttachment(r[a],{encode:!0,ctx:k},function(b,c){var e=f._attachments[a];e.data=c,delete e.stub,delete e.length,--s||d(null,f)})},g)}else{if(f._attachments)for(var t in f._attachments)f._attachments.hasOwnProperty(t)&&(f._attachments[t].stub=!0);d(null,f)}});if("all"===b.open_revs)this._getRevisionTree(a,function(a,b){return a?d(a):(f=i.collectLeaves(b).map(function(a){return a.rev}),void e())});else{if(!Array.isArray(b.open_revs))return d(j.error(j.UNKNOWN_ERROR,"function_clause"));f=b.open_revs;for(var k=0;k<f.length;k++){var l=f[k];if("string"!=typeof l||!/^\d+-/.test(l))return d(j.error(j.INVALID_REV))}e()}}),g.prototype.getAttachment=h.adapterFun("getAttachment",function(a,b,c,d){var e=this;c instanceof Function&&(d=c,c={}),c=h.clone(c),this._get(a,c,function(a,f){return a?d(a):f.doc._attachments&&f.doc._attachments[b]?(c.ctx=f.ctx,void e._getAttachment(f.doc._attachments[b],c,d)):d(j.error(j.MISSING_DOC))})}),g.prototype.allDocs=h.adapterFun("allDocs",function(a,b){if("function"==typeof a&&(b=a,a={}),a=h.clone(a),a.skip="undefined"!=typeof a.skip?a.skip:0,"keys"in a){if(!Array.isArray(a.keys))return b(new TypeError("options.keys must be an array"));var c=["startkey","endkey","key"].filter(function(b){return b in a})[0];if(c)return void b(j.error(j.QUERY_PARSE_ERROR,"Query parameter `"+c+"` is not compatible with multi-get"));if("http"!==this.type())return f(this,a,b)}return this._allDocs(a,b)}),g.prototype.changes=function(a,b){return"function"==typeof a&&(b=a,a={}),new m(this,a,b)},g.prototype.close=h.adapterFun("close",function(a){return this._closed=!0,this._close(a)}),g.prototype.info=h.adapterFun("info",function(a){var b=this;this._info(function(c,d){return c?a(c):(d.db_name=d.db_name||b._db_name,d.auto_compaction=!(!b.auto_compaction||"http"===b.type()),void a(null,d))})}),g.prototype.id=h.adapterFun("id",function(a){return this._id(a)}),g.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},g.prototype.bulkDocs=h.adapterFun("bulkDocs",function(a,b,c){if("function"==typeof b&&(c=b,b={}),b=h.clone(b),Array.isArray(a)&&(a={docs:a}),!a||!a.docs||!Array.isArray(a.docs))return c(j.error(j.MISSING_BULK_DOCS));for(var d=0;d<a.docs.length;++d)if("object"!=typeof a.docs[d]||Array.isArray(a.docs[d]))return c(j.error(j.NOT_AN_OBJECT));return a=h.clone(a),"new_edits"in b||(b.new_edits="new_edits"in a?a.new_edits:!0),b.new_edits||"http"===this.type()||a.docs.sort(function(a,b){var c=h.compare(a._id,b._id);if(0!==c)return c;var d=a._revisions?a._revisions.start:0,e=b._revisions?b._revisions.start:0;return h.compare(d,e)}),a.docs.forEach(function(a){a._deleted&&delete a._attachments}),this._bulkDocs(a,b,function(a,d){return a?c(a):(b.new_edits||(d=d.filter(function(a){return a.error})),void c(null,d))})}),g.prototype.registerDependentDatabase=h.adapterFun("registerDependentDatabase",function(a,b){function c(b){return b.dependentDbs=b.dependentDbs||{},b.dependentDbs[a]?!1:(b.dependentDbs[a]=!0,b)}var d=new this.constructor(a,this.__opts||{});l(this,"_local/_pouch_dependentDbs",c,function(a){return a?b(a):b(null,{db:d})})})},{}],2:[function(a,b){(function(c){"use strict";function d(a){return/^_(design|local)/.test(a)?a:encodeURIComponent(a)}function e(a){return a._attachments&&Object.keys(a._attachments)?l.Promise.all(Object.keys(a._attachments).map(function(b){var c=a._attachments[b];if(c.data&&"string"!=typeof c.data){if(o)return new l.Promise(function(a){l.readAsBinaryString(c.data,function(b){c.data=l.btoa(b),a()})});c.data=c.data.toString("base64")}})):l.Promise.resolve()}function f(a,b){if(/http(s?):/.test(a)){var c=l.parseUri(a);c.remote=!0,(c.user||c.password)&&(c.auth={username:c.user,password:c.password});var d=c.path.replace(/(^\/|\/$)/g,"").split("/");if(c.db=d.pop(),c.path=d.join("/"),b=b||{},b=l.clone(b),c.headers=b.headers||b.ajax&&b.ajax.headers||{},b.auth||c.auth){var e=b.auth||c.auth,f=l.btoa(e.username+":"+e.password);c.headers.Authorization="Basic "+f}return b.headers&&(c.headers=b.headers),c}return{host:"",path:"/",db:a,auth:!1}}function g(a,b){return h(a,a.db+"/"+b)}function h(a,b){if(a.remote){var c=a.path?"/":"";return a.protocol+"://"+a.host+":"+a.port+"/"+a.path+c+b}return"/"+b}function i(a,b){function c(a,b){var c=l.extend({},t,a);return n(c.method+" "+c.url),l.ajax(c,b)}function i(a){return a.split("/").map(encodeURIComponent).join("/")}var q=this;q.getHost=a.getHost?a.getHost:f;var r=q.getHost(a.name,a),s=g(r,"");q.getUrl=function(){return s},q.getHeaders=function(){return l.clone(r.headers)};var t=a.ajax||{};a=l.clone(a);var u=function(){c({headers:r.headers,method:"PUT",url:s},function(a){a&&401===a.status?c({headers:r.headers,method:"HEAD",url:s},function(a){a?b(a):b(null,q)}):a&&412!==a.status?b(a):b(null,q)})};a.skipSetup||c({headers:r.headers,method:"GET",url:s},function(a){a?404===a.status?(l.explain404("PouchDB is just detecting if the remote DB exists."),u()):b(a):b(null,q)}),q.type=function(){return"http"},q.id=l.adapterFun("id",function(a){c({headers:r.headers,method:"GET",url:h(r,"")},function(b,c){var d=c&&c.uuid?c.uuid+r.db:g(r,"");a(null,d)})}),q.request=l.adapterFun("request",function(a,b){a.headers=r.headers,a.url=g(r,a.url),c(a,b)}),q.compact=l.adapterFun("compact",function(a,b){"function"==typeof a&&(b=a,a={}),a=l.clone(a),c({headers:r.headers,url:g(r,"_compact"),method:"POST"},function(){function c(){q.info(function(d,e){e.compact_running?setTimeout(c,a.interval||200):b(null,{ok:!0})})}"function"==typeof b&&c()})}),q._info=function(a){c({headers:r.headers,method:"GET",url:g(r,"")},function(b,c){b?a(b):(c.host=g(r,""),a(null,c))})},q.get=l.adapterFun("get",function(a,b,e){"function"==typeof b&&(e=b,b={}),b=l.clone(b),void 0===b.auto_encode&&(b.auto_encode=!0);var f=[];b.revs&&f.push("revs=true"),b.revs_info&&f.push("revs_info=true"),b.local_seq&&f.push("local_seq=true"),b.open_revs&&("all"!==b.open_revs&&(b.open_revs=JSON.stringify(b.open_revs)),f.push("open_revs="+b.open_revs)),b.attachments&&f.push("attachments=true"),b.rev&&f.push("rev="+b.rev),b.conflicts&&f.push("conflicts="+b.conflicts),f=f.join("&"),f=""===f?"":"?"+f,b.auto_encode&&(a=d(a));var h={headers:r.headers,method:"GET",url:g(r,a+f)},i=a.split("/");(i.length>1&&"_design"!==i[0]&&"_local"!==i[0]||i.length>2&&"_design"===i[0]&&"_local"!==i[0])&&(h.binary=!0),c(h,function(a,b,c){return a?e(a):void e(null,b,c)})}),q.remove=l.adapterFun("remove",function(a,b,e,f){var h;"string"==typeof b?(h={_id:a,_rev:b},"function"==typeof e&&(f=e,e={})):(h=a,"function"==typeof b?(f=b,e={}):(f=e,e=b));var i=h._rev||e.rev;c({headers:r.headers,method:"DELETE",url:g(r,d(h._id))+"?rev="+i},f)}),q.getAttachment=l.adapterFun("getAttachment",function(a,b,c,e){"function"==typeof c&&(e=c,c={}),c=l.clone(c),void 0===c.auto_encode&&(c.auto_encode=!0),c.auto_encode&&(a=d(a)),c.auto_encode=!1,q.get(a+"/"+i(b),c,e)}),q.removeAttachment=l.adapterFun("removeAttachment",function(a,b,e,f){var h=g(r,d(a)+"/"+i(b))+"?rev="+e;c({headers:r.headers,method:"DELETE",url:h},f)}),q.putAttachment=l.adapterFun("putAttachment",function(a,b,e,f,h,j){"function"==typeof h&&(j=h,h=f,f=e,e=null),"undefined"==typeof h&&(h=f,f=e,e=null);var k=d(a)+"/"+i(b),n=g(r,k);if(e&&(n+="?rev="+e),"string"==typeof f){var q;try{q=l.atob(f)}catch(a){return j(m.error(m.BAD_ARG,"Attachments need to be base64 encoded"))}f=o?l.createBlob([l.fixBinary(q)],{type:h}):q?new p(q,"binary"):""}var s={headers:l.clone(r.headers),method:"PUT",url:n,processData:!1,body:f,timeout:6e4};s.headers["Content-Type"]=h,c(s,j)}),q.put=l.adapterFun("put",l.getArguments(function(a){var b,f,h,i=a.shift(),j="_id"in i,k=a.pop();return"object"!=typeof i||Array.isArray(i)?k(m.error(m.NOT_AN_OBJECT)):(i=l.clone(i),void e(i).then(function(){for(;b=a.shift(),f=typeof b,"string"!==f||j?"string"!==f||!j||"_rev"in i?"object"===f&&(h=l.clone(b)):i._rev=b:(i._id=b,j=!0),a.length;);h=h||{};var e=l.invalidIdError(i._id);if(e)throw e;var m=[];h&&"undefined"!=typeof h.new_edits&&m.push("new_edits="+h.new_edits),m=m.join("&"),""!==m&&(m="?"+m),c({headers:r.headers,method:"PUT",url:g(r,d(i._id))+m,body:i},function(a,b){return a?k(a):(b.ok=!0,void k(null,b))})}).catch(k))})),q.post=l.adapterFun("post",function(a,b,c){return"function"==typeof b&&(c=b,b={}),b=l.clone(b),"object"!=typeof a?c(m.error(m.NOT_AN_OBJECT)):("_id"in a||(a._id=l.uuid()),void q.put(a,b,function(a,b){return a?c(a):(b.ok=!0,void c(null,b))}))}),q._bulkDocs=function(a,b,d){"undefined"!=typeof b.new_edits&&(a.new_edits=b.new_edits),l.Promise.all(a.docs.map(e)).then(function(){c({headers:r.headers,method:"POST",url:g(r,"_bulk_docs"),body:a},function(a,b){return a?d(a):(b.forEach(function(a){a.ok=!0}),void d(null,b))})}).catch(d)},q.allDocs=l.adapterFun("allDocs",function(a,b){"function"==typeof a&&(b=a,a={}),a=l.clone(a);var d,e=[],f="GET";if(a.conflicts&&e.push("conflicts=true"),a.descending&&e.push("descending=true"),a.include_docs&&e.push("include_docs=true"),a.attachments&&e.push("attachments=true"),a.key&&e.push("key="+encodeURIComponent(JSON.stringify(a.key))),a.startkey&&e.push("startkey="+encodeURIComponent(JSON.stringify(a.startkey))),a.endkey&&e.push("endkey="+encodeURIComponent(JSON.stringify(a.endkey))),"undefined"!=typeof a.inclusive_end&&e.push("inclusive_end="+!!a.inclusive_end),"undefined"!=typeof a.limit&&e.push("limit="+a.limit),"undefined"!=typeof a.skip&&e.push("skip="+a.skip),e=e.join("&"),""!==e&&(e="?"+e),"undefined"!=typeof a.keys){var h="keys="+encodeURIComponent(JSON.stringify(a.keys));h.length+e.length+1<=k?e+=(-1!==e.indexOf("?")?"&":"?")+h:(f="POST",d=JSON.stringify({keys:a.keys}))}c({headers:r.headers,method:f,url:g(r,"_all_docs"+e),body:d},b)}),q._changes=function(a){var b="batch_size"in a?a.batch_size:j;a=l.clone(a),a.timeout=a.timeout||3e4;var d={timeout:a.timeout-5e3},e="undefined"!=typeof a.limit?a.limit:!1;0===e&&(e=1);var f;f="returnDocs"in a?a.returnDocs:!0;var h=e;if(a.style&&(d.style=a.style),(a.include_docs||a.filter&&"function"==typeof a.filter)&&(d.include_docs=!0),a.attachments&&(d.attachments=!0),a.continuous&&(d.feed="longpoll"),a.conflicts&&(d.conflicts=!0),a.descending&&(d.descending=!0),a.filter&&"string"==typeof a.filter&&(d.filter=a.filter,"_view"===a.filter&&a.view&&"string"==typeof a.view&&(d.view=a.view)),a.query_params&&"object"==typeof a.query_params)for(var i in a.query_params)a.query_params.hasOwnProperty(i)&&(d[i]=a.query_params[i]);var n,o="GET";if(a.doc_ids){d.filter="_doc_ids";var p=JSON.stringify(a.doc_ids);p.length<k?d.doc_ids=p:(o="POST",n={doc_ids:a.doc_ids})}if(a.continuous&&q._useSSE)return q.sse(a,d,f);var s,t,u=function(f,i){if(!a.aborted){d.since=f,"object"==typeof d.since&&(d.since=JSON.stringify(d.since)),a.descending?e&&(d.limit=h):d.limit=!e||h>b?b:h;var j="?"+Object.keys(d).map(function(a){return a+"="+d[a]}).join("&"),k={headers:r.headers,method:o,url:g(r,"_changes"+j),timeout:a.timeout,body:n};t=f,a.aborted||(s=c(k,i))}},v=10,w=0,x={results:[]},y=function(c,d){if(!a.aborted){var g=0;if(d&&d.results){g=d.results.length,x.last_seq=d.last_seq;var i={};i.query=a.query_params,d.results=d.results.filter(function(b){h--;var c=l.filterChange(a)(b);return c&&(f&&x.results.push(b),l.call(a.onChange,b)),c})}else if(c)return a.aborted=!0,void l.call(a.complete,c);d&&d.last_seq&&(t=d.last_seq);var j=e&&0>=h||d&&b>g||a.descending;if((!a.continuous||e&&0>=h)&&j)l.call(a.complete,null,x);else{c?w+=1:w=0;var k=1<<w,n=v*k,o=a.maximumWait||3e4;if(n>o)return void l.call(a.complete,c||m.error(m.UNKNOWN_ERROR));setTimeout(function(){u(t,y)},n)}}};return u(a.since||0,y),{cancel:function(){a.aborted=!0,s&&s.abort()}}},q.sse=function(a,b,c){function d(b){var d=JSON.parse(b.data);c&&j.results.push(d),j.last_seq=d.seq,l.call(a.onChange,d)}function e(b){return i.removeEventListener("message",d,!1),m===!1?(q._useSSE=!1,void(k=q._changes(a))):(i.close(),void l.call(a.complete,b))}b.feed="eventsource",b.since=a.since||0,b.limit=a.limit,delete b.timeout;var f="?"+Object.keys(b).map(function(a){return a+"="+b[a]}).join("&"),h=g(r,"_changes"+f),i=new EventSource(h),j={results:[],last_seq:!1},k=!1,m=!1;return i.addEventListener("message",d,!1),i.onopen=function(){m=!0},i.onerror=e,{cancel:function(){return k?k.cancel():(i.removeEventListener("message",d,!1),void i.close())}}},q._useSSE=!1,q.revsDiff=l.adapterFun("revsDiff",function(a,b,d){"function"==typeof b&&(d=b,b={}),c({headers:r.headers,method:"POST",url:g(r,"_revs_diff"),body:JSON.stringify(a)},d)}),q._close=function(a){a()},q.destroy=l.adapterFun("destroy",function(a){c({url:g(r,""),method:"DELETE",headers:r.headers},function(b,c){b?(q.emit("error",b),a(b)):(q.emit("destroyed"),a(null,c))})})}var j=25,k=1800,l=a(34),m=a(19),n=a(40)("pouchdb:http"),o="undefined"==typeof c||c.browser,p=a(18);i.destroy=l.toPromise(function(a,b,c){var d=f(a,b);b=b||{},"function"==typeof b&&(c=b,b={}),b=l.clone(b),b.headers=d.headers,b.method="DELETE",b.url=g(d,"");var e=b.ajax||{};b=l.extend({},b,e),l.ajax(b,c)}),i.valid=function(){return!0},b.exports=i}).call(this,a(39))},{}],3:[function(a,b){"use strict";function c(a,b){return new d.Promise(function(c,e){var g=d.createBlob([""],{type:"image/png"});a.objectStore(f).put(g,"key"),a.oncomplete=function(){var a=b.transaction([f],"readwrite"),g=a.objectStore(f).get("key");g.onerror=e,g.onsuccess=function(a){var b=a.target.result,e=URL.createObjectURL(b);d.ajax({url:e,cache:!0,binary:!0},function(a,b){a&&405===a.status?c(!0):(c(!(!b||"image/png"!==b.type)),a&&404===a.status&&d.explain404("PouchDB is just detecting blob URL support.")),URL.revokeObjectURL(e)})}}}).catch(function(){return!1})}var d=a(34),e=a(5),f=e.DETECT_BLOB_SUPPORT_STORE;b.exports=c},{}],4:[function(a,b){"use strict";function c(a,b,c,f,g,s){function t(){var a=[k,j,i,m,l,h],b=r(f,a,"readwrite");return b.error?s(b.error):(F=b.txn,F.onerror=q(s),F.ontimeout=q(s),F.oncomplete=w,G=F.objectStore(k),H=F.objectStore(j),I=F.objectStore(i),J=F.objectStore(h),void y(function(a){return a?(R=!0,s(a)):void v()}))}function u(){d.processDocs(L,c,Q,F,P,z,b)}function v(){function a(){++c===L.length&&u()}function b(b){var c=o(b.target.result);c&&Q.set(c.id,c),a()}if(L.length)for(var c=0,e=0,f=L.length;f>e;e++){var g=L[e];if(g._id&&d.isLocalId(g._id))a();else{var h=G.get(g.metadata.id);h.onsuccess=b}}}function w(){R||(g.notify(c._name),c._docCount=-1,s(null,P))}function x(a,b){var c=I.get(a);c.onsuccess=function(c){if(c.target.result)b();else{var d=e.error(e.MISSING_STUB,"unknown stub attachment with digest "+a);d.status=412,b(d)}}}function y(a){function b(){++e===c.length&&a(d)}var c=[];if(L.forEach(function(a){a.data&&a.data._attachments&&Object.keys(a.data._attachments).forEach(function(b){var d=a.data._attachments[b];d.stub&&c.push(d.digest)})}),!c.length)return a();var d,e=0;c.forEach(function(a){x(a,function(a){a&&!d&&(d=a),b()})})}function z(a,b,c,d,e,f,g){var h=a.data;h._id=a.metadata.id,h._rev=a.metadata.rev,c&&(h._deleted=!0);var i=h._attachments&&Object.keys(h._attachments).length;return i?C(a,b,c,d,e,g):void B(a,b,c,d,e,g)}function A(a){var b=d.compactTree(a.metadata);n(b,a.metadata.id,F)}function B(a,b,d,e,f,g){function h(e){f&&c.auto_compaction&&A(a),l.seq=e.target.result,delete l.rev;var g=p(l,b,d),h=G.put(g);h.onsuccess=j}function i(a){a.preventDefault(),a.stopPropagation();var b=H.index("_doc_id_rev"),c=b.getKey(k._doc_id_rev);c.onsuccess=function(a){var b=H.put(k,a.target.result);b.onsuccess=h}}function j(){P[g]={ok:!0,id:l.id,rev:b},Q.set(a.metadata.id,a.metadata),D(a,l.seq,e)}var k=a.data,l=a.metadata;k._doc_id_rev=l.id+"::"+l.rev,delete k._id,delete k._rev;
var m=H.put(k);m.onsuccess=h,m.onerror=i}function C(a,b,c,d,e,f){function g(){j===k.length&&B(a,b,c,d,e,f)}function h(){j++,g()}var i=a.data,j=0,k=Object.keys(i._attachments);k.forEach(function(b){var c=a.data._attachments[b];if(c.stub)j++,g();else{var d=c.data;delete c.data;var e=c.digest;E(e,d,h)}})}function D(a,b,c){function d(){++f===g.length&&c()}function e(c){var e=a.data._attachments[c].digest,f=J.put({seq:b,digestSeq:e+"::"+b});f.onsuccess=d,f.onerror=function(a){a.preventDefault(),a.stopPropagation(),d()}}var f=0,g=Object.keys(a.data._attachments||{});if(!g.length)return c();for(var h=0;h<g.length;h++)e(g[h])}function E(a,b,c){var d=I.count(a);d.onsuccess=function(d){var e=d.target.result;if(e)return c();var f={digest:a,body:b},g=I.put(f);g.onsuccess=c}}for(var F,G,H,I,J,K,L=a.docs,M=0,N=L.length;N>M;M++){var O=L[M];O._id&&d.isLocalId(O._id)||(O=L[M]=d.parseDoc(O,b.new_edits),O.error&&!K&&(K=O))}if(K)return s(K);var P=new Array(L.length),Q=new d.Map,R=!1,S=c._blobSupport?"blob":"base64";d.preprocessAttachments(L,S,function(a){return a?s(a):void t()})}var d=a(34),e=a(19),f=a(6),g=a(5),h=g.ATTACH_AND_SEQ_STORE,i=g.ATTACH_STORE,j=g.BY_SEQ_STORE,k=g.DOC_STORE,l=g.LOCAL_STORE,m=g.META_STORE,n=f.compactRevs,o=f.decodeMetadata,p=f.encodeMetadata,q=f.idbError,r=f.openTransactionSafely;b.exports=c},{}],5:[function(a,b,c){"use strict";c.ADAPTER_VERSION=5,c.DOC_STORE="document-store",c.BY_SEQ_STORE="by-sequence",c.ATTACH_STORE="attach-store",c.ATTACH_AND_SEQ_STORE="attach-seq-store",c.META_STORE="meta-store",c.LOCAL_STORE="local-store",c.DETECT_BLOB_SUPPORT_STORE="detect-blob-support"},{}],6:[function(a,b,c){(function(b){"use strict";function d(a,b,c){try{a.apply(b,c)}catch(a){"undefined"!=typeof PouchDB&&PouchDB.emit("error",a)}}var e=a(19),f=a(34),g=a(5);c.taskQueue={running:!1,queue:[]},c.applyNext=function(){if(!c.taskQueue.running&&c.taskQueue.queue.length){c.taskQueue.running=!0;var a=c.taskQueue.queue.shift();a.action(function(e,f){d(a.callback,this,[e,f]),c.taskQueue.running=!1,b.nextTick(c.applyNext)})}},c.idbError=function(a){return function(b){var c=b.target&&b.target.error&&b.target.error.name||b.target;a(e.error(e.IDB_ERROR,c,b.type))}},c.encodeMetadata=function(a,b,c){return{data:f.safeJsonStringify(a),winningRev:b,deletedOrLocal:c?"1":"0",seq:a.seq,id:a.id}},c.decodeMetadata=function(a){if(!a)return null;var b=f.safeJsonParse(a.data);return b.winningRev=a.winningRev,b.deletedOrLocal="1"===a.deletedOrLocal,b.seq=a.seq,b},c.decodeDoc=function(a){if(!a)return a;var b=f.lastIndexOf(a._doc_id_rev,":");return a._id=a._doc_id_rev.substring(0,b-1),a._rev=a._doc_id_rev.substring(b+1),delete a._doc_id_rev,a},c.readBlobData=function(a,b,c,d){c?a?"string"!=typeof a?f.readAsBinaryString(a,function(a){d(f.btoa(a))}):d(a):d(""):a?"string"!=typeof a?d(a):(a=f.fixBinary(atob(a)),d(f.createBlob([a],{type:b}))):d(f.createBlob([""],{type:b}))},c.fetchAttachmentsIfNecessary=function(a,b,c,d){function e(){++i===h.length&&d&&d()}function f(a,b){var d=a._attachments[b],f=d.digest,h=c.objectStore(g.ATTACH_STORE).get(f);h.onsuccess=function(a){d.body=a.target.result.body,e()}}var h=Object.keys(a._attachments||{});if(!h.length)return d&&d();var i=0;h.forEach(function(c){b.attachments&&b.include_docs?f(a,c):(a._attachments[c].stub=!0,e())})},c.postProcessAttachments=function(a){return f.Promise.all(a.map(function(a){if(a.doc&&a.doc._attachments){var b=Object.keys(a.doc._attachments);return f.Promise.all(b.map(function(b){var d=a.doc._attachments[b];if("body"in d){var e=d.body,g=d.content_type;return new f.Promise(function(h){c.readBlobData(e,g,!0,function(c){a.doc._attachments[b]=f.extend(f.pick(d,["digest","content_type"]),{data:c}),h()})})}}))}}))},c.compactRevs=function(a,b,c){function d(){k--,k||e()}function e(){f.length&&f.forEach(function(a){var b=j.index("digestSeq").count(IDBKeyRange.bound(a+"::",a+"::￿",!1,!1));b.onsuccess=function(b){var c=b.target.result;c||i.delete(a)}})}var f=[],h=c.objectStore(g.BY_SEQ_STORE),i=c.objectStore(g.ATTACH_STORE),j=c.objectStore(g.ATTACH_AND_SEQ_STORE),k=a.length;a.forEach(function(a){var c=h.index("_doc_id_rev"),e=b+"::"+a;c.getKey(e).onsuccess=function(a){var b=a.target.result;if("number"!=typeof b)return d();h.delete(b);var c=j.index("seq").openCursor(IDBKeyRange.only(b));c.onsuccess=function(a){var b=a.target.result;if(b){var c=b.value.digestSeq.split("::")[0];f.push(c),j.delete(b.primaryKey),b.continue()}else d()}}})},c.openTransactionSafely=function(a,b,c){try{return{txn:a.transaction(b,c)}}catch(a){return{error:a}}}}).call(this,a(39))},{}],7:[function(a,b){(function(c){"use strict";function d(a,b){var c=this;F.queue.push({action:function(b){e(c,a,b)},callback:b}),w()}function e(a,b,e){function f(a){var b=a.createObjectStore(t,{keyPath:"id"});a.createObjectStore(r,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),a.createObjectStore(q,{keyPath:"digest"}),a.createObjectStore(v,{keyPath:"id",autoIncrement:!1}),a.createObjectStore(s),b.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),a.createObjectStore(u,{keyPath:"_id"});var c=a.createObjectStore(p,{autoIncrement:!0});c.createIndex("seq","seq"),c.createIndex("digestSeq","digestSeq",{unique:!0})}function k(a,b){var c=a.objectStore(t);c.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),c.openCursor().onsuccess=function(a){var d=a.target.result;if(d){var e=d.value,f=h.isDeleted(e);e.deletedOrLocal=f?"1":"0",c.put(e),d.continue()}else b()}}function l(a){a.createObjectStore(u,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function w(a,b){var c=a.objectStore(u),d=a.objectStore(t),e=a.objectStore(r),f=d.openCursor();f.onsuccess=function(a){var f=a.target.result;if(f){var g=f.value,j=g.id,k=h.isLocalId(j),l=i.winningRev(g);if(k){var m=j+"::"+l,n=j+"::",o=j+"::~",p=e.index("_doc_id_rev"),q=IDBKeyRange.bound(n,o,!1,!1),r=p.openCursor(q);r.onsuccess=function(a){if(r=a.target.result){var b=r.value;b._doc_id_rev===m&&c.put(b),e.delete(r.primaryKey),r.continue()}else d.delete(f.primaryKey),f.continue()}}else f.continue()}else b&&b()}}function F(a){var b=a.createObjectStore(p,{autoIncrement:!0});b.createIndex("seq","seq"),b.createIndex("digestSeq","digestSeq",{unique:!0})}function I(a,b){var c=a.objectStore(r),d=a.objectStore(q),e=a.objectStore(p),f=d.count();f.onsuccess=function(a){var d=a.target.result;return d?void(c.openCursor().onsuccess=function(a){var c=a.target.result;if(!c)return b();for(var d=c.value,f=c.primaryKey,g=Object.keys(d._attachments||{}),h={},i=0;i<g.length;i++){var j=d._attachments[g[i]];h[j.digest]=!0}var k=Object.keys(h);for(i=0;i<k.length;i++){var l=k[i];e.put({seq:f,digestSeq:l+"::"+f})}c.continue()}):b()}}function J(a){function b(a){return a.data?z(a):(a.deletedOrLocal="1"===a.deletedOrLocal,a)}var c=a.objectStore(r),d=a.objectStore(t),e=d.openCursor();e.onsuccess=function(a){function e(){var a=h.id+"::",b=h.id+"::￿",d=c.index("_doc_id_rev").openCursor(IDBKeyRange.bound(a,b)),e=0;d.onsuccess=function(a){var b=a.target.result;if(!b)return h.seq=e,f();var c=b.primaryKey;c>e&&(e=c),b.continue()}}function f(){var a=A(h,h.winningRev,h.deletedOrLocal),b=d.put(a);b.onsuccess=function(){g.continue()}}var g=a.target.result;if(g){var h=b(g.value);return h.winningRev=h.winningRev||i.winningRev(h),h.seq?f():void e()}}}function K(a,b,c,d,e){try{if(a&&b)return e?IDBKeyRange.bound(b,a,!c,!1):IDBKeyRange.bound(a,b,!1,!c);if(a)return e?IDBKeyRange.upperBound(a):IDBKeyRange.lowerBound(a);if(b)return e?IDBKeyRange.lowerBound(b,!c):IDBKeyRange.upperBound(b,!c);if(d)return IDBKeyRange.only(d)}catch(a){return{error:a}}return null}function L(a,b,c){function d(){c(null,{total_rows:a,offset:b.skip,rows:A})}var e="startkey"in b?b.startkey:!1,f="endkey"in b?b.endkey:!1,g="key"in b?b.key:!1,k=b.skip||0,l="number"==typeof b.limit?b.limit:-1,m=b.inclusive_end!==!1,n="descending"in b&&b.descending?"prev":null,o=K(e,f,m,g,n);if(o&&o.error){var p=o.error;return"DataError"===p.name&&0===p.code?c(null,{total_rows:a,offset:b.skip,rows:[]}):c(j.error(j.IDB_ERROR,p.name,p.message))}var s=[t,r];b.attachments&&s.push(q);var u=G(Q,s,"readonly");if(u.error)return c(u.error);var v=u.txn;v.oncomplete=function(){b.attachments?D(A).then(d):d()};var w=v.objectStore(t),x=n?w.openCursor(o,n):w.openCursor(o),A=[];x.onsuccess=function(a){function c(a,c){var e={id:a.id,key:a.id,value:{rev:f}};b.include_docs&&(e.doc=c,b.conflicts&&(e.doc._conflicts=i.collectConflicts(a)),B(e.doc,b,v));var g=h.isDeleted(a,f);if("ok"===b.deleted)g&&(e.value.deleted=!0,e.doc=null),A.push(e);else if(!g&&k--<=0&&(A.push(e),0===--l))return;d.continue()}if(a.target.result){var d=a.target.result,e=z(d.value),f=e.winningRev;if(b.include_docs){var g=v.objectStore(r).index("_doc_id_rev"),j=e.id+"::"+f;g.get(j).onsuccess=function(a){c(z(d.value),y(a.target.result))}}else c(e)}}}function M(b){if(-1!==a._docCount)return b(null,a._docCount);var c,d=G(Q,[t],"readonly");if(d.error)return b(d.error);var e=d.txn,f=e.objectStore(t).index("deletedOrLocal");f.count(IDBKeyRange.only("0")).onsuccess=function(a){c=a.target.result},e.onerror=C(b),e.oncomplete=function(){a._docCount=c,b(null,a._docCount)}}var N=b.name,O=null,P=!1,Q=null;a._docCount=-1,a._blobSupport=null,a._name=N,a.type=function(){return"idb"},a._id=h.toPromise(function(a){a(null,O)}),a._bulkDocs=function(b,c,e){m(b,c,a,Q,d.Changes,e)},a._get=function(a,b,c){function d(){c(g,{doc:e,metadata:f,ctx:i})}var e,f,g,i;if(b=h.clone(b),b.ctx)i=b.ctx;else{var k=G(Q,[t,r,q],"readonly");if(k.error)return c(k.error);i=k.txn}i.objectStore(t).get(a).onsuccess=function(a){if(f=z(a.target.result),!f)return g=j.error(j.MISSING_DOC,"missing"),d();if(h.isDeleted(f)&&!b.rev)return g=j.error(j.MISSING_DOC,"deleted"),d();var c=i.objectStore(r),k=b.rev||f.winningRev,l=f.id+"::"+k;c.index("_doc_id_rev").get(l).onsuccess=function(a){return e=a.target.result,e&&(e=y(e)),e?void d():(g=j.error(j.MISSING_DOC,"missing"),d())}}},a._getAttachment=function(a,b,c){var d;if(b=h.clone(b),b.ctx)d=b.ctx;else{var e=G(Q,[t,r,q],"readonly");if(e.error)return c(e.error);d=e.txn}var f=a.digest,g=a.content_type;d.objectStore(q).get(f).onsuccess=function(a){var d=a.target.result.body;E(d,g,b.encode,function(a){c(null,a)})}},a._allDocs=function(a,b){M(function(c,d){return c?b(c):0===a.limit?b(null,{total_rows:d,offset:a.skip,rows:[]}):void L(d,a,b)})},a._info=function(b){M(function(c,d){if(c)return b(c);if(null===Q||!H[a._name]){var e=new Error("db isn't open");return e.id="idbNull",b(e)}var f=0,g=G(Q,[r],"readonly");if(g.error)return b(g.error);var h=g.txn;h.objectStore(r).openCursor(null,"prev").onsuccess=function(a){var b=a.target.result;f=b?b.key:0},h.oncomplete=function(){b(null,{doc_count:d,update_seq:f,idb_attachment_format:a._blobSupport?"binary":"base64"})}})},a._changes=function(b){function c(a){function c(){return h.seq!==g?a.continue():(l=g,h.winningRev===f._rev?e(f):void d())}function d(){var a=f._id+"::"+h.winningRev,b=p.index("_doc_id_rev").openCursor(IDBKeyRange.bound(a,a+"￿"));b.onsuccess=function(a){e(y(a.target.result.value))}}function e(c){var d=b.processChange(c,h,b);d.seq=h.seq,w(d)&&(v++,n&&u.push(d),b.attachments&&b.include_docs?B(c,b,o,function(){D([d]).then(function(){b.onChange(d)})}):b.onChange(d)),v!==m&&a.continue()}var f=y(a.value),g=a.key;if(j&&!j.has(f._id))return a.continue();var h;return(h=x.get(f._id))?c():void(s.get(f._id).onsuccess=function(a){h=z(a.target.result),x.set(f._id,h),c()})}function e(a){var b=a.target.result;b&&c(b)}function f(){var a=[t,r];b.attachments&&a.push(q);var c=G(Q,a,"readonly");if(c.error)return b.complete(c.error);o=c.txn,o.onerror=C(b.complete),o.oncomplete=g,p=o.objectStore(r),s=o.objectStore(t);var d;d=k?p.openCursor(null,k):p.openCursor(IDBKeyRange.lowerBound(b.since,!0)),d.onsuccess=e}function g(){function a(){b.complete(null,{results:u,last_seq:l})}!b.continuous&&b.attachments?D(u).then(a):a()}if(b=h.clone(b),b.continuous){var i=N+":"+h.uuid();return d.Changes.addListener(N,i,a,b),d.Changes.notify(N),{cancel:function(){d.Changes.removeListener(N,i)}}}var j=b.doc_ids&&new h.Set(b.doc_ids),k=b.descending?"prev":null;b.since=b.since||0;var l=b.since,m="limit"in b?b.limit:-1;0===m&&(m=1);var n;n="returnDocs"in b?b.returnDocs:!0;var o,p,s,u=[],v=0,w=h.filterChange(b),x=new h.Map;f()},a._close=function(a){return null===Q?a(j.error(j.NOT_OPEN)):(Q.close(),delete H[N],Q=null,void a())},a._getRevisionTree=function(a,b){var c=G(Q,[t],"readonly");if(c.error)return b(c.error);var d=c.txn,e=d.objectStore(t).get(a);e.onsuccess=function(a){var c=z(a.target.result);c?b(null,c.rev_tree):b(j.error(j.MISSING_DOC))}},a._doCompaction=function(a,b,c){var d=[t,r,q,p],e=G(Q,d,"readwrite");if(e.error)return c(e.error);var f=e.txn,g=f.objectStore(t);g.get(a).onsuccess=function(c){var d=z(c.target.result);i.traverseRevTree(d.rev_tree,function(a,c,d,e,f){var g=c+"-"+d;-1!==b.indexOf(g)&&(f.status="missing")}),x(b,a,f);var e=d.winningRev,g=d.deletedOrLocal;f.objectStore(t).put(A(d,e,g))},f.onerror=C(c),f.oncomplete=function(){h.call(c)}},a._getLocal=function(a,b){var c=G(Q,[u],"readonly");if(c.error)return b(c.error);var d=c.txn,e=d.objectStore(u).get(a);e.onerror=C(b),e.onsuccess=function(a){var c=a.target.result;c?(delete c._doc_id_rev,b(null,c)):b(j.error(j.MISSING_DOC))}},a._putLocal=function(a,b,c){"function"==typeof b&&(c=b,b={}),delete a._revisions;var d=a._rev,e=a._id;a._rev=d?"0-"+(parseInt(d.split("-")[1],10)+1):"0-1";var f,g=b.ctx;if(!g){var h=G(Q,[u],"readwrite");if(h.error)return c(h.error);g=h.txn,g.onerror=C(c),g.oncomplete=function(){f&&c(null,f)}}var i,k=g.objectStore(u);d?(i=k.get(e),i.onsuccess=function(e){var g=e.target.result;if(g&&g._rev===d){var h=k.put(a);h.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)}}else c(j.error(j.REV_CONFLICT))}):(i=k.add(a),i.onerror=function(a){c(j.error(j.REV_CONFLICT)),a.preventDefault(),a.stopPropagation()},i.onsuccess=function(){f={ok:!0,id:a._id,rev:a._rev},b.ctx&&c(null,f)})},a._removeLocal=function(a,b){var c=G(Q,[u],"readwrite");if(c.error)return b(c.error);var d,e=c.txn;e.oncomplete=function(){d&&b(null,d)};var f=a._id,g=e.objectStore(u),h=g.get(f);h.onerror=C(b),h.onsuccess=function(c){var e=c.target.result;e&&e._rev===a._rev?(g.delete(f),d={ok:!0,id:f,rev:"0-0"}):b(j.error(j.MISSING_DOC))}};var R=H[N];if(R)return Q=R.idb,O=R.instanceId,a._blobSupport=R.blobSupport,void c.nextTick(function(){e(null,a)});var S=indexedDB.open(N,o);"openReqList"in d||(d.openReqList={}),d.openReqList[N]=S,S.onupgradeneeded=function(a){function b(){var a=e[g-1];g++,a&&a(d,b)}var c=a.target.result;if(a.oldVersion<1)return f(c);var d=a.currentTarget.transaction;a.oldVersion<3&&l(c),a.oldVersion<4&&F(c);var e=[k,w,I,J],g=a.oldVersion;b()},S.onsuccess=function(b){Q=b.target.result,Q.onversionchange=function(){Q.close(),delete H[N]},Q.onabort=function(){Q.close(),delete H[N]};var c=Q.transaction([v,s],"readwrite"),d=c.objectStore(v).get(v);d.onsuccess=function(b){var d=function(){null!==a._blobSupport&&P&&(H[N]={idb:Q,instanceId:O,blobSupport:a._blobSupport,loaded:!0},e(null,a))},f=b.target.result||{id:v};N+"_id"in f?(O=f[N+"_id"],P=!0,d()):(O=h.uuid(),f[N+"_id"]=O,c.objectStore(v).put(f).onsuccess=function(){P=!0,d()}),g||(g=n(c,Q)),g.then(function(b){a._blobSupport=b,d()})}},S.onerror=C(e)}function f(a,b,c){"openReqList"in d||(d.openReqList={}),d.Changes.removeAllListeners(a),d.openReqList[a]&&d.openReqList[a].result&&(d.openReqList[a].result.close(),delete H[a]);var e=indexedDB.deleteDatabase(a);e.onsuccess=function(){d.openReqList[a]&&(d.openReqList[a]=null),h.hasLocalStorage()&&a in localStorage&&delete localStorage[a],c(null,{ok:!0})},e.onerror=C(c)}var g,h=a(34),i=a(29),j=a(19),k=a(6),l=a(5),m=a(4),n=a(3),o=l.ADAPTER_VERSION,p=l.ATTACH_AND_SEQ_STORE,q=l.ATTACH_STORE,r=l.BY_SEQ_STORE,s=l.DETECT_BLOB_SUPPORT_STORE,t=l.DOC_STORE,u=l.LOCAL_STORE,v=l.META_STORE,w=k.applyNext,x=k.compactRevs,y=k.decodeDoc,z=k.decodeMetadata,A=k.encodeMetadata,B=k.fetchAttachmentsIfNecessary,C=k.idbError,D=k.postProcessAttachments,E=k.readBlobData,F=k.taskQueue,G=k.openTransactionSafely,H={};d.valid=function(){var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);return!a&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange},d.destroy=h.toPromise(function(a,b,c){F.queue.push({action:function(c){f(a,b,c)},callback:c}),w()}),d.Changes=new h.Changes,b.exports=d}).call(this,a(39))},{}],8:[function(a,b){b.exports=["idb","websql"]},{}],9:[function(a,b){"use strict";function c(a,b,c,g,p,q){function r(){return D?q(D):(p.notify(c._name),c._docCount=-1,void q(null,E))}function s(a,b){var c="SELECT count(*) as cnt FROM "+j+" WHERE digest=?";C.executeSql(c,[a],function(c,d){if(0===d.rows.item(0).cnt){var f=e.error(e.MISSING_STUB,"unknown stub attachment with digest "+a);b(f)}else b()})}function t(a){function b(){++e===c.length&&a(d)}var c=[];if(A.forEach(function(a){a.data&&a.data._attachments&&Object.keys(a.data._attachments).forEach(function(b){var d=a.data._attachments[b];d.stub&&c.push(d.digest)})}),!c.length)return a();var d,e=0;c.forEach(function(a){s(a,function(a){a&&!d&&(d=a),b()})})}function u(a,b,e,f,g,j,o){function p(){function b(a,b){function d(){return++f===g.length&&b(),!1}function e(b){var e="INSERT INTO "+k+" (digest, seq) VALUES (?,?)",f=[c._attachments[b].digest,a];C.executeSql(e,f,d,d)}var f=0,g=Object.keys(c._attachments||{});if(!g.length)return b();for(var h=0;h<g.length;h++)e(g[h])}var c=a.data,d=e?1:0,f=c._id,g=c._rev,h=m(c),j="INSERT INTO "+i+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",n=[f,g,h,d];C.executeSql(j,n,function(a,c){var d=c.insertId;b(d,function(){t(a,d)})},function(){var a=l("seq",i,null,"doc_id=? AND rev=?");return C.executeSql(a,[f,g],function(a,c){var e=c.rows.item(0).seq,j="UPDATE "+i+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",k=[h,d,f,g];a.executeSql(j,k,function(a){b(e,function(){t(a,e)})})}),!1})}function q(a){u||(a?(u=a,f(u)):v===w.length&&p())}function r(a){v++,q(a)}function s(){if(g&&c.auto_compaction){var b=a.metadata.id,e=d.compactTree(a.metadata);n(e,b,C)}}function t(c,e){s(),a.metadata.seq=e,delete a.metadata.rev;var j=g?"UPDATE "+h+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+i+" WHERE doc_id="+h+".id AND rev=?) WHERE id=?":"INSERT INTO "+h+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",k=d.safeJsonStringify(a.metadata),l=a.metadata.id,m=g?[k,e,b,l]:[l,e,e,k];c.executeSql(j,m,function(){E[o]={ok:!0,id:a.metadata.id,rev:b},F.set(l,a.metadata),f()})}var u=null,v=0;a.data._id=a.metadata.id,a.data._rev=a.metadata.rev;var w=Object.keys(a.data._attachments||{});e&&(a.data._deleted=!0),w.forEach(function(b){var c=a.data._attachments[b];if(c.stub)v++,q();else{var d=c.data;delete c.data;var e=c.digest;x(e,d,r)}}),w.length||p()}function v(){d.processDocs(A,c,F,C,E,u,b)}function w(a){function b(){++c===A.length&&a()}if(!A.length)return a();var c=0;A.forEach(function(a){if(a._id&&d.isLocalId(a._id))return b();var c=a.metadata.id;C.executeSql("SELECT json FROM "+h+" WHERE id = ?",[c],function(a,e){if(e.rows.length){var f=d.safeJsonParse(e.rows.item(0).json);F.set(c,f)}b()})})}function x(a,b,c){var d="SELECT digest FROM "+j+" WHERE digest=?";C.executeSql(d,[a],function(e,g){return g.rows.length?c():(d="INSERT INTO "+j+" (digest, body, escaped) VALUES (?,?,1)",void e.executeSql(d,[a,f.escapeBlob(b)],function(){c()},function(){return c(),!1}))})}var y=b.new_edits,z=a.docs,A=z.map(function(a){if(a._id&&d.isLocalId(a._id))return a;var b=d.parseDoc(a,y);return b}),B=A.filter(function(a){return a.error});if(B.length)return q(B[0]);var C,D,E=new Array(A.length),F=new d.Map;d.preprocessAttachments(A,"binary",function(a){return a?q(a):void g.transaction(function(a){C=a,t(function(a){a?D=a:w(v)})},o(q),r)})}var d=a(34),e=a(19),f=a(11),g=a(10),h=g.DOC_STORE,i=g.BY_SEQ_STORE,j=g.ATTACH_STORE,k=g.ATTACH_AND_SEQ_STORE,l=f.select,m=f.stringifyDoc,n=f.compactRevs,o=f.unknownError;b.exports=c},{}],10:[function(a,b,c){"use strict";function d(a){return"'"+a+"'"}c.ADAPTER_VERSION=7,c.DOC_STORE=d("document-store"),c.BY_SEQ_STORE=d("by-sequence"),c.ATTACH_STORE=d("attach-store"),c.LOCAL_STORE=d("local-store"),c.META_STORE=d("metadata-store"),c.ATTACH_AND_SEQ_STORE=d("attach-seq-store")},{}],11:[function(a,b){"use strict";function c(a){return a.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function d(a){return a.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function e(a){return delete a._id,delete a._rev,JSON.stringify(a)}function f(a,b,c){return a=JSON.parse(a),a._id=b,a._rev=c,a}function g(a){for(var b="(";a--;)b+="?",a&&(b+=",");return b+")"}function h(a,b,c,d,e){return"SELECT "+a+" FROM "+("string"==typeof b?b:b.join(" JOIN "))+(c?" ON "+c:"")+(d?" WHERE "+("string"==typeof d?d:d.join(" AND ")):"")+(e?" ORDER BY "+e:"")}function i(a,b,c){function d(){++f===a.length&&e()}function e(){if(h.length){var a="SELECT DISTINCT digest AS digest FROM "+s+" WHERE seq IN "+g(h.length);c.executeSql(a,h,function(a,b){for(var c=[],d=0;d<b.rows.length;d++)c.push(b.rows.item(d).digest);if(c.length){var e="DELETE FROM "+s+" WHERE seq IN ("+h.map(function(){return"?"}).join(",")+")";a.executeSql(e,h,function(a){var b="SELECT digest FROM "+s+" WHERE digest IN ("+c.map(function(){return"?"}).join(",")+")";a.executeSql(b,c,function(a,b){for(var d=new n.Set,e=0;e<b.rows.length;e++)d.add(b.rows.item(e).digest);c.forEach(function(b){d.has(b)||(a.executeSql("DELETE FROM "+s+" WHERE digest=?",[b]),a.executeSql("DELETE FROM "+r+" WHERE digest=?",[b]))})})})}})}}if(a.length){var f=0,h=[];a.forEach(function(a){var e="SELECT seq FROM "+q+" WHERE doc_id=? AND rev=?";c.executeSql(e,[b,a],function(a,b){if(!b.rows.length)return d();var c=b.rows.item(0).seq;h.push(c),a.executeSql("DELETE FROM "+q+" WHERE seq=?",[c],d)})})}}function j(a){return function(b){var c=b&&b.constructor.toString().match(/function ([^\(]+)/),d=c&&c[1]||b.type,e=b.target||b.message;a(o.error(o.WSQ_ERROR,e,d))}}function k(a){if("size"in a)return 1e6*a.size;var b=/Android/.test(window.navigator.userAgent);return b?5e6:1}function l(a,b,c,d){var e="undefined"!=typeof sqlitePlugin&&sqlitePlugin.openDatabase&&sqlitePlugin.openDatabase.bind(sqlitePlugin),f=e||"undefined"!=typeof openDatabase&&openDatabase,g=t[a];return g||(g=t[a]=f(a,b,c,d),g._sqlitePlugin=!!e),g}function m(){return"undefined"!=typeof openDatabase||"undefined"!=typeof SQLitePlugin}var n=a(34),o=a(19),p=a(10),q=p.BY_SEQ_STORE,r=p.ATTACH_STORE,s=p.ATTACH_AND_SEQ_STORE,t={};b.exports={escapeBlob:c,unescapeBlob:d,stringifyDoc:e,unstringifyDoc:f,qMarks:g,select:h,compactRevs:i,unknownError:j,getSize:k,openDB:l,valid:m}},{}],12:[function(a,b){"use strict";function c(a,b,c,d,f){function g(){++j===i.length&&f&&f()}function h(a,b){var f=a._attachments[b],h={encode:!0,ctx:d};c._getAttachment(f,h,function(c,d){a._attachments[b]=e.extend(e.pick(f,["digest","content_type"]),{data:d}),g()})}var i=Object.keys(a._attachments||{});if(!i.length)return f&&f();var j=0;i.forEach(function(c){b.attachments&&b.include_docs?h(a,c):(a._attachments[c].stub=!0,g())})}function d(a,b){function i(){e.hasLocalStorage()&&(window.localStorage["_pouch__websqldb_"+V._name]=!0),b(null,V)}function I(a,b){a.executeSql(D),a.executeSql("ALTER TABLE "+n+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){a.executeSql(B),a.executeSql("ALTER TABLE "+m+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){a.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+m+" (local, id)");var c="SELECT "+m+".winningseq AS seq, "+m+".json AS metadata FROM "+n+" JOIN "+m+" ON "+n+".seq = "+m+".winningseq";a.executeSql(c,[],function(a,c){for(var d=[],f=[],g=0;g<c.rows.length;g++){var h=c.rows.item(g),i=h.seq,j=JSON.parse(h.metadata);e.isDeleted(j)&&d.push(i),e.isLocalId(j.id)&&f.push(j.id)}a.executeSql("UPDATE "+m+"SET local = 1 WHERE id IN "+s(f.length),f,function(){a.executeSql("UPDATE "+n+" SET deleted = 1 WHERE seq IN "+s(d.length),d,b)})})})})}function J(a,b){var c="CREATE TABLE IF NOT EXISTS "+p+" (id UNIQUE, rev, json)";a.executeSql(c,[],function(){var c="SELECT "+m+".id AS id, "+n+".json AS data FROM "+n+" JOIN "+m+" ON "+n+".seq = "+m+".winningseq WHERE local = 1";a.executeSql(c,[],function(a,c){function d(){if(!e.length)return b(a);var c=e.shift(),f=JSON.parse(c.data)._rev;a.executeSql("INSERT INTO "+p+" (id, rev, json) VALUES (?,?,?)",[c.id,f,c.data],function(a){a.executeSql("DELETE FROM "+m+" WHERE id=?",[c.id],function(a){a.executeSql("DELETE FROM "+n+" WHERE seq=?",[c.seq],function(){d()})})})}for(var e=[],f=0;f<c.rows.length;f++)e.push(c.rows.item(f));d()})})}function K(a,b){function c(c){function d(){if(!c.length)return b(a);var e=c.shift(),f=h(e.hex,U),g=f.lastIndexOf("::"),i=f.substring(0,g),j=f.substring(g+2),k="UPDATE "+n+" SET doc_id=?, rev=? WHERE doc_id_rev=?";a.executeSql(k,[i,j,f],function(){d()})}d()}var d="ALTER TABLE "+n+" ADD COLUMN doc_id";a.executeSql(d,[],function(a){var b="ALTER TABLE "+n+" ADD COLUMN rev";a.executeSql(b,[],function(a){a.executeSql(C,[],function(a){var b="SELECT hex(doc_id_rev) as hex FROM "+n;a.executeSql(b,[],function(a,b){for(var d=[],e=0;e<b.rows.length;e++)d.push(b.rows.item(e));c(d)})})})})}function L(a,b){function c(a){var c="SELECT COUNT(*) AS cnt FROM "+o;a.executeSql(c,[],function(a,c){function d(){var c=v(H+", "+m+".id AS id",[m,n],G,null,m+".id ");c+=" LIMIT "+g+" OFFSET "+f,f+=g,a.executeSql(c,[],function(a,c){function e(a,b){var c=f[a]=f[a]||[];-1===c.indexOf(b)&&c.push(b)}if(!c.rows.length)return b(a);for(var f={},g=0;g<c.rows.length;g++)for(var h=c.rows.item(g),i=u(h.data,h.id,h.rev),j=Object.keys(i._attachments||{}),k=0;k<j.length;k++){var l=i._attachments[j[k]];e(l.digest,h.seq)}var m=[];if(Object.keys(f).forEach(function(a){var b=f[a];b.forEach(function(b){m.push([a,b])})}),!m.length)return d();var n=0;m.forEach(function(b){var c="INSERT INTO "+r+" (digest, seq) VALUES (?,?)";a.executeSql(c,b,function(){++n===m.length&&d()})})})}var e=c.rows.item(0).cnt;if(!e)return b(a);var f=0,g=10;d()})}var d="CREATE TABLE IF NOT EXISTS "+r+" (digest, seq INTEGER)";a.executeSql(d,[],function(a){a.executeSql(F,[],function(a){a.executeSql(E,[],c)})})}function M(a,b){var c="ALTER TABLE "+o+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";a.executeSql(c,[],b)}function N(a,b){var c="ALTER TABLE "+m+" ADD COLUMN max_seq INTEGER";a.executeSql(c,[],function(a){var c="UPDATE "+m+" SET max_seq=(SELECT MAX(seq) FROM "+n+" WHERE doc_id=id)";a.executeSql(c,[],function(a){var c="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+m+" (max_seq)";a.executeSql(c,[],b)})})}function O(a,b){a.executeSql('SELECT HEX("a") AS hex',[],function(a,c){var d=c.rows.item(0).hex;U=2===d.length?"UTF-8":"UTF-16",b()})}function P(){for(;Y.length>0;){var a=Y.pop();a(null,W)}}function Q(a,b){if(0===b){var c="CREATE TABLE IF NOT EXISTS "+q+" (dbid, db_version INTEGER)",d="CREATE TABLE IF NOT EXISTS "+o+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",f="CREATE TABLE IF NOT EXISTS "+r+" (digest, seq INTEGER)",g="CREATE TABLE IF NOT EXISTS "+m+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",h="CREATE TABLE IF NOT EXISTS "+n+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",i="CREATE TABLE IF NOT EXISTS "+p+" (id UNIQUE, rev, json)";a.executeSql(d),a.executeSql(i),a.executeSql(f,[],function(){a.executeSql(E),a.executeSql(F)}),a.executeSql(g,[],function(){a.executeSql(D),a.executeSql(h,[],function(){a.executeSql(B),a.executeSql(C),a.executeSql(c,[],function(){var b="INSERT INTO "+q+" (db_version, dbid) VALUES (?,?)";W=e.uuid();var c=[l,W];a.executeSql(b,c,function(){P()})})})})}else{var j=function(){var c=l>b;c&&a.executeSql("UPDATE "+q+" SET db_version = "+l);var d="SELECT dbid FROM "+q;a.executeSql(d,[],function(a,b){W=b.rows.item(0).dbid,P()})},k=[I,J,K,L,M,N,j],s=b,t=function(a){k[s-1](a,t),s++};t(a)}}function R(){Z.transaction(function(a){O(a,function(){S(a)})},x(b),i)}function S(a){var b="SELECT sql FROM sqlite_master WHERE tbl_name = "+q;a.executeSql(b,[],function(a,b){b.rows.length?/db_version/.test(b.rows.item(0).sql)?a.executeSql("SELECT db_version FROM "+q,[],function(a,b){var c=b.rows.item(0).db_version;Q(a,c)}):a.executeSql("ALTER TABLE "+q+" ADD COLUMN db_version INTEGER",[],function(){Q(a,1)}):Q(a,0)})}function T(a,b){if(-1!==V._docCount)return b(V._docCount);var c=v("COUNT("+m+".id) AS 'num'",[m,n],G,n+".deleted=0");a.executeSql(c,[],function(a,c){V._docCount=c.rows.item(0).num,b(V._docCount)})}var U,V=this,W=null,X=y(a),Y=[];V._docCount=-1,V._name=a.name;var Z=z(V._name,A,V._name,X);return Z?("function"!=typeof Z.readTransaction&&(Z.readTransaction=Z.transaction),e.isCordova()?window.addEventListener(V._name+"_pouch",function a(){window.removeEventListener(V._name+"_pouch",a,!1),R()},!1):R(),V.type=function(){return"websql"},V._id=e.toPromise(function(a){a(null,W)}),V._info=function(a){Z.readTransaction(function(b){T(b,function(c){var d="SELECT MAX(seq) AS seq FROM "+n;b.executeSql(d,[],function(b,d){var e=d.rows.item(0).seq||0;a(null,{doc_count:c,update_seq:e,sqlite_plugin:Z._sqlitePlugin,websql_encoding:U})})})},x(a))},V._bulkDocs=function(a,b,c){k(a,b,V,Z,d.Changes,c)},V._get=function(a,b,c){function d(){c(i,{doc:f,metadata:h,ctx:l})}b=e.clone(b);var f,h,i;if(!b.ctx)return void Z.readTransaction(function(d){b.ctx=d,V._get(a,b,c)});var j,k,l=b.ctx;b.rev?(j=v(H,[m,n],m+".id="+n+".doc_id",[n+".doc_id=?",n+".rev=?"]),k=[a,b.rev]):(j=v(H,[m,n],G,m+".id=?"),k=[a]),l.executeSql(j,k,function(a,c){if(!c.rows.length)return i=g.error(g.MISSING_DOC,"missing"),d();var j=c.rows.item(0);return h=e.safeJsonParse(j.metadata),j.deleted&&!b.rev?(i=g.error(g.MISSING_DOC,"deleted"),d()):(f=u(j.data,h.id,j.rev),void d())})},V._allDocs=function(a,b){var d,g=[],h="startkey"in a?a.startkey:!1,i="endkey"in a?a.endkey:!1,j="key"in a?a.key:!1,k="descending"in a?a.descending:!1,l="limit"in a?a.limit:-1,o="skip"in a?a.skip:0,p=a.inclusive_end!==!1,q=[],r=[];if(j!==!1)r.push(m+".id = ?"),q.push(j);else if(h!==!1||i!==!1){if(h!==!1&&(r.push(m+".id "+(k?"<=":">=")+" ?"),q.push(h)),i!==!1){var s=k?">":"<";p&&(s+="="),r.push(m+".id "+s+" ?"),q.push(i)}j!==!1&&(r.push(m+".id = ?"),q.push(j))}"ok"!==a.deleted&&r.push(n+".deleted = 0"),Z.readTransaction(function(b){T(b,function(h){if(d=h,0!==l){var i=v(H,[m,n],G,r,m+".id "+(k?"DESC":"ASC"));i+=" LIMIT "+l+" OFFSET "+o,b.executeSql(i,q,function(b,d){for(var h=0,i=d.rows.length;i>h;h++){var j=d.rows.item(h),k=e.safeJsonParse(j.metadata),l=k.id,m=u(j.data,l,j.rev),n=m._rev,o={id:l,key:l,value:{rev:n}};if(a.include_docs&&(o.doc=m,o.doc._rev=n,a.conflicts&&(o.doc._conflicts=f.collectConflicts(k)),c(o.doc,a,V,b)),j.deleted){if("ok"!==a.deleted)continue;o.value.deleted=!0,o.doc=null}g.push(o)}})}})},x(b),function(){b(null,{total_rows:d,offset:a.skip,rows:g})})},V._changes=function(a){function b(){var b=m+".json AS metadata, "+m+".max_seq AS maxSeq, "+n+".json AS winningDoc, "+n+".rev AS winningRev ",d=m+" JOIN "+n,f=m+".id="+n+".doc_id AND "+m+".winningseq="+n+".seq",l=["maxSeq > ?"],o=[a.since];a.doc_ids&&(l.push(m+".id IN "+s(a.doc_ids.length)),o=o.concat(a.doc_ids));var p="maxSeq "+(g?"DESC":"ASC"),q=v(b,d,f,l,p),r=e.filterChange(a);a.view||a.filter||(q+=" LIMIT "+h);var t=a.since||0;Z.readTransaction(function(b){b.executeSql(q,o,function(b,d){function f(b){return function(){a.onChange(b)}}for(var g=0,l=d.rows.length;l>g;g++){var m=d.rows.item(g),n=e.safeJsonParse(m.metadata);t=m.maxSeq;var o=u(m.winningDoc,n.id,m.winningRev),p=a.processChange(o,n,a);if(p.seq=m.maxSeq,r(p)&&(k++,i&&j.push(p),a.attachments&&a.include_docs?c(o,a,V,b,f(p)):f(p)()),k===h)break}})},x(a.complete),function(){a.continuous||a.complete(null,{results:j,last_seq:t})})}if(a=e.clone(a),a.continuous){var f=V._name+":"+e.uuid();return d.Changes.addListener(V._name,f,V,a),d.Changes.notify(V._name),{cancel:function(){d.Changes.removeListener(V._name,f)}}}var g=a.descending;a.since=a.since&&!g?a.since:0;var h="limit"in a?a.limit:-1;
0===h&&(h=1);var i;i="returnDocs"in a?a.returnDocs:!0;var j=[],k=0;b()},V._close=function(a){a()},V._getAttachment=function(a,b,c){var d,f=b.ctx,g=a.digest,i=a.content_type,k="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+o+" WHERE digest=?";f.executeSql(k,[g],function(a,f){var g=f.rows.item(0),k=g.escaped?j.unescapeBlob(g.body):h(g.body,U);b.encode?d=btoa(k):(k=e.fixBinary(k),d=e.createBlob([k],{type:i})),c(null,d)})},V._getRevisionTree=function(a,b){Z.readTransaction(function(c){var d="SELECT json AS metadata FROM "+m+" WHERE id = ?";c.executeSql(d,[a],function(a,c){if(c.rows.length){var d=e.safeJsonParse(c.rows.item(0).metadata);b(null,d.rev_tree)}else b(g.error(g.MISSING_DOC))})})},V._doCompaction=function(a,b,c){return b.length?void Z.transaction(function(c){var d="SELECT json AS metadata FROM "+m+" WHERE id = ?";c.executeSql(d,[a],function(c,d){var g=e.safeJsonParse(d.rows.item(0).metadata);f.traverseRevTree(g.rev_tree,function(a,c,d,e,f){var g=c+"-"+d;-1!==b.indexOf(g)&&(f.status="missing")});var h="UPDATE "+m+" SET json = ? WHERE id = ?";c.executeSql(h,[e.safeJsonStringify(g),a])}),w(b,a,c)},x(c),function(){c()}):c()},V._getLocal=function(a,b){Z.readTransaction(function(c){var d="SELECT json, rev FROM "+p+" WHERE id=?";c.executeSql(d,[a],function(c,d){if(d.rows.length){var e=d.rows.item(0),f=u(e.json,a,e.rev);b(null,f)}else b(g.error(g.MISSING_DOC))})})},V._putLocal=function(a,b,c){function d(a){var d,k;f?(d="UPDATE "+p+" SET rev=?, json=? WHERE id=? AND rev=?",k=[e,j,h,f]):(d="INSERT INTO "+p+" (id, rev, json) VALUES (?,?,?)",k=[h,e,j]),a.executeSql(d,k,function(a,d){d.rowsAffected?(i={ok:!0,id:h,rev:e},b.ctx&&c(null,i)):c(g.error(g.REV_CONFLICT))},function(){return c(g.error(g.REV_CONFLICT)),!1})}"function"==typeof b&&(c=b,b={}),delete a._revisions;var e,f=a._rev,h=a._id;e=a._rev=f?"0-"+(parseInt(f.split("-")[1],10)+1):"0-1";var i,j=t(a);b.ctx?d(b.ctx):Z.transaction(function(a){d(a)},x(c),function(){i&&c(null,i)})},void(V._removeLocal=function(a,b){var c;Z.transaction(function(d){var e="DELETE FROM "+p+" WHERE id=? AND rev=?",f=[a._id,a._rev];d.executeSql(e,f,function(d,e){return e.rowsAffected?void(c={ok:!0,id:a._id,rev:"0-0"}):b(g.error(g.MISSING_DOC))})},x(b),function(){c&&b(null,c)})})):b(g.error(g.UNKNOWN_ERROR))}var e=a(34),f=a(29),g=a(19),h=a(22),i=a(10),j=a(11),k=a(9),l=i.ADAPTER_VERSION,m=i.DOC_STORE,n=i.BY_SEQ_STORE,o=i.ATTACH_STORE,p=i.LOCAL_STORE,q=i.META_STORE,r=i.ATTACH_AND_SEQ_STORE,s=j.qMarks,t=j.stringifyDoc,u=j.unstringifyDoc,v=j.select,w=j.compactRevs,x=j.unknownError,y=j.getSize,z=j.openDB,A=1,B="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+n+" (seq, deleted)",C="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+n+" (doc_id, rev)",D="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+m+" (winningseq)",E="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+r+" (seq)",F="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+r+" (digest, seq)",G=n+".seq = "+m+".winningseq",H=n+".seq AS seq, "+n+".deleted AS deleted, "+n+".json AS data, "+n+".rev AS rev, "+m+".json AS metadata";d.valid=j.valid,d.destroy=e.toPromise(function(a,b,c){d.Changes.removeAllListeners(a);var f=y(b),g=z(a,A,a,f);g.transaction(function(a){var b=[m,n,o,q,p,r];b.forEach(function(b){a.executeSql("DROP TABLE IF EXISTS "+b,[])})},x(c),function(){e.hasLocalStorage()&&(delete window.localStorage["_pouch__websqldb_"+a],delete window.localStorage[a]),c(null,{ok:!0})})}),d.Changes=new e.Changes,b.exports=d},{}],13:[function(a,b){"use strict";function c(a,b,c){function d(){f.cancel()}h.call(this);var f=this;this.db=a,b=b?e.clone(b):{};var g=c||b.complete||function(){},i=b.complete=e.once(function(b,c){b?f.emit("error",b):f.emit("complete",c),f.removeAllListeners(),a.removeListener("destroyed",d)});g&&(f.on("complete",function(a){g(null,a)}),f.on("error",function(a){g(a)}));var j=b.onChange;j&&f.on("change",j),a.once("destroyed",d),b.onChange=function(a){b.isCancelled||(f.emit("change",a),f.startSeq&&f.startSeq<=a.seq&&(f.emit("uptodate"),f.startSeq=!1),a.deleted?f.emit("delete",a):1===a.changes.length&&"1-"===a.changes[0].rev.slice(0,2)?f.emit("create",a):f.emit("update",a))};var k=new e.Promise(function(a,c){b.complete=function(b,d){b?c(b):a(d)}});f.once("cancel",function(){j&&f.removeListener("change",j),b.complete(null,{status:"cancelled"})}),this.then=k.then.bind(k),this.catch=k.catch.bind(k),this.then(function(a){i(null,a)},i),a.taskqueue.isReady?f.doChanges(b):a.taskqueue.addTask(function(){f.isCancelled?f.emit("cancel"):f.doChanges(b)})}function d(a,b,c){var d=[{rev:a._rev}];"all_docs"===c.style&&(d=f.collectLeaves(b.rev_tree).map(function(a){return{rev:a.rev}}));var g={id:b.id,changes:d,doc:a};return e.isDeleted(b,a._rev)&&(g.deleted=!0),c.conflicts&&(g.doc._conflicts=f.collectConflicts(b),g.doc._conflicts.length||delete g.doc._conflicts),g}var e=a(34),f=a(29),g=a(19),h=a(38).EventEmitter,i=a(27),j=a(28);b.exports=c,e.inherits(c,h),c.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},c.prototype.doChanges=function(a){var b=this,c=a.complete;if(a=e.clone(a),"live"in a&&!("continuous"in a)&&(a.continuous=a.live),a.processChange=d,"latest"===a.since&&(a.since="now"),a.since||(a.since=0),"now"===a.since)return void this.db.info().then(function(d){return b.isCancelled?void c(null,{status:"cancelled"}):(a.since=d.update_seq,void b.doChanges(a))},c);if(a.continuous&&"now"!==a.since&&this.db.info().then(function(a){b.startSeq=a.update_seq},function(a){if("idbNull"!==a.id)throw a}),"http"!==this.db.type()&&a.filter&&"string"==typeof a.filter&&!a.doc_ids)return this.filterChanges(a);"descending"in a||(a.descending=!1),a.limit=0===a.limit?1:a.limit,a.complete=c;var f=this.db._changes(a);if(f&&"function"==typeof f.cancel){var g=b.cancel;b.cancel=e.getArguments(function(a){f.cancel(),g.apply(this,a)})}},c.prototype.filterChanges=function(a){var b=this,c=a.complete;if("_view"===a.filter){if(!a.view||"string"!=typeof a.view){var d=g.error(g.BAD_REQUEST,"`view` filter parameter is not provided.");return void c(d)}var e=a.view.split("/");this.db.get("_design/"+e[0],function(d,f){if(b.isCancelled)return void c(null,{status:"cancelled"});if(d)return void c(g.generateErrorFromResponse(d));if(f&&f.views&&f.views[e[1]]){var h=j(f.views[e[1]].map);return a.filter=h,void b.doChanges(a)}var i=f.views?"missing json key: "+e[1]:"missing json key: views";d||(d=g.error(g.MISSING_DOC,i)),c(d)})}else{var f=a.filter.split("/");this.db.get("_design/"+f[0],function(d,e){if(b.isCancelled)return void c(null,{status:"cancelled"});if(d)return void c(g.generateErrorFromResponse(d));if(e&&e.filters&&e.filters[f[1]]){var h=i(e.filters[f[1]]);return a.filter=h,void b.doChanges(a)}var j=e&&e.filters?"missing json key: "+f[1]:"missing json key: filters";return d||(d=g.error(g.MISSING_DOC,j)),void c(d)})}}},{}],14:[function(a,b){"use strict";function c(a,b,c,d){return a.get(b).catch(function(c){if(404===c.status)return"http"===a.type()&&e.explain404("PouchDB is just checking if a remote checkpoint exists."),{_id:b};throw c}).then(function(b){return d.cancelled?void 0:(b.last_seq=c,a.put(b))})}function d(a,b,c,d){this.src=a,this.target=b,this.id=c,this.returnValue=d}var e=a(34),f=a(62),g=f.collate;d.prototype.writeCheckpoint=function(a){var b=this;return this.updateTarget(a).then(function(){return b.updateSource(a)})},d.prototype.updateTarget=function(a){return c(this.target,this.id,a,this.returnValue)},d.prototype.updateSource=function(a){var b=this;return this.readOnlySource?e.Promise.resolve(!0):c(this.src,this.id,a,this.returnValue).catch(function(a){var c="number"==typeof a.status&&4===Math.floor(a.status/100);if(c)return b.readOnlySource=!0,!0;throw a})},d.prototype.getCheckpoint=function(){var a=this;return a.target.get(a.id).then(function(b){return a.src.get(a.id).then(function(a){return 0===g(b.last_seq,a.last_seq)?a.last_seq:0},function(c){if(404===c.status&&b.last_seq)return a.src.put({_id:a.id,last_seq:0}).then(function(){return 0},function(c){return 401===c.status?(a.readOnlySource=!0,b.last_seq):0});throw c})}).catch(function(a){if(404!==a.status)throw a;return 0})},b.exports=d},{}],15:[function(a,b){(function(c,d){"use strict";function e(a){a&&d.debug&&console.error(a)}function f(a,b,d){if(!(this instanceof f))return new f(a,b,d);var k=this;("function"==typeof b||"undefined"==typeof b)&&(d=b,b={}),a&&"object"==typeof a&&(b=a,a=void 0),"undefined"==typeof d&&(d=e),b=b||{},this.__opts=b;var l=d;k.auto_compaction=b.auto_compaction,k.prefix=f.prefix,g.call(k),k.taskqueue=new i;var m=new j(function(e,g){d=function(a,b){return a?g(a):(delete b.then,void e(b))},b=h.clone(b);var i,j,l=b.name||a;return function(){try{if("string"!=typeof l)throw j=new Error("Missing/invalid DB name"),j.code=400,j;if(i=f.parseAdapter(l,b),b.originalName=l,b.name=i.name,b.prefix&&"http"!==i.adapter&&"https"!==i.adapter&&(b.name=b.prefix+b.name),b.adapter=b.adapter||i.adapter,k._adapter=b.adapter,k._db_name=l,!f.adapters[b.adapter])throw j=new Error("Adapter is missing"),j.code=404,j;if(!f.adapters[b.adapter].valid())throw j=new Error("Invalid Adapter"),j.code=404,j}catch(a){k.taskqueue.fail(a),k.changes=h.toPromise(function(b){b.complete&&b.complete(a)})}}(),j?g(j):(k.adapter=b.adapter,k.replicate={},k.replicate.from=function(a,b,c){return k.constructor.replicate(a,k,b,c)},k.replicate.to=function(a,b,c){return k.constructor.replicate(k,a,b,c)},k.sync=function(a,b,c){return k.constructor.sync(k,a,b,c)},k.replicate.sync=k.sync,k.destroy=h.adapterFun("destroy",function(a){var b=this,c=this.__opts||{};b.info(function(d,e){return d?a(d):(c.internal=!0,void b.constructor.destroy(e.db_name,c,a))})}),f.adapters[b.adapter].call(k,b,function(a){function c(a){"destroyed"===a&&(k.emit("destroyed"),f.removeListener(l,c))}return a?void(d&&(k.taskqueue.fail(a),d(a))):(f.on(l,c),k.emit("created",k),f.emit("created",b.originalName),k.taskqueue.ready(k),void d(null,k))}),b.skipSetup&&(k.taskqueue.ready(k),c.nextTick(function(){d(null,k)})),void(h.isCordova()&&cordova.fireWindowEvent(b.name+"_pouch",{})))});m.then(function(a){l(null,a)},l),k.then=m.then.bind(m),k.catch=m.catch.bind(m)}var g=a(1),h=a(34),i=a(33),j=h.Promise;h.inherits(f,g),f.debug=a(40),b.exports=f}).call(this,a(39),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(a,b){(function(c){"use strict";function d(a,b){function d(b,c,d){if(a.binary||a.json||!a.processData||"string"==typeof b){if(!a.binary&&a.json&&"string"==typeof b)try{b=JSON.parse(b)}catch(a){return d(a)}}else b=JSON.stringify(b);Array.isArray(b)&&(b=b.map(function(a){return a.error||a.missing?g.generateErrorFromResponse(a):a})),d(null,b,c)}function i(a,b){var c,d;if(a.code&&a.status){var e=new Error(a.message||a.code);return e.status=a.status,b(e)}try{c=JSON.parse(a.responseText),d=g.generateErrorFromResponse(c)}catch(b){d=g.generateErrorFromResponse(a)}b(d)}function j(){return c.browser?"":new f("","binary")}var k=!1,l=h.getArguments(function(a){k||(b.apply(this,a),k=!0)});"function"==typeof a&&(l=a,a={}),a=h.clone(a);var m={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return a=h.extend(!0,m,a),a.json&&(a.binary||(a.headers.Accept="application/json"),a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json"),a.binary&&(a.encoding=null,a.json=!1),a.processData||(a.json=!1),e(a,function(b,c,e){if(b)return b.status=c?c.statusCode:400,i(b,l);var f,h=c.headers&&c.headers["content-type"],k=e||j();a.binary||!a.json&&a.processData||"object"==typeof k||!(/json/.test(h)||/^[\s]*\{/.test(k)&&/\}[\s]*$/.test(k))||(k=JSON.parse(k)),c.statusCode>=200&&c.statusCode<300?d(k,c,l):(a.binary&&(k=JSON.parse(k.toString())),f=g.generateErrorFromResponse(k),f.status=c.statusCode,l(f))})}var e=a(24),f=a(18),g=a(19),h=a(34);b.exports=d}).call(this,a(39))},{}],17:[function(a,b){(function(a){"use strict";function c(b,c){b=b||[],c=c||{};try{return new Blob(b,c)}catch(g){if("TypeError"!==g.name)throw g;for(var d=a.BlobBuilder||a.MSBlobBuilder||a.MozBlobBuilder||a.WebKitBlobBuilder,e=new d,f=0;f<b.length;f+=1)e.append(b[f]);return e.getBlob(c.type)}}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(a,b){b.exports={}},{}],19:[function(a,b,c){"use strict";function d(a){Error.call(a.reason),this.status=a.status,this.name=a.error,this.message=a.reason,this.error=!0}var e=a(43);e(d,Error),d.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message})},c.UNAUTHORIZED=new d({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),c.MISSING_BULK_DOCS=new d({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),c.MISSING_DOC=new d({status:404,error:"not_found",reason:"missing"}),c.REV_CONFLICT=new d({status:409,error:"conflict",reason:"Document update conflict"}),c.INVALID_ID=new d({status:400,error:"invalid_id",reason:"_id field must contain a string"}),c.MISSING_ID=new d({status:412,error:"missing_id",reason:"_id is required for puts"}),c.RESERVED_ID=new d({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),c.NOT_OPEN=new d({status:412,error:"precondition_failed",reason:"Database not open"}),c.UNKNOWN_ERROR=new d({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),c.BAD_ARG=new d({status:500,error:"badarg",reason:"Some query argument is invalid"}),c.INVALID_REQUEST=new d({status:400,error:"invalid_request",reason:"Request was invalid"}),c.QUERY_PARSE_ERROR=new d({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),c.DOC_VALIDATION=new d({status:500,error:"doc_validation",reason:"Bad special document member"}),c.BAD_REQUEST=new d({status:400,error:"bad_request",reason:"Something wrong with the request"}),c.NOT_AN_OBJECT=new d({status:400,error:"bad_request",reason:"Document must be a JSON object"}),c.DB_MISSING=new d({status:404,error:"not_found",reason:"Database not found"}),c.IDB_ERROR=new d({status:500,error:"indexed_db_went_bad",reason:"unknown"}),c.WSQ_ERROR=new d({status:500,error:"web_sql_went_bad",reason:"unknown"}),c.LDB_ERROR=new d({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),c.FORBIDDEN=new d({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),c.INVALID_REV=new d({status:400,error:"bad_request",reason:"Invalid rev format"}),c.FILE_EXISTS=new d({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),c.MISSING_STUB=new d({status:412,error:"missing_stub"}),c.error=function(a,b,c){function e(b){for(var d in a)"function"!=typeof a[d]&&(this[d]=a[d]);void 0!==c&&(this.name=c),void 0!==b&&(this.reason=b)}return e.prototype=d.prototype,new e(b)},c.getErrorTypeByProp=function(a,b,d){var e=c,f=Object.keys(e).filter(function(c){var d=e[c];return"function"!=typeof d&&d[a]===b}),g=d&&f.filter(function(a){var b=e[a];return b.message===d})[0]||f[0];return g?e[g]:null},c.generateErrorFromResponse=function(a){var b,d,e,f,g,h=c;return d=a.error===!0&&"string"==typeof a.name?a.name:a.error,g=a.reason,e=h.getErrorTypeByProp("name",d,g),a.missing||"missing"===g||"deleted"===g||"not_found"===d?e=h.MISSING_DOC:"doc_validation"===d?(e=h.DOC_VALIDATION,f=g):"bad_request"===d&&e.message!==g&&(0===g.indexOf("unknown stub attachment")?(e=h.MISSING_STUB,f=g):e=h.BAD_REQUEST),e||(e=h.getErrorTypeByProp("status",a.status,g)||h.UNKNOWN_ERROR),b=h.error(e,g,d),f&&(b.message=f),a.id&&(b.id=a.id),a.status&&(b.status=a.status),a.statusText&&(b.name=a.statusText),a.missing&&(b.missing=a.missing),b}},{}],20:[function(a,b){(function(c,d){"use strict";function e(a,b,c){if("function"==typeof a.slice)return b||c?c?a.slice(b,c):a.slice(b):a.slice();b=Math.floor(b||0),c=Math.floor(c||0);var d=a.byteLength;if(b=0>b?Math.max(b+d,0):Math.min(d,b),c=0>c?Math.max(c+d,0):Math.min(d,c),0>=c-b)return new ArrayBuffer(0);var e=new ArrayBuffer(c-b),f=new Uint8Array(e),g=new Uint8Array(a,b,c-b);return f.set(g),e}function f(a){var b=[255&a,a>>>8&255,a>>>16&255,a>>>24&255];return b.map(function(a){return String.fromCharCode(a)}).join("")}function g(a){for(var b="",c=0;c<a.length;c++)b+=f(a[c]);return btoa(b)}var h=a(37),i=a(73),j=d.setImmediate||d.setTimeout,k=32768;b.exports=function(a,b){function d(a,b,c,d){m?a.appendBinary(b.substring(c,d)):a.append(e(b,c,d))}function f(){var c=q*o,e=c+o;if(q++,p>q)d(r,a,c,e),j(f);else{d(r,a,c,e);var h=r.end(!0),i=g(h);b(null,i),r.destroy()}}if(!c.browser){var l=h.createHash("md5").update(a).digest("base64");return void b(null,l)}var m="string"==typeof a,n=m?a.length:a.byteLength,o=Math.min(k,n),p=Math.ceil(n/o),q=0,r=m?new i:new i.ArrayBuffer;f()}}).call(this,a(39),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],21:[function(a,b,c){"use strict";function d(a){return a.reduce(function(a,b){return a[b]=!0,a},{})}function e(a){if(!/^\d+\-./.test(a))return g.error(g.INVALID_REV);var b=a.indexOf("-"),c=a.substring(0,b),d=a.substring(b+1);return{prefix:parseInt(c,10),id:d}}function f(a,b){for(var c=a.start-a.ids.length+1,d=a.ids,e=[d[0],b,[]],f=1,g=d.length;g>f;f++)e=[d[f],{status:"missing"},[e]];return[{pos:c,ids:e}]}var g=a(19),h=a(26),i=d(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),j=d(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);c.invalidIdError=function(a){var b;if(a?"string"!=typeof a?b=g.error(g.INVALID_ID):/^_/.test(a)&&!/^_(design|local)/.test(a)&&(b=g.error(g.RESERVED_ID)):b=g.error(g.MISSING_ID),b)throw b},c.parseDoc=function(a,b){var d,k,l,m={status:"available"};if(a._deleted&&(m.deleted=!0),b)if(a._id||(a._id=h()),k=h(32,16).toLowerCase(),a._rev){if(l=e(a._rev),l.error)return l;a._rev_tree=[{pos:l.prefix,ids:[l.id,{status:"missing"},[[k,m,[]]]]}],d=l.prefix+1}else a._rev_tree=[{pos:1,ids:[k,m,[]]}],d=1;else if(a._revisions&&(a._rev_tree=f(a._revisions,m),d=a._revisions.start,k=a._revisions.ids[0]),!a._rev_tree){if(l=e(a._rev),l.error)return l;d=l.prefix,k=l.id,a._rev_tree=[{pos:d,ids:[k,m,[]]}]}c.invalidIdError(a._id),a._rev=d+"-"+k;var n={metadata:{},data:{}};for(var o in a)if(a.hasOwnProperty(o)){var p="_"===o[0];if(p&&!i[o]){var q=g.error(g.DOC_VALIDATION,o);throw q.message=g.DOC_VALIDATION.message+": "+o,q}p&&!j[o]?n.metadata[o.slice(1)]=a[o]:n.data[o]=a[o]}return n}},{}],22:[function(a,b){"use strict";function c(a){return decodeURIComponent(window.escape(a))}function d(a){return 65>a?a-48:a-55}function e(a,b,c){for(var e="";c>b;)e+=String.fromCharCode(d(a.charCodeAt(b++))<<4|d(a.charCodeAt(b++)));return e}function f(a,b,c){for(var e="";c>b;)e+=String.fromCharCode(d(a.charCodeAt(b+2))<<12|d(a.charCodeAt(b+3))<<8|d(a.charCodeAt(b))<<4|d(a.charCodeAt(b+1))),b+=4;return e}function g(a,b){return"UTF-8"===b?c(e(a,0,a.length)):f(a,0,a.length)}b.exports=g},{}],23:[function(a,b){"use strict";function c(a){for(var b=d,c=b.parser[b.strictMode?"strict":"loose"].exec(a),e={},f=14;f--;){var g=b.key[f],h=c[f]||"",i=-1!==["user","password"].indexOf(g);e[g]=i?decodeURIComponent(h):h}return e[b.q.name]={},e[b.key[12]].replace(b.q.parser,function(a,c,d){c&&(e[b.q.name][c]=d)}),e}var d={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};b.exports=c},{}],24:[function(a,b){"use strict";var c=a(17),d=a(34);b.exports=function(a,b){var e,f,g,h=function(){e.abort()};if(e=a.xhr?new a.xhr:new XMLHttpRequest,"GET"===a.method&&!a.cache){var i=-1!==a.url.indexOf("?");a.url+=(i?"&":"?")+"_nonce="+Date.now()}e.open(a.method,a.url),e.withCredentials=!0,a.json&&(a.headers.Accept="application/json",a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json",a.body&&a.processData&&"string"!=typeof a.body&&(a.body=JSON.stringify(a.body))),a.binary&&(e.responseType="arraybuffer"),"body"in a||(a.body=null);for(var j in a.headers)a.headers.hasOwnProperty(j)&&e.setRequestHeader(j,a.headers[j]);return a.timeout>0&&(f=setTimeout(h,a.timeout),e.onprogress=function(){clearTimeout(f),f=setTimeout(h,a.timeout)},"undefined"==typeof g&&(g=-1!==Object.keys(e).indexOf("upload")),g&&(e.upload.onprogress=e.onprogress)),e.onreadystatechange=function(){if(4===e.readyState){var d={statusCode:e.status};if(e.status>=200&&e.status<300){var f;f=a.binary?c([e.response||""],{type:e.getResponseHeader("Content-Type")}):e.responseText,b(null,d,f)}else{var g={};try{g=JSON.parse(e.response)}catch(a){}b(g,d)}}},a.body&&a.body instanceof Blob?d.readAsBinaryString(a.body,function(a){e.send(d.fixBinary(a))}):e.send(a.body),{abort:h}}},{}],25:[function(a,b){"use strict";var c=a(72).upsert;b.exports=function(a,b,d,e){return c.call(a,b,d,e)}},{}],26:[function(a,b){"use strict";function c(a){return 0|Math.random()*a}function d(a,b){b=b||e.length;var d="",f=-1;if(a){for(;++f<a;)d+=e[c(b)];return d}for(;++f<36;)switch(f){case 8:case 13:case 18:case 23:d+="-";break;case 19:d+=e[3&c(16)|8];break;default:d+=e[c(16)]}return d}var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");b.exports=d},{}],27:[function(_dereq_,module,exports){"use strict";function evalFilter(input){return eval(["(function () { return ",input," })()"].join(""))}module.exports=evalFilter},{}],28:[function(_dereq_,module,exports){"use strict";function evalView(input){return eval(["(function () {","  return function (doc) {","    var emitted = false;","    var emit = function (a, b) {","      emitted = true;","    };","    var view = "+input+";","    view(doc);","    if (emitted) {","      return true;","    }","  }","})()"].join("\n"))}module.exports=evalView},{}],29:[function(a,b){"use strict";function c(a,b,c){for(var d,e=0,f=a.length;f>e;)d=e+f>>>1,c(a[d],b)<0?e=d+1:f=d;return e}function d(a,b,d){var e=c(a,b,d);a.splice(e,0,b)}function e(a){for(var b,c=a.shift(),d=[c.id,c.opts,[]],e=d;a.length;)c=a.shift(),b=[c.id,c.opts,[]],e[2].push(b),e=b;return d}function f(a,b){return a[0]<b[0]?-1:1}function g(a,b){for(var c=[{tree1:a,tree2:b}],e=!1;c.length>0;){var g=c.pop(),h=g.tree1,i=g.tree2;(h[1].status||i[1].status)&&(h[1].status="available"===h[1].status||"available"===i[1].status?"available":"missing");for(var j=0;j<i[2].length;j++)if(h[2][0]){for(var k=!1,l=0;l<h[2].length;l++)h[2][l][0]===i[2][j][0]&&(c.push({tree1:h[2][l],tree2:i[2][j]}),k=!0);k||(e="new_branch",d(h[2],i[2][j],f))}else e="new_leaf",h[2][0]=i[2][j]}return{conflicts:e,tree:a}}function h(a,b,c){var d,e=[],f=!1,h=!1;return a.length?(a.forEach(function(a){if(a.pos===b.pos&&a.ids[0]===b.ids[0])d=g(a.ids,b.ids),e.push({pos:a.pos,ids:d.tree}),f=f||d.conflicts,h=!0;else if(c!==!0){var i=a.pos<b.pos?a:b,j=a.pos<b.pos?b:a,k=j.pos-i.pos,l=[],m=[];for(m.push({ids:i.ids,diff:k,parent:null,parentIdx:null});m.length>0;){var n=m.pop();0!==n.diff?n.ids&&n.ids[2].forEach(function(a,b){m.push({ids:a,diff:n.diff-1,parent:n.ids,parentIdx:b})}):n.ids[0]===j.ids[0]&&l.push(n)}var o=l[0];o?(d=g(o.ids,j.ids),o.parent[2][o.parentIdx]=d.tree,e.push({pos:i.pos,ids:i.ids}),f=f||d.conflicts,h=!0):e.push(a)}else e.push(a)}),h||e.push(b),e.sort(function(a,b){return a.pos-b.pos}),{tree:e,conflicts:f||"internal_node"}):{tree:[b],conflicts:"new_leaf"}}function i(a,b){var c=k.rootToLeaf(a).map(function(a){var c=a.ids.slice(-b);return{pos:a.pos+(a.ids.length-c.length),ids:e(c)}});return c.reduce(function(a,b){return h(a,b,!0).tree},[c.shift()])}var j=a(65),k={};k.merge=function(a,b,c){a=j(!0,[],a),b=j(!0,{},b);var d=h(a,b);return{tree:i(d.tree,c),conflicts:d.conflicts}},k.winningRev=function(a){var b=[];return k.traverseRevTree(a.rev_tree,function(a,c,d,e,f){a&&b.push({pos:c,id:d,deleted:!!f.deleted})}),b.sort(function(a,b){return a.deleted!==b.deleted?a.deleted>b.deleted?1:-1:a.pos!==b.pos?b.pos-a.pos:a.id<b.id?1:-1}),b[0].pos+"-"+b[0].id},k.traverseRevTree=function(a,b){for(var c,d=a.slice();c=d.pop();)for(var e=c.pos,f=c.ids,g=f[2],h=b(0===g.length,e,f[0],c.ctx,f[1]),i=0,j=g.length;j>i;i++)d.push({pos:e+1,ids:g[i],ctx:h})},k.collectLeaves=function(a){var b=[];return k.traverseRevTree(a,function(a,c,d,e,f){a&&b.push({rev:c+"-"+d,pos:c,opts:f})}),b.sort(function(a,b){return b.pos-a.pos}),b.forEach(function(a){delete a.pos}),b},k.collectConflicts=function(a){var b=k.winningRev(a),c=k.collectLeaves(a.rev_tree),d=[];return c.forEach(function(a){a.rev===b||a.opts.deleted||d.push(a.rev)}),d},k.rootToLeaf=function(a){var b=[];return k.traverseRevTree(a,function(a,c,d,e,f){if(e=e?e.slice(0):[],e.push({id:d,opts:f}),a){var g=c+1-e.length;b.unshift({pos:g,ids:e})}return e}),b},b.exports=k},{}],30:[function(a,b,c){"use strict";function d(a,b){a=parseInt(a,10),b=parseInt(b,10),a!==a&&(a=0),b!==b||a>=b?b=(a||1)<<1:b+=1;var c=Math.random(),d=b-a;return~~(d*c+a)}function e(a){var b=0;return a||(b=2e3),d(a,b)}function f(a,b,c,d,f,g,h){return d.retry===!1?(f.emit("error",h),void f.removeAllListeners()):(d.default_back_off=d.default_back_off||0,d.retries=d.retries||0,"function"!=typeof d.back_off_function&&(d.back_off_function=e),d.retries++,d.max_retries&&d.retries>d.max_retries?(f.emit("error",new Error("tried "+d.retries+" times but replication failed")),void f.removeAllListeners()):(f.emit("requestError",h),"active"===f.state&&(f.emit("paused",h),f.state="stopped",f.once("active",function(){d.current_back_off=d.default_back_off})),d.current_back_off=d.current_back_off||d.default_back_off,d.current_back_off=d.back_off_function(d.current_back_off),void setTimeout(function(){i(a,b,c,d,f)},d.current_back_off)))}function g(){m.call(this),this.cancelled=!1,this.state="pending";var a=this,b=new l.Promise(function(b,c){a.once("complete",b),a.once("error",c)});a.then=function(a,c){return b.then(a,c)},a.catch=function(a){return b.catch(a)},a.catch(function(){})}function h(a,b,c){var d=c.filter?c.filter.toString():"";return a.id().then(function(a){return b.id().then(function(b){var e=a+b+d+JSON.stringify(c.query_params)+c.doc_ids;return l.MD5(e).then(function(a){return a=a.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+a})})})}function i(a,b,c,d,e,g){function h(){if(0!==A.docs.length){var a=A.docs;return c.bulkDocs({docs:a,new_edits:!1}).then(function(b){if(M.cancelled)throw u(),new Error("cancelled");var c=[],d={};b.forEach(function(a){a.error&&(g.doc_write_failures++,c.push(a),d[a.id]=a)}),g.errors=c,O=O.concat(c),g.docs_written+=A.docs.length-c.length;var f=c.filter(function(a){return"unauthorized"!==a.name&&"forbidden"!==a.name});if(P=[],a.forEach(function(a){var b=d[a._id];b?e.emit("denied",l.clone(b)):P.push(a)}),f.length>0){var h=new Error("bulkDocs error");throw h.other_errors=c,t("target.bulkDocs failed to write docs",h),new Error("bulkWrite partial failure")}},function(b){throw g.doc_write_failures+=a.length,b})}}function i(a){for(var c=A.diffs,d=c[a].missing,e=[],f=0;f<d.length;f+=o)e.push(d.slice(f,Math.min(d.length,f+o)));return l.Promise.all(e.map(function(d){var e={revs:!0,open_revs:d,attachments:!0};return b.get(a,e).then(function(b){b.forEach(function(a){return M.cancelled?u():void(a.ok&&(g.docs_read++,A.pendingRevs++,A.docs.push(a.ok)))}),delete c[a]})}))}function j(){var a=Object.keys(A.diffs);return l.Promise.all(a.map(i))}function k(){var a=Object.keys(A.diffs).filter(function(a){var b=A.diffs[a].missing;return 1===b.length&&"1-"===b[0].slice(0,2)});return a.length?b.allDocs({keys:a,include_docs:!0}).then(function(a){if(M.cancelled)throw u(),new Error("cancelled");a.rows.forEach(function(a){!a.doc||a.deleted||"1-"!==a.value.rev.slice(0,2)||a.doc._attachments&&0!==Object.keys(a.doc._attachments).length||(g.docs_read++,A.pendingRevs++,A.docs.push(a.doc),delete A.diffs[a.id])})}):l.Promise.resolve()}function m(){return k().then(j)}function p(){return D=!0,N.writeCheckpoint(A.seq).then(function(){if(D=!1,M.cancelled)throw u(),new Error("cancelled");g.last_seq=G=A.seq;var a=l.clone(g);a.docs=P,e.emit("change",a),A=void 0,y()}).catch(function(a){throw D=!1,t("writeCheckpoint completed with error",a),a})}function q(){var a={};return A.changes.forEach(function(b){a[b.id]=b.changes.map(function(a){return a.rev})}),c.revsDiff(a).then(function(a){if(M.cancelled)throw u(),new Error("cancelled");A.diffs=a,A.pendingRevs=0})}function r(){if(!M.cancelled&&!A){if(0===B.length)return void s(!0);A=B.shift(),q().then(m).then(h).then(p).then(r).catch(function(a){t("batch processing terminated with error",a)})}}function s(a){return 0===C.changes.length?void(0!==B.length||A||((H&&Q.live||E)&&(e.emit("paused"),e.emit("uptodate",g)),E&&u())):void((a||E||C.changes.length>=I)&&(B.push(C),C={seq:0,changes:[],docs:[]},r()))}function t(a,b){F||(b.message||(b.message=a),g.ok=!1,g.status="aborting",g.errors.push(b),O=O.concat(b),B=[],C={seq:0,changes:[],docs:[]},u())}function u(){if(!(F||M.cancelled&&(g.status="cancelled",D))){g.status=g.status||"complete",g.end_time=new Date,g.last_seq=G,F=M.cancelled=!0;var h=O.filter(function(a){return"unauthorized"!==a.name&&"forbidden"!==a.name});if(h.length>0){var i=O.pop();O.length>0&&(i.other_errors=O),i.result=g,f(a,b,c,d,e,g,i)}else g.errors=O,e.emit("complete",g),e.removeAllListeners()}}function v(a){if(M.cancelled)return u();var b=l.filterChange(d)(a);b&&(0!==C.changes.length||0!==B.length||A||e.emit("outofdate",g),C.seq=a.seq,C.changes.push(a),s(0===B.length))}function w(a){return K=!1,M.cancelled?u():(a.results.length>0?(Q.since=a.last_seq,y()):H?(Q.live=!0,y()):E=!0,void s(!0))}function x(a){return K=!1,M.cancelled?u():void t("changes rejected",a)}function y(){function a(){d.cancel()}function c(){e.removeListener("cancel",a)}if(!K&&!E&&B.length<J){K=!0,e.once("cancel",a);var d=b.changes(Q).on("change",v);d.then(c,c),d.then(w).catch(x)}}function z(){N.getCheckpoint().then(function(a){G=a,Q={since:G,limit:I,batch_size:I,style:"all_docs",doc_ids:L,returnDocs:!0},d.filter&&(Q.include_docs=!0),d.query_params&&(Q.query_params=d.query_params),y()}).catch(function(a){t("getCheckpoint rejected with ",a)})}var A,B=[],C={seq:0,changes:[],docs:[]},D=!1,E=!1,F=!1,G=0,H=d.continuous||d.live||!1,I=d.batch_size||100,J=d.batches_limit||10,K=!1,L=d.doc_ids,M={cancelled:!1},N=new n(b,c,a,M),O=[],P=[];g=g||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var Q={};e.ready(b,c),e.once("cancel",u),"function"==typeof d.onChange&&e.on("change",d.onChange),"function"==typeof d.complete&&(e.once("error",d.complete),e.once("complete",function(a){d.complete(null,a)})),"undefined"==typeof d.since?z():(D=!0,N.writeCheckpoint(d.since).then(function(){return D=!1,M.cancelled?void u():(G=d.since,void z())}).catch(function(a){throw D=!1,t("writeCheckpoint completed with error",a),a}))}function j(a,b){var c=b.PouchConstructor;return"string"==typeof a?new c(a):a.then?a:l.Promise.resolve(a)}function k(a,b,c,d){"function"==typeof c&&(d=c,c={}),"undefined"==typeof c&&(c={}),c.complete||(c.complete=d||function(){}),c=l.clone(c),c.continuous=c.continuous||c.live,c.retry="retry"in c?c.retry:p,c.PouchConstructor=c.PouchConstructor||this;var e=new g(c);return j(a,c).then(function(a){return j(b,c).then(function(b){return h(a,b,c).then(function(d){i(d,a,b,c,e)})})}).catch(function(a){e.emit("error",a),c.complete(a)}),e}var l=a(34),m=a(38).EventEmitter,n=a(14),o=50,p=!1;
l.inherits(g,m),g.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},g.prototype.ready=function(a,b){function c(){e.cancel()}function d(){a.removeListener("destroyed",c),b.removeListener("destroyed",c)}var e=this;this.once("change",function(){("pending"===this.state||"stopped"===this.state)&&(e.state="active",e.emit("active"))}),a.once("destroyed",c),b.once("destroyed",c),this.then(d,d)},c.toPouch=j,c.replicate=k},{}],31:[function(a,b){"use strict";var c=a(15),d=a(34),e=d.Promise,f=a(38).EventEmitter;c.adapters={},c.preferredAdapters=a(8),c.prefix="_pouch_";var g=new f,h=["on","addListener","emit","listeners","once","removeAllListeners","removeListener","setMaxListeners"];h.forEach(function(a){c[a]=g[a].bind(g)}),c.setMaxListeners(0),c.parseAdapter=function(a,b){var e,f,g=a.match(/([a-z\-]*):\/\/(.*)/);if(g){if(a=/http(s?)/.test(g[1])?g[1]+"://"+g[2]:g[2],e=g[1],!c.adapters[e].valid())throw"Invalid adapter";return{name:a,adapter:g[1]}}var h="idb"in c.adapters&&"websql"in c.adapters&&d.hasLocalStorage()&&localStorage["_pouch__websqldb_"+c.prefix+a];if("undefined"!=typeof b&&b.db)f="leveldb";else for(var i=0;i<c.preferredAdapters.length;++i)if(f=c.preferredAdapters[i],f in c.adapters){if(h&&"idb"===f)continue;break}if(e=c.adapters[f],f&&e){var j="use_prefix"in e?e.use_prefix:!0;return{name:j?c.prefix+a:a,adapter:f}}throw"No valid adapter found"},c.destroy=d.toPromise(function(a,b,f){function g(){j.destroy(m,b,function(b,d){b?f(b):(c.emit("destroyed",a),c.emit(a,"destroyed"),f(null,d||{ok:!0}))})}("function"==typeof b||"undefined"==typeof b)&&(f=b,b={}),a&&"object"==typeof a&&(b=a,a=void 0),b.internal||console.log("PouchDB.destroy() is deprecated and will be removed. Please use db.destroy() instead.");var h=c.parseAdapter(b.name||a,b),i=h.name,j=c.adapters[h.adapter],k="use_prefix"in j?j.use_prefix:!0,l=k?i.replace(new RegExp("^"+c.prefix),""):i,m=("http"===h.adapter||"https"===h.adapter?"":b.prefix||"")+i,n=d.extend(!0,{},b,{adapter:h.adapter});new c(l,n,function(a,h){return a?f(a):void h.get("_local/_pouch_dependentDbs",function(a,i){if(a)return 404!==a.status?f(a):g();var j=i.dependentDbs,l=Object.keys(j).map(function(a){var e=k?a.replace(new RegExp("^"+c.prefix),""):a,f=d.extend(!0,b,h.__opts||{});return h.constructor.destroy(e,f)});e.all(l).then(g,function(a){f(a)})})})}),c.adapter=function(a,b){b.valid()&&(c.adapters[a]=b)},c.plugin=function(a){Object.keys(a).forEach(function(b){c.prototype[b]=a[b]})},c.defaults=function(a){function b(b,e,f){("function"==typeof e||"undefined"==typeof e)&&(f=e,e={}),b&&"object"==typeof b&&(e=b,b=void 0),e=d.extend(!0,{},a,e),c.call(this,b,e,f)}return d.inherits(b,c),b.destroy=d.toPromise(function(b,e,f){return("function"==typeof e||"undefined"==typeof e)&&(f=e,e={}),b&&"object"==typeof b&&(e=b,b=void 0),e=d.extend(!0,{},a,e),c.destroy(b,e,f)}),h.forEach(function(a){b[a]=g[a].bind(g)}),b.setMaxListeners(0),b.preferredAdapters=c.preferredAdapters.slice(),Object.keys(c).forEach(function(a){a in b||(b[a]=c[a])}),b},b.exports=c},{}],32:[function(a,b){"use strict";function c(a,b,c,g){return"function"==typeof c&&(g=c,c={}),"undefined"==typeof c&&(c={}),c=e.clone(c),c.PouchConstructor=c.PouchConstructor||this,a=f.toPouch(a,c),b=f.toPouch(b,c),new d(a,b,c,g)}function d(a,b,c,d){function f(a){p||(p=!0,m.emit("cancel",a))}function h(a){m.emit("change",{direction:"pull",change:a})}function i(a){m.emit("change",{direction:"push",change:a})}function j(a){m.emit("denied",{direction:"push",doc:a})}function k(a){m.emit("denied",{direction:"pull",doc:a})}function l(a){return function(b,c){var d="change"===b&&(c===h||c===i),e="cancel"===b&&c===f,g=b in q&&c===q[b];(d||e||g)&&(b in r||(r[b]={}),r[b][a]=!0,2===Object.keys(r[b]).length&&m.removeAllListeners(b))}}var m=this;this.canceled=!1;var n,o;"onChange"in c&&(n=c.onChange,delete c.onChange),"function"!=typeof d||c.complete?"complete"in c&&(o=c.complete,delete c.complete):o=d,this.push=g(a,b,c),this.pull=g(b,a,c);var p=!1,q={},r={};c.live&&(this.push.on("complete",m.pull.cancel.bind(m.pull)),this.pull.on("complete",m.push.cancel.bind(m.push))),this.on("newListener",function(a){"change"===a?(m.pull.on("change",h),m.push.on("change",i)):"denied"===a?(m.pull.on("denied",k),m.push.on("denied",j)):"cancel"===a?(m.pull.on("cancel",f),m.push.on("cancel",f)):"error"===a||"removeListener"===a||"complete"===a||a in q||(q[a]=function(b){m.emit(a,b)},m.pull.on(a,q[a]),m.push.on(a,q[a]))}),this.on("removeListener",function(a){"change"===a?(m.pull.removeListener("change",h),m.push.removeListener("change",i)):"cancel"===a?(m.pull.removeListener("cancel",f),m.push.removeListener("cancel",f)):a in q&&"function"==typeof q[a]&&(m.pull.removeListener(a,q[a]),m.push.removeListener(a,q[a]),delete q[a])}),this.pull.on("removeListener",l("pull")),this.push.on("removeListener",l("push"));var s=e.Promise.all([this.push,this.pull]).then(function(a){var b={push:a[0],pull:a[1]};return m.emit("complete",b),o&&o(null,b),m.removeAllListeners(),b},function(a){throw m.cancel(),m.emit("error",a),o&&o(a),m.removeAllListeners(),a});this.then=function(a,b){return s.then(a,b)},this.catch=function(a){return s.catch(a)}}var e=a(34),f=a(30),g=f.replicate,h=a(38).EventEmitter;e.inherits(d,h),b.exports=c,d.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}},{}],33:[function(a,b){"use strict";function c(){this.isReady=!1,this.failed=!1,this.queue=[]}b.exports=c,c.prototype.execute=function(){var a,b;if(this.failed)for(;a=this.queue.shift();)"function"!=typeof a?(b=a.parameters[a.parameters.length-1],"function"==typeof b?b(this.failed):"changes"===a.name&&"function"==typeof b.complete&&b.complete(this.failed)):a(this.failed);else if(this.isReady)for(;a=this.queue.shift();)"function"==typeof a?a():a.task=this.db[a.name].apply(this.db,a.parameters)},c.prototype.fail=function(a){this.failed=a,this.execute()},c.prototype.ready=function(a){return this.failed?!1:0===arguments.length?this.isReady:(this.isReady=!!a,this.db=a,void this.execute())},c.prototype.addTask=function(a,b){if("function"!=typeof a){var c={name:a,parameters:b};return this.queue.push(c),this.failed&&this.execute(),c}this.queue.push(a),this.failed&&this.execute()}},{}],34:[function(a,b,c){(function(b,d){function e(){return"undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage&&"undefined"!=typeof chrome.storage.local}function f(){if(!(this instanceof f))return new f;var a=this;j.call(this),this.isChrome=e(),this.listeners={},this.hasLocal=!1,this.isChrome||(this.hasLocal=c.hasLocalStorage()),this.isChrome?chrome.storage.onChanged.addListener(function(b){null!=b.db_name&&a.emit(b.dbName.newValue)}):this.hasLocal&&("undefined"!=typeof addEventListener?addEventListener("storage",function(b){a.emit(b.key)}):window.attachEvent("storage",function(b){a.emit(b.key)}))}var g=a(29);c.extend=a(65),c.ajax=a(16),c.createBlob=a(17),c.uuid=a(26),c.getArguments=a(36);var h=a(18),i=a(19),j=a(38).EventEmitter,k=a(64);c.Map=k.Map,c.Set=k.Set;var l=a(21);c.Promise="function"==typeof d.Promise?d.Promise:a(47);var m=c.Promise;c.lastIndexOf=function(a,b){for(var c=a.length-1;c>=0;c--)if(a.charAt(c)===b)return c;return-1},c.clone=function(a){return c.extend(!0,{},a)},c.pick=function(a,b){for(var c={},d=0,e=b.length;e>d;d++){var f=b[d];c[f]=a[f]}return c},c.inherits=a(43),c.call=c.getArguments(function(a){if(a.length){var b=a.shift();"function"==typeof b&&b.apply(this,a)}}),c.isLocalId=function(a){return/^_local/.test(a)},c.isDeleted=function(a,b){b||(b=g.winningRev(a));var c=b.indexOf("-");-1!==c&&(b=b.substring(c+1));var d=!1;return g.traverseRevTree(a.rev_tree,function(a,c,e,f,g){e===b&&(d=!!g.deleted)}),d},c.revExists=function(a,b){var c=!1;return g.traverseRevTree(a.rev_tree,function(a,d,e){d+"-"+e===b&&(c=!0)}),c},c.filterChange=function(a){var b={},c=a.filter&&"function"==typeof a.filter;return b.query=a.query_params,function(d){if(a.filter&&c&&!a.filter.call(this,d.doc,b))return!1;if(a.include_docs){if(!a.attachments)for(var e in d.doc._attachments)d.doc._attachments.hasOwnProperty(e)&&(d.doc._attachments[e].stub=!0)}else delete d.doc;return!0}},c.parseDoc=l.parseDoc,c.invalidIdError=l.invalidIdError,c.isCordova=function(){return"undefined"!=typeof cordova||"undefined"!=typeof PhoneGap||"undefined"!=typeof phonegap},c.hasLocalStorage=function(){if(e())return!1;try{return localStorage}catch(a){return!1}},c.Changes=f,c.inherits(f,j),f.prototype.addListener=function(a,d,e,f){function g(){if(h.listeners[d]){if(i)return void(i="waiting");i=!0,e.changes({style:f.style,include_docs:f.include_docs,attachments:f.attachments,conflicts:f.conflicts,continuous:!1,descending:!1,filter:f.filter,doc_ids:f.doc_ids,view:f.view,since:f.since,query_params:f.query_params}).on("change",function(a){a.seq>f.since&&!f.cancelled&&(f.since=a.seq,c.call(f.onChange,a))}).on("complete",function(){"waiting"===i&&b.nextTick(function(){h.notify(a)}),i=!1}).on("error",function(){i=!1})}}if(!this.listeners[d]){var h=this,i=!1;this.listeners[d]=g,this.on(a,g)}},f.prototype.removeListener=function(a,b){b in this.listeners&&j.prototype.removeListener.call(this,a,this.listeners[b])},f.prototype.notifyLocalWindows=function(a){this.isChrome?chrome.storage.local.set({dbName:a}):this.hasLocal&&(localStorage[a]="a"===localStorage[a]?"b":"a")},f.prototype.notify=function(a){this.emit(a),this.notifyLocalWindows(a)},c.atob="function"==typeof atob?function(a){return atob(a)}:function(a){var b=new h(a,"base64");if(b.toString("base64")!==a)throw"Cannot base64 encode full string";return b.toString("binary")},c.btoa="function"==typeof btoa?function(a){return btoa(a)}:function(a){return new h(a,"binary").toString("base64")},c.fixBinary=function(a){if(!b.browser)return a;for(var c=a.length,d=new ArrayBuffer(c),e=new Uint8Array(d),f=0;c>f;f++)e[f]=a.charCodeAt(f);return d},c.readAsBinaryString=function(a,b){var d=new FileReader,e="function"==typeof d.readAsBinaryString;d.onloadend=function(a){var d=a.target.result||"";return e?b(d):void b(c.arrayBufferToBinaryString(d))},e?d.readAsBinaryString(a):d.readAsArrayBuffer(a)},c.readAsArrayBuffer=function(a,b){var c=new FileReader;c.onloadend=function(a){var c=a.target.result||new ArrayBuffer(0);b(c)},c.readAsArrayBuffer(a)},c.once=function(a){var b=!1;return c.getArguments(function(c){if(b)throw new Error("once called  more than once");b=!0,a.apply(this,c)})},c.toPromise=function(a){return c.getArguments(function(d){var e,f=this,g="function"==typeof d[d.length-1]?d.pop():!1;g&&(e=function(a,c){b.nextTick(function(){g(a,c)})});var h=new m(function(b,e){var g;try{var h=c.once(function(a,c){a?e(a):b(c)});d.push(h),g=a.apply(f,d),g&&"function"==typeof g.then&&b(g)}catch(a){e(a)}});return e&&h.then(function(a){e(null,a)},e),h.cancel=function(){return this},h})},c.adapterFun=function(b,d){function e(a,b,c){if(f.enabled){for(var d=[a._db_name,b],e=0;e<c.length-1;e++)d.push(c[e]);f.apply(null,d);var g=c[c.length-1];c[c.length-1]=function(c,d){var e=[a._db_name,b];e=e.concat(c?["error",c]:["success",d]),f.apply(null,e),g(c,d)}}}var f=a(40)("pouchdb:api");return c.toPromise(c.getArguments(function(a){if(this._closed)return m.reject(new Error("database is closed"));var f=this;return e(f,b,a),this.taskqueue.isReady?d.apply(this,a):new c.Promise(function(c,d){f.taskqueue.addTask(function(e){e?d(e):c(f[b].apply(f,a))})})}))},c.arrayBufferToBinaryString=function(a){for(var b="",c=new Uint8Array(a),d=c.byteLength,e=0;d>e;e++)b+=String.fromCharCode(c[e]);return b},c.cancellableFun=function(a,b,d){d=d?c.clone(!0,{},d):{};var e=new j,f=d.complete||function(){},g=d.complete=c.once(function(a,b){a?f(a):(e.emit("end",b),f(null,b)),e.removeAllListeners()}),h=d.onChange||function(){},i=0;b.on("destroyed",function(){e.removeAllListeners()}),d.onChange=function(a){h(a),a.seq<=i||(i=a.seq,e.emit("change",a),a.deleted?e.emit("delete",a):1===a.changes.length&&"1-"===a.changes[0].rev.slice(0,1)?e.emit("create",a):e.emit("update",a))};var k=new m(function(a,b){d.complete=function(c,d){c?b(c):a(d)}});return k.then(function(a){g(null,a)},g),k.cancel=function(){k.isCancelled=!0,b.taskqueue.isReady&&d.complete(null,{status:"cancelled"})},b.taskqueue.isReady?a(b,d,k):b.taskqueue.addTask(function(){k.isCancelled?d.complete(null,{status:"cancelled"}):a(b,d,k)}),k.on=e.on.bind(e),k.once=e.once.bind(e),k.addListener=e.addListener.bind(e),k.removeListener=e.removeListener.bind(e),k.removeAllListeners=e.removeAllListeners.bind(e),k.setMaxListeners=e.setMaxListeners.bind(e),k.listeners=e.listeners.bind(e),k.emit=e.emit.bind(e),k},c.MD5=c.toPromise(a(20)),c.explain404=function(a){b.browser&&"console"in d&&"info"in console&&console.info("The above 404 is totally normal. "+a)},c.info=function(a){"undefined"!=typeof console&&"info"in console&&console.info(a)},c.parseUri=a(23),c.compare=function(a,b){return b>a?-1:a>b?1:0},c.updateDoc=function(a,b,d,e,f,h,j){if(c.revExists(a,b.metadata.rev))return d[e]=b,f();var k=c.isDeleted(a),l=c.isDeleted(b.metadata),m=/^1-/.test(b.metadata.rev);if(k&&!l&&j&&m){var n=b.data;n._rev=g.winningRev(a),n._id=b.metadata.id,b=c.parseDoc(n,j)}var o=g.merge(a.rev_tree,b.metadata.rev_tree[0],1e3),p=j&&(k&&l||!k&&"new_leaf"!==o.conflicts||k&&!l&&"new_branch"===o.conflicts);if(p){var q=i.error(i.REV_CONFLICT);return d[e]=q,f()}var r=b.metadata.rev;b.metadata.rev_tree=o.tree,a.rev_map&&(b.metadata.rev_map=a.rev_map);var s=g.winningRev(b.metadata);l=c.isDeleted(b.metadata,s);var t=0;(j||s===r)&&(t=k===l?0:l>k?-1:1),h(b,s,l,f,!0,t,e)},c.processDocs=function(a,b,d,e,f,h,j,k){function l(a,b,d){var e=g.winningRev(a.metadata),k=c.isDeleted(a.metadata,e);if("was_delete"in j&&k)return f[b]=i.error(i.MISSING_DOC,"deleted"),d();var l=k?0:1;h(a,e,k,d,!1,l,b)}function m(){++p===q&&k&&k()}if(a.length){var n=j.new_edits,o=new c.Map,p=0,q=a.length;a.forEach(function(a,d){if(a._id&&c.isLocalId(a._id))return void b[a._deleted?"_removeLocal":"_putLocal"](a,{ctx:e},function(a){f[d]=a?a:{ok:!0},m()});var g=a.metadata.id;o.has(g)?(q--,o.get(g).push([a,d])):o.set(g,[[a,d]])}),o.forEach(function(a,b){function e(){++i<a.length?g():m()}function g(){var g=a[i],j=g[0],k=g[1];d.has(b)?c.updateDoc(d.get(b),j,f,k,e,h,n):l(j,k,e)}var i=0;g()})}},c.preprocessAttachments=function(a,b,d){function e(a){try{return c.atob(a)}catch(a){var b=i.error(i.BAD_ARG,"Attachments need to be base64 encoded");return{error:b}}}function f(a,d){if(a.stub)return d();if("string"==typeof a.data){var f=e(a.data);if(f.error)return d(f.error);a.length=f.length,a.data="blob"===b?c.createBlob([c.fixBinary(f)],{type:a.content_type}):"base64"===b?c.btoa(f):f,c.MD5(f).then(function(b){a.digest="md5-"+b,d()})}else c.readAsArrayBuffer(a.data,function(e){"binary"===b?a.data=c.arrayBufferToBinaryString(e):"base64"===b&&(a.data=c.btoa(c.arrayBufferToBinaryString(e))),c.MD5(e).then(function(b){a.digest="md5-"+b,a.length=e.byteLength,d()})})}function g(){j++,a.length===j&&(h?d(h):d())}if(!a.length)return d();var h,j=0;a.forEach(function(a){function b(a){h=a,d++,d===c.length&&g()}var c=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],d=0;if(!c.length)return g();for(var e in a.data._attachments)a.data._attachments.hasOwnProperty(e)&&f(a.data._attachments[e],b)})},c.compactTree=function(a){var b=[];return g.traverseRevTree(a.rev_tree,function(a,c,d,e,f){"available"!==f.status||a||(b.push(c+"-"+d),f.status="missing")}),b};var n=a(74);c.safeJsonParse=function(a){try{return JSON.parse(a)}catch(b){return n.parse(a)}},c.safeJsonStringify=function(a){try{return JSON.stringify(a)}catch(b){return n.stringify(a)}}}).call(this,a(39),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(a,b){b.exports="3.3.1"},{}],36:[function(a,b){"use strict";function c(a){return function(){var b=arguments.length;if(b){for(var c=[],d=-1;++d<b;)c[d]=arguments[d];return a.call(this,c)}return a.call(this,[])}}b.exports=c},{}],37:[function(){},{}],38:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],39:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],40:[function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,b=this.useColors;if(a[0]=(b?"%c":"")+this.namespace+(b?" %c":" ")+a[0]+(b?"%c ":" ")+"+"+c.humanize(this.diff),!b)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?j.removeItem("debug"):j.debug=a}catch(a){}}function h(){var a;try{a=j.debug}catch(a){}return a}function i(){try{return window.localStorage}catch(a){}}c=b.exports=a(41),c.log=f,c.formatArgs=e,c.save=g,c.load=h,c.useColors=d;var j;j="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:i(),c.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],c.formatters.j=function(a){return JSON.stringify(a)},c.enable(h())},{}],41:[function(a,b,c){function d(){return c.colors[k++%c.colors.length]}function e(a){function b(){}function e(){var a=e,b=+new Date,f=b-(j||b);a.diff=f,a.prev=j,a.curr=b,j=b,null==a.useColors&&(a.useColors=c.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=c.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(b,d){if("%"===b)return b;h++;var e=c.formatters[d];if("function"==typeof e){var f=g[h];b=e.call(a,f),g.splice(h,1),h--}return b}),"function"==typeof c.formatArgs&&(g=c.formatArgs.apply(a,g));var i=e.log||c.log||console.log.bind(console);i.apply(a,g)}b.enabled=!1,e.enabled=!0;var f=c.enabled(a)?e:b;return f.namespace=a,f}function f(a){c.save(a);for(var b=(a||"").split(/[\s,]+/),d=b.length,e=0;d>e;e++)b[e]&&(a=b[e].replace(/\*/g,".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$")))}function g(){c.enable("")}function h(a){var b,d;for(b=0,d=c.skips.length;d>b;b++)if(c.skips[b].test(a))return!1;for(b=0,d=c.names.length;d>b;b++)if(c.names[b].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}c=b.exports=e,c.coerce=i,c.disable=g,c.enable=f,c.enabled=h,c.humanize=a(42),c.names=[],c.skips=[],c.formatters={};var j,k=0},{}],42:[function(a,b){function c(a){var b=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"y":return c*k;case"days":case"day":case"d":return c*j;case"hours":case"hour":case"h":return c*i;case"minutes":case"minute":case"m":return c*h;case"seconds":case"second":case"s":return c*g;case"ms":return c}}}function d(a){return a>=j?Math.round(a/j)+"d":a>=i?Math.round(a/i)+"h":a>=h?Math.round(a/h)+"m":a>=g?Math.round(a/g)+"s":a+"ms"}function e(a){return f(a,j,"day")||f(a,i,"hour")||f(a,h,"minute")||f(a,g,"second")||a+" ms"}function f(a,b,c){return b>a?void 0:1.5*b>a?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=1e3,h=60*g,i=60*h,j=24*i,k=365.25*j;b.exports=function(a,b){return b=b||{},"string"==typeof a?c(a):b.long?e(a):d(a)}},{}],43:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],44:[function(a,b){"use strict";function c(){}b.exports=c},{}],45:[function(a,b){"use strict";function c(a){function b(a,b){function d(a){j[b]=a,++k===c&!i&&(i=!0,h.resolve(m,j))}f(a).then(d,function(a){i||(i=!0,h.reject(m,a))})}if("[object Array]"!==Object.prototype.toString.call(a))return e(new TypeError("must be an array"));var c=a.length,i=!1;if(!c)return f([]);for(var j=new Array(c),k=0,l=-1,m=new d(g);++l<c;)b(a[l],l);return m}var d=a(48),e=a(51),f=a(52),g=a(44),h=a(46);b.exports=c},{}],46:[function(a,b,c){"use strict";function d(a){var b=a&&a.then;return a&&"object"==typeof a&&"function"==typeof b?function(){b.apply(a,arguments)}:void 0}var e=a(55),f=a(53),g=a(54);c.resolve=function(a,b){var h=e(d,b);if("error"===h.status)return c.reject(a,h.value);var i=h.value;if(i)f.safely(a,i);else{a.state=g.FULFILLED,a.outcome=b;for(var j=-1,k=a.queue.length;++j<k;)a.queue[j].callFulfilled(b)}return a},c.reject=function(a,b){a.state=g.REJECTED,a.outcome=b;for(var c=-1,d=a.queue.length;++c<d;)a.queue[c].callRejected(b);return a}},{}],47:[function(a,b,c){b.exports=c=a(48),c.resolve=a(52),c.reject=a(51),c.all=a(45),c.race=a(50)},{}],48:[function(a,b){"use strict";function c(a){if(!(this instanceof c))return new c(a);if("function"!=typeof a)throw new TypeError("resolver must be a function");this.state=g.PENDING,this.queue=[],this.outcome=void 0,a!==e&&f.safely(this,a)}var d=a(56),e=a(44),f=a(53),g=a(54),h=a(49);b.exports=c,c.prototype.catch=function(a){return this.then(null,a)},c.prototype.then=function(a,b){if("function"!=typeof a&&this.state===g.FULFILLED||"function"!=typeof b&&this.state===g.REJECTED)return this;var f=new c(e);if(this.state!==g.PENDING){var i=this.state===g.FULFILLED?a:b;d(f,i,this.outcome)}else this.queue.push(new h(f,a,b));return f}},{}],49:[function(a,b){"use strict";function c(a,b,c){this.promise=a,"function"==typeof b&&(this.onFulfilled=b,this.callFulfilled=this.otherCallFulfilled),"function"==typeof c&&(this.onRejected=c,this.callRejected=this.otherCallRejected)}var d=a(46),e=a(56);b.exports=c,c.prototype.callFulfilled=function(a){d.resolve(this.promise,a)},c.prototype.otherCallFulfilled=function(a){e(this.promise,this.onFulfilled,a)},c.prototype.callRejected=function(a){d.reject(this.promise,a)},c.prototype.otherCallRejected=function(a){e(this.promise,this.onRejected,a)}},{}],50:[function(a,b){"use strict";function c(a){function b(a){f(a).then(function(a){i||(i=!0,h.resolve(k,a))},function(a){i||(i=!0,h.reject(k,a))})}if("[object Array]"!==Object.prototype.toString.call(a))return e(new TypeError("must be an array"));var c=a.length,i=!1;if(!c)return f([]);for(var j=-1,k=new d(g);++j<c;)b(a[j]);return k}var d=a(48),e=a(51),f=a(52),g=a(44),h=a(46);b.exports=c},{}],51:[function(a,b){"use strict";function c(a){var b=new d(e);return f.reject(b,a)}var d=a(48),e=a(44),f=a(46);b.exports=c},{}],52:[function(a,b){"use strict";function c(a){if(a)return a instanceof d?a:f.resolve(new d(e),a);var b=typeof a;switch(b){case"boolean":return g;case"undefined":return i;case"object":return h;case"number":return j;case"string":return k}}var d=a(48),e=a(44),f=a(46);b.exports=c;var g=f.resolve(new d(e),!1),h=f.resolve(new d(e),null),i=f.resolve(new d(e),void 0),j=f.resolve(new d(e),0),k=f.resolve(new d(e),"")},{}],53:[function(a,b,c){"use strict";function d(a,b){function c(b){h||(h=!0,e.reject(a,b))}function d(b){h||(h=!0,e.resolve(a,b))}function g(){b(d,c)}var h=!1,i=f(g);"error"===i.status&&c(i.value)}var e=a(46),f=a(55);c.safely=d},{}],54:[function(a,b,c){c.REJECTED=["REJECTED"],c.FULFILLED=["FULFILLED"],c.PENDING=["PENDING"]},{}],55:[function(a,b){"use strict";function c(a,b){var c={};try{c.value=a(b),c.status="success"}catch(a){c.status="error",c.value=a}return c}b.exports=c},{}],56:[function(a,b){"use strict";function c(a,b,c){d(function(){var d;try{d=b(c)}catch(b){return e.reject(a,b)}d===a?e.reject(a,new TypeError("Cannot resolve promise with itself")):e.resolve(a,d)})}var d=a(57),e=a(46);b.exports=c},{}],57:[function(a,b){"use strict";function c(){e=!0;for(var a,b,c=h.length;c;){for(b=h,h=[],a=-1;++a<c;)b[a]();c=h.length}e=!1}function d(a){1!==h.push(a)||e||f()}for(var e,f,g=[a(37),a(59),a(58),a(60),a(61)],h=[],i=-1,j=g.length;++i<j;)if(g[i]&&g[i].test&&g[i].test()){f=g[i].install(c);break}b.exports=d},{}],58:[function(a,b,c){(function(a){"use strict";c.test=function(){return a.setImmediate?!1:"undefined"!=typeof a.MessageChannel},c.install=function(b){var c=new a.MessageChannel;return c.port1.onmessage=b,function(){c.port2.postMessage(0)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],59:[function(a,b,c){(function(a){"use strict";var b=a.MutationObserver||a.WebKitMutationObserver;c.test=function(){return b},c.install=function(c){var d=0,e=new b(c),f=a.document.createTextNode("");return e.observe(f,{characterData:!0}),function(){f.data=d=++d%2}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],60:[function(a,b,c){(function(a){"use strict";c.test=function(){return"document"in a&&"onreadystatechange"in a.document.createElement("script")},c.install=function(b){return function(){var c=a.document.createElement("script");return c.onreadystatechange=function(){b(),c.onreadystatechange=null,c.parentNode.removeChild(c),c=null},a.document.documentElement.appendChild(c),b}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],61:[function(a,b,c){"use strict";c.test=function(){return!0},c.install=function(a){return function(){setTimeout(a,0)}}},{}],62:[function(a,b,c){"use strict";function d(a){if(null!==a)switch(typeof a){case"boolean":return a?1:0;case"number":return k(a);case"string":return a.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var b=Array.isArray(a),d=b?a:Object.keys(a),e=-1,f=d.length,g="";if(b)for(;++e<f;)g+=c.toIndexableString(d[e]);else for(;++e<f;){var h=d[e];g+=c.toIndexableString(h)+c.toIndexableString(a[h])}return g}return""}function e(a,b){var c,d=b,e="1"===a[b];if(e)c=0,b++;else{var f="0"===a[b];b++;var g="",h=a.substring(b,b+m),i=parseInt(h,10)+l;for(f&&(i=-i),b+=m;;){var j=a[b];if("\x00"===j)break;g+=j,b++}g=g.split("."),c=1===g.length?parseInt(g,10):parseFloat(g[0]+"."+g[1]),f&&(c-=10),0!==i&&(c=parseFloat(c+"e"+i))}return{num:c,length:b-d}}function f(a,b){var c=a.pop();if(b.length){var d=b[b.length-1];c===d.element&&(b.pop(),d=b[b.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(c);else if(f===a.length-2){var g=a.pop();e[g]=c}else a.push(c)}}function g(a,b){for(var d=Math.min(a.length,b.length),e=0;d>e;e++){var f=c.collate(a[e],b[e]);if(0!==f)return f}return a.length===b.length?0:a.length>b.length?1:-1}function h(a,b){return a===b?0:a>b?1:-1}function i(a,b){for(var d=Object.keys(a),e=Object.keys(b),f=Math.min(d.length,e.length),g=0;f>g;g++){var h=c.collate(d[g],e[g]);if(0!==h)return h;if(h=c.collate(a[d[g]],b[e[g]]),0!==h)return h}return d.length===e.length?0:d.length>e.length?1:-1}function j(a){var b=["boolean","number","string","object"],c=b.indexOf(typeof a);return~c?null===a?1:Array.isArray(a)?5:3>c?c+2:c+3:Array.isArray(a)?5:void 0}function k(a){if(0===a)return"1";var b=a.toExponential().split(/e\+?/),c=parseInt(b[1],10),d=0>a,e=d?"0":"2",f=(d?-c:c)-l,g=o.padLeft(f.toString(),"0",m);e+=n+g;var h=Math.abs(parseFloat(b[0]));d&&(h=10-h);var i=h.toFixed(20);return i=i.replace(/\.?0+$/,""),e+=n+i}var l=-324,m=3,n="",o=a(63);c.collate=function(a,b){if(a===b)return 0;a=c.normalizeKey(a),b=c.normalizeKey(b);
var d=j(a),e=j(b);if(d-e!==0)return d-e;if(null===a)return 0;switch(typeof a){case"number":return a-b;case"boolean":return a===b?0:b>a?-1:1;case"string":return h(a,b)}return Array.isArray(a)?g(a,b):i(a,b)},c.normalizeKey=function(a){switch(typeof a){case"undefined":return null;case"number":return 1/0===a||a===-1/0||isNaN(a)?null:a;case"object":var b=a;if(Array.isArray(a)){var d=a.length;a=new Array(d);for(var e=0;d>e;e++)a[e]=c.normalizeKey(b[e])}else{if(a instanceof Date)return a.toJSON();if(null!==a){a={};for(var f in b)if(b.hasOwnProperty(f)){var g=b[f];"undefined"!=typeof g&&(a[f]=c.normalizeKey(g))}}}}return a},c.toIndexableString=function(a){var b="\x00";return a=c.normalizeKey(a),j(a)+n+d(a)+b},c.parseIndexableString=function(a){for(var b=[],c=[],d=0;;){var g=a[d++];if("\x00"!==g)switch(g){case"1":b.push(null);break;case"2":b.push("1"===a[d]),d++;break;case"3":var h=e(a,d);b.push(h.num),d+=h.length;break;case"4":for(var i="";;){var j=a[d];if("\x00"===j)break;i+=j,d++}i=i.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),b.push(i);break;case"5":var k={element:[],index:b.length};b.push(k.element),c.push(k);break;case"6":var l={element:{},index:b.length};b.push(l.element),c.push(l);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+g)}else{if(1===b.length)return b.pop();f(b,c)}}}},{}],63:[function(a,b,c){"use strict";function d(a,b,c){for(var d="",e=c-a.length;d.length<e;)d+=b;return d}c.padLeft=function(a,b,c){var e=d(a,b,c);return e+a},c.padRight=function(a,b,c){var e=d(a,b,c);return a+e},c.stringLexCompare=function(a,b){var c,d=a.length,e=b.length;for(c=0;d>c;c++){if(c===e)return 1;var f=a.charAt(c),g=b.charAt(c);if(f!==g)return g>f?-1:1}return e>d?-1:0},c.intToDecimalForm=function(a){var b=0>a,c="";do{var d=b?-Math.ceil(a%10):Math.floor(a%10);c=d+c,a=b?Math.ceil(a/10):Math.floor(a/10)}while(a);return b&&"0"!==c&&(c="-"+c),c}},{}],64:[function(a,b,c){"use strict";function d(){this.store={}}function e(a){if(this.store=new d,a&&Array.isArray(a))for(var b=0,c=a.length;c>b;b++)this.add(a[b])}c.Map=d,c.Set=e,d.prototype.mangle=function(a){if("string"!=typeof a)throw new TypeError("key must be a string but Got "+a);return"$"+a},d.prototype.unmangle=function(a){return a.substring(1)},d.prototype.get=function(a){var b=this.mangle(a);return b in this.store?this.store[b]:void 0},d.prototype.set=function(a,b){var c=this.mangle(a);return this.store[c]=b,!0},d.prototype.has=function(a){var b=this.mangle(a);return b in this.store},d.prototype.delete=function(a){var b=this.mangle(a);return b in this.store?(delete this.store[b],!0):!1},d.prototype.forEach=function(a){var b=this,c=Object.keys(b.store);c.forEach(function(c){var d=b.store[c];c=b.unmangle(c),a(d,c)})},e.prototype.add=function(a){return this.store.set(a,!0)},e.prototype.has=function(a){return this.store.has(a)},e.prototype.delete=function(a){return this.store.delete(a)}},{}],65:[function(a,b){"use strict";function c(a){return null===a?String(a):"object"==typeof a||"function"==typeof a?i[m.call(a)]||"object":typeof a}function d(a){return null!==a&&a===a.window}function e(a){if(!a||"object"!==c(a)||a.nodeType||d(a))return!1;try{if(a.constructor&&!n.call(a,"constructor")&&!n.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(a){return!1}var b;for(b in a);return void 0===b||n.call(a,b)}function f(a){return"function"===c(a)}function g(){for(var a=[],b=-1,c=arguments.length,d=new Array(c);++b<c;)d[b]=arguments[b];var e={};a.push({args:d,result:{container:e,key:"key"}});for(var f;f=a.pop();)h(a,f.args,f.result);return e.key}function h(a,b,c){var d,g,h,i,j,k,l,m=b[0]||{},n=1,p=b.length,q=!1,r=/\d+/;for("boolean"==typeof m&&(q=m,m=b[1]||{},n=2),"object"==typeof m||f(m)||(m={}),p===n&&(m=this,--n);p>n;n++)if(null!=(d=b[n])){l=o(d);for(g in d)if(!(g in Object.prototype)){if(l&&!r.test(g))continue;if(h=m[g],i=d[g],m===i)continue;q&&i&&(e(i)||(j=o(i)))?(j?(j=!1,k=h&&o(h)?h:[]):k=h&&e(h)?h:{},a.push({args:[q,k,i],result:{container:m,key:g}})):void 0!==i&&(o(d)&&f(i)||(m[g]=i))}}c.container[c.key]=m}for(var i={},j=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],k=0;k<j.length;k++){var l=j[k];i["[object "+l+"]"]=l.toLowerCase()}var m=i.toString,n=i.hasOwnProperty,o=Array.isArray||function(a){return"array"===c(a)};b.exports=g},{}],66:[function(a,b){"use strict";var c=a(70),d=a(71),e=d.Promise;b.exports=function(a){var b=a.db,f=a.viewName,g=a.map,h=a.reduce,i=a.temporary,j=g.toString()+(h&&h.toString())+"undefined";if(!i&&b._cachedViews){var k=b._cachedViews[j];if(k)return e.resolve(k)}return b.info().then(function(a){function e(a){a.views=a.views||{};var b=f;-1===b.indexOf("/")&&(b=f+"/"+f);var c=a.views[b]=a.views[b]||{};return c[k]?void 0:(c[k]=!0,a)}var k=a.db_name+"-mrview-"+(i?"temp":d.MD5(j));return c(b,"_local/mrviews",e).then(function(){return b.registerDependentDatabase(k).then(function(a){var c=a.db;c.auto_compaction=!0;var d={name:k,db:c,sourceDB:b,adapter:b.adapter,mapFun:g,reduceFun:h};return d.db.get("_local/lastSeq").catch(function(a){if(404!==a.status)throw a}).then(function(a){return d.seq=a?a.seq:0,i||(b._cachedViews=b._cachedViews||{},b._cachedViews[j]=d,d.db.on("destroyed",function(){delete b._cachedViews[j]})),d})})})})}},{}],67:[function(_dereq_,module,exports){"use strict";module.exports=function(func,emit,sum,log,isArray,toJSON){return eval("'use strict'; ("+func.replace(/;\s*$/,"")+");")}},{}],68:[function(a,b,c){(function(b){"use strict";function d(a){return-1===a.indexOf("/")?[a,a]:a.split("/")}function e(a){return 1===a.length&&/^1-/.test(a[0].rev)}function f(a,b,c){try{return{output:b.apply(null,c)}}catch(b){return a.emit("error",b),{error:b}}}function g(a,b){var c=F(a.key,b.key);return 0!==c?c:F(a.value,b.value)}function h(a,b,c){return c=c||0,"number"==typeof b?a.slice(c,b+c):c>0?a.slice(c):a}function i(a){var b=a.value,c=b&&"object"==typeof b&&b._id||a.id;return c}function j(a){var b=new Error("builtin "+a+" function requires map values to be numbers or number arrays");return b.name="invalid_value",b.status=500,b}function k(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];if("number"!=typeof e){if(!Array.isArray(e))throw j("_sum");b="number"==typeof b?[b]:b;for(var f=0,g=e.length;g>f;f++){var h=e[f];if("number"!=typeof h)throw j("_sum");"undefined"==typeof b[f]?b.push(h):b[f]+=h}}else"number"==typeof b?b+=e:b[0]+=e}return b}function l(a,b,c,d){var e=b[a];"undefined"!=typeof e&&(d&&(e=encodeURIComponent(JSON.stringify(e))),c.push(a+"="+e))}function m(a,b){var c=a.descending?"endkey":"startkey",d=a.descending?"startkey":"endkey";if("undefined"!=typeof a[c]&&"undefined"!=typeof a[d]&&F(a[c],a[d])>0)throw new A("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(b.reduce&&a.reduce!==!1){if(a.include_docs)throw new A("{include_docs:true} is invalid for reduce");if(a.keys&&a.keys.length>1&&!a.group&&!a.group_level)throw new A("Multi-key fetches for reduce views must use {group: true}")}if(a.group_level){if("number"!=typeof a.group_level)throw new A('Invalid value for integer: "'+a.group_level+'"');if(a.group_level<0)throw new A('Invalid value for positive integer: "'+a.group_level+'"')}}function n(a,b,c){var e,f=[],g="GET";if(l("reduce",c,f),l("include_docs",c,f),l("attachments",c,f),l("limit",c,f),l("descending",c,f),l("group",c,f),l("group_level",c,f),l("skip",c,f),l("stale",c,f),l("conflicts",c,f),l("startkey",c,f,!0),l("endkey",c,f,!0),l("inclusive_end",c,f),l("key",c,f,!0),f=f.join("&"),f=""===f?"":"?"+f,"undefined"!=typeof c.keys){var h=2e3,i="keys="+encodeURIComponent(JSON.stringify(c.keys));i.length+f.length+1<=h?f+=("?"===f[0]?"&":"?")+i:(g="POST","string"==typeof b?e=JSON.stringify({keys:c.keys}):b.keys=c.keys)}if("string"==typeof b){var j=d(b);return a.request({method:g,url:"_design/"+j[0]+"/_view/"+j[1]+f,body:e})}return e=e||{},Object.keys(b).forEach(function(a){e[a]=Array.isArray(b[a])?b[a]:b[a].toString()}),a.request({method:"POST",url:"_temp_view"+f,body:e})}function o(a){return function(b){if(404===b.status)return a;throw b}}function p(a,b,c){function d(){return e(l)?L.resolve(i):b.db.get(h).catch(o(i))}function f(a){return a.keys.length?b.db.allDocs({keys:a.keys,include_docs:!0}):L.resolve({rows:[]})}function g(a,b){for(var c=[],d={},e=0,f=b.rows.length;f>e;e++){var g=b.rows[e],h=g.doc;if(h&&(c.push(h),d[h._id]=!0,h._deleted=!k[h._id],!h._deleted)){var i=k[h._id];"value"in i&&(h.value=i.value)}}var j=Object.keys(k);return j.forEach(function(a){if(!d[a]){var b={_id:a},e=k[a];"value"in e&&(b.value=e.value),c.push(b)}}),a.keys=K.uniq(j.concat(a.keys)),c.push(a),c}var h="_local/doc_"+a,i={_id:h,keys:[]},j=c[a],k=j.indexableKeysToKeyValues,l=j.changes;return d().then(function(a){return f(a).then(function(b){return g(a,b)})})}function q(a,b,c){var d="_local/lastSeq";return a.db.get(d).catch(o({_id:d,seq:0})).then(function(d){var e=Object.keys(b);return L.all(e.map(function(c){return p(c,a,b)})).then(function(b){var e=K.flatten(b);return d.seq=c,e.push(d),a.db.bulkDocs({docs:e})})})}function r(a){var b="string"==typeof a?a:a.name,c=M[b];return c||(c=M[b]=new E),c}function s(a){return K.sequentialize(r(a),function(){return t(a)})()}function t(a){function b(a,b){var c={id:e._id,key:H(a)};"undefined"!=typeof b&&null!==b&&(c.value=H(b)),d.push(c)}function c(b,c){return function(){return q(a,b,c)}}var d,e,h;if("function"==typeof a.mapFun&&2===a.mapFun.length){var i=a.mapFun;h=function(a){return i(a,b)}}else h=J(a.mapFun.toString(),b,k,C,Array.isArray,JSON.parse);var j=a.seq||0,l=new E;return new L(function(b,i){function k(){l.finish().then(function(){a.seq=j,b()})}function m(){function b(a){i(a)}a.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:j,limit:O}).on("complete",function(b){var i=b.results;if(!i.length)return k();for(var n={},o=0,p=i.length;p>o;o++){var q=i[o];if("_"!==q.doc._id[0]){d=[],e=q.doc,e._deleted||f(a.sourceDB,h,[e]),d.sort(g);for(var r,s={},t=0,u=d.length;u>t;t++){var v=d[t],w=[v.key,v.id];v.key===r&&w.push(t);var x=G(w);s[x]=v,r=v.key}n[q.doc._id]={indexableKeysToKeyValues:s,changes:q.changes}}j=q.seq}return l.add(c(n,j)),i.length<O?k():m()}).on("error",b)}m()})}function u(a,b,c){0===c.group_level&&delete c.group_level;var d,e=c.group||c.group_level;d=P[a.reduceFun]?P[a.reduceFun]:J(a.reduceFun.toString(),null,k,C,Array.isArray,JSON.parse);var g=[],i=c.group_level;b.forEach(function(a){var b=g[g.length-1],c=e?a.key:null;return e&&Array.isArray(c)&&"number"==typeof i&&(c=c.length>i?c.slice(0,i):c),b&&0===F(b.key[0][0],c)?(b.key.push([c,a.id]),void b.value.push(a.value)):void g.push({key:[[c,a.id]],value:[a.value]})});for(var j=0,l=g.length;l>j;j++){var m=g[j],n=f(a.sourceDB,d,[m.key,m.value,!1]);m.value=n.error?null:n.output,m.key=m.key[0][0]}return{rows:h(g,c.limit,c.skip)}}function v(a,b){return K.sequentialize(r(a),function(){return w(a,b)})()}function w(a,b){function c(b){return b.include_docs=!0,a.db.allDocs(b).then(function(a){return e=a.total_rows,a.rows.map(function(a){if("value"in a.doc&&"object"==typeof a.doc.value&&null!==a.doc.value){var b=Object.keys(a.doc.value).sort(),c=["id","key","value"];if(!(c>b||b>c))return a.doc.value}var d=D.parseIndexableString(a.doc._id);return{key:d[0],id:d[1],value:"value"in a.doc?a.doc.value:null}})})}function d(c){var d;if(d=f?u(a,c,b):{total_rows:e,offset:g,rows:c},b.include_docs){var h=K.uniq(c.map(i));return a.sourceDB.allDocs({keys:h,include_docs:!0,conflicts:b.conflicts,attachments:b.attachments}).then(function(a){var b={};return a.rows.forEach(function(a){a.doc&&(b["$"+a.id]=a.doc)}),c.forEach(function(a){var c=i(a),d=b["$"+c];d&&(a.doc=d)}),d})}return d}var e,f=a.reduceFun&&b.reduce!==!1,g=b.skip||0;"undefined"==typeof b.keys||b.keys.length||(b.limit=0,delete b.keys);var h=function(a){return a.reduce(function(a,b){return a.concat(b)})};if("undefined"!=typeof b.keys){var j=b.keys,k=j.map(function(a){var b={startkey:G([a]),endkey:G([a,{}])};return c(b)});return L.all(k).then(h).then(d)}var l={descending:b.descending};if("undefined"!=typeof b.startkey&&(l.startkey=G(b.descending?[b.startkey,{}]:[b.startkey])),"undefined"!=typeof b.endkey){var m=b.inclusive_end!==!1;b.descending&&(m=!m),l.endkey=G(m?[b.endkey,{}]:[b.endkey])}if("undefined"!=typeof b.key){var n=G([b.key]),o=G([b.key,{}]);l.descending?(l.endkey=n,l.startkey=o):(l.startkey=n,l.endkey=o)}return f||("number"==typeof b.limit&&(l.limit=b.limit),l.skip=g),c(l).then(d)}function x(a){return a.request({method:"POST",url:"_view_cleanup"})}function y(a){return a.get("_local/mrviews").then(function(b){var c={};Object.keys(b.views).forEach(function(a){var b=d(a),e="_design/"+b[0],f=b[1];c[e]=c[e]||{},c[e][f]=!0});var e={keys:Object.keys(c),include_docs:!0};return a.allDocs(e).then(function(d){var e={};d.rows.forEach(function(a){var d=a.key.substring(8);Object.keys(c[a.key]).forEach(function(c){var f=d+"/"+c;b.views[f]||(f=c);var g=Object.keys(b.views[f]),h=a.doc&&a.doc.views&&a.doc.views[c];g.forEach(function(a){e[a]=e[a]||h})})});var f=Object.keys(e).filter(function(a){return!e[a]}),g=f.map(function(b){return K.sequentialize(r(b),function(){return a.constructor.destroy(b,a.__opts)})()});return L.all(g).then(function(){return{ok:!0}})})},o({ok:!0}))}function z(a,c,e){if("http"===a.type())return n(a,c,e);if("string"!=typeof c){m(e,c);var f={db:a,viewName:"temp_view/temp_view",map:c.map,reduce:c.reduce,temporary:!0};return N.add(function(){return I(f).then(function(a){function b(){return a.db.destroy()}return K.fin(s(a).then(function(){return v(a,e)}),b)})}),N.finish()}var g=c,h=d(g),i=h[0],j=h[1];return a.get("_design/"+i).then(function(c){var d=c.views&&c.views[j];if(!d||"string"!=typeof d.map)throw new B("ddoc "+i+" has no view named "+j);m(e,d);var f={db:a,viewName:g,map:d.map,reduce:d.reduce};return I(f).then(function(a){return"ok"===e.stale||"update_after"===e.stale?("update_after"===e.stale&&b.nextTick(function(){s(a)}),v(a,e)):s(a).then(function(){return v(a,e)})})})}function A(a){this.status=400,this.name="query_parse_error",this.message=a,this.error=!0;try{Error.captureStackTrace(this,A)}catch(a){}}function B(a){this.status=404,this.name="not_found",this.message=a,this.error=!0;try{Error.captureStackTrace(this,B)}catch(a){}}var C,D=a(62),E=a(69),F=D.collate,G=D.toIndexableString,H=D.normalizeKey,I=a(66),J=a(67);C="undefined"!=typeof console&&"function"==typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var K=a(71),L=K.Promise,M={},N=new E,O=50,P={_sum:function(a,b){return k(b)},_count:function(a,b){return b.length},_stats:function(a,b){function c(a){for(var b=0,c=0,d=a.length;d>c;c++){var e=a[c];b+=e*e}return b}return{sum:k(b),min:Math.min.apply(null,b),max:Math.max.apply(null,b),count:b.length,sumsqr:c(b)}}};c.viewCleanup=K.callbackify(function(){var a=this;return"http"===a.type()?x(a):y(a)}),c.query=function(a,b,c){"function"==typeof b&&(c=b,b={}),b=K.extend(!0,{},b),"function"==typeof a&&(a={map:a});var d=this,e=L.resolve().then(function(){return z(d,a,b)});return K.promisedCallback(e,c),e},K.inherits(A,Error),K.inherits(B,Error)}).call(this,a(39))},{}],69:[function(a,b){"use strict";function c(){this.promise=new d(function(a){a()})}var d=a(71).Promise;c.prototype.add=function(a){return this.promise=this.promise.catch(function(){}).then(function(){return a()}),this.promise},c.prototype.finish=function(){return this.promise},b.exports=c},{}],70:[function(a,b){"use strict";var c=a(72).upsert;b.exports=function(a,b,d){return c.apply(a,[b,d])}},{}],71:[function(a,b,c){(function(b,d){"use strict";c.Promise="function"==typeof d.Promise?d.Promise:a(47),c.inherits=a(43),c.extend=a(65);var e=a(36);c.promisedCallback=function(a,c){return c&&a.then(function(a){b.nextTick(function(){c(null,a)})},function(a){b.nextTick(function(){c(a)})}),a},c.callbackify=function(a){return e(function(b){var d=b.pop(),e=a.apply(this,b);return"function"==typeof d&&c.promisedCallback(e,d),e})},c.fin=function(a,b){return a.then(function(a){var c=b();return"function"==typeof c.then?c.then(function(){return a}):a},function(a){var c=b();if("function"==typeof c.then)return c.then(function(){throw a});throw a})},c.sequentialize=function(a,b){return function(){var c=arguments,d=this;return a.add(function(){return b.apply(d,c)})}},c.flatten=function(a){for(var b=[],c=0,d=a.length;d>c;c++)b=b.concat(a[c]);return b},c.uniq=function(a){for(var b={},c=0,d=a.length;d>c;c++)b["$"+a[c]]=!0;var e=Object.keys(b),f=new Array(e.length);for(c=0,d=e.length;d>c;c++)f[c]=e[c].substring(1);return f};var f=a(37),g=a(73);c.MD5=function(a){return b.browser?g.hash(a):f.createHash("md5").update(a).digest("hex")}}).call(this,a(39),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],72:[function(a,b,c){(function(b){"use strict";function d(a,b,c){return new f(function(d,f){return"string"!=typeof b?f(new Error("doc id is required")):void a.get(b,function(g,h){if(g){if(404!==g.status)return f(g);h={}}var i=c(h);return i?(i._id=b,i._rev=h._rev,void d(e(a,i,c))):d({updated:!1,rev:h._rev})})})}function e(a,b,c){return a.put(b).then(function(a){return{updated:!0,rev:a.rev}},function(e){if(409!==e.status)throw e;return d(a,b._id,c)})}var f;f="undefined"!=typeof window&&window.PouchDB?window.PouchDB.utils.Promise:"function"==typeof b.Promise?b.Promise:a(47),c.upsert=function(a,b,c){var e=this,f=d(e,a,b);return"function"!=typeof c?f:void f.then(function(a){c(null,a)},c)},c.putIfNotExists=function(a,b,c){var e=this;"string"!=typeof a&&(c=b,b=a,a=b._id);var f=function(a){return a._rev?!1:b},g=d(e,a,f);return"function"!=typeof c?g:void g.then(function(a){c(null,a)},c)},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(c)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],73:[function(a,b,c){!function(a){if("object"==typeof c)b.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var d;try{d=window}catch(a){d=self}d.SparkMD5=a()}}(function(){"use strict";var a=function(a,b){return a+b&4294967295},b=function(b,c,d,e,f,g){return c=a(a(c,b),a(e,g)),a(c<<f|c>>>32-f,d)},c=function(a,c,d,e,f,g,h){return b(c&d|~c&e,a,c,f,g,h)},d=function(a,c,d,e,f,g,h){return b(c&e|d&~e,a,c,f,g,h)},e=function(a,c,d,e,f,g,h){return b(c^d^e,a,c,f,g,h)},f=function(a,c,d,e,f,g,h){return b(d^(c|~e),a,c,f,g,h)},g=function(b,g){var h=b[0],i=b[1],j=b[2],k=b[3];h=c(h,i,j,k,g[0],7,-680876936),k=c(k,h,i,j,g[1],12,-389564586),j=c(j,k,h,i,g[2],17,606105819),i=c(i,j,k,h,g[3],22,-1044525330),h=c(h,i,j,k,g[4],7,-176418897),k=c(k,h,i,j,g[5],12,1200080426),j=c(j,k,h,i,g[6],17,-1473231341),i=c(i,j,k,h,g[7],22,-45705983),h=c(h,i,j,k,g[8],7,1770035416),k=c(k,h,i,j,g[9],12,-1958414417),j=c(j,k,h,i,g[10],17,-42063),i=c(i,j,k,h,g[11],22,-1990404162),h=c(h,i,j,k,g[12],7,1804603682),k=c(k,h,i,j,g[13],12,-40341101),j=c(j,k,h,i,g[14],17,-1502002290),i=c(i,j,k,h,g[15],22,1236535329),h=d(h,i,j,k,g[1],5,-165796510),k=d(k,h,i,j,g[6],9,-1069501632),j=d(j,k,h,i,g[11],14,643717713),i=d(i,j,k,h,g[0],20,-373897302),h=d(h,i,j,k,g[5],5,-701558691),k=d(k,h,i,j,g[10],9,38016083),j=d(j,k,h,i,g[15],14,-660478335),i=d(i,j,k,h,g[4],20,-405537848),h=d(h,i,j,k,g[9],5,568446438),k=d(k,h,i,j,g[14],9,-1019803690),j=d(j,k,h,i,g[3],14,-187363961),i=d(i,j,k,h,g[8],20,1163531501),h=d(h,i,j,k,g[13],5,-1444681467),k=d(k,h,i,j,g[2],9,-51403784),j=d(j,k,h,i,g[7],14,1735328473),i=d(i,j,k,h,g[12],20,-1926607734),h=e(h,i,j,k,g[5],4,-378558),k=e(k,h,i,j,g[8],11,-2022574463),j=e(j,k,h,i,g[11],16,1839030562),i=e(i,j,k,h,g[14],23,-35309556),h=e(h,i,j,k,g[1],4,-1530992060),k=e(k,h,i,j,g[4],11,1272893353),j=e(j,k,h,i,g[7],16,-155497632),i=e(i,j,k,h,g[10],23,-1094730640),h=e(h,i,j,k,g[13],4,681279174),k=e(k,h,i,j,g[0],11,-358537222),j=e(j,k,h,i,g[3],16,-722521979),i=e(i,j,k,h,g[6],23,76029189),h=e(h,i,j,k,g[9],4,-640364487),k=e(k,h,i,j,g[12],11,-421815835),j=e(j,k,h,i,g[15],16,530742520),i=e(i,j,k,h,g[2],23,-995338651),h=f(h,i,j,k,g[0],6,-198630844),k=f(k,h,i,j,g[7],10,1126891415),j=f(j,k,h,i,g[14],15,-1416354905),i=f(i,j,k,h,g[5],21,-57434055),h=f(h,i,j,k,g[12],6,1700485571),k=f(k,h,i,j,g[3],10,-1894986606),j=f(j,k,h,i,g[10],15,-1051523),i=f(i,j,k,h,g[1],21,-2054922799),h=f(h,i,j,k,g[8],6,1873313359),k=f(k,h,i,j,g[15],10,-30611744),j=f(j,k,h,i,g[6],15,-1560198380),i=f(i,j,k,h,g[13],21,1309151649),h=f(h,i,j,k,g[4],6,-145523070),k=f(k,h,i,j,g[11],10,-1120210379),j=f(j,k,h,i,g[2],15,718787259),i=f(i,j,k,h,g[9],21,-343485551),b[0]=a(h,b[0]),b[1]=a(i,b[1]),b[2]=a(j,b[2]),b[3]=a(k,b[3])},h=function(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a.charCodeAt(b)+(a.charCodeAt(b+1)<<8)+(a.charCodeAt(b+2)<<16)+(a.charCodeAt(b+3)<<24);return c},i=function(a){var b,c=[];for(b=0;64>b;b+=4)c[b>>2]=a[b]+(a[b+1]<<8)+(a[b+2]<<16)+(a[b+3]<<24);return c},j=function(a){var b,c,d,e,f,i,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,h(a.substring(b-64,b)));for(a=a.substring(b-64),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a.charCodeAt(b)<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),i=parseInt(e[1],16)||0,d[14]=f,d[15]=i,g(k,d),k},k=function(a){var b,c,d,e,f,h,j=a.length,k=[1732584193,-271733879,-1732584194,271733878];for(b=64;j>=b;b+=64)g(k,i(a.subarray(b-64,b)));for(a=j>b-64?a.subarray(b-64):new Uint8Array(0),c=a.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=0;c>b;b+=1)d[b>>2]|=a[b]<<(b%4<<3);if(d[b>>2]|=128<<(b%4<<3),b>55)for(g(k,d),b=0;16>b;b+=1)d[b]=0;return e=8*j,e=e.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(e[2],16),h=parseInt(e[1],16)||0,d[14]=f,d[15]=h,g(k,d),k},l=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],m=function(a){var b,c="";for(b=0;4>b;b+=1)c+=l[a>>8*b+4&15]+l[a>>8*b&15];return c},n=function(a){var b;for(b=0;b<a.length;b+=1)a[b]=m(a[b]);return a.join("")},o=function(a){return n(j(a))},p=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==o("hello")&&(a=function(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}),p.prototype.append=function(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),this.appendBinary(a),this},p.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var b,c=this._buff.length;for(b=64;c>=b;b+=64)g(this._state,h(this._buff.substring(b-64,b)));return this._buff=this._buff.substr(b-64),this},p.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d.charCodeAt(b)<<(b%4<<3);return this._finish(f,e),c=a?this._state:n(this._state),this.reset(),c},p.prototype._finish=function(a,b){var c,d,e,f=b;if(a[f>>2]|=128<<(f%4<<3),f>55)for(g(this._state,a),f=0;16>f;f+=1)a[f]=0;c=8*this._length,c=c.toString(16).match(/(.*?)(.{0,8})$/),d=parseInt(c[2],16),e=parseInt(c[1],16)||0,a[14]=d,a[15]=e,g(this._state,a)},p.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},p.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},p.hash=function(a,b){/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a)));var c=j(a);return b?c:n(c)},p.hashBinary=function(a,b){var c=j(a);return b?c:n(c)},p.ArrayBuffer=function(){this.reset()},p.ArrayBuffer.prototype.append=function(a){var b,c=this._concatArrayBuffer(this._buff,a),d=c.length;for(this._length+=a.byteLength,b=64;d>=b;b+=64)g(this._state,i(c.subarray(b-64,b)));return this._buff=d>b-64?c.subarray(b-64):new Uint8Array(0),this},p.ArrayBuffer.prototype.end=function(a){var b,c,d=this._buff,e=d.length,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(b=0;e>b;b+=1)f[b>>2]|=d[b]<<(b%4<<3);return this._finish(f,e),c=a?this._state:n(this._state),this.reset(),c},p.ArrayBuffer.prototype._finish=p.prototype._finish,p.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},p.ArrayBuffer.prototype.destroy=p.prototype.destroy,p.ArrayBuffer.prototype._concatArrayBuffer=function(a,b){var c=a.length,d=new Uint8Array(c+b.byteLength);return d.set(a),d.set(new Uint8Array(b),c),d},p.ArrayBuffer.hash=function(a,b){var c=k(new Uint8Array(a));return b?c:n(c)},p})},{}],74:[function(a,b,c){"use strict";function d(a,b,c){var d=c[c.length-1];a===d.element&&(c.pop(),d=c[c.length-1]);var e=d.element,f=d.index;if(Array.isArray(e))e.push(a);else if(f===b.length-2){var g=b.pop();e[g]=a}else b.push(a)}c.stringify=function(a){var b=[];b.push({obj:a});for(var c,d,e,f,g,h,i,j,k,l,m,n="";c=b.pop();)if(d=c.obj,e=c.prefix||"",f=c.val||"",n+=e,f)n+=f;else if("object"!=typeof d)n+="undefined"==typeof d?null:JSON.stringify(d);else if(null===d)n+="null";else if(Array.isArray(d)){for(b.push({val:"]"}),g=d.length-1;g>=0;g--)h=0===g?"":",",b.push({obj:d[g],prefix:h});b.push({val:"["})}else{i=[];for(j in d)d.hasOwnProperty(j)&&i.push(j);for(b.push({val:"}"}),g=i.length-1;g>=0;g--)k=i[g],l=d[k],m=g>0?",":"",m+=JSON.stringify(k)+":",b.push({obj:l,prefix:m});b.push({val:"{"})}return n},c.parse=function(a){for(var b,c,e,f,g,h,i,j,k,l=[],m=[],n=0;;)if(b=a[n++],"}"!==b&&"]"!==b&&"undefined"!=typeof b)switch(b){case" ":case"	":case"\n":case":":case",":break;case"n":n+=3,d(null,l,m);break;case"t":n+=3,d(!0,l,m);break;case"f":n+=4,d(!1,l,m);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(c="",n--;;){if(e=a[n++],!/[\d\.\-e\+]/.test(e)){n--;break}c+=e}d(parseFloat(c),l,m);break;case'"':for(f="",g=void 0,h=0;i=a[n++],'"'!==i||"\\"===g&&h%2===1;)f+=i,g=i,"\\"===g?h++:h=0;d(JSON.parse('"'+f+'"'),l,m);break;case"[":j={element:[],index:l.length},l.push(j.element),m.push(j);break;case"{":k={element:{},index:l.length},l.push(k.element),m.push(k);break;default:throw new Error("unexpectedly reached end of input: "+b)}else{if(1===l.length)return l.pop();d(l.pop(),l,m)}}},{}],75:[function(a,b){(function(c){"use strict";var d=a(31);b.exports=d,d.ajax=a(16),d.utils=a(34),d.Errors=a(19),d.replicate=a(30).replicate,d.sync=a(32),d.version=a(35);var e=a(2);if(d.adapter("http",e),d.adapter("https",e),d.adapter("idb",a(7)),d.adapter("websql",a(12)),d.plugin(a(68)),!c.browser){var f=a(37);d.adapter("ldb",f),d.adapter("leveldb",f)}}).call(this,a(39))},{}]},{},[75])(75)}),function(a){function b(a){throw RangeError(E[a])}function c(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function d(a,b){return c(a.split(D),b).join(".")}function e(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function f(a){return c(a,function(a){var b="";return a>65535&&(a-=65536,b+=H(a>>>10&1023|55296),a=56320|1023&a),b+=H(a)}).join("")}function g(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:t}function h(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function i(a,b,c){var d=0;for(a=c?G(a/x):a>>1,a+=G(a/b);a>F*v>>1;d+=t)a=G(a/F);return G(d+(F+1)*a/(a+w))}function j(a){var c,d,e,h,j,k,l,m,n,o,p=[],q=a.length,r=0,w=z,x=y;for(d=a.lastIndexOf(A),0>d&&(d=0),e=0;d>e;++e)a.charCodeAt(e)>=128&&b("not-basic"),p.push(a.charCodeAt(e));for(h=d>0?d+1:0;q>h;){for(j=r,k=1,l=t;h>=q&&b("invalid-input"),m=g(a.charCodeAt(h++)),(m>=t||m>G((s-r)/k))&&b("overflow"),r+=m*k,n=x>=l?u:l>=x+v?v:l-x,!(n>m);l+=t)o=t-n,k>G(s/o)&&b("overflow"),k*=o;c=p.length+1,x=i(r-j,c,0==j),G(r/c)>s-w&&b("overflow"),w+=G(r/c),r%=c,p.splice(r++,0,w)}return f(p)}function k(a){var c,d,f,g,j,k,l,m,n,o,p,q,r,w,x,B=[];for(a=e(a),q=a.length,c=z,d=0,j=y,k=0;q>k;++k)p=a[k],128>p&&B.push(H(p));for(f=g=B.length,g&&B.push(A);q>f;){for(l=s,k=0;q>k;++k)p=a[k],p>=c&&l>p&&(l=p);for(r=f+1,l-c>G((s-d)/r)&&b("overflow"),d+=(l-c)*r,c=l,k=0;q>k;++k)if(p=a[k],c>p&&++d>s&&b("overflow"),p==c){for(m=d,n=t;o=j>=n?u:n>=j+v?v:n-j,!(o>m);n+=t)x=m-o,w=t-o,B.push(H(h(o+x%w,0))),m=G(x/w);B.push(H(h(m,0))),j=i(d,r,f==g),d=0,++f}++d,++c}return B.join("")}function l(a){return d(a,function(a){return B.test(a)?j(a.slice(4).toLowerCase()):a})}function m(a){return d(a,function(a){return C.test(a)?"xn--"+k(a):a})}var n="object"==typeof exports&&exports,o="object"==typeof module&&module&&module.exports==n&&module,p="object"==typeof global&&global;p.global!==p&&p.window!==p||(a=p);var q,r,s=2147483647,t=36,u=1,v=26,w=38,x=700,y=72,z=128,A="-",B=/^xn--/,C=/[^ -~]/,D=/\x2E|\u3002|\uFF0E|\uFF61/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},F=t-u,G=Math.floor,H=String.fromCharCode;if(q={version:"1.2.3",ucs2:{decode:e,encode:f},decode:j,encode:k,toASCII:m,toUnicode:l},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("uri/punycode",[],function(){return q});else if(n&&!n.nodeType)if(o)o.exports=q;else for(r in q)q.hasOwnProperty(r)&&(n[r]=q[r]);else a.punycode=q}(this),function(a,b){"use strict";"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("uri/IPv6",b):a.IPv6=b(a)}(this,function(a){"use strict";function b(a){var b=a.toLowerCase(),c=b.split(":"),d=c.length,e=8;""===c[0]&&""===c[1]&&""===c[2]?(c.shift(),c.shift()):""===c[0]&&""===c[1]?c.shift():""===c[d-1]&&""===c[d-2]&&c.pop(),d=c.length,-1!==c[d-1].indexOf(".")&&(e=7);var f;for(f=0;d>f&&""!==c[f];f++);if(e>f){for(c.splice(f,1,"0000");c.length<e;)c.splice(f,0,"0000");d=c.length}for(var g,h=0;e>h;h++){g=c[h].split("");for(var i=0;3>i&&("0"===g[0]&&g.length>1);i++)g.splice(0,1);c[h]=g.join("")}var j=-1,k=0,l=0,m=-1,n=!1;for(h=0;e>h;h++)n?"0"===c[h]?l+=1:(n=!1,l>k&&(j=m,k=l)):"0"===c[h]&&(n=!0,m=h,l=1);l>k&&(j=m,k=l),k>1&&c.splice(j,k,""),d=c.length;var o="";for(""===c[0]&&(o=":"),h=0;d>h&&(o+=c[h],h!==d-1);h++)o+=":";return""===c[d-1]&&(o+=":"),o}function c(){return a.IPv6===this&&(a.IPv6=d),this}var d=a&&a.IPv6;return{best:b,noConflict:c}}),function(a,b){"use strict";"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("uri/SecondLevelDomains",b):a.SecondLevelDomains=b(a)}(this,function(a){"use strict";var b=a&&a.SecondLevelDomains,c={list:{ac:" com gov mil net org ",ae:" ac co gov mil name net org pro sch ",af:" com edu gov net org ",al:" com edu gov mil net org ",ao:" co ed gv it og pb ",ar:" com edu gob gov int mil net org tur ",at:" ac co gv or ",au:" asn com csiro edu gov id net org ",ba:" co com edu gov mil net org rs unbi unmo unsa untz unze ",bb:" biz co com edu gov info net org store tv ",bh:" biz cc com edu gov info net org ",bn:" com edu gov net org ",bo:" com edu gob gov int mil net org tv ",br:" adm adv agr am arq art ato b bio blog bmd cim cng cnt com coop ecn edu eng esp etc eti far flog fm fnd fot fst g12 ggf gov imb ind inf jor jus lel mat med mil mus net nom not ntr odo org ppg pro psc psi qsl rec slg srv tmp trd tur tv vet vlog wiki zlg ",bs:" com edu gov net org ",bz:" du et om ov rg ",ca:" ab bc mb nb nf nl ns nt nu on pe qc sk yk ",ck:" biz co edu gen gov info net org ",cn:" ac ah bj com cq edu fj gd gov gs gx gz ha hb he hi hl hn jl js jx ln mil net nm nx org qh sc sd sh sn sx tj tw xj xz yn zj ",co:" com edu gov mil net nom org ",cr:" ac c co ed fi go or sa ",cy:" ac biz com ekloges gov ltd name net org parliament press pro tm ",do:" art com edu gob gov mil net org sld web ",dz:" art asso com edu gov net org pol ",ec:" com edu fin gov info med mil net org pro ",eg:" com edu eun gov mil name net org sci ",er:" com edu gov ind mil net org rochest w ",es:" com edu gob nom org ",et:" biz com edu gov info name net org ",fj:" ac biz com info mil name net org pro ",fk:" ac co gov net nom org ",fr:" asso com f gouv nom prd presse tm ",gg:" co net org ",gh:" com edu gov mil org ",gn:" ac com gov net org ",gr:" com edu gov mil net org ",gt:" com edu gob ind mil net org ",gu:" com edu gov net org ",hk:" com edu gov idv net org ",hu:" 2000 agrar bolt casino city co erotica erotika film forum games hotel info ingatlan jogasz konyvelo lakas media news org priv reklam sex shop sport suli szex tm tozsde utazas video ",
id:" ac co go mil net or sch web ",il:" ac co gov idf k12 muni net org ",in:" ac co edu ernet firm gen gov i ind mil net nic org res ",iq:" com edu gov i mil net org ",ir:" ac co dnssec gov i id net org sch ",it:" edu gov ",je:" co net org ",jo:" com edu gov mil name net org sch ",jp:" ac ad co ed go gr lg ne or ",ke:" ac co go info me mobi ne or sc ",kh:" com edu gov mil net org per ",ki:" biz com de edu gov info mob net org tel ",km:" asso com coop edu gouv k medecin mil nom notaires pharmaciens presse tm veterinaire ",kn:" edu gov net org ",kr:" ac busan chungbuk chungnam co daegu daejeon es gangwon go gwangju gyeongbuk gyeonggi gyeongnam hs incheon jeju jeonbuk jeonnam k kg mil ms ne or pe re sc seoul ulsan ",kw:" com edu gov net org ",ky:" com edu gov net org ",kz:" com edu gov mil net org ",lb:" com edu gov net org ",lk:" assn com edu gov grp hotel int ltd net ngo org sch soc web ",lr:" com edu gov net org ",lv:" asn com conf edu gov id mil net org ",ly:" com edu gov id med net org plc sch ",ma:" ac co gov m net org press ",mc:" asso tm ",me:" ac co edu gov its net org priv ",mg:" com edu gov mil nom org prd tm ",mk:" com edu gov inf name net org pro ",ml:" com edu gov net org presse ",mn:" edu gov org ",mo:" com edu gov net org ",mt:" com edu gov net org ",mv:" aero biz com coop edu gov info int mil museum name net org pro ",mw:" ac co com coop edu gov int museum net org ",mx:" com edu gob net org ",my:" com edu gov mil name net org sch ",nf:" arts com firm info net other per rec store web ",ng:" biz com edu gov mil mobi name net org sch ",ni:" ac co com edu gob mil net nom org ",np:" com edu gov mil net org ",nr:" biz com edu gov info net org ",om:" ac biz co com edu gov med mil museum net org pro sch ",pe:" com edu gob mil net nom org sld ",ph:" com edu gov i mil net ngo org ",pk:" biz com edu fam gob gok gon gop gos gov net org web ",pl:" art bialystok biz com edu gda gdansk gorzow gov info katowice krakow lodz lublin mil net ngo olsztyn org poznan pwr radom slupsk szczecin torun warszawa waw wroc wroclaw zgora ",pr:" ac biz com edu est gov info isla name net org pro prof ",ps:" com edu gov net org plo sec ",pw:" belau co ed go ne or ",ro:" arts com firm info nom nt org rec store tm www ",rs:" ac co edu gov in org ",sb:" com edu gov net org ",sc:" com edu gov net org ",sh:" co com edu gov net nom org ",sl:" com edu gov net org ",st:" co com consulado edu embaixada gov mil net org principe saotome store ",sv:" com edu gob org red ",sz:" ac co org ",tr:" av bbs bel biz com dr edu gen gov info k12 name net org pol tel tsk tv web ",tt:" aero biz cat co com coop edu gov info int jobs mil mobi museum name net org pro tel travel ",tw:" club com ebiz edu game gov idv mil net org ",mu:" ac co com gov net or org ",mz:" ac co edu gov org ",na:" co com ",nz:" ac co cri geek gen govt health iwi maori mil net org parliament school ",pa:" abo ac com edu gob ing med net nom org sld ",pt:" com edu gov int net nome org publ ",py:" com edu gov mil net org ",qa:" com edu gov mil net org ",re:" asso com nom ",ru:" ac adygeya altai amur arkhangelsk astrakhan bashkiria belgorod bir bryansk buryatia cbg chel chelyabinsk chita chukotka chuvashia com dagestan e-burg edu gov grozny int irkutsk ivanovo izhevsk jar joshkar-ola kalmykia kaluga kamchatka karelia kazan kchr kemerovo khabarovsk khakassia khv kirov koenig komi kostroma kranoyarsk kuban kurgan kursk lipetsk magadan mari mari-el marine mil mordovia mosreg msk murmansk nalchik net nnov nov novosibirsk nsk omsk orenburg org oryol penza perm pp pskov ptz rnd ryazan sakhalin samara saratov simbirsk smolensk spb stavropol stv surgut tambov tatarstan tom tomsk tsaritsyn tsk tula tuva tver tyumen udm udmurtia ulan-ude vladikavkaz vladimir vladivostok volgograd vologda voronezh vrn vyatka yakutia yamal yekaterinburg yuzhno-sakhalinsk ",rw:" ac co com edu gouv gov int mil net ",sa:" com edu gov med net org pub sch ",sd:" com edu gov info med net org tv ",se:" a ac b bd c d e f g h i k l m n o org p parti pp press r s t tm u w x y z ",sg:" com edu gov idn net org per ",sn:" art com edu gouv org perso univ ",sy:" com edu gov mil net news org ",th:" ac co go in mi net or ",tj:" ac biz co com edu go gov info int mil name net nic org test web ",tn:" agrinet com defense edunet ens fin gov ind info intl mincom nat net org perso rnrt rns rnu tourism ",tz:" ac co go ne or ",ua:" biz cherkassy chernigov chernovtsy ck cn co com crimea cv dn dnepropetrovsk donetsk dp edu gov if in ivano-frankivsk kh kharkov kherson khmelnitskiy kiev kirovograd km kr ks kv lg lugansk lutsk lviv me mk net nikolaev od odessa org pl poltava pp rovno rv sebastopol sumy te ternopil uzhgorod vinnica vn zaporizhzhe zhitomir zp zt ",ug:" ac co go ne or org sc ",uk:" ac bl british-library co cym gov govt icnet jet lea ltd me mil mod national-library-scotland nel net nhs nic nls org orgn parliament plc police sch scot soc ",us:" dni fed isa kids nsn ",uy:" com edu gub mil net org ",ve:" co com edu gob info mil net org web ",vi:" co com k12 net org ",vn:" ac biz com edu gov health info int name net org pro ",ye:" co com gov ltd me net org plc ",yu:" ac co edu gov org ",za:" ac agric alt bourse city co cybernet db edu gov grondar iaccess imt inca landesign law mil net ngo nis nom olivetti org pix school tm web ",zm:" ac co com edu gov net org sch "},has:function(a){var b=a.lastIndexOf(".");if(0>=b||b>=a.length-1)return!1;var d=a.lastIndexOf(".",b-1);if(0>=d||d>=b-1)return!1;var e=c.list[a.slice(b+1)];return e?e.indexOf(" "+a.slice(d+1,b)+" ")>=0:!1},is:function(a){var b=a.lastIndexOf(".");if(0>=b||b>=a.length-1)return!1;var d=a.lastIndexOf(".",b-1);if(d>=0)return!1;var e=c.list[a.slice(b+1)];return e?e.indexOf(" "+a.slice(0,b)+" ")>=0:!1},get:function(a){var b=a.lastIndexOf(".");if(0>=b||b>=a.length-1)return null;var d=a.lastIndexOf(".",b-1);if(0>=d||d>=b-1)return null;var e=c.list[a.slice(b+1)];return e?e.indexOf(" "+a.slice(d+1,b)+" ")<0?null:a.slice(d+1):null},noConflict:function(){return a.SecondLevelDomains===this&&(a.SecondLevelDomains=b),this}};return c}),function(a,b){"use strict";"object"==typeof exports?module.exports=b(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define("uri/URI",["./punycode","./IPv6","./SecondLevelDomains"],b):a.URI=b(a.punycode,a.IPv6,a.SecondLevelDomains,a)}(this,function(a,b,c,d){"use strict";function e(a,b){return this instanceof e?(void 0===a&&(a="undefined"!=typeof location?location.href+"":""),this.href(a),void 0!==b?this.absoluteTo(b):this):new e(a,b)}function f(a){return a.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function g(a){return void 0===a?"Undefined":String(Object.prototype.toString.call(a)).slice(8,-1)}function h(a){return"Array"===g(a)}function i(a,b){var c,d,e={};if(h(b))for(c=0,d=b.length;d>c;c++)e[b[c]]=!0;else e[b]=!0;for(c=0,d=a.length;d>c;c++)void 0!==e[a[c]]&&(a.splice(c,1),d--,c--);return a}function j(a,b){var c,d;if(h(b)){for(c=0,d=b.length;d>c;c++)if(!j(a,b[c]))return!1;return!0}var e=g(b);for(c=0,d=a.length;d>c;c++)if("RegExp"===e){if("string"==typeof a[c]&&a[c].match(b))return!0}else if(a[c]===b)return!0;return!1}function k(a,b){if(!h(a)||!h(b))return!1;if(a.length!==b.length)return!1;a.sort(),b.sort();for(var c=0,d=a.length;d>c;c++)if(a[c]!==b[c])return!1;return!0}function l(a){return escape(a)}function m(a){return encodeURIComponent(a).replace(/[!'()*]/g,l).replace(/\*/g,"%2A")}function n(a){return function(b,c){return void 0===b?this._parts[a]||"":(this._parts[a]=b||null,this.build(!c),this)}}function o(a,b){return function(c,d){return void 0===c?this._parts[a]||"":(null!==c&&(c+="",c.charAt(0)===b&&(c=c.substring(1))),this._parts[a]=c,this.build(!d),this)}}var p=d&&d.URI;e.version="1.14.1";var q=e.prototype,r=Object.prototype.hasOwnProperty;e._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:e.duplicateQueryParameters,escapeQuerySpace:e.escapeQuerySpace}},e.duplicateQueryParameters=!1,e.escapeQuerySpace=!0,e.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,e.idn_expression=/[^a-z0-9\.-]/i,e.punycode_expression=/(xn--)/i,e.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,e.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,e.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,e.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/},e.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},e.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,e.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src",audio:"src",video:"src"},e.getDomAttribute=function(a){if(a&&a.nodeName){var b=a.nodeName.toLowerCase();if("input"!==b||"image"===a.type)return e.domAttributes[b]}},e.encode=m,e.decode=decodeURIComponent,e.iso8859=function(){e.encode=escape,e.decode=unescape},e.unicode=function(){e.encode=m,e.decode=decodeURIComponent},e.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}},e.encodeQuery=function(a,b){var c=e.encode(a+"");return void 0===b&&(b=e.escapeQuerySpace),b?c.replace(/%20/g,"+"):c},e.decodeQuery=function(a,b){a+="",void 0===b&&(b=e.escapeQuerySpace);try{return e.decode(b?a.replace(/\+/g,"%20"):a)}catch(b){return a}},e.recodePath=function(a){for(var b=(a+"").split("/"),c=0,d=b.length;d>c;c++)b[c]=e.encodePathSegment(e.decode(b[c]));return b.join("/")},e.decodePath=function(a){for(var b=(a+"").split("/"),c=0,d=b.length;d>c;c++)b[c]=e.decodePathSegment(b[c]);return b.join("/")};var s,t={encode:"encode",decode:"decode"},u=function(a,b){return function(c){try{return e[b](c+"").replace(e.characters[a][b].expression,function(c){return e.characters[a][b].map[c]})}catch(a){return c}}};for(s in t)e[s+"PathSegment"]=u("pathname",t[s]);e.encodeReserved=u("reserved","encode"),e.parse=function(a,b){var c;return b||(b={}),c=a.indexOf("#"),c>-1&&(b.fragment=a.substring(c+1)||null,a=a.substring(0,c)),c=a.indexOf("?"),c>-1&&(b.query=a.substring(c+1)||null,a=a.substring(0,c)),"//"===a.substring(0,2)?(b.protocol=null,a=a.substring(2),a=e.parseAuthority(a,b)):(c=a.indexOf(":"),c>-1&&(b.protocol=a.substring(0,c)||null,b.protocol&&!b.protocol.match(e.protocol_expression)?b.protocol=void 0:"//"===a.substring(c+1,c+3)?(a=a.substring(c+3),a=e.parseAuthority(a,b)):(a=a.substring(c+1),b.urn=!0))),b.path=a,b},e.parseHost=function(a,b){var c,d,e=a.indexOf("/");return-1===e&&(e=a.length),"["===a.charAt(0)?(c=a.indexOf("]"),b.hostname=a.substring(1,c)||null,b.port=a.substring(c+2,e)||null,"/"===b.port&&(b.port=null)):a.indexOf(":")!==a.lastIndexOf(":")?(b.hostname=a.substring(0,e)||null,b.port=null):(d=a.substring(0,e).split(":"),b.hostname=d[0]||null,b.port=d[1]||null),b.hostname&&"/"!==a.substring(e).charAt(0)&&(e++,a="/"+a),a.substring(e)||"/"},e.parseAuthority=function(a,b){return a=e.parseUserinfo(a,b),e.parseHost(a,b)},e.parseUserinfo=function(a,b){var c,d=a.indexOf("/"),f=a.lastIndexOf("@",d>-1?d:a.length-1);return f>-1&&(-1===d||d>f)?(c=a.substring(0,f).split(":"),b.username=c[0]?e.decode(c[0]):null,c.shift(),b.password=c[0]?e.decode(c.join(":")):null,a=a.substring(f+1)):(b.username=null,b.password=null),a},e.parseQuery=function(a,b){if(!a)return{};if(a=a.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!a)return{};for(var c,d,f,g={},h=a.split("&"),i=h.length,j=0;i>j;j++)c=h[j].split("="),d=e.decodeQuery(c.shift(),b),f=c.length?e.decodeQuery(c.join("="),b):null,r.call(g,d)?("string"==typeof g[d]&&(g[d]=[g[d]]),g[d].push(f)):g[d]=f;return g},e.build=function(a){var b="";return a.protocol&&(b+=a.protocol+":"),a.urn||!b&&!a.hostname||(b+="//"),b+=e.buildAuthority(a)||"","string"==typeof a.path&&("/"!==a.path.charAt(0)&&"string"==typeof a.hostname&&(b+="/"),b+=a.path),"string"==typeof a.query&&a.query&&(b+="?"+a.query),"string"==typeof a.fragment&&a.fragment&&(b+="#"+a.fragment),b},e.buildHost=function(a){var b="";return a.hostname?(b+=e.ip6_expression.test(a.hostname)?"["+a.hostname+"]":a.hostname,a.port&&(b+=":"+a.port),b):""},e.buildAuthority=function(a){return e.buildUserinfo(a)+e.buildHost(a)},e.buildUserinfo=function(a){var b="";return a.username&&(b+=e.encode(a.username),a.password&&(b+=":"+e.encode(a.password)),b+="@"),b},e.buildQuery=function(a,b,c){var d,f,g,i,j="";for(f in a)if(r.call(a,f)&&f)if(h(a[f]))for(d={},g=0,i=a[f].length;i>g;g++)void 0!==a[f][g]&&void 0===d[a[f][g]+""]&&(j+="&"+e.buildQueryParameter(f,a[f][g],c),b!==!0&&(d[a[f][g]+""]=!0));else void 0!==a[f]&&(j+="&"+e.buildQueryParameter(f,a[f],c));return j.substring(1)},e.buildQueryParameter=function(a,b,c){return e.encodeQuery(a,c)+(null!==b?"="+e.encodeQuery(b,c):"")},e.addQuery=function(a,b,c){if("object"==typeof b)for(var d in b)r.call(b,d)&&e.addQuery(a,d,b[d]);else{if("string"!=typeof b)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===a[b])return void(a[b]=c);"string"==typeof a[b]&&(a[b]=[a[b]]),h(c)||(c=[c]),a[b]=(a[b]||[]).concat(c)}},e.removeQuery=function(a,b,c){var d,f,g;if(h(b))for(d=0,f=b.length;f>d;d++)a[b[d]]=void 0;else if("object"==typeof b)for(g in b)r.call(b,g)&&e.removeQuery(a,g,b[g]);else{if("string"!=typeof b)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");void 0!==c?a[b]===c?a[b]=void 0:h(a[b])&&(a[b]=i(a[b],c)):a[b]=void 0}},e.hasQuery=function(a,b,c,d){if("object"==typeof b){for(var f in b)if(r.call(b,f)&&!e.hasQuery(a,f,b[f]))return!1;return!0}if("string"!=typeof b)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(g(c)){case"Undefined":return b in a;case"Boolean":var i=Boolean(h(a[b])?a[b].length:a[b]);return c===i;case"Function":return!!c(a[b],b,a);case"Array":if(!h(a[b]))return!1;var l=d?j:k;return l(a[b],c);case"RegExp":return h(a[b])?d?j(a[b],c):!1:Boolean(a[b]&&a[b].match(c));case"Number":c=String(c);case"String":return h(a[b])?d?j(a[b],c):!1:a[b]===c;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},e.commonPath=function(a,b){var c,d=Math.min(a.length,b.length);for(c=0;d>c;c++)if(a.charAt(c)!==b.charAt(c)){c--;break}return 1>c?a.charAt(0)===b.charAt(0)&&"/"===a.charAt(0)?"/":"":("/"===a.charAt(c)&&"/"===b.charAt(c)||(c=a.substring(0,c).lastIndexOf("/")),a.substring(0,c+1))},e.withinString=function(a,b,c){c||(c={});var d=c.start||e.findUri.start,f=c.end||e.findUri.end,g=c.trim||e.findUri.trim,h=/[a-z0-9-]=["']?$/i;for(d.lastIndex=0;;){var i=d.exec(a);if(!i)break;var j=i.index;if(c.ignoreHtml){var k=a.slice(Math.max(j-3,0),j);if(k&&h.test(k))continue}var l=j+a.slice(j).search(f),m=a.slice(j,l).replace(g,"");if(!c.ignore||!c.ignore.test(m)){l=j+m.length;var n=b(m,j,l,a);a=a.slice(0,j)+n+a.slice(l),d.lastIndex=j+n.length}}return d.lastIndex=0,a},e.ensureValidHostname=function(b){if(b.match(e.invalid_hostname_characters)){if(!a)throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-] and Punycode.js is not available');if(a.toASCII(b).match(e.invalid_hostname_characters))throw new TypeError('Hostname "'+b+'" contains characters other than [A-Z0-9.-]')}},e.noConflict=function(a){if(a){var b={URI:this.noConflict()};return d.URITemplate&&"function"==typeof d.URITemplate.noConflict&&(b.URITemplate=d.URITemplate.noConflict()),d.IPv6&&"function"==typeof d.IPv6.noConflict&&(b.IPv6=d.IPv6.noConflict()),d.SecondLevelDomains&&"function"==typeof d.SecondLevelDomains.noConflict&&(b.SecondLevelDomains=d.SecondLevelDomains.noConflict()),b}return d.URI===this&&(d.URI=p),this},q.build=function(a){return a===!0?this._deferred_build=!0:(void 0===a||this._deferred_build)&&(this._string=e.build(this._parts),this._deferred_build=!1),this},q.clone=function(){return new e(this)},q.valueOf=q.toString=function(){return this.build(!1)._string},q.protocol=n("protocol"),q.username=n("username"),q.password=n("password"),q.hostname=n("hostname"),q.port=n("port"),q.query=o("query","?"),q.fragment=o("fragment","#"),q.search=function(a,b){var c=this.query(a,b);return"string"==typeof c&&c.length?"?"+c:c},q.hash=function(a,b){var c=this.fragment(a,b);return"string"==typeof c&&c.length?"#"+c:c},q.pathname=function(a,b){if(void 0===a||a===!0){var c=this._parts.path||(this._parts.hostname?"/":"");return a?e.decodePath(c):c}return this._parts.path=a?e.recodePath(a):"/",this.build(!b),this},q.path=q.pathname,q.href=function(a,b){var c;if(void 0===a)return this.toString();this._string="",this._parts=e._parts();var d=a instanceof e,f="object"==typeof a&&(a.hostname||a.path||a.pathname);if(a.nodeName){var g=e.getDomAttribute(a);a=a[g]||"",f=!1}if(!d&&f&&void 0!==a.pathname&&(a=a.toString()),"string"==typeof a||a instanceof String)this._parts=e.parse(String(a),this._parts);else{if(!d&&!f)throw new TypeError("invalid input");var h=d?a._parts:a;for(c in h)r.call(this._parts,c)&&(this._parts[c]=h[c])}return this.build(!b),this},q.is=function(a){var b=!1,d=!1,f=!1,g=!1,h=!1,i=!1,j=!1,k=!this._parts.urn;switch(this._parts.hostname&&(k=!1,d=e.ip4_expression.test(this._parts.hostname),f=e.ip6_expression.test(this._parts.hostname),b=d||f,g=!b,h=g&&c&&c.has(this._parts.hostname),i=g&&e.idn_expression.test(this._parts.hostname),j=g&&e.punycode_expression.test(this._parts.hostname)),a.toLowerCase()){case"relative":return k;case"absolute":return!k;case"domain":case"name":return g;case"sld":return h;case"ip":return b;case"ip4":case"ipv4":case"inet4":return d;case"ip6":case"ipv6":case"inet6":return f;case"idn":return i;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return j}return null};var v=q.protocol,w=q.port,x=q.hostname;q.protocol=function(a,b){if(void 0!==a&&a&&(a=a.replace(/:(\/\/)?$/,""),!a.match(e.protocol_expression)))throw new TypeError('Protocol "'+a+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return v.call(this,a,b)},q.scheme=q.protocol,q.port=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0!==a&&(0===a&&(a=null),a&&(a+="",":"===a.charAt(0)&&(a=a.substring(1)),a.match(/[^0-9]/))))throw new TypeError('Port "'+a+'" contains characters other than [0-9]');return w.call(this,a,b)},q.hostname=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0!==a){var c={};e.parseHost(a,c),a=c.hostname}return x.call(this,a,b)},q.host=function(a,b){return this._parts.urn?void 0===a?"":this:void 0===a?this._parts.hostname?e.buildHost(this._parts):"":(e.parseHost(a,this._parts),this.build(!b),this)},q.authority=function(a,b){return this._parts.urn?void 0===a?"":this:void 0===a?this._parts.hostname?e.buildAuthority(this._parts):"":(e.parseAuthority(a,this._parts),this.build(!b),this)},q.userinfo=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a){if(!this._parts.username)return"";var c=e.buildUserinfo(this._parts);return c.substring(0,c.length-1)}return"@"!==a[a.length-1]&&(a+="@"),e.parseUserinfo(a,this._parts),this.build(!b),this},q.resource=function(a,b){var c;return void 0===a?this.path()+this.search()+this.hash():(c=e.parse(a),this._parts.path=c.path,this._parts.query=c.query,this._parts.fragment=c.fragment,this.build(!b),this)},q.subdomain=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a){if(!this._parts.hostname||this.is("IP"))return"";var c=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,c)||""}var d=this._parts.hostname.length-this.domain().length,g=this._parts.hostname.substring(0,d),h=new RegExp("^"+f(g));return a&&"."!==a.charAt(a.length-1)&&(a+="."),a&&e.ensureValidHostname(a),this._parts.hostname=this._parts.hostname.replace(h,a),this.build(!b),this},q.domain=function(a,b){if(this._parts.urn)return void 0===a?"":this;if("boolean"==typeof a&&(b=a,a=void 0),void 0===a){if(!this._parts.hostname||this.is("IP"))return"";var c=this._parts.hostname.match(/\./g);if(c&&c.length<2)return this._parts.hostname;var d=this._parts.hostname.length-this.tld(b).length-1;return d=this._parts.hostname.lastIndexOf(".",d-1)+1,this._parts.hostname.substring(d)||""}if(!a)throw new TypeError("cannot set domain empty");if(e.ensureValidHostname(a),!this._parts.hostname||this.is("IP"))this._parts.hostname=a;else{var g=new RegExp(f(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(g,a)}return this.build(!b),this},q.tld=function(a,b){if(this._parts.urn)return void 0===a?"":this;if("boolean"==typeof a&&(b=a,a=void 0),void 0===a){if(!this._parts.hostname||this.is("IP"))return"";var d=this._parts.hostname.lastIndexOf("."),e=this._parts.hostname.substring(d+1);return b!==!0&&c&&c.list[e.toLowerCase()]?c.get(this._parts.hostname)||e:e}var g;if(!a)throw new TypeError("cannot set TLD empty");if(a.match(/[^a-zA-Z0-9-]/)){if(!c||!c.is(a))throw new TypeError('TLD "'+a+'" contains characters other than [A-Z0-9]');g=new RegExp(f(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(g,a)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");g=new RegExp(f(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(g,a)}return this.build(!b),this},q.directory=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a||a===!0){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var c=this._parts.path.length-this.filename().length-1,d=this._parts.path.substring(0,c)||(this._parts.hostname?"/":"");return a?e.decodePath(d):d}var g=this._parts.path.length-this.filename().length,h=this._parts.path.substring(0,g),i=new RegExp("^"+f(h));return this.is("relative")||(a||(a="/"),"/"!==a.charAt(0)&&(a="/"+a)),a&&"/"!==a.charAt(a.length-1)&&(a+="/"),a=e.recodePath(a),this._parts.path=this._parts.path.replace(i,a),this.build(!b),this},q.filename=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a||a===!0){if(!this._parts.path||"/"===this._parts.path)return"";var c=this._parts.path.lastIndexOf("/"),d=this._parts.path.substring(c+1);return a?e.decodePathSegment(d):d}var g=!1;"/"===a.charAt(0)&&(a=a.substring(1)),a.match(/\.?\//)&&(g=!0);var h=new RegExp(f(this.filename())+"$");return a=e.recodePath(a),this._parts.path=this._parts.path.replace(h,a),g?this.normalizePath(b):this.build(!b),this},q.suffix=function(a,b){if(this._parts.urn)return void 0===a?"":this;if(void 0===a||a===!0){if(!this._parts.path||"/"===this._parts.path)return"";var c,d,g=this.filename(),h=g.lastIndexOf(".");return-1===h?"":(c=g.substring(h+1),d=/^[a-z0-9%]+$/i.test(c)?c:"",a?e.decodePathSegment(d):d)}"."===a.charAt(0)&&(a=a.substring(1));var i,j=this.suffix();if(j)i=a?new RegExp(f(j)+"$"):new RegExp(f("."+j)+"$");else{if(!a)return this;this._parts.path+="."+e.recodePath(a)}return i&&(a=e.recodePath(a),this._parts.path=this._parts.path.replace(i,a)),this.build(!b),this},q.segment=function(a,b,c){var d=this._parts.urn?":":"/",e=this.path(),f="/"===e.substring(0,1),g=e.split(d);if(void 0!==a&&"number"!=typeof a&&(c=b,b=a,a=void 0),void 0!==a&&"number"!=typeof a)throw new Error('Bad segment "'+a+'", must be 0-based integer');if(f&&g.shift(),0>a&&(a=Math.max(g.length+a,0)),void 0===b)return void 0===a?g:g[a];if(null===a||void 0===g[a])if(h(b)){g=[];for(var i=0,j=b.length;j>i;i++)(b[i].length||g.length&&g[g.length-1].length)&&(g.length&&!g[g.length-1].length&&g.pop(),g.push(b[i]))}else(b||"string"==typeof b)&&(""===g[g.length-1]?g[g.length-1]=b:g.push(b));else b?g[a]=b:g.splice(a,1);return f&&g.unshift(""),this.path(g.join(d),c)},q.segmentCoded=function(a,b,c){var d,f,g;if("number"!=typeof a&&(c=b,b=a,a=void 0),void 0===b){if(d=this.segment(a,b,c),h(d))for(f=0,g=d.length;g>f;f++)d[f]=e.decode(d[f]);else d=void 0!==d?e.decode(d):void 0;return d}if(h(b))for(f=0,g=b.length;g>f;f++)b[f]=e.decode(b[f]);else b="string"==typeof b||b instanceof String?e.encode(b):b;return this.segment(a,b,c)};var y=q.query;return q.query=function(a,b){if(a===!0)return e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof a){var c=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace),d=a.call(this,c);return this._parts.query=e.buildQuery(d||c,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!b),this}return void 0!==a&&"string"!=typeof a?(this._parts.query=e.buildQuery(a,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!b),this):y.call(this,a,b)},q.setQuery=function(a,b,c){var d=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("string"==typeof a||a instanceof String)d[a]=void 0!==b?b:null;else{if("object"!=typeof a)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var f in a)r.call(a,f)&&(d[f]=a[f])}return this._parts.query=e.buildQuery(d,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof a&&(c=b),this.build(!c),this},q.addQuery=function(a,b,c){var d=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return e.addQuery(d,a,void 0===b?null:b),this._parts.query=e.buildQuery(d,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof a&&(c=b),this.build(!c),this},q.removeQuery=function(a,b,c){var d=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return e.removeQuery(d,a,b),this._parts.query=e.buildQuery(d,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof a&&(c=b),this.build(!c),this},q.hasQuery=function(a,b,c){var d=e.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return e.hasQuery(d,a,b,c)},q.setSearch=q.setQuery,q.addSearch=q.addQuery,q.removeSearch=q.removeQuery,q.hasSearch=q.hasQuery,q.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},q.normalizeProtocol=function(a){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!a)),this},q.normalizeHostname=function(c){return this._parts.hostname&&(this.is("IDN")&&a?this._parts.hostname=a.toASCII(this._parts.hostname):this.is("IPv6")&&b&&(this._parts.hostname=b.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!c)),this},q.normalizePort=function(a){return"string"==typeof this._parts.protocol&&this._parts.port===e.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!a)),this},q.normalizePath=function(a){if(this._parts.urn)return this;if(!this._parts.path||"/"===this._parts.path)return this;var b,c,d,f=this._parts.path,g="";for("/"!==f.charAt(0)&&(b=!0,f="/"+f),f=f.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),b&&(g=f.substring(1).match(/^(\.\.\/)+/)||"",g&&(g=g[0]));;){if(c=f.indexOf("/.."),-1===c)break;0!==c?(d=f.substring(0,c).lastIndexOf("/"),-1===d&&(d=c),f=f.substring(0,d)+f.substring(c+3)):f=f.substring(3)}return b&&this.is("relative")&&(f=g+f.substring(1)),f=e.recodePath(f),this._parts.path=f,this.build(!a),this},q.normalizePathname=q.normalizePath,q.normalizeQuery=function(a){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(e.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!a)),this},q.normalizeFragment=function(a){return this._parts.fragment||(this._parts.fragment=null,this.build(!a)),this},q.normalizeSearch=q.normalizeQuery,q.normalizeHash=q.normalizeFragment,q.iso8859=function(){var a=e.encode,b=e.decode;return e.encode=escape,e.decode=decodeURIComponent,this.normalize(),e.encode=a,e.decode=b,this},q.unicode=function(){var a=e.encode,b=e.decode;return e.encode=m,e.decode=unescape,this.normalize(),e.encode=a,e.decode=b,this},q.readable=function(){var b=this.clone();b.username("").password("").normalize();var c="";if(b._parts.protocol&&(c+=b._parts.protocol+"://"),b._parts.hostname&&(b.is("punycode")&&a?(c+=a.toUnicode(b._parts.hostname),b._parts.port&&(c+=":"+b._parts.port)):c+=b.host()),b._parts.hostname&&b._parts.path&&"/"!==b._parts.path.charAt(0)&&(c+="/"),c+=b.path(!0),b._parts.query){for(var d="",f=0,g=b._parts.query.split("&"),h=g.length;h>f;f++){var i=(g[f]||"").split("=");d+="&"+e.decodeQuery(i[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==i[1]&&(d+="="+e.decodeQuery(i[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}c+="?"+d.substring(1)}return c+=e.decodeQuery(b.hash(),!0)},q.absoluteTo=function(a){var b,c,d,f=this.clone(),g=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(a instanceof e||(a=new e(a)),f._parts.protocol||(f._parts.protocol=a._parts.protocol),this._parts.hostname)return f;for(c=0;d=g[c];c++)f._parts[d]=a._parts[d];return f._parts.path?".."===f._parts.path.substring(-2)&&(f._parts.path+="/"):(f._parts.path=a._parts.path,f._parts.query||(f._parts.query=a._parts.query)),"/"!==f.path().charAt(0)&&(b=a.directory(),f._parts.path=(b?b+"/":"")+f._parts.path,f.normalizePath()),f.build(),f},q.relativeTo=function(a){var b,c,d,f,g,h=this.clone().normalize();if(h._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(a=new e(a).normalize(),b=h._parts,c=a._parts,f=h.path(),g=a.path(),"/"!==f.charAt(0))throw new Error("URI is already relative");if("/"!==g.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(b.protocol===c.protocol&&(b.protocol=null),b.username!==c.username||b.password!==c.password)return h.build();if(null!==b.protocol||null!==b.username||null!==b.password)return h.build();if(b.hostname!==c.hostname||b.port!==c.port)return h.build();if(b.hostname=null,b.port=null,f===g)return b.path="",h.build();if(d=e.commonPath(h.path(),a.path()),!d)return h.build();var i=c.path.substring(d.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return b.path=i+b.path.substring(d.length),h.build()},q.equals=function(a){var b,c,d,f=this.clone(),g=new e(a),i={},j={},l={};if(f.normalize(),g.normalize(),f.toString()===g.toString())return!0;if(b=f.query(),c=g.query(),f.query(""),g.query(""),f.toString()!==g.toString())return!1;
if(b.length!==c.length)return!1;i=e.parseQuery(b,this._parts.escapeQuerySpace),j=e.parseQuery(c,this._parts.escapeQuerySpace);for(d in i)if(r.call(i,d)){if(h(i[d])){if(!k(i[d],j[d]))return!1}else if(i[d]!==j[d])return!1;l[d]=!0}for(d in j)if(r.call(j,d)&&!l[d])return!1;return!0},q.duplicateQueryParameters=function(a){return this._parts.duplicateQueryParameters=!!a,this},q.escapeQuerySpace=function(a){return this._parts.escapeQuerySpace=!!a,this},e}),define("src/util/pouchtovar",["pouchdb","uri/URI","src/util/debug","src/main/datas"],function(a,b,c){function d(a){this.initProperties();for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);this.addChangeListener()}function e(a){this.type="array",this.value=DataObject.check(a||[]),Object.defineProperty(this,"__pouch",m);for(var b=0,c=this.value.length;c>b;b++)this.value[b]=new d(this.value[b]),this.value[b].__parent=this}function f(a){this.url=a,this.urlH=a.replace(/\/\/[^\/]*@/,"//***@"),this.froms={},this.tos={},this.run()}function g(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a),d.onload=function(){200===d.status?b():c(Error(d.status+" : "+d.statusText))},d.onerror=function(){c(Error("Network error"))},d.send()})}function h(a){var c=new b(a);c.normalize();for(var d=c.segment();d.length>0;){var e=d.pop();if(e){c.segment(d);break}}return String(c)}function i(a,b,c,d){var e=h(c);o[e]||(o[e]=new f(e));var g=o[e];g.add(a,c,b,d)}function j(a,b){for(var c=-1,d=0,e=a.length;e>d;d++)if(a[d]._id===b){c=d;break}return c}function k(b){this.name=b,this.pouchdb=new a(b),this.singleDocs={};var c=this;this.pouchdb.changes({include_docs:!0,live:!0,since:"now"}).on("create",function(a){if(c.allDocs){var b=new d(a.doc);b.setPouch(c),c.allDocs.value.push(b),c.allDocs.triggerChange("internal_pouch_change")}}).on("update",function(a){var b=a.id;if(c.singleDocs[b]&&c.singleDocs[b]._rev!==a.doc._rev&&c.singleDocs[b].mergeWith(a.doc,"internal_pouch_change"),c.allDocs){var d=c.allDocs.value,e=j(d,b);e>-1&&d[e]._rev!==a.doc._rev&&d[e].mergeWith(a.doc,"internal_pouch_change")}}).on("delete",function(a){var b=a.id;if(c.singleDocs[b]&&(c.singleDocs[b].setPouch(null),delete c.singleDocs[b]),c.allDocs){var d=c.allDocs.value,e=j(d,b);e>-1&&(d[e].setPouch(null),d.splice(e,1),c.allDocs.triggerChange("internal_pouch_change"))}})}var l={},m={writable:!0,enumerable:!1};d.prototype=Object.create(DataObject.prototype,{constructor:{value:d},initProperties:{value:function(){Object.defineProperties(this,{__pouch:m,__nane:m,__parent:m,_id:m,_rev:m})}},setPouch:{value:function(a){this.__pouch=a}},getPouch:{value:function(){return this.__pouch}},exportForPouch:{value:function(){var a=new DataObject;for(var b in this)"function"!=typeof this[b]&&0!==b.indexOf("_")&&(a[b]=this[b]);return a.resurrect()}},addChangeListener:{value:function(){function a(f){if(!d||f){d=!0;var g=b.shift();e.getPouch().pouchdb.put(g,e._id,e._rev,function(f,g){return f?c.error("Error while writing PouchObject",f):(e._rev=g.rev,void(b.length?a(!0):d=!1))})}}if(!this.hasChangeListener){Object.defineProperty(this,"hasChangeListener",{value:!0});var b=[],d=!1,e=this;this.onChange(function(){var c=e.exportForPouch();b.push(c),a()},"internal_pouch_change")}}}}),d.from=function(a,b){return a instanceof d||(a.__proto__=d.prototype,a.initProperties(),a.addChangeListener()),a.setPouch(b),a},e.prototype=Object.create(DataObject.prototype,{constructor:{value:e},setPouch:{value:function(a){this.__pouch=a;for(var b=0,c=this.value.length;c>b;b++)this.value[b].__pouch=a}},getPouch:{value:function(){return this.__pouch}},push:{value:function(){var a;if(!(a=this.getPouch()))return void c.error("No Pouch manager has been defined for this array. Aborting push procedure.");Array.prototype.push.apply(this.value,arguments);for(var b=arguments.length,e=Array(b),f=Array(b),g=0;b>g;g++){var h=d.from(arguments[g],a,!0),i=h.exportForPouch();h._id&&(i._id=h._id),e[g]=i,f[g]=h}a.pouchdb.bulkDocs({docs:e}).then(function(a){for(var c=0;b>c;c++)f[c]._rev=a[c].rev},function(a){c.error("An error occured while pushing into PouchArray.",a)}),this.triggerChange("internal_pouch_change")}},splice:{value:function(){var a;if(!(a=this.getPouch()))return void c.error("No Pouch manager has been defined for this array. Aborting splice procedure.");for(var b=Array.prototype.splice.apply(this.value,arguments),d=0,e=b.length;e>d;d++)a.pouchdb.remove(b[d]);return this.triggerChange("internal_pouch_change"),b}},indexOf:{value:function(){return Array.prototype.indexOf.apply(this.value,arguments)}}});var n=function(){var a={};return{get:function(b){return a[b]||(a[b]=new k(b)),a[b]}}}(),o={};f.prototype.add=function(a,b,d,e){function f(b){return b.ok?a?c.debug("Replication from couchDB "+i+" to localDB "+h+" finished.",b):c.debug("Replication from localDB "+h+" to couchDB "+i+" finished.",b):a?c.warn("Replication from couchDB "+i+" to localDB "+h+" failed.",b):c.warn("Replication from localDB "+h+" to couchDB "+i+" failed.",b)}e=!!e;var g,h=d.name,i=b.replace(/\/\/[^\/]*@/,"//***@");if(a){if(this.froms[h])return;g=function(){return c.debug("Started replication from couchDB "+i+" to localDB "+h+"."),d.pouchdb.replicate.from(b,{live:e}).on("complete",f)},this.froms[h]=g}else{if(this.tos[h])return;g=function(){return c.debug("Started replication from localDB "+h+" to couchDB "+i+"."),d.pouchdb.replicate.to(b,{live:e}).on("complete",f)},this.tos[h]=g}this.online&&this.running.push(g())},f.prototype.run=function(){if(!this.isRunning){this.isRunning=!0,this.online=!1,this.running=[];var a=this,b=function(){var b;g(a.url).then(function(){if(c.trace(a.urlH+" is responding."),!a.online){c.info("Start all replications");for(b in a.froms)a.running.push(a.froms[b]());for(b in a.tos)a.running.push(a.tos[b]());a.online=!0}},function(b){if(c.trace(a.urlH+" is not responding.",b),a.online){for(c.warn("Stop all replications");a.running.length>0;)a.running.pop().cancel();a.online=!1}})};b(),this.interval=window.setInterval(b,6e4)}},k.prototype.sync=function(a,b,c){i(a,this,b,c)},k.prototype.getDoc=function(a,b){if(this.singleDocs[a])return Promise.resolve(this.singleDocs[a]);b=b||{};var e=this;return new Promise(function(f){var g;e.pouchdb.get(a,b).then(function(b){g=new d(b,!0),g.setPouch(e),e.singleDocs[a]=g,f(g)},function(b){c.info("Doc "+a+" does not exist, creating new doc.",b),g=new d({_id:a}),g.setPouch(e),e.singleDocs[a]=g,f(g)})})},k.prototype.getDocs=function(a){if(this.allDocs)return Promise.resolve(this.allDocs);a=a||{},a.include_docs=!0;var b=this;return new Promise(function(d){b.pouchdb.allDocs(a).then(function(a){for(var c=[],f=0,g=a.rows.length;g>f;f++)c.push(a.rows[f].doc);c=new e(c),c.setPouch(b),b.allDocs=c,d(c)},function(a){c.warn("Error in pouchdb.allDocs",a)})})};var p={direction:"both",continuous:!0};return l.replicate=function(a,b,c){if(a&&b){c=$.extend({},p,c);var d=n.get(a);"CtoP"!==c.direction&&"both"!==c.direction||d.sync(!0,b,c.continuous),"PtoC"!==c.direction&&"both"!==c.direction||d.sync(!1,b,c.continuous)}},l.abortReplications=function(){for(var a in o){var b=o[a];if(b.isRunning)for(window.clearInterval(b.interval);b.running.length>0;)b.running.pop().cancel();delete o[a]}},l.pouchToVar=function(a,b,d,e){var f;return(f=l.getManager(a))?("function"==typeof b&&(e=d,d=b,b=!1),b?f.getDoc(b,e).then(d,function(){c.error("Caught error in PouchManager.getDoc",a,b)}):f.getDocs(e).then(d,function(){c.error("Caught error in PouchManager.getDocs",a)})):!0},l.getManager=function(a){return a?n.get(a):void 0},l}),!function(a,b){"undefined"!=typeof module&&module.exports?module.exports=b():"function"==typeof define&&define.amd?define("bowser",b):this[a]=b()}("bowser",function(){function a(a){function c(b){var c=a.match(b);return c&&c.length>1&&c[1]||""}function d(b){var c=a.match(b);return c&&c.length>1&&c[2]||""}var e,f=c(/(ipod|iphone|ipad)/i).toLowerCase(),g=/like android/i.test(a),h=!g&&/android/i.test(a),i=/CrOS/.test(a),j=c(/edge\/(\d+(\.\d+)?)/i),k=c(/version\/(\d+(\.\d+)?)/i),l=/tablet/i.test(a),m=!l&&/[^-]mobi/i.test(a);/opera|opr/i.test(a)?e={name:"Opera",opera:b,version:k||c(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(a)?e={name:"Yandex Browser",yandexbrowser:b,version:k||c(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/windows phone/i.test(a)?(e={name:"Windows Phone",windowsphone:b},j?(e.msedge=b,e.version=j):(e.msie=b,e.version=c(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(a)?e={name:"Internet Explorer",msie:b,version:c(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:i?e={name:"Chrome",chromeBook:b,chrome:b,version:c(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(a)?e={name:"Microsoft Edge",msedge:b,version:j}:/chrome|crios|crmo/i.test(a)?e={name:"Chrome",chrome:b,version:c(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:f?(e={name:"iphone"==f?"iPhone":"ipad"==f?"iPad":"iPod"},k&&(e.version=k)):/sailfish/i.test(a)?e={name:"Sailfish",sailfish:b,version:c(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(a)?e={name:"SeaMonkey",seamonkey:b,version:c(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(a)?(e={name:"Firefox",firefox:b,version:c(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(a)&&(e.firefoxos=b)):/silk/i.test(a)?e={name:"Amazon Silk",silk:b,version:c(/silk\/(\d+(\.\d+)?)/i)}:h?e={name:"Android",version:k}:/phantom/i.test(a)?e={name:"PhantomJS",phantom:b,version:c(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(a)||/rim\stablet/i.test(a)?e={name:"BlackBerry",blackberry:b,version:k||c(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/(web|hpw)os/i.test(a)?(e={name:"WebOS",webos:b,version:k||c(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(a)&&(e.touchpad=b)):e=/bada/i.test(a)?{name:"Bada",bada:b,version:c(/dolfin\/(\d+(\.\d+)?)/i)}:/tizen/i.test(a)?{name:"Tizen",tizen:b,version:c(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||k}:/safari/i.test(a)?{name:"Safari",safari:b,version:k}:{name:c(/^(.*)\/(.*) /),version:d(/^(.*)\/(.*) /)},!e.msedge&&/(apple)?webkit/i.test(a)?(e.name=e.name||"Webkit",e.webkit=b,!e.version&&k&&(e.version=k)):!e.opera&&/gecko\//i.test(a)&&(e.name=e.name||"Gecko",e.gecko=b,e.version=e.version||c(/gecko\/(\d+(\.\d+)?)/i)),e.msedge||!h&&!e.silk?f&&(e[f]=b,e.ios=b):e.android=b;var n="";e.windowsphone?n=c(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):f?(n=c(/os (\d+([_\s]\d+)*) like mac os x/i),n=n.replace(/[_\s]/g,".")):h?n=c(/android[ \/-](\d+(\.\d+)*)/i):e.webos?n=c(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):e.blackberry?n=c(/rim\stablet\sos\s(\d+(\.\d+)*)/i):e.bada?n=c(/bada\/(\d+(\.\d+)*)/i):e.tizen&&(n=c(/tizen[\/\s](\d+(\.\d+)*)/i)),n&&(e.osversion=n);var o=n.split(".")[0];return l||"ipad"==f||h&&(3==o||4==o&&!m)||e.silk?e.tablet=b:(m||"iphone"==f||"ipod"==f||h||e.blackberry||e.webos||e.bada)&&(e.mobile=b),e.msedge||e.msie&&e.version>=10||e.yandexbrowser&&e.version>=15||e.chrome&&e.version>=20||e.firefox&&e.version>=20||e.safari&&e.version>=6||e.opera&&e.version>=10||e.ios&&e.osversion&&e.osversion.split(".")[0]>=6||e.blackberry&&e.version>=10.1?e.a=b:e.msie&&e.version<10||e.chrome&&e.version<20||e.firefox&&e.version<20||e.safari&&e.version<6||e.opera&&e.version<10||e.ios&&e.osversion&&e.osversion.split(".")[0]<6?e.c=b:e.x=b,e}var b=!0,c=a("undefined"!=typeof navigator?navigator.userAgent:"");return c.test=function(a){for(var b=0;b<a.length;++b){var d=a[b];if("string"==typeof d&&d in c)return!0}return!1},c._detect=a,c}),window.Modernizr=function(a,b,c){function d(a){t.cssText=a}function e(a,b){return d(x.join(a+";")+(b||""))}function f(a,b){return typeof a===b}function g(a,b){return!!~(""+a).indexOf(b)}function h(a,b){for(var d in a){var e=a[d];if(!g(e,"-")&&t[e]!==c)return"pfx"==b?e:!0}return!1}function i(a,b,d){for(var e in a){var g=b[a[e]];if(g!==c)return d===!1?a[e]:f(g,"function")?g.bind(d||b):g}return!1}function j(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+z.join(d+" ")+d).split(" ");return f(b,"string")||f(b,"undefined")?h(e,b):(e=(a+" "+A.join(d+" ")+d).split(" "),i(e,b,c))}function k(){o.input=function(c){for(var d=0,e=c.length;e>d;d++)E[c[d]]=!!(c[d]in u);return E.list&&(E.list=!(!b.createElement("datalist")||!a.HTMLDataListElement)),E}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),o.inputtypes=function(a){for(var d,e,f,g=0,h=a.length;h>g;g++)u.setAttribute("type",e=a[g]),d="text"!==u.type,d&&(u.value=v,u.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(e)&&u.style.WebkitAppearance!==c?(q.appendChild(u),f=b.defaultView,d=f.getComputedStyle&&"textfield"!==f.getComputedStyle(u,null).WebkitAppearance&&0!==u.offsetHeight,q.removeChild(u)):/^(search|tel)$/.test(e)||(d=/^(url|email)$/.test(e)?u.checkValidity&&u.checkValidity()===!1:u.value!=v)),D[a[g]]=!!d;return D}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var l,m,n="2.8.3",o={},p=!0,q=b.documentElement,r="modernizr",s=b.createElement(r),t=s.style,u=b.createElement("input"),v=":)",w={}.toString,x=" -webkit- -moz- -o- -ms- ".split(" "),y="Webkit Moz O ms",z=y.split(" "),A=y.toLowerCase().split(" "),B={svg:"http://www.w3.org/2000/svg"},C={},D={},E={},F=[],G=F.slice,H=function(a,c,d,e){var f,g,h,i,j=b.createElement("div"),k=b.body,l=k||b.createElement("body");if(parseInt(d,10))for(;d--;)h=b.createElement("div"),h.id=e?e[d]:r+(d+1),j.appendChild(h);return f=["&#173;",'<style id="s',r,'">',a,"</style>"].join(""),j.id=r,(k?j:l).innerHTML+=f,l.appendChild(j),k||(l.style.background="",l.style.overflow="hidden",i=q.style.overflow,q.style.overflow="hidden",q.appendChild(l)),g=c(j,a),k?j.parentNode.removeChild(j):(l.parentNode.removeChild(l),q.style.overflow=i),!!g},I=function(b){var c=a.matchMedia||a.msMatchMedia;if(c)return c(b)&&c(b).matches||!1;var d;return H("@media "+b+" { #"+r+" { position: absolute; } }",function(b){d="absolute"==(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle).position}),d},J=function(){function a(a,e){e=e||b.createElement(d[a]||"div"),a="on"+a;var g=a in e;return g||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(a,""),g=f(e[a],"function"),f(e[a],"undefined")||(e[a]=c),e.removeAttribute(a))),e=null,g}var d={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return a}(),K={}.hasOwnProperty;m=f(K,"undefined")||f(K.call,"undefined")?function(a,b){return b in a&&f(a.constructor.prototype[b],"undefined")}:function(a,b){return K.call(a,b)},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=G.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(G.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(G.call(arguments)))};return d}),C.flexbox=function(){return j("flexWrap")},C.flexboxlegacy=function(){return j("boxDirection")},C.canvas=function(){var a=b.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))},C.canvastext=function(){return!(!o.canvas||!f(b.createElement("canvas").getContext("2d").fillText,"function"))},C.webgl=function(){return!!a.WebGLRenderingContext},C.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:H(["@media (",x.join("touch-enabled),("),r,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=9===a.offsetTop}),c},C.geolocation=function(){return"geolocation"in navigator},C.postmessage=function(){return!!a.postMessage},C.websqldatabase=function(){return!!a.openDatabase},C.indexedDB=function(){return!!j("indexedDB",a)},C.hashchange=function(){return J("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},C.history=function(){return!(!a.history||!history.pushState)},C.draganddrop=function(){var a=b.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a},C.websockets=function(){return"WebSocket"in a||"MozWebSocket"in a},C.rgba=function(){return d("background-color:rgba(150,255,150,.5)"),g(t.backgroundColor,"rgba")},C.hsla=function(){return d("background-color:hsla(120,40%,100%,.5)"),g(t.backgroundColor,"rgba")||g(t.backgroundColor,"hsla")},C.multiplebgs=function(){return d("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(t.background)},C.backgroundsize=function(){return j("backgroundSize")},C.borderimage=function(){return j("borderImage")},C.borderradius=function(){return j("borderRadius")},C.boxshadow=function(){return j("boxShadow")},C.textshadow=function(){return""===b.createElement("div").style.textShadow},C.opacity=function(){return e("opacity:.55"),/^0.55$/.test(t.opacity)},C.cssanimations=function(){return j("animationName")},C.csscolumns=function(){return j("columnCount")},C.cssgradients=function(){var a="background-image:",b="gradient(linear,left top,right bottom,from(#9f9),to(white));",c="linear-gradient(left top,#9f9, white);";return d((a+"-webkit- ".split(" ").join(b+a)+x.join(c+a)).slice(0,-a.length)),g(t.backgroundImage,"gradient")},C.cssreflections=function(){return j("boxReflect")},C.csstransforms=function(){return!!j("transform")},C.csstransforms3d=function(){var a=!!j("perspective");return a&&"webkitPerspective"in q.style&&H("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(b,c){a=9===b.offsetLeft&&3===b.offsetHeight}),a},C.csstransitions=function(){return j("transition")},C.fontface=function(){var a;return H('@font-face {font-family:"font";src:url("https://")}',function(c,d){var e=b.getElementById("smodernizr"),f=e.sheet||e.styleSheet,g=f?f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"":"";a=/src/i.test(g)&&0===g.indexOf(d.split(" ")[0])}),a},C.generatedcontent=function(){var a;return H(["#",r,"{font:0/0 a}#",r,':after{content:"',v,'";visibility:hidden;font:3px/1 a}'].join(""),function(b){a=b.offsetHeight>=3}),a},C.video=function(){var a=b.createElement("video"),c=!1;try{(c=!!a.canPlayType)&&(c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(a){}return c},C.audio=function(){var a=b.createElement("audio"),c=!1;try{(c=!!a.canPlayType)&&(c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),c.mp3=a.canPlayType("audio/mpeg;").replace(/^no$/,""),c.wav=a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),c.m4a=(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""))}catch(a){}return c},C.localstorage=function(){try{return localStorage.setItem(r,r),localStorage.removeItem(r),!0}catch(a){return!1}},C.sessionstorage=function(){try{return sessionStorage.setItem(r,r),sessionStorage.removeItem(r),!0}catch(a){return!1}},C.webworkers=function(){return!!a.Worker},C.applicationcache=function(){return!!a.applicationCache},C.svg=function(){return!!b.createElementNS&&!!b.createElementNS(B.svg,"svg").createSVGRect},C.inlinesvg=function(){var a=b.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==B.svg},C.smil=function(){return!!b.createElementNS&&/SVGAnimate/.test(w.call(b.createElementNS(B.svg,"animate")))},C.svgclippaths=function(){return!!b.createElementNS&&/SVGClipPath/.test(w.call(b.createElementNS(B.svg,"clipPath")))};for(var L in C)m(C,L)&&(l=L.toLowerCase(),o[l]=C[L](),F.push((o[l]?"":"no-")+l));return o.input||k(),o.addTest=function(a,b){if("object"==typeof a)for(var d in a)m(a,d)&&o.addTest(d,a[d]);else{if(a=a.toLowerCase(),o[a]!==c)return o;b="function"==typeof b?b():b,"undefined"!=typeof p&&p&&(q.className+=" "+(b?"":"no-")+a),o[a]=b}return o},d(""),s=u=null,function(a,b){function c(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function d(){var a=s.elements;return"string"==typeof a?a.split(" "):a}function e(a){var b=r[a[p]];return b||(b={},q++,a[p]=q,r[q]=b),b}function f(a,c,d){if(c||(c=b),k)return c.createElement(a);d||(d=e(c));var f;return f=d.cache[a]?d.cache[a].cloneNode():o.test(a)?(d.cache[a]=d.createElem(a)).cloneNode():d.createElem(a),!f.canHaveChildren||n.test(a)||f.tagUrn?f:d.frag.appendChild(f)}function g(a,c){if(a||(a=b),k)return a.createDocumentFragment();c=c||e(a);for(var f=c.frag.cloneNode(),g=0,h=d(),i=h.length;i>g;g++)f.createElement(h[g]);return f}function h(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return s.shivMethods?f(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+d().join().replace(/[\w\-]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(s,b.frag)}function i(a){a||(a=b);var d=e(a);return!s.shivCSS||j||d.hasCSS||(d.hasCSS=!!c(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),k||h(a,d),a}var j,k,l="3.7.0",m=a.html5||{},n=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,o=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,p="_html5shiv",q=0,r={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",j="hidden"in a,k=1==a.childNodes.length||function(){b.createElement("a");var a=b.createDocumentFragment();return"undefined"==typeof a.cloneNode||"undefined"==typeof a.createDocumentFragment||"undefined"==typeof a.createElement}()}catch(a){j=!0,k=!0}}();var s={elements:m.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:l,shivCSS:m.shivCSS!==!1,supportsUnknownElements:k,shivMethods:m.shivMethods!==!1,type:"default",shivDocument:i,createElement:f,createDocumentFragment:g};a.html5=s,i(b)}(this,b),o._version=n,o._prefixes=x,o._domPrefixes=A,o._cssomPrefixes=z,o.mq=I,o.hasEvent=J,o.testProp=function(a){return h([a])},o.testAllProps=j,o.testStyles=H,o.prefixed=function(a,b,c){return b?j(a,b,c):j(a,"pfx")},q.className=q.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(p?" js "+F.join(" "):""),o}(this,this.document),define("modernizr",function(a){return function(){var b;return b||a.Modernizr}}(this)),function(a){"function"==typeof define&&define.amd?define("jquery-cookie",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(a){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),define("src/util/browser",["src/util/debug","bowser","lodash","modernizr","src/util/ui","jquery-cookie"],function(a,b,c,d,e){function f(){var d=/bot/i;if(navigator.userAgent.match(d))return"bot";var e=c.keys(k),f=c.map(e,function(a){return b[a]}),g=c.some(f);if(!g)return a.warn("browser not recognized"),!0;var h=e[f.indexOf(!0)];return k[h]<=+b.version}function g(){var a="<h1>Incompatible browser</h1>";return a+="<b><%- browserName %> <%- browserVersion %> </b> is incompatible with the visualizer<br/>",a+="Please update your browser to one of the following: <br/>",a+='<ul class="browser-list"><% _.forEach(browsers, function(b) { %><li class="<%- b.name.toLowerCase() %>"><a href="<%- b.url %>"> <%- b.name %> </a> <span style="color:orange"><%- b.message %></span></li><% }); %></ul>',c.template(a)(l)}function h(){var a="<h1>Your browser is missing some important features </h1><br/>";a+='<table><% _.forEach(features, function(f) { %> <tr>  <td style="width:20px; background-color: <%- f.color %>;"></td> <td> <%- f.name %>  </td></tr> <% }); %> </table><br/>',a+="<p>We recommend updating your browser to one of the following:</p>",a+='<ul class="browser-list"><% _.forEach(browsers, function(b) { %><li class="<%- b.name.toLowerCase() %>"><a href="<%- b.url %>"> <%- b.name %> </a> <span style="color:orange"><%- b.message %></span></li><% }); %></ul>';var b={features:c.cloneDeep(i)};return c.template(a)(c.merge(b,l))}var i={canvas:{name:"Canvas",type:"recommended"},webgl:{name:"WebGL",type:"recommended"},localstorage:{name:"LocalStorage",type:"recommended"}};c.keys(i).forEach(function(a){d[a]?(i[a].has=!0,i[a].color="green"):(i[a].has=!1,i[a].color="red")});var j=c.every(c.map(i,function(a){return a.has})),k={chrome:5,msie:11,firefox:5,msedge:0},l={browserName:b.name,browserVersion:b.version,browsers:[{name:"Chrome",url:"https://www.google.com/intl/en/chrome/browser/",message:"(Recommended)"},{name:"Firefox",url:"https://www.mozilla.org/en-US/firefox/new/"}]},m=f();return{checkCompatibility:function(){return new Promise(function(b){if("bot"===m)return b();if(!m)return a.error("browser is not compatible"),b(g());if($.cookie("visualizer-skip-feature-warning"))return a.info("user does not want to see warning"),b();if(j)return b();var c=$("<div>");c.html(h()),c.append('<input id="skip-warning-checkbox" type="checkbox">Don\'t show this again</input>'),e.dialog(c,{buttons:{Ok:function(){$(this).dialog("close"),$("#skip-warning-checkbox").is(":checked")&&$.cookie("visualizer-skip-feature-warning",!0,{path:"/"}),b()}},close:function(){b()},width:600})})}}}),define("src/util/shortcuts",["jquery","src/util/versioning"],function(a,b){a(document).keydown(function(a){!a.ctrlKey&&!a.metaKey||a.altKey||191!=a.which&&111!==a.which||(a.preventDefault(),require(["src/util/searchBox"],function(a){a()}))})}),define("src/util/mousetracker",["jquery"],function(a){var b={kind:"grid"};return document.addEventListener("mousemove",function(c){var d=c.target.id;if("modules-grid"===d)return void(b={kind:"grid"});var e=a(c.target);if(e.hasClass("ci-module-header")){var f=e.parents(".ci-module-wrapper").attr("data-module-id");return void(b={kind:"module",moduleId:Number(f)})}b={}}),{getState:function(){return b}}}),define("src/util/copyPasteManager",["src/util/mousetracker","modules/modulefactory","src/util/ui","src/util/versioning","src/main/grid","src/util/debug"],function(a,b,c,d,e,f){document.addEventListener("copy",function(e){var f=document.activeElement;if(!f||"TEXTAREA"!==f.nodeName){var g=!1,h=a.getState();if("grid"===h.kind)e.clipboardData.setData("text/plain",d.getViewJSON()),c.showNotification("View copied","success"),g=!0;else if("module"===h.kind){var i=b.getModules();i=i.filter(function(a){return Number(a.getId())===h.moduleId}),i.length&&(e.clipboardData.setData("text/plain",JSON.stringify(i[0].definition)),c.showNotification("Module copied","success"),g=!0)}g&&e.preventDefault()}}),document.addEventListener("paste",function(b){var c=a.getState();"grid"!==c.kind&&"module"!==c.kind||b.clipboardData.items[0].getAsString(function(a){try{var b=JSON.parse(a);b.version?d.setViewJSON(b):b.url&&e.addModuleFromJSON(b)}catch(a){f.info("Ignored error while pasting")}})})}),define("src/header/components/default",["jquery","src/util/util"],function(a,b){function c(){}return c.prototype.init=function(a){this.options=a,this._open=!1,this.makeDom(),this.initImpl()},c.prototype.initImpl=b.noop,c.prototype.makeDom=function(){var b=this;this._dom=document.createElement("li"),this.$_dom=a(this._dom),this.$_dom.text(this.options.label||this.options.title||""),this.$_dom.bind("click",function(){b.onClick()})},c.prototype.getDom=function(){return this.$_dom},c.prototype.onClick=function(){this._open=!this._open,this._onClick()},c.prototype._onClick=b.noop,c.prototype.setStyleOpen=function(a){this.$_dom[a?"addClass":"removeClass"]("opened")},c.prototype.open=function(){this.$_elToOpen.addClass("header-button-list ci-visualizer-text"),0===this.$_elToOpen.parents("body").length&&a("body").append(this.$_elToOpen),this.$_elToOpen.show();var b,c,d=this.$_elToOpen.outerWidth(!0),e=this.$_dom.outerHeight(!0),f=this.$_dom.position(),g=(a(window).outerHeight(!0),a("#header").outerWidth(!0));b=f.left+d>=g?g-d:f.left,c=e+f.top-1,this.$_elToOpen.css({top:c,left:b})},c.prototype.close=function(){this.$_elToOpen&&this.$_elToOpen.hide()},c}),define("src/header/components/blankview",["jquery","src/header/components/default","src/util/versioning","src/util/util"],function(a,b,c,d){function e(){}return d.inherits(e,b,{_onClick:function(){c.blankView()}}),e}),define("src/header/components/copydata",["jquery","src/util/ui","src/header/components/default","src/util/versioning","src/util/util"],function(a,b,c,d,e){function f(){}return e.inherits(f,c,{_onClick:function(){b.copyData()}}),f}),define("src/header/components/copyview",["jquery","src/util/ui","src/header/components/default","src/util/versioning","src/util/util"],function(a,b,c,d,e){function f(){}return e.inherits(f,c,{_onClick:function(){b.copyview()}}),f}),define("src/header/components/couchshare",["src/util/ui","src/header/components/default","src/util/util"],function(a,b,c){function d(){}return c.inherits(d,b,{initImpl:function(){this.dialogOptions={title:"Share view",width:550,height:170}},_onClick:function(){a.couchShare(this.options,this.dialogOptions)}}),d}),define("src/header/components/feedback",["jquery","src/util/ui","src/header/components/default","./../../util/couchshare","forms/button","src/util/util"],function(a,b,c,d,e,f){function g(){}var h={couchUrl:"https://visualizer.epfl.ch",database:"x",tinyUrl:"https://visualizer.epfl.ch/tiny"};return f.inherits(g,c,{initImpl:function(){},_onClick:function(){b.feedback(this.options,h)}}),g}),define("src/header/components/pastedata",["jquery","src/util/ui","src/header/components/default","src/util/versioning","forms/button","src/util/util"],function(a,b,c,d,e,f){function g(){}return f.inherits(g,c,{_onClick:function(){b.pasteData()}}),g}),define("src/header/components/pasteview",["jquery","src/util/ui","src/header/components/default","src/util/versioning","forms/button","src/util/util"],function(a,b,c,d,e,f){function g(){}return f.inherits(g,c,{_onClick:function(){b.pasteView()}}),g}),define("src/util/sandbox",[],function(){function Sandbox(){this.contextData=[],this.contextString="",this.scriptID=0}function safeEval(script,ctxString,__ctx__,Sandbox){return eval(ctxString+script)}return Sandbox.prototype.setContext=function(a){var b="",c=[];Object.keys(a).forEach(function(d,e){b+="var "+d+" = __ctx__["+e+"]; ",c.push(a[d])}),this.contextString=b,this.contextData=c},Sandbox.prototype.run=function(a,b){return b&&(a+="//# sourceURL="+b+"@"+this.scriptID++),safeEval(a,this.contextString,this.contextData.slice())},Sandbox}),function(a){"function"==typeof define&&define.amd?define("select2",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b=function(){if(a&&a.fn&&a.fn.select2&&a.fn.select2.amd)var b=a.fn.select2.amd;var b;return function(){if(!b||!b.requirejs){b?c=b:b={};var a,c,d;!function(b){function e(a,b){return u.call(a,b)}function f(a,b){
var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(n=n.slice(0,n.length-1),a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.concat(a),k=0;k<a.length;k+=1)if(m=a[k],"."===m)a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if(e=o[n.slice(0,l).join("/")],e&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,c){return function(){return n.apply(b,v.call(arguments,0).concat([a,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var c=r[a];delete r[a],t[a]=!0,m.apply(b,c)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||a,"undefined"===v||"function"===v){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,"require"===k)u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[a],u):void 0,a&&(h&&h.exports!==b&&h.exports!==q[a]?q[a]=h.exports:l===b&&s||(q[a]=l))}else a&&(q[a]=d)},a=c=n=function(a,c,d,e,f){if("string"==typeof a)return p[a]?p[a](c):j(o(a,c).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(a=c,c=d,d=null):a=b}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(b,a,c,d):setTimeout(function(){m(b,a,c,d)},4),n},n.config=function(a){return n(a)},a._defined=q,d=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),b.requirejs=a,b.require=c,b.define=d}}(),b.define("almond",function(){}),b.define("jquery",[],function(){var b=a||$;return null==b&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),b}),b.define("select2/utils",["jquery"],function(a){function b(a){var b=a.prototype,c=[];for(var d in b){var e=b[d];"function"==typeof e&&"constructor"!==d&&c.push(d)}return c}var c={};c.Extend=function(a,b){function c(){this.constructor=a}var d={}.hasOwnProperty;for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},c.Decorate=function(a,c){function d(){var b=Array.prototype.unshift,d=c.prototype.constructor.length,e=a.prototype.constructor;d>0&&(b.call(arguments,a.prototype.constructor),e=c.prototype.constructor),e.apply(this,arguments)}function e(){this.constructor=d}var f=b(c),g=b(a);c.displayName=a.displayName,d.prototype=new e;for(var h=0;h<g.length;h++){var i=g[h];d.prototype[i]=a.prototype[i]}for(var j=(function(a){var b=function(){};a in d.prototype&&(b=d.prototype[a]);var e=c.prototype[a];return function(){var a=Array.prototype.unshift;return a.call(arguments,b),e.apply(this,arguments)}}),k=0;k<f.length;k++){var l=f[k];d.prototype[l]=j(l)}return d};var d=function(){this.listeners={}};return d.prototype.on=function(a,b){this.listeners=this.listeners||{},a in this.listeners?this.listeners[a].push(b):this.listeners[a]=[b]},d.prototype.trigger=function(a){var b=Array.prototype.slice;this.listeners=this.listeners||{},a in this.listeners&&this.invoke(this.listeners[a],b.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},d.prototype.invoke=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c].apply(this,b)},c.Observable=d,c.generateChars=function(a){for(var b="",c=0;a>c;c++){var d=Math.floor(36*Math.random());b+=d.toString(36)}return b},c.bind=function(a,b){return function(){a.apply(b,arguments)}},c._convertData=function(a){for(var b in a){var c=b.split("-"),d=a;if(1!==c.length){for(var e=0;e<c.length;e++){var f=c[e];f=f.substring(0,1).toLowerCase()+f.substring(1),f in d||(d[f]={}),e==c.length-1&&(d[f]=a[b]),d=d[f]}delete a[b]}}return a},c.hasScroll=function(b,c){var d=a(c),e=c.style.overflowX,f=c.style.overflowY;return e!==f||"hidden"!==f&&"visible"!==f?"scroll"===e||"scroll"===f?!0:d.innerHeight()<c.scrollHeight||d.innerWidth()<c.scrollWidth:!1},c.escapeMarkup=function(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof a?a:String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})},c.appendMany=function(b,c){if("1.7"===a.fn.jquery.substr(0,3)){var d=a();a.map(c,function(a){d=d.add(a)}),c=d}b.append(c)},c}),b.define("select2/results",["jquery","./utils"],function(a,b){function c(a,b,d){this.$element=a,this.data=d,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&b.attr("aria-multiselectable","true"),this.$results=b,b},c.prototype.clear=function(){this.$results.empty()},c.prototype.displayMessage=function(b){var c=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var d=a('<li role="treeitem" class="select2-results__option"></li>'),e=this.options.get("translations").get(b.message);d.append(c(e(b.args))),this.$results.append(d)},c.prototype.append=function(a){this.hideLoading();var b=[];if(null==a.results||0===a.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));a.results=this.sort(a.results);for(var c=0;c<a.results.length;c++){var d=a.results[c],e=this.option(d);b.push(e)}this.$results.append(b)},c.prototype.position=function(a,b){var c=b.find(".select2-results");c.append(a)},c.prototype.sort=function(a){var b=this.options.get("sorter");return b(a)},c.prototype.setClasses=function(){var b=this;this.data.current(function(c){var d=a.map(c,function(a){return a.id.toString()}),e=b.$results.find(".select2-results__option[aria-selected]");e.each(function(){var b=a(this),c=a.data(this,"data"),e=""+c.id;null!=c.element&&c.element.selected||null==c.element&&a.inArray(e,d)>-1?b.attr("aria-selected","true"):b.attr("aria-selected","false")});var f=e.filter("[aria-selected=true]");f.length>0?f.first().trigger("mouseenter"):e.first().trigger("mouseenter")})},c.prototype.showLoading=function(a){this.hideLoading();var b=this.options.get("translations").get("searching"),c={disabled:!0,loading:!0,text:b(a)},d=this.option(c);d.className+=" loading-results",this.$results.prepend(d)},c.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},c.prototype.option=function(b){var c=document.createElement("li");c.className="select2-results__option";var d={role:"treeitem","aria-selected":"false"};b.disabled&&(delete d["aria-selected"],d["aria-disabled"]="true"),null==b.id&&delete d["aria-selected"],null!=b._resultId&&(c.id=b._resultId),b.title&&(c.title=b.title),b.children&&(d.role="group",d["aria-label"]=b.text,delete d["aria-selected"]);for(var e in d){var f=d[e];c.setAttribute(e,f)}if(b.children){var g=a(c),h=document.createElement("strong");h.className="select2-results__group";a(h);this.template(b,h);for(var i=[],j=0;j<b.children.length;j++){var k=b.children[j],l=this.option(k);i.push(l)}var m=a("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});m.append(i),g.append(h),g.append(m)}else this.template(b,c);return a.data(c,"data",b),c},c.prototype.bind=function(b,c){var d=this,e=b.id+"-results";this.$results.attr("id",e),b.on("results:all",function(a){d.clear(),d.append(a.data),b.isOpen()&&d.setClasses()}),b.on("results:append",function(a){d.append(a.data),b.isOpen()&&d.setClasses()}),b.on("query",function(a){d.showLoading(a)}),b.on("select",function(){b.isOpen()&&d.setClasses()}),b.on("unselect",function(){b.isOpen()&&d.setClasses()}),b.on("open",function(){d.$results.attr("aria-expanded","true"),d.$results.attr("aria-hidden","false"),d.setClasses(),d.ensureHighlightVisible()}),b.on("close",function(){d.$results.attr("aria-expanded","false"),d.$results.attr("aria-hidden","true"),d.$results.removeAttr("aria-activedescendant")}),b.on("results:toggle",function(){var a=d.getHighlightedResults();0!==a.length&&a.trigger("mouseup")}),b.on("results:select",function(){var a=d.getHighlightedResults();if(0!==a.length){var b=a.data("data");"true"==a.attr("aria-selected")?d.trigger("close"):d.trigger("select",{data:b})}}),b.on("results:previous",function(){var a=d.getHighlightedResults(),b=d.$results.find("[aria-selected]"),c=b.index(a);if(0!==c){var e=c-1;0===a.length&&(e=0);var f=b.eq(e);f.trigger("mouseenter");var g=d.$results.offset().top,h=f.offset().top,i=d.$results.scrollTop()+(h-g);0===e?d.$results.scrollTop(0):0>h-g&&d.$results.scrollTop(i)}}),b.on("results:next",function(){var a=d.getHighlightedResults(),b=d.$results.find("[aria-selected]"),c=b.index(a),e=c+1;if(!(e>=b.length)){var f=b.eq(e);f.trigger("mouseenter");var g=d.$results.offset().top+d.$results.outerHeight(!1),h=f.offset().top+f.outerHeight(!1),i=d.$results.scrollTop()+h-g;0===e?d.$results.scrollTop(0):h>g&&d.$results.scrollTop(i)}}),b.on("results:focus",function(a){a.element.addClass("select2-results__option--highlighted")}),b.on("results:message",function(a){d.displayMessage(a)}),a.fn.mousewheel&&this.$results.on("mousewheel",function(a){var b=d.$results.scrollTop(),c=d.$results.get(0).scrollHeight-d.$results.scrollTop()+a.deltaY,e=a.deltaY>0&&b-a.deltaY<=0,f=a.deltaY<0&&c<=d.$results.height();e?(d.$results.scrollTop(0),a.preventDefault(),a.stopPropagation()):f&&(d.$results.scrollTop(d.$results.get(0).scrollHeight-d.$results.height()),a.preventDefault(),a.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(b){var c=a(this),e=c.data("data");return"true"===c.attr("aria-selected")?void(d.options.get("multiple")?d.trigger("unselect",{originalEvent:b,data:e}):d.trigger("close")):void d.trigger("select",{originalEvent:b,data:e})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(b){var c=a(this).data("data");d.getHighlightedResults().removeClass("select2-results__option--highlighted"),d.trigger("results:focus",{data:c,element:a(this)})})},c.prototype.getHighlightedResults=function(){var a=this.$results.find(".select2-results__option--highlighted");return a},c.prototype.destroy=function(){this.$results.remove()},c.prototype.ensureHighlightVisible=function(){var a=this.getHighlightedResults();if(0!==a.length){var b=this.$results.find("[aria-selected]"),c=b.index(a),d=this.$results.offset().top,e=a.offset().top,f=this.$results.scrollTop()+(e-d),g=e-d;f-=2*a.outerHeight(!1),2>=c?this.$results.scrollTop(0):(g>this.$results.outerHeight()||0>g)&&this.$results.scrollTop(f)}},c.prototype.template=function(b,c){var d=this.options.get("templateResult"),e=this.options.get("escapeMarkup"),f=d(b);null==f?c.style.display="none":"string"==typeof f?c.innerHTML=e(f):a(c).append(f)},c}),b.define("select2/keys",[],function(){var a={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return a}),b.define("select2/selection/base",["jquery","../utils","../keys"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,b.Observable),d.prototype.render=function(){var b=a('<span class="select2-selection" role="combobox" aria-autocomplete="list" aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),b.attr("title",this.$element.attr("title")),b.attr("tabindex",this._tabindex),this.$selection=b,b},d.prototype.bind=function(a,b){var d=this,e=(a.id+"-container",a.id+"-results");this.container=a,this.$selection.on("focus",function(a){d.trigger("focus",a)}),this.$selection.on("blur",function(a){d.trigger("blur",a)}),this.$selection.on("keydown",function(a){d.trigger("keypress",a),a.which===c.SPACE&&a.preventDefault()}),a.on("results:focus",function(a){d.$selection.attr("aria-activedescendant",a.data._resultId)}),a.on("selection:update",function(a){d.update(a.data)}),a.on("open",function(){d.$selection.attr("aria-expanded","true"),d.$selection.attr("aria-owns",e),d._attachCloseHandler(a)}),a.on("close",function(){d.$selection.attr("aria-expanded","false"),d.$selection.removeAttr("aria-activedescendant"),d.$selection.removeAttr("aria-owns"),d.$selection.focus(),d._detachCloseHandler(a)}),a.on("enable",function(){d.$selection.attr("tabindex",d._tabindex)}),a.on("disable",function(){d.$selection.attr("tabindex","-1")})},d.prototype._attachCloseHandler=function(b){a(document.body).on("mousedown.select2."+b.id,function(b){var c=a(b.target),d=c.closest(".select2"),e=a(".select2.select2-container--open");e.each(function(){var b=a(this);if(this!=d[0]){var c=b.data("element");c.select2("close")}})})},d.prototype._detachCloseHandler=function(b){a(document.body).off("mousedown.select2."+b.id)},d.prototype.position=function(a,b){var c=b.find(".selection");c.append(a)},d.prototype.destroy=function(){this._detachCloseHandler(this.container)},d.prototype.update=function(a){throw new Error("The `update` method must be defined in child classes.")},d}),b.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(a,b,c,d){function e(){e.__super__.constructor.apply(this,arguments)}return c.Extend(e,b),e.prototype.render=function(){var a=e.__super__.render.call(this);return a.addClass("select2-selection--single"),a.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),a},e.prototype.bind=function(a,b){var c=this;e.__super__.bind.apply(this,arguments);var d=a.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",d),this.$selection.attr("aria-labelledby",d),this.$selection.on("mousedown",function(a){1===a.which&&c.trigger("toggle",{originalEvent:a})}),this.$selection.on("focus",function(a){}),this.$selection.on("blur",function(a){}),a.on("selection:update",function(a){c.update(a.data)})},e.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},e.prototype.display=function(a){var b=this.options.get("templateSelection"),c=this.options.get("escapeMarkup");return c(b(a))},e.prototype.selectionContainer=function(){return a("<span></span>")},e.prototype.update=function(a){if(0===a.length)return void this.clear();var b=a[0],c=this.display(b),d=this.$selection.find(".select2-selection__rendered");d.empty().append(c),d.prop("title",b.title||b.text)},e}),b.define("select2/selection/multiple",["jquery","./base","../utils"],function(a,b,c){function d(a,b){d.__super__.constructor.apply(this,arguments)}return c.Extend(d,b),d.prototype.render=function(){var a=d.__super__.render.call(this);return a.addClass("select2-selection--multiple"),a.html('<ul class="select2-selection__rendered"></ul>'),a},d.prototype.bind=function(b,c){var e=this;d.__super__.bind.apply(this,arguments),this.$selection.on("click",function(a){e.trigger("toggle",{originalEvent:a})}),this.$selection.on("click",".select2-selection__choice__remove",function(b){var c=a(this),d=c.parent(),f=d.data("data");e.trigger("unselect",{originalEvent:b,data:f})})},d.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},d.prototype.display=function(a){var b=this.options.get("templateSelection"),c=this.options.get("escapeMarkup");return c(b(a))},d.prototype.selectionContainer=function(){var b=a('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return b},d.prototype.update=function(a){if(this.clear(),0!==a.length){for(var b=[],d=0;d<a.length;d++){var e=a[d],f=this.display(e),g=this.selectionContainer();g.append(f),g.prop("title",e.title||e.text),g.data("data",e),b.push(g)}var h=this.$selection.find(".select2-selection__rendered");c.appendMany(h,b)}},d}),b.define("select2/selection/placeholder",["../utils"],function(a){function b(a,b,c){this.placeholder=this.normalizePlaceholder(c.get("placeholder")),a.call(this,b,c)}return b.prototype.normalizePlaceholder=function(a,b){return"string"==typeof b&&(b={id:"",text:b}),b},b.prototype.createPlaceholder=function(a,b){var c=this.selectionContainer();return c.html(this.display(b)),c.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),c},b.prototype.update=function(a,b){var c=1==b.length&&b[0].id!=this.placeholder.id,d=b.length>1;if(d||c)return a.call(this,b);this.clear();var e=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(e)},b}),b.define("select2/selection/allowClear",["jquery","../keys"],function(a,b){function c(){}return c.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",function(a){d._handleClear(a)}),b.on("keypress",function(a){d._handleKeyboardClear(a,b)})},c.prototype._handleClear=function(a,b){if(!this.options.get("disabled")){var c=this.$selection.find(".select2-selection__clear");if(0!==c.length){b.stopPropagation();for(var d=c.data("data"),e=0;e<d.length;e++){var f={data:d[e]};if(this.trigger("unselect",f),f.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle")}}},c.prototype._handleKeyboardClear=function(a,c,d){d.isOpen()||c.which!=b.DELETE&&c.which!=b.BACKSPACE||this._handleClear(c)},c.prototype.update=function(b,c){if(b.call(this,c),!(this.$selection.find(".select2-selection__placeholder").length>0||0===c.length)){var d=a('<span class="select2-selection__clear">&times;</span>');d.data("data",c),this.$selection.find(".select2-selection__rendered").prepend(d)}},c}),b.define("select2/selection/search",["jquery","../utils","../keys"],function(a,b,c){function d(a,b,c){a.call(this,b,c)}return d.prototype.render=function(b){var c=a('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></li>');this.$searchContainer=c,this.$search=c.find("input");var d=b.call(this);return d},d.prototype.bind=function(a,b,d){var e=this;a.call(this,b,d),b.on("open",function(){e.$search.attr("tabindex",0),e.$search.focus()}),b.on("close",function(){e.$search.attr("tabindex",-1),e.$search.val(""),e.$search.focus()}),b.on("enable",function(){e.$search.prop("disabled",!1)}),b.on("disable",function(){e.$search.prop("disabled",!0)}),this.$selection.on("focusin",".select2-search--inline",function(a){e.trigger("focus",a)}),this.$selection.on("focusout",".select2-search--inline",function(a){e.trigger("blur",a)}),this.$selection.on("keydown",".select2-search--inline",function(a){a.stopPropagation(),e.trigger("keypress",a),e._keyUpPrevented=a.isDefaultPrevented();var b=a.which;if(b===c.BACKSPACE&&""===e.$search.val()){var d=e.$searchContainer.prev(".select2-selection__choice");if(d.length>0){var f=d.data("data");e.searchRemoveChoice(f),a.preventDefault()}}}),this.$selection.on("input",".select2-search--inline",function(a){e.$selection.off("keyup.search")}),this.$selection.on("keyup.search input",".select2-search--inline",function(a){e.handleSearch(a)})},d.prototype.createPlaceholder=function(a,b){this.$search.attr("placeholder",b.text)},d.prototype.update=function(a,b){this.$search.attr("placeholder",""),a.call(this,b),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch()},d.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var a=this.$search.val();this.trigger("query",{term:a})}this._keyUpPrevented=!1},d.prototype.searchRemoveChoice=function(a,b){this.trigger("unselect",{data:b}),this.trigger("open"),this.$search.val(b.text+" ")},d.prototype.resizeSearch=function(){this.$search.css("width","25px");var a="";if(""!==this.$search.attr("placeholder"))a=this.$selection.find(".select2-selection__rendered").innerWidth();else{var b=this.$search.val().length+1;a=.75*b+"em"}this.$search.css("width",a)},d}),b.define("select2/selection/eventRelay",["jquery"],function(a){function b(){}return b.prototype.bind=function(b,c,d){var e=this,f=["open","opening","close","closing","select","selecting","unselect","unselecting"],g=["opening","closing","selecting","unselecting"];b.call(this,c,d),c.on("*",function(b,c){if(-1!==a.inArray(b,f)){c=c||{};var d=a.Event("select2:"+b,{params:c});e.$element.trigger(d),-1!==a.inArray(b,g)&&(c.prevented=d.isDefaultPrevented())}})},b}),b.define("select2/translation",["jquery","require"],function(a,b){function c(a){this.dict=a||{}}return c.prototype.all=function(){return this.dict},c.prototype.get=function(a){return this.dict[a]},c.prototype.extend=function(b){this.dict=a.extend({},b.all(),this.dict)},c._cache={},c.loadPath=function(a){if(!(a in c._cache)){var d=b(a);c._cache[a]=d}return new c(c._cache[a])},c}),b.define("select2/diacritics",[],function(){var a={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};return a}),b.define("select2/data/base",["../utils"],function(a){function b(a,c){b.__super__.constructor.call(this)}return a.Extend(b,a.Observable),b.prototype.current=function(a){throw new Error("The `current` method must be defined in child classes.")},b.prototype.query=function(a,b){throw new Error("The `query` method must be defined in child classes.")},b.prototype.bind=function(a,b){},b.prototype.destroy=function(){},b.prototype.generateResultId=function(b,c){var d=b.id+"-result-";return d+=a.generateChars(4),d+=null!=c.id?"-"+c.id.toString():"-"+a.generateChars(4)},b}),b.define("select2/data/select",["./base","../utils","jquery"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,a),d.prototype.current=function(a){var b=[],d=this;this.$element.find(":selected").each(function(){var a=c(this),e=d.item(a);b.push(e)}),a(b)},d.prototype.select=function(a){var b=this;if(a.selected=!0,c(a.element).is("option"))return a.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(d){var e=[];a=[a],a.push.apply(a,d);for(var f=0;f<a.length;f++){var g=a[f].id;-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger("change")});else{var d=a.id;this.$element.val(d),this.$element.trigger("change")}},d.prototype.unselect=function(a){var b=this;if(this.$element.prop("multiple"))return a.selected=!1,c(a.element).is("option")?(a.element.selected=!1,void this.$element.trigger("change")):void this.current(function(d){for(var e=[],f=0;f<d.length;f++){var g=d[f].id;g!==a.id&&-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger("change")})},d.prototype.bind=function(a,b){var c=this;this.container=a,a.on("select",function(a){c.select(a.data)}),a.on("unselect",function(a){c.unselect(a.data)})},d.prototype.destroy=function(){this.$element.find("*").each(function(){c.removeData(this,"data")})},d.prototype.query=function(a,b){var d=[],e=this,f=this.$element.children();f.each(function(){var b=c(this);if(b.is("option")||b.is("optgroup")){var f=e.item(b),g=e.matches(a,f);null!==g&&d.push(g)}}),b({results:d})},d.prototype.addOptions=function(a){b.appendMany(this.$element,a)},d.prototype.option=function(a){var b;a.children?(b=document.createElement("optgroup"),b.label=a.text):(b=document.createElement("option"),void 0!==b.textContent?b.textContent=a.text:b.innerText=a.text),a.id&&(b.value=a.id),a.disabled&&(b.disabled=!0),a.selected&&(b.selected=!0),a.title&&(b.title=a.title);var d=c(b),e=this._normalizeItem(a);return e.element=b,c.data(b,"data",e),d},d.prototype.item=function(a){var b={};if(b=c.data(a[0],"data"),null!=b)return b;if(a.is("option"))b={id:a.val(),text:a.text(),disabled:a.prop("disabled"),selected:a.prop("selected"),title:a.prop("title")};else if(a.is("optgroup")){b={text:a.prop("label"),children:[],title:a.prop("title")};for(var d=a.children("option"),e=[],f=0;f<d.length;f++){var g=c(d[f]),h=this.item(g);
e.push(h)}b.children=e}return b=this._normalizeItem(b),b.element=a[0],c.data(a[0],"data",b),b},d.prototype._normalizeItem=function(a){c.isPlainObject(a)||(a={id:a,text:a}),a=c.extend({},{text:""},a);var b={selected:!1,disabled:!1};return null!=a.id&&(a.id=a.id.toString()),null!=a.text&&(a.text=a.text.toString()),null==a._resultId&&a.id&&null!=this.container&&(a._resultId=this.generateResultId(this.container,a)),c.extend({},b,a)},d.prototype.matches=function(a,b){var c=this.options.get("matcher");return c(a,b)},d}),b.define("select2/data/array",["./select","../utils","jquery"],function(a,b,c){function d(a,b){var c=b.get("data")||[];d.__super__.constructor.call(this,a,b),this.addOptions(this.convertToOptions(c))}return b.Extend(d,a),d.prototype.select=function(a){var b=this.$element.find("option").filter(function(b,c){return c.value==a.id.toString()});0===b.length&&(b=this.option(a),this.addOptions(b)),d.__super__.select.call(this,a)},d.prototype.convertToOptions=function(a){function d(a){return function(){return c(this).val()==a.id}}for(var e=this,f=this.$element.find("option"),g=f.map(function(){return e.item(c(this)).id}).get(),h=[],i=0;i<a.length;i++){var j=this._normalizeItem(a[i]);if(c.inArray(j.id,g)>=0){var k=f.filter(d(j)),l=this.item(k),m=(c.extend(!0,{},l,j),this.option(l));k.replaceWith(m)}else{var n=this.option(j);if(j.children){var o=this.convertToOptions(j.children);b.appendMany(n,o)}h.push(n)}}return h},d}),b.define("select2/data/ajax",["./array","../utils","jquery"],function(a,b,c){function d(b,c){this.ajaxOptions=this._applyDefaults(c.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),a.__super__.constructor.call(this,b,c)}return b.Extend(d,a),d.prototype._applyDefaults=function(a){var b={data:function(a){return{q:a.term}},transport:function(a,b,d){var e=c.ajax(a);return e.then(b),e.fail(d),e}};return c.extend({},b,a,!0)},d.prototype.processResults=function(a){return a},d.prototype.query=function(a,b){function d(){var d=f.transport(f,function(d){var f=e.processResults(d,a);e.options.get("debug")&&window.console&&console.error&&(f&&f.results&&c.isArray(f.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),b(f)},function(){});e._request=d}var e=this;null!=this._request&&(c.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var f=c.extend({type:"GET"},this.ajaxOptions);"function"==typeof f.url&&(f.url=f.url(a)),"function"==typeof f.data&&(f.data=f.data(a)),this.ajaxOptions.delay&&""!==a.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(d,this.ajaxOptions.delay)):d()},d}),b.define("select2/data/tags",["jquery"],function(a){function b(b,c,d){var e=d.get("tags"),f=d.get("createTag");if(void 0!==f&&(this.createTag=f),b.call(this,c,d),a.isArray(e))for(var g=0;g<e.length;g++){var h=e[g],i=this._normalizeItem(h),j=this.option(i);this.$element.append(j)}}return b.prototype.query=function(a,b,c){function d(a,f){for(var g=a.results,h=0;h<g.length;h++){var i=g[h],j=null!=i.children&&!d({results:i.children},!0),k=i.text===b.term;if(k||j)return f?!1:(a.data=g,void c(a))}if(f)return!0;var l=e.createTag(b);if(null!=l){var m=e.option(l);m.attr("data-select2-tag",!0),e.addOptions([m]),e.insertTag(g,l)}a.results=g,c(a)}var e=this;return this._removeOldTags(),null==b.term||null!=b.page?void a.call(this,b,c):void a.call(this,b,d)},b.prototype.createTag=function(b,c){var d=a.trim(c.term);return""===d?null:{id:d,text:d}},b.prototype.insertTag=function(a,b,c){b.unshift(c)},b.prototype._removeOldTags=function(b){var c=(this._lastTag,this.$element.find("option[data-select2-tag]"));c.each(function(){this.selected||a(this).remove()})},b}),b.define("select2/data/tokenizer",["jquery"],function(a){function b(a,b,c){var d=c.get("tokenizer");void 0!==d&&(this.tokenizer=d),a.call(this,b,c)}return b.prototype.bind=function(a,b,c){a.call(this,b,c),this.$search=b.dropdown.$search||b.selection.$search||c.find(".select2-search__field")},b.prototype.query=function(a,b,c){function d(a){e.select(a)}var e=this;b.term=b.term||"";var f=this.tokenizer(b,this.options,d);f.term!==b.term&&(this.$search.length&&(this.$search.val(f.term),this.$search.focus()),b.term=f.term),a.call(this,b,c)},b.prototype.tokenizer=function(b,c,d,e){for(var f=d.get("tokenSeparators")||[],g=c.term,h=0,i=this.createTag||function(a){return{id:a.term,text:a.term}};h<g.length;){var j=g[h];if(-1!==a.inArray(j,f)){var k=g.substr(0,h),l=a.extend({},c,{term:k}),m=i(l);e(m),g=g.substr(h+1)||"",h=0}else h++}return{term:g}},b}),b.define("select2/data/minimumInputLength",[],function(){function a(a,b,c){this.minimumInputLength=c.get("minimumInputLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){return b.term=b.term||"",b.term.length<this.minimumInputLength?void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:b.term,params:b}}):void a.call(this,b,c)},a}),b.define("select2/data/maximumInputLength",[],function(){function a(a,b,c){this.maximumInputLength=c.get("maximumInputLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){return b.term=b.term||"",this.maximumInputLength>0&&b.term.length>this.maximumInputLength?void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:b.term,params:b}}):void a.call(this,b,c)},a}),b.define("select2/data/maximumSelectionLength",[],function(){function a(a,b,c){this.maximumSelectionLength=c.get("maximumSelectionLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){var d=this;this.current(function(e){var f=null!=e?e.length:0;return d.maximumSelectionLength>0&&f>=d.maximumSelectionLength?void d.trigger("results:message",{message:"maximumSelected",args:{maximum:d.maximumSelectionLength}}):void a.call(d,b,c)})},a}),b.define("select2/dropdown",["jquery","./utils"],function(a,b){function c(a,b){this.$element=a,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<span class="select2-dropdown"><span class="select2-results"></span></span>');return b.attr("dir",this.options.get("dir")),this.$dropdown=b,b},c.prototype.position=function(a,b){},c.prototype.destroy=function(){this.$dropdown.remove()},c}),b.define("select2/dropdown/search",["jquery","../utils"],function(a,b){function c(){}return c.prototype.render=function(b){var c=b.call(this),d=a('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=d,this.$search=d.find("input"),c.prepend(d),c},c.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),this.$search.on("keydown",function(a){e.trigger("keypress",a),e._keyUpPrevented=a.isDefaultPrevented()}),this.$search.on("input",function(b){a(this).off("keyup")}),this.$search.on("keyup input",function(a){e.handleSearch(a)}),c.on("open",function(){e.$search.attr("tabindex",0),e.$search.focus(),window.setTimeout(function(){e.$search.focus()},0)}),c.on("close",function(){e.$search.attr("tabindex",-1),e.$search.val("")}),c.on("results:all",function(a){if(null==a.query.term||""===a.query.term){var b=e.showSearch(a);b?e.$searchContainer.removeClass("select2-search--hide"):e.$searchContainer.addClass("select2-search--hide")}})},c.prototype.handleSearch=function(a){if(!this._keyUpPrevented){var b=this.$search.val();this.trigger("query",{term:b})}this._keyUpPrevented=!1},c.prototype.showSearch=function(a,b){return!0},c}),b.define("select2/dropdown/hidePlaceholder",[],function(){function a(a,b,c,d){this.placeholder=this.normalizePlaceholder(c.get("placeholder")),a.call(this,b,c,d)}return a.prototype.append=function(a,b){b.results=this.removePlaceholder(b.results),a.call(this,b)},a.prototype.normalizePlaceholder=function(a,b){return"string"==typeof b&&(b={id:"",text:b}),b},a.prototype.removePlaceholder=function(a,b){for(var c=b.slice(0),d=b.length-1;d>=0;d--){var e=b[d];this.placeholder.id===e.id&&c.splice(d,1)}return c},a}),b.define("select2/dropdown/infiniteScroll",["jquery"],function(a){function b(a,b,c,d){this.lastParams={},a.call(this,b,c,d),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return b.prototype.append=function(a,b){this.$loadingMore.remove(),this.loading=!1,a.call(this,b),this.showLoadingMore(b)&&this.$results.append(this.$loadingMore)},b.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),c.on("query",function(a){e.lastParams=a,e.loading=!0}),c.on("query:append",function(a){e.lastParams=a,e.loading=!0}),this.$results.on("scroll",function(){var b=a.contains(document.documentElement,e.$loadingMore[0]);if(!e.loading&&b){var c=e.$results.offset().top+e.$results.outerHeight(!1),d=e.$loadingMore.offset().top+e.$loadingMore.outerHeight(!1);c+50>=d&&e.loadMore()}})},b.prototype.loadMore=function(){this.loading=!0;var b=a.extend({},{page:1},this.lastParams);b.page++,this.trigger("query:append",b)},b.prototype.showLoadingMore=function(a,b){return b.pagination&&b.pagination.more},b.prototype.createLoadingMore=function(){var b=a('<li class="option load-more" role="treeitem"></li>'),c=this.options.get("translations").get("loadingMore");return b.html(c(this.lastParams)),b},b}),b.define("select2/dropdown/attachBody",["jquery","../utils"],function(a,b){function c(a,b,c){this.$dropdownParent=c.get("dropdownParent")||document.body,a.call(this,b,c)}return c.prototype.bind=function(a,b,c){var d=this,e=!1;a.call(this,b,c),b.on("open",function(){d._showDropdown(),d._attachPositioningHandler(b),e||(e=!0,b.on("results:all",function(){d._positionDropdown(),d._resizeDropdown()}),b.on("results:append",function(){d._positionDropdown(),d._resizeDropdown()}))}),b.on("close",function(){d._hideDropdown(),d._detachPositioningHandler(b)}),this.$dropdownContainer.on("mousedown",function(a){a.stopPropagation()})},c.prototype.position=function(a,b,c){b.attr("class",c.attr("class")),b.removeClass("select2"),b.addClass("select2-container--open"),b.css({position:"absolute",top:-999999}),this.$container=c},c.prototype.render=function(b){var c=a("<span></span>"),d=b.call(this);return c.append(d),this.$dropdownContainer=c,c},c.prototype._hideDropdown=function(a){this.$dropdownContainer.detach()},c.prototype._attachPositioningHandler=function(c){var d=this,e="scroll.select2."+c.id,f="resize.select2."+c.id,g="orientationchange.select2."+c.id,h=this.$container.parents().filter(b.hasScroll);h.each(function(){a(this).data("select2-scroll-position",{x:a(this).scrollLeft(),y:a(this).scrollTop()})}),h.on(e,function(b){var c=a(this).data("select2-scroll-position");a(this).scrollTop(c.y)}),a(window).on(e+" "+f+" "+g,function(a){d._positionDropdown(),d._resizeDropdown()})},c.prototype._detachPositioningHandler=function(c){var d="scroll.select2."+c.id,e="resize.select2."+c.id,f="orientationchange.select2."+c.id,g=this.$container.parents().filter(b.hasScroll);g.off(d),a(window).off(d+" "+e+" "+f)},c.prototype._positionDropdown=function(){var b=a(window),c=this.$dropdown.hasClass("select2-dropdown--above"),d=this.$dropdown.hasClass("select2-dropdown--below"),e=null,f=(this.$container.position(),this.$container.offset());f.bottom=f.top+this.$container.outerHeight(!1);var g={height:this.$container.outerHeight(!1)};g.top=f.top,g.bottom=f.top+g.height;var h={height:this.$dropdown.outerHeight(!1)},i={top:b.scrollTop(),bottom:b.scrollTop()+b.height()},j=i.top<f.top-h.height,k=i.bottom>f.bottom+h.height,l={left:f.left,top:g.bottom};c||d||(e="below"),k||!j||c?!j&&k&&c&&(e="below"):e="above",("above"==e||c&&"below"!==e)&&(l.top=g.top-h.height),null!=e&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+e),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+e)),this.$dropdownContainer.css(l)},c.prototype._resizeDropdown=function(){this.$dropdownContainer.width();var a={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(a.minWidth=a.width,a.width="auto"),this.$dropdown.css(a)},c.prototype._showDropdown=function(a){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},c}),b.define("select2/dropdown/minimumResultsForSearch",[],function(){function a(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];e.children?c+=a(e.children):c++}return c}function b(a,b,c,d){this.minimumResultsForSearch=c.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),a.call(this,b,c,d)}return b.prototype.showSearch=function(b,c){return a(c.data.results)<this.minimumResultsForSearch?!1:b.call(this,c)},b}),b.define("select2/dropdown/selectOnClose",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on("close",function(){d._handleSelectOnClose()})},a.prototype._handleSelectOnClose=function(){var a=this.getHighlightedResults();a.length<1||this.trigger("select",{data:a.data("data")})},a}),b.define("select2/dropdown/closeOnSelect",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on("select",function(a){d._selectTriggered(a)}),b.on("unselect",function(a){d._selectTriggered(a)})},a.prototype._selectTriggered=function(a,b){var c=b.originalEvent;c&&c.ctrlKey||this.trigger("close")},a}),b.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(a){var b=a.input.length-a.maximum,c="Please delete "+b+" character";return 1!=b&&(c+="s"),c},inputTooShort:function(a){var b=a.minimum-a.input.length,c="Please enter "+b+" or more characters";return c},loadingMore:function(){return"Loading more results…"},maximumSelected:function(a){var b="You can only select "+a.maximum+" item";return 1!=a.maximum&&(b+="s"),b},noResults:function(){return"No results found"},searching:function(){return"Searching…"}}}),b.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){function D(){this.reset()}D.prototype.apply=function(l){if(l=a.extend({},this.defaults,l),null==l.dataAdapter){if(null!=l.ajax?l.dataAdapter=o:null!=l.data?l.dataAdapter=n:l.dataAdapter=m,l.minimumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,r)),l.maximumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,s)),l.maximumSelectionLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,t)),l.tags&&(l.dataAdapter=j.Decorate(l.dataAdapter,p)),null==l.tokenSeparators&&null==l.tokenizer||(l.dataAdapter=j.Decorate(l.dataAdapter,q)),null!=l.query){var C=b(l.amdBase+"compat/query");l.dataAdapter=j.Decorate(l.dataAdapter,C)}if(null!=l.initSelection){var D=b(l.amdBase+"compat/initSelection");l.dataAdapter=j.Decorate(l.dataAdapter,D)}}if(null==l.resultsAdapter&&(l.resultsAdapter=c,null!=l.ajax&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,x)),null!=l.placeholder&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,w)),l.selectOnClose&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,A))),null==l.dropdownAdapter){if(l.multiple)l.dropdownAdapter=u;else{var E=j.Decorate(u,v);l.dropdownAdapter=E}if(0!==l.minimumResultsForSearch&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,z)),l.closeOnSelect&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,B)),null!=l.dropdownCssClass||null!=l.dropdownCss||null!=l.adaptDropdownCssClass){var F=b(l.amdBase+"compat/dropdownCss");l.dropdownAdapter=j.Decorate(l.dropdownAdapter,F)}l.dropdownAdapter=j.Decorate(l.dropdownAdapter,y)}if(null==l.selectionAdapter){if(l.multiple?l.selectionAdapter=e:l.selectionAdapter=d,null!=l.placeholder&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,f)),l.allowClear&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,g)),l.multiple&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,h)),null!=l.containerCssClass||null!=l.containerCss||null!=l.adaptContainerCssClass){var G=b(l.amdBase+"compat/containerCss");l.selectionAdapter=j.Decorate(l.selectionAdapter,G)}l.selectionAdapter=j.Decorate(l.selectionAdapter,i)}if("string"==typeof l.language)if(l.language.indexOf("-")>0){var H=l.language.split("-"),I=H[0];l.language=[l.language,I]}else l.language=[l.language];if(a.isArray(l.language)){var J=new k;l.language.push("en");for(var K=l.language,L=0;L<K.length;L++){var M=K[L],N={};try{N=k.loadPath(M)}catch(a){try{M=this.defaults.amdLanguageBase+M,N=k.loadPath(M)}catch(a){l.debug&&window.console&&console.warn&&console.warn('Select2: The language file for "'+M+'" could not be automatically loaded. A fallback will be used instead.');continue}}J.extend(N)}l.translations=J}else{var O=k.loadPath(this.defaults.amdLanguageBase+"en"),P=new k(l.language);P.extend(O),l.translations=P}return l},D.prototype.reset=function(){function b(a){function b(a){return l[a]||a}return a.replace(/[^\u0000-\u007E]/g,b)}function c(d,e){if(""===a.trim(d.term))return e;if(e.children&&e.children.length>0){for(var f=a.extend(!0,{},e),g=e.children.length-1;g>=0;g--){var h=e.children[g],i=c(d,h);null==i&&f.children.splice(g,1)}return f.children.length>0?f:c(d,f)}var j=b(e.text).toUpperCase(),k=b(d.term).toUpperCase();return j.indexOf(k)>-1?e:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:j.escapeMarkup,language:C,matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(a){return a},templateResult:function(a){return a.text},templateSelection:function(a){return a.text},theme:"default",width:"resolve"}},D.prototype.set=function(b,c){var d=a.camelCase(b),e={};e[d]=c;var f=j._convertData(e);a.extend(this.defaults,f)};var E=new D;return E}),b.define("select2/options",["require","jquery","./defaults","./utils"],function(a,b,c,d){function e(b,e){if(this.options=b,null!=e&&this.fromElement(e),this.options=c.apply(this.options),e&&e.is("input")){var f=a(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=d.Decorate(this.options.dataAdapter,f)}}return e.prototype.fromElement=function(a){var c=["select2"];null==this.options.multiple&&(this.options.multiple=a.prop("multiple")),null==this.options.disabled&&(this.options.disabled=a.prop("disabled")),null==this.options.language&&(a.prop("lang")?this.options.language=a.prop("lang").toLowerCase():a.closest("[lang]").prop("lang")&&(this.options.language=a.closest("[lang]").prop("lang"))),null==this.options.dir&&(a.prop("dir")?this.options.dir=a.prop("dir"):a.closest("[dir]").prop("dir")?this.options.dir=a.closest("[dir]").prop("dir"):this.options.dir="ltr"),a.prop("disabled",this.options.disabled),a.prop("multiple",this.options.multiple),a.data("select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),a.data("data",a.data("select2Tags")),a.data("tags",!0)),a.data("ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),a.attr("ajax--url",a.data("ajaxUrl")),a.data("ajax--url",a.data("ajaxUrl")));var e={};e=b.fn.jquery&&"1."==b.fn.jquery.substr(0,2)&&a[0].dataset?b.extend(!0,{},a[0].dataset,a.data()):a.data();var f=b.extend(!0,{},e);f=d._convertData(f);for(var g in f)b.inArray(g,c)>-1||(b.isPlainObject(this.options[g])?b.extend(this.options[g],f[g]):this.options[g]=f[g]);return this},e.prototype.get=function(a){return this.options[a]},e.prototype.set=function(a,b){this.options[a]=b},e}),b.define("select2/core",["jquery","./options","./utils","./keys"],function(a,b,c,d){var e=function(a,c){null!=a.data("select2")&&a.data("select2").destroy(),this.$element=a,this.id=this._generateId(a),c=c||{},this.options=new b(c,a),e.__super__.constructor.call(this);var d=a.attr("tabindex")||0;a.data("old-tabindex",d),a.attr("tabindex","-1");var f=this.options.get("dataAdapter");this.dataAdapter=new f(a,this.options);var g=this.render();this._placeContainer(g);var h=this.options.get("selectionAdapter");this.selection=new h(a,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,g);var i=this.options.get("dropdownAdapter");this.dropdown=new i(a,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,g);var j=this.options.get("resultsAdapter");this.results=new j(a,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var k=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(a){k.trigger("selection:update",{data:a})}),a.addClass("select2-hidden-accessible"),a.attr("aria-hidden","true"),this._syncAttributes(),a.data("select2",this)};return c.Extend(e,c.Observable),e.prototype._generateId=function(a){var b="";return b=null!=a.attr("id")?a.attr("id"):null!=a.attr("name")?a.attr("name")+"-"+c.generateChars(2):c.generateChars(4),b="select2-"+b},e.prototype._placeContainer=function(a){a.insertAfter(this.$element);var b=this._resolveWidth(this.$element,this.options.get("width"));null!=b&&a.css("width",b)},e.prototype._resolveWidth=function(a,b){var c=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==b){var d=this._resolveWidth(a,"style");return null!=d?d:this._resolveWidth(a,"element")}if("element"==b){var e=a.outerWidth(!1);return 0>=e?"auto":e+"px"}if("style"==b){var f=a.attr("style");if("string"!=typeof f)return null;for(var g=f.split(";"),h=0,i=g.length;i>h;h+=1){var j=g[h].replace(/\s/g,""),k=j.match(c);if(null!==k&&k.length>=1)return k[1]}return null}return b},e.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},e.prototype._registerDomEvents=function(){var b=this;this.$element.on("change.select2",function(){b.dataAdapter.current(function(a){b.trigger("selection:update",{data:a})})}),this._sync=c.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=d?(this._observer=new d(function(c){a.each(c,b._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",b._sync,!1)},e.prototype._registerDataEvents=function(){var a=this;this.dataAdapter.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerSelectionEvents=function(){var b=this,c=["toggle"];this.selection.on("toggle",function(){b.toggleDropdown()}),this.selection.on("*",function(d,e){-1===a.inArray(d,c)&&b.trigger(d,e)})},e.prototype._registerDropdownEvents=function(){var a=this;this.dropdown.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerResultsEvents=function(){var a=this;this.results.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerEvents=function(){var a=this;this.on("open",function(){a.$container.addClass("select2-container--open")}),this.on("close",function(){a.$container.removeClass("select2-container--open")}),this.on("enable",function(){a.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){a.$container.addClass("select2-container--disabled")}),this.on("focus",function(){a.$container.addClass("select2-container--focus")}),this.on("blur",function(){a.$container.removeClass("select2-container--focus")}),this.on("query",function(b){a.isOpen()||a.trigger("open"),this.dataAdapter.query(b,function(c){a.trigger("results:all",{data:c,query:b})})}),this.on("query:append",function(b){this.dataAdapter.query(b,function(c){a.trigger("results:append",{data:c,query:b})})}),this.on("keypress",function(b){var c=b.which;a.isOpen()?c===d.ENTER?(a.trigger("results:select"),b.preventDefault()):c===d.SPACE&&b.ctrlKey?(a.trigger("results:toggle"),b.preventDefault()):c===d.UP?(a.trigger("results:previous"),b.preventDefault()):c===d.DOWN?(a.trigger("results:next"),b.preventDefault()):c!==d.ESC&&c!==d.TAB||(a.close(),b.preventDefault()):(c===d.ENTER||c===d.SPACE||(c===d.DOWN||c===d.UP)&&b.altKey)&&(a.open(),b.preventDefault())})},e.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable")):this.trigger("enable")},e.prototype.trigger=function(a,b){var c=e.__super__.trigger,d={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(a in d){var f=d[a],g={prevented:!1,name:a,args:b};if(c.call(this,f,g),g.prevented)return void(b.prevented=!0)}c.call(this,a,b)},e.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},e.prototype.open=function(){this.isOpen()||(this.trigger("query",{}),this.trigger("open"))},e.prototype.close=function(){this.isOpen()&&this.trigger("close")},e.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},e.prototype.enable=function(a){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=a&&0!==a.length||(a=[!0]);var b=!a[0];this.$element.prop("disabled",b)},e.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var a=[];return this.dataAdapter.current(function(b){a=b}),a},e.prototype.val=function(b){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==b||0===b.length)return this.$element.val();var c=b[0];a.isArray(c)&&(c=a.map(c,function(a){return a.toString()})),this.$element.val(c).trigger("change")},e.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},e.prototype.render=function(){var b=a('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return b.attr("dir",this.options.get("dir")),this.$container=b,this.$container.addClass("select2-container--"+this.options.get("theme")),b.data("element",this.$element),b},e}),b.define("select2/compat/utils",["jquery"],function(a){function b(b,c,d){var e,f,g=[];e=a.trim(b.attr("class")),e&&(e=""+e,a(e.split(/\s+/)).each(function(){0===this.indexOf("select2-")&&g.push(this)})),e=a.trim(c.attr("class")),e&&(e=""+e,a(e.split(/\s+/)).each(function(){0!==this.indexOf("select2-")&&(f=d(this),null!=f&&g.push(f))})),b.attr("class",g.join(" "))}return{syncCssClasses:b}}),b.define("select2/compat/containerCss",["jquery","./utils"],function(a,b){function c(a){return null}function d(){}return d.prototype.render=function(d){var e=d.call(this),f=this.options.get("containerCssClass")||"";a.isFunction(f)&&(f=f(this.$element));var g=this.options.get("adaptContainerCssClass");if(g=g||c,-1!==f.indexOf(":all:")){f=f.replace(":all","");var h=g;g=function(a){var b=h(a);return null!=b?b+" "+a:a}}var i=this.options.get("containerCss")||{};return a.isFunction(i)&&(i=i(this.$element)),b.syncCssClasses(e,this.$element,g),e.css(i),e.addClass(f),e},d}),b.define("select2/compat/dropdownCss",["jquery","./utils"],function(a,b){function c(a){return null}function d(){}return d.prototype.render=function(d){var e=d.call(this),f=this.options.get("dropdownCssClass")||"";a.isFunction(f)&&(f=f(this.$element));var g=this.options.get("adaptDropdownCssClass");if(g=g||c,-1!==f.indexOf(":all:")){f=f.replace(":all","");var h=g;g=function(a){var b=h(a);return null!=b?b+" "+a:a}}var i=this.options.get("dropdownCss")||{};return a.isFunction(i)&&(i=i(this.$element)),b.syncCssClasses(e,this.$element,g),e.css(i),e.addClass(f),e},d}),b.define("select2/compat/initSelection",["jquery"],function(a){function b(a,b,c){c.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `initSelection` option has been deprecated in favor of a custom data adapter that overrides the `current` method. This method is now called multiple times instead of a single time when the instance is initialized. Support will be removed for the `initSelection` option in future versions of Select2"),this.initSelection=c.get("initSelection"),this._isInitialized=!1,a.call(this,b,c)}return b.prototype.current=function(b,c){var d=this;return this._isInitialized?void b.call(this,c):void this.initSelection.call(null,this.$element,function(b){d._isInitialized=!0,a.isArray(b)||(b=[b]),c(b)})},b}),b.define("select2/compat/inputData",["jquery"],function(a){function b(a,b,c){this._currentData=[],this._valueSeparator=c.get("valueSeparator")||",","hidden"===b.prop("type")&&c.get("debug")&&console&&console.warn&&console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead."),a.call(this,b,c)}return b.prototype.current=function(b,c){function d(b,c){var e=[];return b.selected||-1!==a.inArray(b.id,c)?(b.selected=!0,e.push(b)):b.selected=!1,b.children&&e.push.apply(e,d(b.children,c)),e}for(var e=[],f=0;f<this._currentData.length;f++){var g=this._currentData[f];e.push.apply(e,d(g,this.$element.val().split(this._valueSeparator)))}c(e)},b.prototype.select=function(b,c){if(this.options.get("multiple")){var d=this.$element.val();d+=this._valueSeparator+c.id,this.$element.val(d),this.$element.trigger("change")}else this.current(function(b){a.map(b,function(a){a.selected=!1})}),this.$element.val(c.id),this.$element.trigger("change")},b.prototype.unselect=function(a,b){var c=this;b.selected=!1,this.current(function(a){for(var d=[],e=0;e<a.length;e++){var f=a[e];b.id!=f.id&&d.push(f.id)}c.$element.val(d.join(c._valueSeparator)),c.$element.trigger("change")})},b.prototype.query=function(a,b,c){for(var d=[],e=0;e<this._currentData.length;e++){var f=this._currentData[e],g=this.matches(b,f);null!==g&&d.push(g);
}c({results:d})},b.prototype.addOptions=function(b,c){var d=a.map(c,function(b){return a.data(b[0],"data")});this._currentData.push.apply(this._currentData,d)},b}),b.define("select2/compat/matcher",["jquery"],function(a){function b(b){function c(c,d){var e=a.extend(!0,{},d);if(null==c.term||""===a.trim(c.term))return e;if(d.children){for(var f=d.children.length-1;f>=0;f--){var g=d.children[f],h=b(c.term,g.text,g);h||e.children.splice(f,1)}if(e.children.length>0)return e}return b(c.term,d.text,d)?e:null}return c}return b}),b.define("select2/compat/query",[],function(){function a(a,b,c){c.get("debug")&&window.console&&console.warn&&console.warn("Select2: The `query` option has been deprecated in favor of a custom data adapter that overrides the `query` method. Support will be removed for the `query` option in future versions of Select2."),a.call(this,b,c)}return a.prototype.query=function(a,b,c){b.callback=c;var d=this.options.get("query");d.call(null,b)},a}),b.define("select2/dropdown/attachContainer",[],function(){function a(a,b,c){a.call(this,b,c)}return a.prototype.position=function(a,b,c){var d=c.find(".dropdown-wrapper");d.append(b),b.addClass("select2-dropdown--below"),c.addClass("select2-container--below")},a}),b.define("select2/dropdown/stopPropagation",[],function(){function a(){}return a.prototype.bind=function(a,b,c){a.call(this,b,c);var d=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$dropdown.on(d.join(" "),function(a){a.stopPropagation()})},a}),b.define("select2/selection/stopPropagation",[],function(){function a(){}return a.prototype.bind=function(a,b,c){a.call(this,b,c);var d=["blur","change","click","dblclick","focus","focusin","focusout","input","keydown","keyup","keypress","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseup","search","touchend","touchstart"];this.$selection.on(d.join(" "),function(a){a.stopPropagation()})},a}),b.define("jquery.select2",["jquery","require","./select2/core","./select2/defaults"],function(a,b,c,d){if(b("jquery.mousewheel"),null==a.fn.select2){var e=["open","close","destroy"];a.fn.select2=function(b){if(b=b||{},"object"==typeof b)return this.each(function(){var d=a.extend({},b,!0);new c(a(this),d)}),this;if("string"==typeof b){var d=this.data("select2");null==d&&window.console&&console.error&&console.error("The select2('"+b+"') method was called on an element that is not using Select2.");var f=Array.prototype.slice.call(arguments,1),g=d[b](f);return a.inArray(b,e)>-1?this:g}throw new Error("Invalid arguments for Select2: "+b)}}return null==a.fn.select2.defaults&&(a.fn.select2.defaults=d),c}),function(c){"function"==typeof b.define&&b.define.amd?b.define("jquery.mousewheel",["jquery"],c):"object"==typeof exports?module.exports=c:c(a)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),{define:b.define,require:b.require}}(),c=b.require("jquery.select2");return a.fn.select2.amd=b,c}),define("src/util/searchBox",["src/util/util","src/util/api","modules/modulefactory","src/main/grid","select2"],function(a,b,c,d){return function(){a.loadCss("components/select2/dist/css/select2.css").then(function(){function a(a){return a.moduleName||a.text}for(var e=c.getModulesById(),f=Object.keys(e),g=new Array(f.length),h=b.getLayerNames(),i=b.getActiveLayerName(),j=[],k=0;k<f.length;k++)g[k]=e[f[k]],g[k].text=f[k]+" "+g[k].moduleName,g[k].cat="module";for(k=0;k<h.length;k++){var l={};l.text=h[k],l.cat="layer",l.id="layer-"+h[k],h[k]===i&&(l.disabled=!0),j.push(l)}var m='<div><div style="height:50px"></div> <select>',n=500,o=Math.max(document.documentElement.clientWidth,window.innerWidth||0),p=Math.max(document.documentElement.clientHeight,window.innerHeight||0);m+="</select></div>",m=$(m),m=m.css({position:"fixed","justify-content":"center",top:0,left:0,width:o,height:p,paddingLeft:Math.floor(o/2-n/2),paddingTop:50,margin:0,"box-sizing":"border-box",opacity:.7,backgroundColor:"#262b33"}).appendTo("body").find("select").addClass("js-example-basic-single").css({width:n,zIndex:5e3});var q=[];j.length&&q.push({id:"layer-list",text:"Layers",children:j}),g.length&&q.push({id:"module-list",text:"Modules",children:g}),m.select2({placeholder:"Select a module",data:q,templateResult:a}).select2("open").val(null).trigger("change");var r;m.on("select2:selecting",function(a){r=!0}),m.on("select2:select",function(a){var c=a.params.data.url;m.select2("destroy"),m.parent().remove(),"module"===a.params.data.cat?setImmediate(function(){d.newModule(c)}):"layer"===a.params.data.cat&&b.switchToLayer(a.params.data.text)}),m.on("select2:close",function(a){r||(m.select2("destroy"),m.parent().remove())})})}}),define("modules/default/defaultcontroller",["src/util/api","src/util/util","src/main/grid"],function(a,b,c){return{setModule:function(a){this.module=a},init:function(){this.initImpl()},initImpl:function(){this.resolveReady()},getToolbar:function(){var b=this.module.definition.toolbar;if(b)var c=this.module.definition.toolbar.common[0].toolbar[0],d=this.module.definition.toolbar.custom[0];c||(c=["Open Preferences"]);var e=[{onClick:function(){this.exportData()},title:"Export Data",cssClass:"fa fa-sign-out",ifLocked:!0},{onClick:function(){this.printView()},title:"Print",cssClass:"fa fa-print",ifLocked:!0},{onClick:function(){this.enableFullscreen()},title:"Show fullscreen",cssClass:"fa fa-expand",ifLocked:!0},{onClick:function(){this.doConfig(2)},title:"Open Preferences",cssClass:"fa fa-wrench",ifLocked:!1}];if(c&&(e=e.filter(function(a){return c.some(function(b){return b===a.title})})),d)for(var f=function(b){var c={ifLocked:!0,title:d[b].title,cssClass:"fa "+d[b].icon,onClick:function(){a.doAction(d[b].action)}};"begin"===d[b].position?e.unshift(c):e.push(c)},g=0;g<d.length;g++)f(g);return e},inDom:b.noop,setVarFromEvent:function(b,c,d,e,f){var g,h=0,i=!0;if(g=this.module.vars_out())for(;h<g.length;h++)g[h].event!=b||g[h].rel!=c&&c||!g[h].name||(i&&f&&(i=!1,f.call(this)),g[h].jpath=g[h].jpath||[],"string"==typeof g[h].jpath&&(g[h].jpath=g[h].jpath.split("."),g[h].jpath.shift()),a.setVar(g[h].name,this.module.getVariableFromRel(d),e.concat(g[h].jpath),g[h].filter))},createDataFromEvent:function(b,c,d,e){var f,g=0,h=!0;if(f=this.module.vars_out())for(;g<f.length;g++)f[g].event!=b||f[g].rel!=c&&c||!f[g].name||(h&&e&&(h=!1,d=e.call(this)),a.createDataJpath(f[g].name,d,f[g].jpath,f[g].filter))},sendActionFromEvent:function(b,c,d){var e,f,g,h=this.module.actions_out();if(h)for(e=h.length-1;e>=0;e--)h[e].name&&h[e].rel===c&&(b&&b===h[e].event||!b)&&(g=h[e].name,f=h[e].jpath,d&&f?(d.getChild||(d=DataObject.check(d,!0)),function(b){d.getChild(f).then(function(c){a.doAction(b,c)})}(g)):a.doAction(g,d))},sendAction:b.deprecate(function(a,b,c){return this.sendActionFromEvent(c,a,b)},"Use sendActionFromEvent instead."),allVariablesFor:function(a,b,c){var d,e=0;if(d=this.module.vars_out())for(;e<d.length;e++)d[e].event!=a||d[e].rel!=b&&b||c(d[e])},export:b.noop,print:function(){return this.module.getDomContent()[0].innerHTML},configurationStructure:b.noop,configFunctions:{},configAliases:{},events:{},variablesIn:[],actionsIn:{_editPreferences:"Edit preferences"},resolveReady:function(){this.module._resolveController()},onBeforeRemove:function(){return!0},onRemove:b.noop}}),define("modules/default/defaultmodel",["src/main/entrypoint","src/util/datatraversing","src/util/api","src/util/debug","src/util/util"],function(a,b,c,d,e){var f={setModule:function(a){this.module=a},init:function(){this.module.model=this,this.data={},this.triggerChangeCallbacksByRels={},this.mapVars(),this.resetListeners(),this.initImpl()},initImpl:function(){this.resolveReady()},inDom:e.noop,resetListeners:function(){this.sourceMap=null,this.mapVars(),c.getRepositoryActions().unListen(this.getActionNameList(),this._actionlisten);for(var a=this.getVarNameList(),b=0,d=a.length;d>b;b++)c.getVar(a[b]).listen(this.module,this.onVarChange.bind(this));this._actionlisten=c.getRepositoryActions().listen(this.getActionNameList(),this.onActionTrigger.bind(this))},mapVars:function(){var a=this.module.vars_in(),b=[],c=[],d={};if(Array.isArray(a))for(var e=a.length,f=e-1;f>=0;f--)b.push(a[f].name),c.push(a[f].rel),d[a[f].name]=a[f];this.sourceMap=d,this.listNames=b,this.listRels=c},getVarNameList:function(){return this.listNames},getActionNameList:function(){var a,b,c=this.module.actions_in(),d=[];if(!c)return d;for(b=c.length,a=b-1;a>=0;a--)d.push(c[a].name);return d},onVarChange:function(a){var b,c,e,f,g,h=this,i=a.getName();Promise.all([this.module.onReady(),a.onReady()]).then(function(){h.module.blankVariable(i);var j=a.getValue();if(i&&h.sourceMap&&h.sourceMap[i]&&h.module.controller.references[h.sourceMap[i].rel]){var k=h.buildData(j,h.module.controller.references[h.sourceMap[i].rel].type);if(k){g=h.module.getDataRelFromName(i),b=0,c=g.length,e=0;var l=h.module.vars_in();for(f=l.length;f>e;e++)l[e].name==i&&h.module.view.update[l[e].rel]&&null!==j&&!function(a){new Promise(function(b,c){l[a].filter?require([l[a].filter],function(a){return a.filter?a.filter(j,b,c):void c("No filter function defined")}):b(j)}).then(function(b){h.setData(l[a].rel,i,b),h.removeAllChangeListeners(l[a].rel),h.module.view.update[l[a].rel].call(h.module.view,b,i)},function(a){d.error("Error while filtering the data : ",a.message,a.stack)}).catch(function(a){d.error("Error while updating module : ",a.message,a.stack)})}(e)}}},function(){}).catch(function(a){d.error("Error while updating variable : ",a.message,a.stack)})},onActionTrigger:function(a,b){var c=this;this.module.onReady().then(function(){var d=c.module.getActionRelFromName(b[0]);c.module.view.onActionReceive&&c.module.view.onActionReceive[d]&&c.module.view.onActionReceive[d].call(c.module.view,a,b[0])})},buildData:function(a,b){if(!a)return!1;var c={};if(!b)return a;Array.isArray(b)||(b=[b]);var d=a.getType(),e=!1;if(0==b.length)return a;for(var f=0;f<b.length;f++)if(b[f]==d)return a;return e?c:!1},getValue:function(){return this.data},setData:function(a,b,c){this.data[a]||(this.data[a]={}),this.data[a][b]=c},getData:function(a,b){return this.data[a]?this.data[a][b]:void 0},getAllDataFromRel:function(a){return this.data[a]},getjPath:function(a,b){return this._getjPath(a,b)},_getjPath:function(a,c){var d=this.module.getDataFromRel(a);return d&&void 0!==c&&(d=d.getChildSync(c)),b.getJPathsFromElement(d)},resolveReady:function(){this.module._resolveModel()},dataListenChange:function(a,b,c){if(a){var e=this,f=function(c,d){d!=e.module.getId()&&b.call(a,c)};this.addChangeListener(c,a,f)?a.onChange(f):(d.setDebugLevel(1),d.error("Adding the change callback is forbidden as no rel has been defined ! Aborting callback binding to prevent leaks"))}},highlightId:function(a,b){c.highlightId(a,b,this.module.getId())},dataTriggerChange:function(a){a.triggerChange(!1,[this.module.getId()])},dataSetChild:function(a,b,c){return a.setChild(b,c,this.module.getId())},dataSetChildSync:function(a,b,c){return a.setChildSync(b,c,this.module.getId())},addChangeListener:function(a,b,c){return a?-1===this.listRels.indexOf(a)?!1:(this.triggerChangeCallbacksByRels[a]=this.triggerChangeCallbacksByRels[a]||[],this.triggerChangeCallbacksByRels[a].push({data:b,callback:c}),!0):!1},removeAllChangeListeners:function(a){if(this.triggerChangeCallbacksByRels[a])for(var b=0,c=this.triggerChangeCallbacksByRels[a].length;c>b;b++)this.removeChangeListener(this.triggerChangeCallbacksByRels[a][b].data,this.triggerChangeCallbacksByRels[a][b].callback)},removeChangeListener:function(a,b){a.unbindChange(b)}};return f.setHighlightId=f.highlightId,f}),define("modules/default/defaultview",["src/util/util"],function(a){return{initDefault:function(){this.onReady=!0},init:function(){this.resolveReady()},setModule:function(a){this.module=a},update:{},blank:{},onResize:a.noop,onActionReceive:{_editPreferences:function(a){function b(a){for(var b=d,c=0,e=a.length-1;e>c&&(b=b[a[c]],"undefined"!=typeof b);c++);return b}var c,d=this.module.definition.configuration,e=this.module.controller.configAliases;for(var f in a)if(a.hasOwnProperty(f)){var g=e[f];g&&(c=b(e[f]),c[0]=a[f])}this.module.reload()}},inDom:a.noop,resolveReady:function(){this.module._resolveView()},startLoading:function(a){this.loadingElements=this.loadingElements||[],this.relsForLoading().indexOf(a)>-1&&-1==this.loadingElements.indexOf(a)&&(this.loadingElements.push(a),this.showLoading())},endLoading:function(a){this.loadingElements=this.loadingElements||[],this.relsForLoading().indexOf(a)>-1&&this.loadingElements.indexOf(a)>-1&&(this.loadingElements.splice(this.loadingElements.indexOf(a),1),0==this.loadingElements.length&&this.hideLoading())},showLoading:function(){this.module.domLoading.addClass("ci-module-loading-visible")},hideLoading:function(){this.module.domLoading.removeClass("ci-module-loading-visible")},relsForLoading:function(){return this._relsForLoading||(this._relsForLoading=[])},refresh:function(){var a=this.module.getDomContent();a.hide(),setImmediate(function(){a.show()})}}}),define("src/main/forceLoad",["src/header/components/blankview","src/header/components/copydata","src/header/components/copyview","src/header/components/couchshare","src/header/components/default","src/header/components/feedback","src/header/components/pastedata","src/header/components/pasteview","src/util/sandbox","src/util/searchBox","modules/default/defaultcontroller","modules/default/defaultmodel","modules/default/defaultview"],function(){return{}}),define("src/main/entrypoint",["jquery","lodash","src/header/header","src/util/repository","src/main/grid","src/util/api","src/util/context","src/util/datatraversing","src/util/versioning","modules/modulefactory","src/util/viewmigration","src/util/actionmanager","src/util/pouchtovar","src/util/debug","src/util/browser","src/util/util","src/util/urldata","src/util/ui","src/util/config","src/util/shortcuts","src/util/copyPasteManager","./forceLoad"],function($,_,Header,Repository,Grid,API,Context,Traversing,Versioning,ModuleFactory,Migration,ActionManager,PouchDBUtil,Debug,browser,Util,UrlData,ui,Config){function doView(a){DataObject.recursiveTransform(a,!1),a=Migration(a),a.grid=a.grid||new DataObject,this.viewLoaded?(reloadingView(),Grid.reset(a.grid)):(Grid.init(a.grid,document.getElementById("modules-grid")),this.viewLoaded=!0),ModuleFactory.empty(),a.modules=a.modules||new DataArray;var b=a.modules.length;a.variables=a.variables||new DataArray,a.aliases=a.aliases||new DataArray,a.pouchvariables=a.pouchvariables||new DataArray,a.configuration=a.configuration||new DataObject,a.configuration.title=a.configuration.title||"No title";for(var c=0;b>c;c++)Grid.addModuleFromJSON(a.getChildSync(["modules",c],!0));Grid.checkDimensions(),a.modules=ModuleFactory.getDefinitions(),viewLoaded()}function reloadingView(){RepositoryData.resetCallbacks(),RepositoryActions.resetCallbacks()}function doData(a,b){b&&reloadingData(),dataLoaded()}function reloadingData(){RepositoryData.resetVariables(),RepositoryActions.resetVariables(),RepositoryHighlight.resetCallbacks(),RepositoryHighlight.resetVariables()}function viewLoaded(){_viewLoaded=!0,_check("view")}function dataLoaded(){_dataLoaded=!0,_check("data")}function _check(loading){function doInitScript(){return new Promise(function(resolve,reject){if(view.init_script){var prefix='(function init_script(init_deferred){"use strict";\n',script=view.init_script[0].groups.general[0].script[0]||"",suffix="\n})({resolve:resolve});";-1===script.indexOf("init_deferred")&&(suffix+="resolve();"),eval(prefix+script+suffix)}else resolve()})}function configureRequirejs(){if(view.aliases){var a=view.aliases;a=_.filter(a,function(a){return a&&a.alias&&a.path});for(var b={paths:{}},c=0;c<a.length;c++)b.paths[a[c].alias]=a[c].path;for(var d in b.paths)require.undef(d);require.config(DataObject.resurrect(b))}}function checkCustomModules(){for(var a=Versioning.getView().duplicate(),b=!1,c=ModuleFactory.getModulesById(),d=0;d<a.modules.length;d++){var e=Util.moduleIdFromUrl(a.modules[d].url),f=c[e];f?f.url.replace(/\/$/,"")!==a.modules[d].url.replace(/\/$/,"")&&(b=!0,a.modules[d].url=f.url):Debug.warn("Your view contains an url to a module (id: "+e+") that does not correspond to any loaded modules")}b&&Versioning.setViewJSON(a)}function loadCustomModules(){var a=view.getChildSync(["custom_filters",0,"sections","modules",0,"groups","modules",0]);if(!a)return Promise.resolve();a=_.filter(a,function(a){return a&&a.url});for(var b=0;b<a.length;b++)a[b].url=a[b].url.replace(/\/$/,"");return ModuleFactory.setModules({folders:_.map(a,"url")})}function loadCustomFilters(){if(view.custom_filters){for(var filters=view.custom_filters[0].sections.filters,allFilters=API.getAllFilters(),i=0;i<filters.length;i++){var filter=filters[i].groups.filter[0];if(filter.name[0]){for(var deps=filters[i].groups.libs[0],depsA=["src/util/api"],defineStr="filterDef = function filterDefinition(API",dep,j=0;j<deps.length;j++)dep=deps[j],dep.lib&&(depsA.push(dep.lib),defineStr+=", "+dep.alias);defineStr+=") { \n "+filter.script[0]+" \n}";try{var filterDef;eval(defineStr),require.undef(filter.name[0]),define(filter.name[0],depsA,filterDef),allFilters.push({file:filter.name[0],name:filter.name[0]})}catch(a){Debug.warn("Problem with custom filter definition",a)}}}var filtersLib=view.getChildSync("custom_filters",0,"sections","filtersLib",0,"groups","filters",0);filtersLib&&(filtersLib=_.filter(filtersLib,function(a){return a&&a.name&&a.file}),API.setAllFilters(filtersLib))}}function loadMainVariables(){if(0===view.variables.length)for(var a in data)"_"!==a.charAt(0)&&view.variables.push(new DataObject({varname:a,jpath:[a]}));API.loading("Fetching remote variables");for(var b=[],a=0,c=view.variables.length;c>a;a++)!function(a){var c=view.traceSync(["variables",a]);c.varname&&(c.url?b.push(UrlData.get(c.url,0|c.timeout,{Accept:"application/json"}).then(function(a){var b=c.varname;return data.setChild([b],a,!0),API.setVariable(b,!1,[b])})):c.jpath?("string"==typeof c.jpath&&(c.jpath=c.jpath.split("."),c.jpath.shift()),b.push(API.setVariable(c.varname,!1,c.jpath))):b.push(API.createData(name,!1)))}(a);return Promise.all(b).then(function(){API.stopLoading("Fetching remote variables")})}function loadPouchVariables(){API.loading("Fetching local variables");for(var a,b=[],c=0,d=view.pouchvariables.length;d>c;c++)a=view.pouchvariables[c],a.dbname&&a.varname&&!function(a){b.push(PouchDBUtil.pouchToVar(view.pouchvariables[a].dbname,view.pouchvariables[a].id,function(b){b.linkToParent(data,view.pouchvariables[a].varname),API.setVariable(view.pouchvariables[a].varname,!1,[view.pouchvariables[a].varname])}))}(c);if(PouchDBUtil.abortReplications(),view.couch_replication)for(var e=view.couch_replication[0].groups.couch[0],c=0,d=e.length;d>c;c++)e[c].couchurl&&PouchDBUtil.replicate(e[c].pouchname,e[c].couchurl,{direction:e[c].direction,continuous:e[c].continuous?e[c].continuous.length:!0});return Promise.all(b).then(function(){API.stopLoading("Fetching local variables")},function(a){Debug.error("Unable to fetch local variables",a)})}if(_dataLoaded&&_viewLoaded){var view=Versioning.getView(),data=Versioning.getData();Promise.all([loadCustomFilters(),loadMainVariables(),loadPouchVariables(),configureRequirejs(),loadCustomModules()]).then(doInitScript).then(function(){ActionManager.viewHasChanged(view),ModuleFactory.getModules().forEach(function(a){a.controller&&"function"==typeof a.controller.onGlobalPreferenceChange&&a.controller.onGlobalPreferenceChange()}),_modulesSet.then(checkCustomModules,checkCustomModules)},function(a){Debug.error("View loading problem",a,a.stack)})}}function configureEntryPoint(){var a=Versioning.getData(),b=Versioning.getView(),c=ui.dialog({autoPosition:!0,width:"80%",noHeader:!0}),d=[];Traversing.getJPathsFromElement(a,d),require(["forms/form"],function(a){var e=new a;e.init({onValueChanged:function(a){}}),e.setStructure({sections:{cfg:{options:{title:"General configuration",icon:"hostname"},groups:{tablevars:{options:{type:"table",title:"Main variables",multiple:!0},fields:{varname:{type:"text",multiple:!1,title:"Variable name"},jpath:{type:"combo",title:"J-Path",options:d,extractValue:function(a){if(a){var b=a.split(".");return b.shift(),b}},insertValue:function(a){return"element."+(a||[]).join(".")}},url:{type:"text",title:"From URL"},timeout:{type:"text",title:"Timeout"}}},pouchvars:{options:{type:"table",title:"PouchDB variables",multiple:!0},fields:{varname:{type:"text",multiple:!1,title:"Variable name"},dbname:{type:"text",title:"DB name"},id:{type:"text",title:"ID"}}},aliases:{options:{type:"table",multiple:!0,title:"Define Global Aliases"},fields:{path:{type:"text",title:"Url or Path (omit .js extension)"},alias:{type:"text",title:"Alias"}}}}},actionscripts:{options:{title:"Action scripting",icon:"script_go"},sections:{actions:{options:{multiple:!0,title:"Action"},groups:{action:{options:{type:"list"},fields:{name:{type:"text",title:"Action name"},script:{type:"jscode",title:"Script"}}}}}}},actionfiles:{options:{title:"Action files",icon:"server_go"},groups:{action:{options:{type:"table",multiple:!0},fields:{name:{type:"text",title:"Action name"},file:{type:"text",title:"File"},mode:{type:"combo",title:"File type",options:[{key:"worker",title:"WebWorker"},{key:"amd",title:"Asynchronously loaded module"}]}}}}},custom_filters:{options:{title:"Custom filters",icon:"script_go"},sections:{modules:{options:{multiple:!1,title:"Modules"},groups:{modules:{options:{type:"table",multiple:!0},fields:{url:{type:"text",title:"Root url to modules"}}}}},filtersLib:{options:{title:"Filters"},groups:{filters:{options:{type:"table",multiple:!0},fields:{name:{type:"text",title:"Name"},file:{type:"text",title:"url"}}}}},filters:{options:{multiple:!0,title:"Custom Filters"},groups:{filter:{options:{type:"list"},fields:{name:{type:"text",title:"Filter name"},script:{type:"jscode",title:"Script"}}},libs:{options:{type:"table",multiple:"true",title:"Dependencies"},fields:{lib:{type:"text",title:"URL"},alias:{type:"text",title:"Alias"}}}}}}},init_script:{options:{title:"Initialization script",icon:"scripts"},groups:{general:{options:{type:"list",multiple:!0},fields:{script:{type:"jscode",title:"Javascript to execute"}}}}},couch_replication:{options:{title:"Couch replication",icon:"scripts"},groups:{couch:{options:{type:"table",multiple:!0},fields:{pouchname:{type:"text",title:"Pouch DB name"},couchurl:{type:"text",title:"Couch URL"},direction:{type:"combo",title:"Direction",options:[{key:"PtoC",title:"Pouch -> Couch"},{key:"CtoP",title:"Couch -> Pouch"},{key:"both",title:"Both ways"}],default:"both"},continuous:{type:"checkbox",title:"Continuous replication",options:{continuous:"Continuous"}}}}}}}}),e.onStructureLoaded().done(function(){e.fill({sections:{cfg:[{groups:{tablevars:[b.variables],pouchvars:[b.pouchvariables],aliases:[b.aliases]}}],actionscripts:[{sections:{actions:ActionManager.getScriptsForm()}}],init_script:b.init_script,custom_filters:b.custom_filters,actionfiles:ActionManager.getFilesForm(),couch_replication:b.couch_replication,requirejs:b.requirejs}})}),e.addButton("Cancel",{color:"blue"},function(){c.dialog("close")}),e.addButton("Save",{color:"green"},function(){c.dialog("close");var a,d=e.getValue();a=new DataArray(d.sections.cfg[0].groups.tablevars[0],!0),b.variables=a,b.aliases=new DataArray(d.sections.cfg[0].groups.aliases[0],!0),b.couch_replication=d.sections.couch_replication,b.init_script=d.sections.init_script,b.custom_filters=d.sections.custom_filters,b.requirejs=d.sections.requirejs,a=new DataArray(d.sections.cfg[0].groups.pouchvars[0]),b.pouchvariables=a,_check(!0),a=d.sections.actionscripts[0].sections.actions,ActionManager.setScriptsFromForm(a),a=d.sections.actionfiles,ActionManager.setFilesFromForm(a)}),e.onLoaded().done(function(){c.html(e.makeDom()),e.inDom()})})}var _viewLoaded,_dataLoaded,_modulesSet,RepositoryData=new Repository,RepositoryHighlight=new Repository,RepositoryActions=new Repository;return API.setRepositoryData(RepositoryData),API.setRepositoryHighlights(RepositoryHighlight),API.setRepositoryActions(RepositoryActions),{init:function(a,b){function c(c){var d=$("#ci-visualizer");if(c)return void d.append('<div id="browser-compatibility">'+c+"</div>");d.html('<table id="viewport" cellpadding="0" cellspacing="0">\n    <tr>\n        <td id="ci-center">\n            <div id="modules-grid">\n                <div id="ci-dialog"></div>\n            </div>\n        </td>\n    </tr>\n</table>');var f=a.config||d.attr("data-ci-config");f||(d.attr("config")?(Debug.warn("config as attribute of ci-visualizer is deprecated. Use data-ci-config instead."),f=d.attr("config")):f=require.toUrl("usr/config/default.json")),$.getJSON(f,{},function(a){a.usrDir&&require.config({paths:{usr:a.usrDir}}),e||Debug.setDebugLevel(a.debugLevel||Debug.Levels.ERROR),Config.setConfig(a),(a.lockView||a.viewLock)&&Versioning.viewLock(),a.header&&Header.init(a.header),a.modules&&(_modulesSet=ModuleFactory.setModules(a.modules)),API.setAllFilters(a.filters||[])}).fail(function(a,b){Debug.error("Error loading the config : "+b)}).always(function(){require(["usr/datastructures/filelist"],function(){Context.init(document.getElementById("modules-grid")),Versioning.isViewLocked()||(Context.listen(Context.getRootDom(),[['<li class="ci-item-configureentrypoint"><a><span class="ui-icon ui-icon-key"></span>Global preferences</a></li>',function(){configureEntryPoint()}]]),Context.listen(Context.getRootDom(),[['<li class="ci-item-refresh" name="refresh"><a><span class="ui-icon ui-icon-arrowrefresh-1-s"></span>Refresh page</a></li>',function(){document.location.reload()}]])),Versioning.setViewLoadCallback(doView),Versioning.setDataLoadCallback(doData),Versioning.setViewJSON({}),Versioning.setDataJSON({}),Versioning.setURLType(b);var c=$("#ci-visualizer"),d=a.viewURL||c.attr("data-ci-view");!d&&c.attr("viewURL")&&(Debug.warn("viewURL as attribute of ci-visualizer is deprecated. Use data-ci-view instead."),d=c.attr("viewURL"));var e=a.dataURL||c.attr("data-ci-data");!e&&c.attr("dataURL")&&(Debug.warn("dataURL as attribute of ci-visualizer is deprecated. Use data-ci-data instead."),e=c.attr("dataURL"));var f={view:{urls:a.views,branch:a.viewBranch,url:d},data:{urls:a.results,branch:a.resultBranch,url:e}};window.history.replaceState({type:"viewchange",value:f},""),Versioning.switchView(f,!1)})})}var d=["css/main.css","components/colors/css/colors.min.css","components/jquery-ui/themes/smoothness/jquery-ui.min.css","lib/forms/style.css","components/fancytree/dist/skin-lion/ui.fancytree.css","css/overwrite_styles.css","components/font-awesome/css/font-awesome.min.css"];d.forEach(function(a){Util.loadCss(a)});var e;a.debug&&(Debug.setDebugLevel(parseInt(a.debug)),e=!0),browser.checkCompatibility().then(c)}}}),function(a,b){"use strict";"object"==typeof exports?module.exports=b(require("./URI")):"function"==typeof define&&define.amd?define("uri/URI.fragmentQuery",["./URI"],b):b(a.URI)}(this,function(a){"use strict";var b=a.prototype,c=b.fragment;a.fragmentPrefix="?";var d=a._parts;return a._parts=function(){var b=d();return b.fragmentPrefix=a.fragmentPrefix,b},b.fragmentPrefix=function(a){return this._parts.fragmentPrefix=a,this},b.fragment=function(b,d){var e=this._parts.fragmentPrefix,f=this._parts.fragment||"";return b===!0?f.substring(0,e.length)!==e?{}:a.parseQuery(f.substring(e.length)):void 0!==b&&"string"!=typeof b?(this._parts.fragment=e+a.buildQuery(b),this.build(!d),this):c.call(this,b,d)},b.addFragment=function(b,c,d){var e=this._parts.fragmentPrefix,f=a.parseQuery((this._parts.fragment||"").substring(e.length));return a.addQuery(f,b,c),this._parts.fragment=e+a.buildQuery(f),"string"!=typeof b&&(d=c),this.build(!d),this},b.removeFragment=function(b,c,d){var e=this._parts.fragmentPrefix,f=a.parseQuery((this._parts.fragment||"").substring(e.length));return a.removeQuery(f,b,c),this._parts.fragment=e+a.buildQuery(f),"string"!=typeof b&&(d=c),this.build(!d),this},b.addHash=b.addFragment,b.removeHash=b.removeFragment,a}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define("components/bluebird/js/browser/bluebird.min",[],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Promise=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof _dereq_&&_dereq_;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof _dereq_&&_dereq_,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports=function(a){function b(a){var b=new c(a),d=b.promise();return b.setHowMany(1),b.setUnwrap(),b.init(),d}var c=a._SomePromiseArray;a.any=function(a){return b(a)},a.prototype.any=function(){return b(this)}}},{}],2:[function(a,b,c){"use strict";function d(){this._isTickUsed=!1,this._lateQueue=new j(16),this._normalQueue=new j(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var a=this;this.drainQueues=function(){a._drainQueues()},this._schedule=i}function e(a,b,c){this._lateQueue.push(a,b,c),this._queueTick()}function f(a,b,c){this._normalQueue.push(a,b,c),this._queueTick()}function g(a){
this._normalQueue._pushOne(a),this._queueTick()}var h;try{throw new Error}catch(a){h=a}var i=a("./schedule"),j=a("./queue"),k=a("./util");d.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},d.prototype.disableTrampolineIfNecessary=function(){k.hasDevTools&&(this._trampolineEnabled=!1)},d.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},d.prototype.fatalError=function(a,b){b?(process.stderr.write("Fatal "+(a instanceof Error?a.stack:a)+"\n"),process.exit(2)):this.throwLater(a)},d.prototype.throwLater=function(a,b){if(1===arguments.length&&(b=a,a=function(){throw b}),"undefined"!=typeof setTimeout)setTimeout(function(){a(b)},0);else try{this._schedule(function(){a(b)})}catch(a){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},k.hasDevTools?(d.prototype.invokeLater=function(a,b,c){this._trampolineEnabled?e.call(this,a,b,c):this._schedule(function(){setTimeout(function(){a.call(b,c)},100)})},d.prototype.invoke=function(a,b,c){this._trampolineEnabled?f.call(this,a,b,c):this._schedule(function(){a.call(b,c)})},d.prototype.settlePromises=function(a){this._trampolineEnabled?g.call(this,a):this._schedule(function(){a._settlePromises()})}):(d.prototype.invokeLater=e,d.prototype.invoke=f,d.prototype.settlePromises=g),d.prototype.invokeFirst=function(a,b,c){this._normalQueue.unshift(a,b,c),this._queueTick()},d.prototype._drainQueue=function(a){for(;a.length()>0;){var b=a.shift();if("function"==typeof b){var c=a.shift(),d=a.shift();b.call(c,d)}else b._settlePromises()}},d.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},d.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},d.prototype._reset=function(){this._isTickUsed=!1},b.exports=d,b.exports.firstLineError=h},{"./queue":26,"./schedule":29,"./util":36}],3:[function(a,b,c){"use strict";b.exports=function(a,b,c,d){var e=!1,f=function(a,b){this._reject(b)},g=function(a,b){b.promiseRejectionQueued=!0,b.bindingPromise._then(f,f,null,this,a)},h=function(a,b){0===(50397184&this._bitField)&&this._resolveCallback(b.target)},i=function(a,b){b.promiseRejectionQueued||this._reject(a)};a.prototype.bind=function(f){e||(e=!0,a.prototype._propagateFrom=d.propagateFromFunction(),a.prototype._boundValue=d.boundValueFunction());var j=c(f),k=new a(b);k._propagateFrom(this,1);var l=this._target();if(k._setBoundTo(j),j instanceof a){var m={promiseRejectionQueued:!1,promise:k,target:l,bindingPromise:j};l._then(b,g,void 0,k,m),j._then(h,i,void 0,k,m),k._setOnCancel(j)}else k._resolveCallback(l);return k},a.prototype._setBoundTo=function(a){void 0!==a?(this._bitField=2097152|this._bitField,this._boundTo=a):this._bitField=-2097153&this._bitField},a.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},a.bind=function(b,c){return a.resolve(c).bind(b)}}},{}],4:[function(a,b,c){"use strict";function d(){try{Promise===f&&(Promise=e)}catch(a){}return f}var e;"undefined"!=typeof Promise&&(e=Promise);var f=a("./promise")();f.noConflict=d,b.exports=f},{"./promise":22}],5:[function(a,b,c){"use strict";var d=Object.create;if(d){var e=d(null),f=d(null);e[" size"]=f[" size"]=0}b.exports=function(b){function c(a,c){var d;if(null!=a&&(d=a[c]),"function"!=typeof d){var e="Object "+h.classString(a)+" has no method '"+h.toString(c)+"'";throw new b.TypeError(e)}return d}function d(a){var b=this.pop(),d=c(a,b);return d.apply(a,this)}function e(a){return a[this]}function f(a){var b=+this;return 0>b&&(b=Math.max(0,b+a.length)),a[b]}var g,h=a("./util"),i=h.canEvaluate;h.isIdentifier,b.prototype.call=function(a){var b=[].slice.call(arguments,1);return b.push(a),this._then(d,void 0,void 0,b,void 0)},b.prototype.get=function(a){var b,c="number"==typeof a;if(c)b=f;else if(i){var d=g(a);b=null!==d?d:e}else b=e;return this._then(b,void 0,void 0,a,void 0)}}},{"./util":36}],6:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){var f=a("./util"),g=f.tryCatch,h=f.errorObj,i=b._async;b.prototype.break=b.prototype.cancel=function(){if(!e.cancellation())return this._warn("cancellation is disabled");for(var a=this,b=a;a.isCancellable();){if(!a._cancelBy(b)){b._isFollowing()?b._followee().cancel():b._cancelBranched();break}var c=a._cancellationParent;if(null==c||!c.isCancellable()){a._isFollowing()?a._followee().cancel():a._cancelBranched();break}a._isFollowing()&&a._followee().cancel(),b=a,a=c}},b.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},b.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},b.prototype._cancelBy=function(a){return a===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),this._enoughBranchesHaveCancelled()?(this._invokeOnCancel(),!0):!1)},b.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},b.prototype._cancel=function(){this.isCancellable()&&(this._setCancelled(),i.invoke(this._cancelPromises,this,void 0))},b.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},b.prototype._unsetOnCancel=function(){this._onCancelField=void 0},b.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},b.prototype._doInvokeOnCancel=function(a,b){if(f.isArray(a))for(var c=0;c<a.length;++c)this._doInvokeOnCancel(a[c],b);else if(void 0!==a)if("function"==typeof a){if(!b){var d=g(a).call(this._boundValue());d===h&&(this._attachExtraTrace(d.e),i.throwLater(d.e))}}else a._resultCancelled(this)},b.prototype._invokeOnCancel=function(){var a=this._onCancel();this._unsetOnCancel(),i.invoke(this._doInvokeOnCancel,this,a)},b.prototype._invokeInternalOnCancel=function(){this.isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},b.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(a,b,c){"use strict";b.exports=function(b){function c(a,c,h){return function(i){var j=h._boundValue();a:for(var k=0;k<a.length;++k){var l=a[k];if(l===Error||null!=l&&l.prototype instanceof Error){if(i instanceof l)return f(c).call(j,i)}else if("function"==typeof l){var m=f(l).call(j,i);if(m===g)return m;if(m)return f(c).call(j,i)}else if(d.isObject(i)){for(var n=e(l),o=0;o<n.length;++o){var p=n[o];if(l[p]!=i[p])continue a}return f(c).call(j,i)}}return b}}var d=a("./util"),e=a("./es5").keys,f=d.tryCatch,g=d.errorObj;return c}},{"./es5":13,"./util":36}],8:[function(a,b,c){"use strict";b.exports=function(a){function b(){this._trace=new b.CapturedTrace(d())}function c(){return e?new b:void 0}function d(){var a=f.length-1;return a>=0?f[a]:void 0}var e=!1,f=[];return a.prototype._promiseCreated=function(){},a.prototype._pushContext=function(){},a.prototype._popContext=function(){return null},a._peekContext=a.prototype._peekContext=function(){},b.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,f.push(this._trace))},b.prototype._popContext=function(){if(void 0!==this._trace){var a=f.pop(),b=a._promiseCreated;return a._promiseCreated=null,b}return null},b.CapturedTrace=null,b.create=c,b.deactivateLongStackTraces=function(){},b.activateLongStackTraces=function(){var c=a.prototype._pushContext,f=a.prototype._popContext,g=a._peekContext,h=a.prototype._peekContext,i=a.prototype._promiseCreated;b.deactivateLongStackTraces=function(){a.prototype._pushContext=c,a.prototype._popContext=f,a._peekContext=g,a.prototype._peekContext=h,a.prototype._promiseCreated=i,e=!1},e=!0,a.prototype._pushContext=b.prototype._pushContext,a.prototype._popContext=b.prototype._popContext,a._peekContext=a.prototype._peekContext=d,a.prototype._promiseCreated=function(){var a=this._peekContext();a&&null==a._promiseCreated&&(a._promiseCreated=this)}},b}},{}],9:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a,b){return{promise:b}}function e(){return!1}function f(a,b,c){var d=this;try{a(b,c,function(a){if("function"!=typeof a)throw new TypeError("onCancel must be a function, got: "+M.toString(a));d._attachCancellationCallback(a)})}catch(a){return a}}function g(a){if(!this.isCancellable())return this;var b=this._onCancel();void 0!==b?M.isArray(b)?b.push(a):this._setOnCancel([b,a]):this._setOnCancel(a)}function h(){return this._onCancelField}function i(a){this._onCancelField=a}function j(){this._cancellationParent=void 0,this._onCancelField=void 0}function k(a,b){if(0!==(1&b)){this._cancellationParent=a;var c=a._branchesRemainingToCancel;void 0===c&&(c=0),a._branchesRemainingToCancel=c+1}0!==(2&b)&&a._isBound()&&this._setBoundTo(a._boundTo)}function l(a,b){0!==(2&b)&&a._isBound()&&this._setBoundTo(a._boundTo)}function m(){var a=this._boundTo;return void 0!==a&&a instanceof b?a.isFulfilled()?a.value():void 0:a}function n(){this._trace=new F(this._peekContext())}function o(a,b){if(N(a)){var c=this._trace;if(void 0!==c&&b&&(c=c._parent),void 0!==c)c.attachExtraTrace(a);else if(!a.__stackCleaned__){var d=x(a);M.notEnumerableProp(a,"stack",d.message+"\n"+d.stack.join("\n")),M.notEnumerableProp(a,"__stackCleaned__",!0)}}}function p(a,b,c,d,e){if(void 0===a&&null!==b&&V){if(void 0!==e&&e._returnedNonUndefined())return;c&&(c+=" ");var f="a promise was created in a "+c+"handler but was not returned from it";d._warn(f,!0,b)}}function q(a,b){var c=a+" is deprecated and will be removed in a future version.";return b&&(c+=" Use "+b+" instead."),r(c)}function r(a,c,d){if(da.warnings){var e,f=new L(a);if(c)d._attachExtraTrace(f);else if(da.longStackTraces&&(e=b._peekContext()))e.attachExtraTrace(f);else{var g=x(f);f.stack=g.message+"\n"+g.stack.join("\n")}$("warning",f)||y(f,"",!0)}}function s(a,b){for(var c=0;c<b.length-1;++c)b[c].push("From previous event:"),b[c]=b[c].join("\n");return c<b.length&&(b[c]=b[c].join("\n")),a+"\n"+b.join("\n")}function t(a){for(var b=0;b<a.length;++b)(0===a[b].length||b+1<a.length&&a[b][0]===a[b+1][0])&&(a.splice(b,1),b--)}function u(a){for(var b=a[0],c=1;c<a.length;++c){for(var d=a[c],e=b.length-1,f=b[e],g=-1,h=d.length-1;h>=0;--h)if(d[h]===f){g=h;break}for(var h=g;h>=0;--h){var i=d[h];if(b[e]!==i)break;b.pop(),e--}b=d}}function v(a){for(var b=[],c=0;c<a.length;++c){var d=a[c],e="    (No stack trace)"===d||P.test(d),f=e&&aa(d);e&&!f&&(R&&" "!==d.charAt(0)&&(d="    "+d),b.push(d))}return b}function w(a){for(var b=a.stack.replace(/\s+$/g,"").split("\n"),c=0;c<b.length;++c){var d=b[c];if("    (No stack trace)"===d||P.test(d))break}return c>0&&(b=b.slice(c)),b}function x(a){var b=a.stack,c=a.toString();return b="string"==typeof b&&b.length>0?w(a):["    (No stack trace)"],{message:c,stack:v(b)}}function y(a,b,c){if("undefined"!=typeof console){var d;if(M.isObject(a)){var e=a.stack;d=b+Q(e,a)}else d=b+String(a);"function"==typeof I?I(d,c):("function"==typeof console.log||"object"==typeof console.log)&&console.log(d)}}function z(a,b,c,d){var e=!1;try{"function"==typeof b&&(e=!0,"rejectionHandled"===a?b(d):b(c,d))}catch(a){K.throwLater(a)}"unhandledRejection"===a?$(a,c,d)||e||y(c,"Unhandled rejection "):$(a,d)}function A(a){var b;if("function"==typeof a)b="[function "+(a.name||"anonymous")+"]";else{b=a&&"function"==typeof a.toString?a.toString():M.toString(a);var c=/\[object [a-zA-Z0-9$_]+\]/;if(c.test(b))try{var d=JSON.stringify(a);b=d}catch(a){}0===b.length&&(b="(empty array)")}return"(<"+B(b)+">, no stack trace)"}function B(a){var b=41;return a.length<b?a:a.substr(0,b-3)+"..."}function C(){return"function"==typeof ca}function D(a){var b=a.match(ba);return b?{fileName:b[1],line:parseInt(b[2],10)}:void 0}function E(a,b){if(C()){for(var c,d,e=a.stack.split("\n"),f=b.stack.split("\n"),g=-1,h=-1,i=0;i<e.length;++i){var j=D(e[i]);if(j){c=j.fileName,g=j.line;break}}for(var i=0;i<f.length;++i){var j=D(f[i]);if(j){d=j.fileName,h=j.line;break}}0>g||0>h||!c||!d||c!==d||g>=h||(aa=function(a){if(O.test(a))return!0;var b=D(a);return!!(b&&b.fileName===c&&g<=b.line&&b.line<=h)})}}function F(a){this._parent=a,this._promisesCreated=0;var b=this._length=1+(void 0===a?0:a._length);ca(this,F),b>32&&this.uncycle()}var G,H,I,J=b._getDomain,K=b._async,L=a("./errors").Warning,M=a("./util"),N=M.canAttachTrace,O=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,P=null,Q=null,R=!1,S=!(0==M.env("BLUEBIRD_DEBUG")||!M.env("BLUEBIRD_DEBUG")&&"development"!==M.env("NODE_ENV")),T=!(0==M.env("BLUEBIRD_WARNINGS")||!S&&!M.env("BLUEBIRD_WARNINGS")),U=!(0==M.env("BLUEBIRD_LONG_STACK_TRACES")||!S&&!M.env("BLUEBIRD_LONG_STACK_TRACES")),V=0!=M.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(T||!!M.env("BLUEBIRD_W_FORGOTTEN_RETURN"));b.prototype.suppressUnhandledRejections=function(){var a=this._target();a._bitField=-1048577&a._bitField|524288},b.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),K.invokeLater(this._notifyUnhandledRejection,this,void 0))},b.prototype._notifyUnhandledRejectionIsHandled=function(){z("rejectionHandled",G,void 0,this)},b.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},b.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},b.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var a=this._settledValue();this._setUnhandledRejectionIsNotified(),z("unhandledRejection",H,a,this)}},b.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},b.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},b.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},b.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},b.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},b.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},b.prototype._warn=function(a,b,c){return r(a,b,c||this)},b.onPossiblyUnhandledRejection=function(a){var b=J();H="function"==typeof a?null===b?a:b.bind(a):void 0},b.onUnhandledRejectionHandled=function(a){var b=J();G="function"==typeof a?null===b?a:b.bind(a):void 0};var W=function(){};b.longStackTraces=function(){if(K.haveItemsQueued()&&!da.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!da.longStackTraces&&C()){var a=b.prototype._captureStackTrace,d=b.prototype._attachExtraTrace;da.longStackTraces=!0,W=function(){if(K.haveItemsQueued()&&!da.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");b.prototype._captureStackTrace=a,b.prototype._attachExtraTrace=d,c.deactivateLongStackTraces(),K.enableTrampoline(),da.longStackTraces=!1},b.prototype._captureStackTrace=n,b.prototype._attachExtraTrace=o,c.activateLongStackTraces(),K.disableTrampolineIfNecessary()}},b.hasLongStackTraces=function(){return da.longStackTraces&&C()};var X=function(){try{var a=document.createEvent("CustomEvent");return a.initCustomEvent("testingtheevent",!1,!0,{}),M.global.dispatchEvent(a),function(a,b){var c=document.createEvent("CustomEvent");return c.initCustomEvent(a.toLowerCase(),!1,!0,b),!M.global.dispatchEvent(c)}}catch(a){}return function(){return!1}}(),Y=function(){return M.isNode?function(){return process.emit.apply(process,arguments)}:M.global?function(a){var b="on"+a.toLowerCase(),c=M.global[b];return c?(c.apply(M.global,[].slice.call(arguments,1)),!0):!1}:function(){return!1}}(),Z={promiseCreated:d,promiseFulfilled:d,promiseRejected:d,promiseResolved:d,promiseCancelled:d,promiseChained:function(a,b,c){return{promise:b,child:c}},warning:function(a,b){return{warning:b}},unhandledRejection:function(a,b,c){return{reason:b,promise:c}},rejectionHandled:d},$=function(a){var b=!1;try{b=Y.apply(null,arguments)}catch(a){K.throwLater(a),b=!0}var c=!1;try{c=X(a,Z[a].apply(null,arguments))}catch(a){K.throwLater(a),c=!0}return c||b};b.config=function(a){if(a=Object(a),"longStackTraces"in a&&(a.longStackTraces?b.longStackTraces():!a.longStackTraces&&b.hasLongStackTraces()&&W()),"warnings"in a){var c=a.warnings;da.warnings=!!c,V=da.warnings,M.isObject(c)&&"wForgottenReturn"in c&&(V=!!c.wForgottenReturn)}if("cancellation"in a&&a.cancellation&&!da.cancellation){if(K.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");b.prototype._clearCancellationData=j,b.prototype._propagateFrom=k,b.prototype._onCancel=h,b.prototype._setOnCancel=i,b.prototype._attachCancellationCallback=g,b.prototype._execute=f,_=k,da.cancellation=!0}"monitoring"in a&&(a.monitoring&&!da.monitoring?(da.monitoring=!0,b.prototype._fireEvent=$):!a.monitoring&&da.monitoring&&(da.monitoring=!1,b.prototype._fireEvent=e))},b.prototype._fireEvent=e,b.prototype._execute=function(a,b,c){try{a(b,c)}catch(a){return a}},b.prototype._onCancel=function(){},b.prototype._setOnCancel=function(a){},b.prototype._attachCancellationCallback=function(a){},b.prototype._captureStackTrace=function(){},b.prototype._attachExtraTrace=function(){},b.prototype._clearCancellationData=function(){},b.prototype._propagateFrom=function(a,b){};var _=l,aa=function(){return!1},ba=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;M.inherits(F,Error),c.CapturedTrace=F,F.prototype.uncycle=function(){var a=this._length;if(!(2>a)){for(var b=[],c={},d=0,e=this;void 0!==e;++d)b.push(e),e=e._parent;a=this._length=d;for(var d=a-1;d>=0;--d){var f=b[d].stack;void 0===c[f]&&(c[f]=d)}for(var d=0;a>d;++d){var g=b[d].stack,h=c[g];if(void 0!==h&&h!==d){h>0&&(b[h-1]._parent=void 0,b[h-1]._length=1),b[d]._parent=void 0,b[d]._length=1;var i=d>0?b[d-1]:this;a-1>h?(i._parent=b[h+1],i._parent.uncycle(),i._length=i._parent._length+1):(i._parent=void 0,i._length=1);for(var j=i._length+1,k=d-2;k>=0;--k)b[k]._length=j,j++;return}}}},F.prototype.attachExtraTrace=function(a){if(!a.__stackCleaned__){this.uncycle();for(var b=x(a),c=b.message,d=[b.stack],e=this;void 0!==e;)d.push(v(e.stack.split("\n"))),e=e._parent;u(d),t(d),M.notEnumerableProp(a,"stack",s(c,d)),M.notEnumerableProp(a,"__stackCleaned__",!0)}};var ca=function(){var a=/^\s*at\s*/,b=function(a,b){return"string"==typeof a?a:void 0!==b.name&&void 0!==b.message?b.toString():A(b)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,P=a,Q=b;var c=Error.captureStackTrace;return aa=function(a){return O.test(a)},function(a,b){Error.stackTraceLimit+=6,c(a,b),Error.stackTraceLimit-=6}}var d=new Error;if("string"==typeof d.stack&&d.stack.split("\n")[0].indexOf("stackDetection@")>=0)return P=/@/,Q=b,R=!0,function(a){a.stack=(new Error).stack};var e;try{throw new Error}catch(a){e="stack"in a}return"stack"in d||!e||"number"!=typeof Error.stackTraceLimit?(Q=function(a,b){return"string"==typeof a?a:"object"!=typeof b&&"function"!=typeof b||void 0===b.name||void 0===b.message?A(b):b.toString()},null):(P=a,Q=b,function(a){Error.stackTraceLimit+=6;try{throw new Error}catch(b){a.stack=b.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(I=function(a){console.warn(a)},M.isNode&&process.stderr.isTTY?I=function(a,b){var c=b?"[33m":"[31m";console.warn(c+a+"[0m\n")}:M.isNode||"string"!=typeof(new Error).stack||(I=function(a,b){console.warn("%c"+a,b?"color: darkorange":"color: red")}));var da={warnings:T,longStackTraces:!1,cancellation:!1,monitoring:!1};return U&&b.longStackTraces(),{longStackTraces:function(){return da.longStackTraces},warnings:function(){return da.warnings},cancellation:function(){return da.cancellation},monitoring:function(){return da.monitoring},propagateFromFunction:function(){return _},boundValueFunction:function(){return m},checkForgottenReturns:p,setBounds:E,warn:r,deprecated:q,CapturedTrace:F,fireDomEvent:X,fireGlobalEvent:Y}}},{"./errors":12,"./util":36}],10:[function(a,b,c){"use strict";b.exports=function(a){function b(){return this.value}function c(){throw this.reason}a.prototype.return=a.prototype.thenReturn=function(c){return c instanceof a&&c.suppressUnhandledRejections(),this._then(b,void 0,void 0,{value:c},void 0)},a.prototype.throw=a.prototype.thenThrow=function(a){return this._then(c,void 0,void 0,{reason:a},void 0)},a.prototype.catchThrow=function(a){if(arguments.length<=1)return this._then(void 0,c,void 0,{reason:a},void 0);var b=arguments[1],d=function(){throw b};return this.caught(a,d)},a.prototype.catchReturn=function(c){if(arguments.length<=1)return c instanceof a&&c.suppressUnhandledRejections(),this._then(void 0,b,void 0,{value:c},void 0);var d=arguments[1];d instanceof a&&d.suppressUnhandledRejections();var e=function(){return d};return this.caught(c,e)}}},{}],11:[function(a,b,c){"use strict";b.exports=function(a,b){function c(){return f(this)}function d(a,c){return e(a,c,b,b)}var e=a.reduce,f=a.all;a.prototype.each=function(a){return this.mapSeries(a)._then(c,void 0,void 0,this,void 0)},a.prototype.mapSeries=function(a){return e(this,a,b,b)},a.each=function(a,b){return d(a,b)._then(c,void 0,void 0,a,void 0)},a.mapSeries=d}},{}],12:[function(a,b,c){"use strict";function d(a,b){function c(d){return this instanceof c?(l(this,"message","string"==typeof d?d:b),l(this,"name",a),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new c(d)}return k(c,Error),c}function e(a){return this instanceof e?(l(this,"name","OperationalError"),l(this,"message",a),this.cause=a,this.isOperational=!0,void(a instanceof Error?(l(this,"message",a.message),l(this,"stack",a.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new e(a)}var f,g,h=a("./es5"),i=h.freeze,j=a("./util"),k=j.inherits,l=j.notEnumerableProp,m=d("Warning","warning"),n=d("CancellationError","cancellation error"),o=d("TimeoutError","timeout error"),p=d("AggregateError","aggregate error");try{f=TypeError,g=RangeError}catch(a){f=d("TypeError","type error"),g=d("RangeError","range error")}for(var q="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),r=0;r<q.length;++r)"function"==typeof Array.prototype[q[r]]&&(p.prototype[q[r]]=Array.prototype[q[r]]);h.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var s=0;p.prototype.toString=function(){var a=Array(4*s+1).join(" "),b="\n"+a+"AggregateError of:\n";s++,a=Array(4*s+1).join(" ");for(var c=0;c<this.length;++c){for(var d=this[c]===this?"[Circular AggregateError]":this[c]+"",e=d.split("\n"),f=0;f<e.length;++f)e[f]=a+e[f];d=e.join("\n"),b+=d+"\n"}return s--,b},k(e,Error);var t=Error.__BluebirdErrorTypes__;t||(t=i({CancellationError:n,TimeoutError:o,OperationalError:e,RejectionError:e,AggregateError:p}),h.defineProperty(Error,"__BluebirdErrorTypes__",{value:t,writable:!1,enumerable:!1,configurable:!1})),b.exports={Error:Error,TypeError:f,RangeError:g,CancellationError:t.CancellationError,OperationalError:t.OperationalError,TimeoutError:t.TimeoutError,AggregateError:t.AggregateError,Warning:m}},{"./es5":13,"./util":36}],13:[function(a,b,c){var d=function(){"use strict";return void 0===this}();if(d)b.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:d,propertyIsWritable:function(a,b){var c=Object.getOwnPropertyDescriptor(a,b);return!(c&&!c.writable&&!c.set)}};else{var e={}.hasOwnProperty,f={}.toString,g={}.constructor.prototype,h=function(a){var b=[];for(var c in a)e.call(a,c)&&b.push(c);return b},i=function(a,b){return{value:a[b]}},j=function(a,b,c){return a[b]=c.value,a},k=function(a){return a},l=function(a){try{return Object(a).constructor.prototype}catch(a){return g}},m=function(a){try{return"[object Array]"===f.call(a)}catch(a){return!1}};b.exports={isArray:m,keys:h,names:h,defineProperty:j,getDescriptor:i,freeze:k,getPrototypeOf:l,isES5:d,propertyIsWritable:function(){return!0}}}},{}],14:[function(a,b,c){"use strict";b.exports=function(a,b){var c=a.map;a.prototype.filter=function(a,d){return c(this,a,d,b)},a.filter=function(a,d,e){return c(a,d,e,b)}}},{}],15:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a,b,c){this.promise=a,this.type=b,this.handler=c,this.called=!1,this.cancelPromise=null}function e(a){this.finallyHandler=a}function f(a,b){return null!=a.cancelPromise?(arguments.length>1?a.cancelPromise._reject(b):a.cancelPromise._cancel(),a.cancelPromise=null,!0):!1}function g(){return i.call(this,this.promise._target()._settledValue())}function h(a){return f(this,a)?void 0:(l.e=a,l)}function i(a){var d=this.promise,i=this.handler;if(!this.called){this.called=!0;var j=this.isFinallyHandler()?i.call(d._boundValue()):i.call(d._boundValue(),a);if(void 0!==j){d._setReturnedNonUndefined();var m=c(j,d);if(m instanceof b){if(null!=this.cancelPromise){if(m.isCancelled()){var n=new k("late cancellation observer");return d._attachExtraTrace(n),l.e=n,l}m.isPending()&&m._attachCancellationCallback(new e(this))}return m._then(g,h,void 0,this,void 0)}}}return d.isRejected()?(f(this),l.e=a,l):(f(this),a)}var j=a("./util"),k=b.CancellationError,l=j.errorObj;return d.prototype.isFinallyHandler=function(){return 0===this.type},e.prototype._resultCancelled=function(){f(this.finallyHandler)},b.prototype._passThrough=function(a,b,c,e){return"function"!=typeof a?this.then():this._then(c,e,void 0,new d(this,b,a),void 0)},b.prototype.lastly=b.prototype.finally=function(a){return this._passThrough(a,0,i,i)},b.prototype.tap=function(a){return this._passThrough(a,1,i)},d}},{"./util":36}],16:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a,c,d){for(var f=0;f<c.length;++f){d._pushContext();var g=n(c[f])(a);if(d._popContext(),g===m){d._pushContext();var h=b.reject(m.e);return d._popContext(),h}var i=e(g,d);if(i instanceof b)return i}return null}function i(a,c,e,f){var g=this._promise=new b(d);g._captureStackTrace(),g._setOnCancel(this),this._stack=f,this._generatorFunction=a,this._receiver=c,this._generator=void 0,this._yieldHandlers="function"==typeof e?[e].concat(o):o,this._yieldedPromise=null}var j=a("./errors"),k=j.TypeError,l=a("./util"),m=l.errorObj,n=l.tryCatch,o=[];l.inherits(i,f),i.prototype._isResolved=function(){return null===this._promise},i.prototype._cleanup=function(){this._promise=this._generator=null},i.prototype._promiseCancelled=function(){if(!this._isResolved()){var a,c="undefined"!=typeof this._generator.return;if(c)this._promise._pushContext(),a=n(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var d=new b.CancellationError("generator .return() sentinel");b.coroutine.returnSentinel=d,this._promise._attachExtraTrace(d),this._promise._pushContext(),a=n(this._generator.throw).call(this._generator,d),this._promise._popContext(),a===m&&a.e===d&&(a=null)}var e=this._promise;this._cleanup(),a===m?e._rejectCallback(a.e,!1):e.cancel()}},i.prototype._promiseFulfilled=function(a){this._yieldedPromise=null,this._promise._pushContext();var b=n(this._generator.next).call(this._generator,a);this._promise._popContext(),this._continue(b)},i.prototype._promiseRejected=function(a){this._yieldedPromise=null,this._promise._attachExtraTrace(a),this._promise._pushContext();var b=n(this._generator.throw).call(this._generator,a);this._promise._popContext(),this._continue(b)},i.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof b){var a=this._yieldedPromise;this._yieldedPromise=null,a.cancel()}},i.prototype.promise=function(){return this._promise},i.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},i.prototype._continue=function(a){var c=this._promise;if(a===m)return this._cleanup(),c._rejectCallback(a.e,!1);var d=a.value;if(a.done===!0)return this._cleanup(),c._resolveCallback(d);var f=e(d,this._promise);if(!(f instanceof b)&&(f=h(f,this._yieldHandlers,this._promise),null===f))return void this._promiseRejected(new k("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",d)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));f=f._target();var g=f._bitField;0===(50397184&g)?(this._yieldedPromise=f,f._proxy(this,null)):0!==(33554432&g)?this._promiseFulfilled(f._value()):0!==(16777216&g)?this._promiseRejected(f._reason()):this._promiseCancelled()},b.coroutine=function(a,b){if("function"!=typeof a)throw new k("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var c=Object(b).yieldHandler,d=i,e=(new Error).stack;return function(){var b=a.apply(this,arguments),f=new d(void 0,void 0,c,e),g=f.promise();return f._generator=b,f._promiseFulfilled(void 0),g}},b.coroutine.addYieldHandler=function(a){if("function"!=typeof a)throw new k("expecting a function but got "+l.classString(a));o.push(a)},b.spawn=function(a){if(g.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof a)return c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var d=new i(a,this),e=d.promise();return d._run(b.spawn),e}}},{"./errors":12,"./util":36}],17:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){var f=a("./util");f.canEvaluate,f.tryCatch,f.errorObj,b.join=function(){var a,b=arguments.length-1;if(b>0&&"function"==typeof arguments[b]){a=arguments[b];var d}var e=[].slice.call(arguments);a&&e.pop();var d=new c(e).promise();return void 0!==a?d.spread(a):d}}},{"./util":36}],18:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a,b,c,d){this.constructor$(a),this._promise._captureStackTrace();var e=j();this._callback=null===e?b:e.bind(b),this._preservedValues=d===f?new Array(this.length()):null,this._limit=c,this._inFlight=0,this._queue=c>=1?[]:n,this._init$(void 0,-2)}function i(a,b,c,e){if("function"!=typeof b)return d("expecting a function but got "+k.classString(b));var f="object"==typeof c&&null!==c?c.concurrency:0;return f="number"==typeof f&&isFinite(f)&&f>=1?f:0,new h(a,b,f,e).promise()}var j=b._getDomain,k=a("./util"),l=k.tryCatch,m=k.errorObj,n=[];k.inherits(h,c),h.prototype._init=function(){},h.prototype._promiseFulfilled=function(a,c){var d=this._values,f=this.length(),h=this._preservedValues,i=this._limit;if(0>c){if(c=-1*c-1,d[c]=a,i>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(i>=1&&this._inFlight>=i)return d[c]=a,this._queue.push(c),!1;null!==h&&(h[c]=a);var j=this._promise,k=this._callback,n=j._boundValue();j._pushContext();var o=l(k).call(n,a,c,f),p=j._popContext();if(g.checkForgottenReturns(o,p,null!==h?"Promise.filter":"Promise.map",j),o===m)return this._reject(o.e),!0;var q=e(o,this._promise);if(q instanceof b){q=q._target();var r=q._bitField;if(0===(50397184&r))return i>=1&&this._inFlight++,d[c]=q,q._proxy(this,-1*(c+1)),!1;if(0===(33554432&r))return 0!==(16777216&r)?(this._reject(q._reason()),!0):(this._cancel(),!0);o=q._value()}d[c]=o}var s=++this._totalResolved;return s>=f?(null!==h?this._filter(d,h):this._resolve(d),!0):!1},h.prototype._drainQueue=function(){for(var a=this._queue,b=this._limit,c=this._values;a.length>0&&this._inFlight<b;){if(this._isResolved())return;var d=a.pop();this._promiseFulfilled(c[d],d)}},h.prototype._filter=function(a,b){for(var c=b.length,d=new Array(c),e=0,f=0;c>f;++f)a[f]&&(d[e++]=b[f]);d.length=e,this._resolve(d)},h.prototype.preservedValues=function(){return this._preservedValues},b.prototype.map=function(a,b){return i(this,a,b,null)},b.map=function(a,b,c,d){return i(a,b,c,d)}}},{"./util":36}],19:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f){var g=a("./util"),h=g.tryCatch;
b.method=function(a){if("function"!=typeof a)throw new b.TypeError("expecting a function but got "+g.classString(a));return function(){var d=new b(c);d._captureStackTrace(),d._pushContext();var e=h(a).apply(this,arguments),g=d._popContext();return f.checkForgottenReturns(e,g,"Promise.method",d),d._resolveFromSyncValue(e),d}},b.attempt=b.try=function(a){if("function"!=typeof a)return e("expecting a function but got "+g.classString(a));var d=new b(c);d._captureStackTrace(),d._pushContext();var i;if(arguments.length>1){f.deprecated("calling Promise.try with more than 1 argument");var j=arguments[1],k=arguments[2];i=g.isArray(j)?h(a).apply(k,j):h(a).call(k,j)}else i=h(a)();var l=d._popContext();return f.checkForgottenReturns(i,l,"Promise.try",d),d._resolveFromSyncValue(i),d},b.prototype._resolveFromSyncValue=function(a){a===g.errorObj?this._rejectCallback(a.e,!1):this._resolveCallback(a,!0)}}},{"./util":36}],20:[function(a,b,c){"use strict";function d(a){return a instanceof Error&&k.getPrototypeOf(a)===Error.prototype}function e(a){var b;if(d(a)){b=new j(a),b.name=a.name,b.message=a.message,b.stack=a.stack;for(var c=k.keys(a),e=0;e<c.length;++e){var f=c[e];l.test(f)||(b[f]=a[f])}return b}return g.markAsOriginatingFromRejection(a),a}function f(a,b){return function(c,d){if(null!==a){if(c){var f=e(h(c));a._attachExtraTrace(f),a._reject(f)}else if(b){var g=[].slice.call(arguments,1);a._fulfill(g)}else a._fulfill(d);a=null}}}var g=a("./util"),h=g.maybeWrapAsError,i=a("./errors"),j=i.OperationalError,k=a("./es5"),l=/^(?:name|message|stack|cause)$/;b.exports=f},{"./errors":12,"./es5":13,"./util":36}],21:[function(a,b,c){"use strict";b.exports=function(b){function c(a,b){var c=this;if(!f.isArray(a))return d.call(c,a,b);var e=h(b).apply(c._boundValue(),[null].concat(a));e===i&&g.throwLater(e.e)}function d(a,b){var c=this,d=c._boundValue(),e=void 0===a?h(b).call(d,null):h(b).call(d,null,a);e===i&&g.throwLater(e.e)}function e(a,b){var c=this;if(!a){var d=new Error(a+"");d.cause=a,a=d}var e=h(b).call(c._boundValue(),a);e===i&&g.throwLater(e.e)}var f=a("./util"),g=b._async,h=f.tryCatch,i=f.errorObj;b.prototype.asCallback=b.prototype.nodeify=function(a,b){if("function"==typeof a){var f=d;void 0!==b&&Object(b).spread&&(f=c),this._then(f,e,void 0,this,a)}return this}}},{"./util":36}],22:[function(a,b,c){"use strict";b.exports=function(){function b(){}function c(a,b){if("function"!=typeof b)throw new r("expecting a function but got "+m.classString(b));if(a.constructor!==d)throw new r("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n")}function d(a){this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,a!==t&&(c(this,a),this._resolveFromExecutor(a)),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function e(a){this.promise._resolveCallback(a)}function f(a){this.promise._rejectCallback(a,!1)}function g(a){var b=new d(t);b._fulfillmentHandler0=a,b._rejectionHandler0=a,b._promise0=a,b._receiver0=a}var h,i=function(){return new r("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},j=function(){return new d.PromiseInspection(this._target())},k=function(a){return d.reject(new r(a))},l={},m=a("./util");h=m.isNode?function(){var a=process.domain;return void 0===a&&(a=null),a}:function(){return null},m.notEnumerableProp(d,"_getDomain",h);var n=a("./es5"),o=a("./async"),p=new o;n.defineProperty(d,"_async",{value:p});var q=a("./errors"),r=d.TypeError=q.TypeError;d.RangeError=q.RangeError;var s=d.CancellationError=q.CancellationError;d.TimeoutError=q.TimeoutError,d.OperationalError=q.OperationalError,d.RejectionError=q.OperationalError,d.AggregateError=q.AggregateError;var t=function(){},u={},v={},w=a("./thenables")(d,t),x=a("./promise_array")(d,t,w,k,b),y=a("./context")(d),z=y.create,A=a("./debuggability")(d,y),B=(A.CapturedTrace,a("./finally")(d,w)),C=a("./catch_filter")(v),D=a("./nodeback"),E=m.errorObj,F=m.tryCatch;return d.prototype.toString=function(){return"[object Promise]"},d.prototype.caught=d.prototype.catch=function(a){var b=arguments.length;if(b>1){var c,d=new Array(b-1),e=0;for(c=0;b-1>c;++c){var f=arguments[c];if(!m.isObject(f))return k("expecting an object but got "+m.classString(f));d[e++]=f}return d.length=e,a=arguments[c],this.then(void 0,C(d,a,this))}return this.then(void 0,a)},d.prototype.reflect=function(){return this._then(j,j,void 0,this,void 0)},d.prototype.then=function(a,b){if(A.warnings()&&arguments.length>0&&"function"!=typeof a&&"function"!=typeof b){var c=".then() only accepts functions but was passed: "+m.classString(a);arguments.length>1&&(c+=", "+m.classString(b)),this._warn(c)}return this._then(a,b,void 0,void 0,void 0)},d.prototype.done=function(a,b){var c=this._then(a,b,void 0,void 0,void 0);c._setIsFinal()},d.prototype.spread=function(a){return"function"!=typeof a?k("expecting a function but got "+m.classString(a)):this.all()._then(a,void 0,void 0,u,void 0)},d.prototype.toJSON=function(){var a={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(a.fulfillmentValue=this.value(),a.isFulfilled=!0):this.isRejected()&&(a.rejectionReason=this.reason(),a.isRejected=!0),a},d.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new x(this).promise()},d.prototype.error=function(a){return this.caught(m.originatesFromRejection,a)},d.is=function(a){return a instanceof d},d.fromNode=d.fromCallback=function(a){var b=new d(t);b._captureStackTrace();var c=arguments.length>1?!!Object(arguments[1]).multiArgs:!1,e=F(a)(D(b,c));return e===E&&b._rejectCallback(e.e,!0),b._isFateSealed()||b._setAsyncGuaranteed(),b},d.all=function(a){return new x(a).promise()},d.cast=function(a){var b=w(a);return b instanceof d||(b=new d(t),b._captureStackTrace(),b._setFulfilled(),b._rejectionHandler0=a),b},d.resolve=d.fulfilled=d.cast,d.reject=d.rejected=function(a){var b=new d(t);return b._captureStackTrace(),b._rejectCallback(a,!0),b},d.setScheduler=function(a){if("function"!=typeof a)throw new r("expecting a function but got "+m.classString(a));var b=p._schedule;return p._schedule=a,b},d.prototype._then=function(a,b,c,e,f){var g=void 0!==f,i=g?f:new d(t),j=this._target(),k=j._bitField;g||(i._propagateFrom(this,3),i._captureStackTrace(),void 0===e&&0!==(2097152&this._bitField)&&(e=0!==(50397184&k)?this._boundValue():j===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,i));var l=h();if(0!==(50397184&k)){var m,n,o=j._settlePromiseCtx;0!==(33554432&k)?(n=j._rejectionHandler0,m=a):0!==(16777216&k)?(n=j._fulfillmentHandler0,m=b,j._unsetRejectionIsUnhandled()):(o=j._settlePromiseLateCancellationObserver,n=new s("late cancellation observer"),j._attachExtraTrace(n),m=b),p.invoke(o,j,{handler:null===l?m:"function"==typeof m&&l.bind(m),promise:i,receiver:e,value:n})}else j._addCallbacks(a,b,i,e,l);return i},d.prototype._length=function(){return 65535&this._bitField},d.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},d.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},d.prototype._setLength=function(a){this._bitField=-65536&this._bitField|65535&a},d.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},d.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},d.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},d.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},d.prototype._isFinal=function(){return(4194304&this._bitField)>0},d.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},d.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},d.prototype._setAsyncGuaranteed=function(){this._bitField=134217728|this._bitField},d.prototype._receiverAt=function(a){var b=0===a?this._receiver0:this[4*a-4+3];return b===l?void 0:void 0===b&&this._isBound()?this._boundValue():b},d.prototype._promiseAt=function(a){return this[4*a-4+2]},d.prototype._fulfillmentHandlerAt=function(a){return this[4*a-4+0]},d.prototype._rejectionHandlerAt=function(a){return this[4*a-4+1]},d.prototype._boundValue=function(){},d.prototype._migrateCallback0=function(a){var b=(a._bitField,a._fulfillmentHandler0),c=a._rejectionHandler0,d=a._promise0,e=a._receiverAt(0);void 0===e&&(e=l),this._addCallbacks(b,c,d,e,null)},d.prototype._migrateCallbackAt=function(a,b){var c=a._fulfillmentHandlerAt(b),d=a._rejectionHandlerAt(b),e=a._promiseAt(b),f=a._receiverAt(b);void 0===f&&(f=l),this._addCallbacks(c,d,e,f,null)},d.prototype._addCallbacks=function(a,b,c,d,e){var f=this._length();if(f>=65531&&(f=0,this._setLength(0)),0===f)this._promise0=c,this._receiver0=d,"function"==typeof a&&(this._fulfillmentHandler0=null===e?a:e.bind(a)),"function"==typeof b&&(this._rejectionHandler0=null===e?b:e.bind(b));else{var g=4*f-4;this[g+2]=c,this[g+3]=d,"function"==typeof a&&(this[g+0]=null===e?a:e.bind(a)),"function"==typeof b&&(this[g+1]=null===e?b:e.bind(b))}return this._setLength(f+1),f},d.prototype._proxy=function(a,b){this._addCallbacks(void 0,void 0,b,a,null)},d.prototype._resolveCallback=function(a,b){if(0===(117506048&this._bitField)){if(a===this)return this._rejectCallback(i(),!1);var c=w(a,this);if(!(c instanceof d))return this._fulfill(a);b&&this._propagateFrom(c,2);var e=c._target();if(e===this)return void this._reject(i());var f=e._bitField;if(0===(50397184&f)){var g=this._length();g>0&&e._migrateCallback0(this);for(var h=1;g>h;++h)e._migrateCallbackAt(this,h);this._setFollowing(),this._setLength(0),this._setFollowee(e)}else if(0!==(33554432&f))this._fulfill(e._value());else if(0!==(16777216&f))this._reject(e._reason());else{var j=new s("late cancellation observer");e._attachExtraTrace(j),this._reject(j)}}},d.prototype._rejectCallback=function(a,b,c){var d=m.ensureErrorObject(a),e=d===a;if(!e&&!c&&A.warnings()){var f="a promise was rejected with a non-error: "+m.classString(a);this._warn(f,!0)}this._attachExtraTrace(d,b?e:!1),this._reject(a)},d.prototype._resolveFromExecutor=function(a){var b=this;this._captureStackTrace(),this._pushContext();var c=!0,d=this._execute(a,function(a){b._resolveCallback(a)},function(a){b._rejectCallback(a,c)});c=!1,this._popContext(),void 0!==d&&b._rejectCallback(d,!0)},d.prototype._settlePromiseFromHandler=function(a,b,c,d){var e=d._bitField;if(0===(65536&e)){d._pushContext();var f;b===u?c&&"number"==typeof c.length?f=F(a).apply(this._boundValue(),c):(f=E,f.e=new r("cannot .spread() a non-array: "+m.classString(c))):f=F(a).call(b,c);var g=d._popContext();e=d._bitField,0===(65536&e)&&(f===v?d._reject(c):f===E?d._rejectCallback(f.e,!1):(A.checkForgottenReturns(f,g,"",d,this),d._resolveCallback(f)))}},d.prototype._target=function(){for(var a=this;a._isFollowing();)a=a._followee();return a},d.prototype._followee=function(){return this._rejectionHandler0},d.prototype._setFollowee=function(a){this._rejectionHandler0=a},d.prototype._settlePromise=function(a,c,e,f){var g=a instanceof d,h=this._bitField,i=0!==(134217728&h);0!==(65536&h)?(g&&a._invokeInternalOnCancel(),e instanceof B&&e.isFinallyHandler()?(e.cancelPromise=a,F(c).call(e,f)===E&&a._reject(E.e)):c===j?a._fulfill(j.call(e)):e instanceof b?e._promiseCancelled(a):g||a instanceof x?a._cancel():e.cancel()):"function"==typeof c?g?(i&&a._setAsyncGuaranteed(),this._settlePromiseFromHandler(c,e,f,a)):c.call(e,f,a):e instanceof b?e._isResolved()||(0!==(33554432&h)?e._promiseFulfilled(f,a):e._promiseRejected(f,a)):g&&(i&&a._setAsyncGuaranteed(),0!==(33554432&h)?a._fulfill(f):a._reject(f))},d.prototype._settlePromiseLateCancellationObserver=function(a){var b=a.handler,c=a.promise,e=a.receiver,f=a.value;"function"==typeof b?c instanceof d?this._settlePromiseFromHandler(b,e,f,c):b.call(e,f,c):c instanceof d&&c._reject(f)},d.prototype._settlePromiseCtx=function(a){this._settlePromise(a.promise,a.handler,a.receiver,a.value)},d.prototype._settlePromise0=function(a,b,c){var d=this._promise0,e=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(d,a,e,b)},d.prototype._clearCallbackDataAtIndex=function(a){var b=4*a-4;this[b+2]=this[b+3]=this[b+0]=this[b+1]=void 0},d.prototype._fulfill=function(a){var b=this._bitField;if(!((117506048&b)>>>16)){if(a===this){var c=i();return this._attachExtraTrace(c),this._reject(c)}this._setFulfilled(),this._rejectionHandler0=a,(65535&b)>0&&(0!==(134217728&b)?this._settlePromises():p.settlePromises(this))}},d.prototype._reject=function(a){var b=this._bitField;return(117506048&b)>>>16?void 0:(this._setRejected(),this._fulfillmentHandler0=a,this._isFinal()?p.fatalError(a,m.isNode):void((65535&b)>0?p.settlePromises(this):this._ensurePossibleRejectionHandled()))},d.prototype._fulfillPromises=function(a,b){for(var c=1;a>c;c++){var d=this._fulfillmentHandlerAt(c),e=this._promiseAt(c),f=this._receiverAt(c);this._clearCallbackDataAtIndex(c),this._settlePromise(e,d,f,b)}},d.prototype._rejectPromises=function(a,b){for(var c=1;a>c;c++){var d=this._rejectionHandlerAt(c),e=this._promiseAt(c),f=this._receiverAt(c);this._clearCallbackDataAtIndex(c),this._settlePromise(e,d,f,b)}},d.prototype._settlePromises=function(){var a=this._bitField,b=65535&a;if(b>0){if(0!==(16842752&a)){var c=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,c,a),this._rejectPromises(b,c)}else{var d=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,d,a),this._fulfillPromises(b,d)}this._setLength(0)}this._clearCancellationData()},d.prototype._settledValue=function(){var a=this._bitField;return 0!==(33554432&a)?this._rejectionHandler0:0!==(16777216&a)?this._fulfillmentHandler0:void 0},d.defer=d.pending=function(){A.deprecated("Promise.defer","new Promise");var a=new d(t);return{promise:a,resolve:e,reject:f}},m.notEnumerableProp(d,"_makeSelfResolutionError",i),a("./method")(d,t,w,k,A),a("./bind")(d,t,w,A),a("./cancel")(d,x,k,A),a("./direct_resolve")(d),a("./synchronous_inspection")(d),a("./join")(d,x,w,t,A),d.Promise=d,a("./map.js")(d,x,k,w,t,A),a("./using.js")(d,k,w,z,t,A),a("./timers.js")(d,t,A),a("./generators.js")(d,k,t,w,b,A),a("./nodeify.js")(d),a("./call_get.js")(d),a("./props.js")(d,x,w,k),a("./race.js")(d,t,w,k),a("./reduce.js")(d,x,k,w,t,A),a("./settle.js")(d,x,A),a("./some.js")(d,x,k),a("./promisify.js")(d,t),a("./any.js")(d),a("./each.js")(d,t),a("./filter.js")(d,t),m.toFastProperties(d),m.toFastProperties(d.prototype),g({a:1}),g({b:2}),g({c:3}),g(1),g(function(){}),g(void 0),g(!1),g(new d(t)),A.setBounds(o.firstLineError,m.lastLineError),d}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f){function g(a){switch(a){case-2:return[];case-3:return{}}}function h(a){var d=this._promise=new b(c);a instanceof b&&d._propagateFrom(a,3),d._setOnCancel(this),this._values=a,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var i=a("./util");return i.isArray,i.inherits(h,f),h.prototype.length=function(){return this._length},h.prototype.promise=function(){return this._promise},h.prototype._init=function a(c,f){var h=d(this._values,this._promise);if(h instanceof b){h=h._target();var j=h._bitField;if(this._values=h,0===(50397184&j))return this._promise._setAsyncGuaranteed(),h._then(a,this._reject,void 0,this,f);if(0===(33554432&j))return 0!==(16777216&j)?this._reject(h._reason()):this._cancel();h=h._value()}if(h=i.asArray(h),null===h){var k=e("expecting an array or an iterable object but got "+i.classString(h)).reason();return void this._promise._rejectCallback(k,!1)}return 0===h.length?void(-5===f?this._resolveEmptyArray():this._resolve(g(f))):void this._iterate(h)},h.prototype._iterate=function(a){var c=this.getActualLength(a.length);this._length=c,this._values=this.shouldCopyValues()?new Array(c):this._values;for(var e=this._promise,f=!1,g=null,h=0;c>h;++h){var i=d(a[h],e);i instanceof b?(i=i._target(),g=i._bitField):g=null,f?null!==g&&i.suppressUnhandledRejections():null!==g?0===(50397184&g)?(i._proxy(this,h),this._values[h]=i):f=0!==(33554432&g)?this._promiseFulfilled(i._value(),h):0!==(16777216&g)?this._promiseRejected(i._reason(),h):this._promiseCancelled(h):f=this._promiseFulfilled(i,h)}f||e._setAsyncGuaranteed()},h.prototype._isResolved=function(){return null===this._values},h.prototype._resolve=function(a){this._values=null,this._promise._fulfill(a)},h.prototype._cancel=function(){!this._isResolved()&&this._promise.isCancellable()&&(this._values=null,this._promise._cancel())},h.prototype._reject=function(a){this._values=null,this._promise._rejectCallback(a,!1)},h.prototype._promiseFulfilled=function(a,b){this._values[b]=a;var c=++this._totalResolved;return c>=this._length?(this._resolve(this._values),!0):!1},h.prototype._promiseCancelled=function(){return this._cancel(),!0},h.prototype._promiseRejected=function(a){return this._totalResolved++,this._reject(a),!0},h.prototype._resultCancelled=function(){if(!this._isResolved()){var a=this._values;if(this._cancel(),a instanceof b)a.cancel();else for(var c=0;c<a.length;++c)a[c]instanceof b&&a[c].cancel()}},h.prototype.shouldCopyValues=function(){return!0},h.prototype.getActualLength=function(a){return a},h}},{"./util":36}],24:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a){return!w.test(a)}function e(a){try{return a.__isPromisified__===!0}catch(a){return!1}}function f(a,b,c){var d=n.getDataPropertyOrDefault(a,b+c,u);return d?e(d):!1}function g(a,b,c){for(var d=0;d<a.length;d+=2){var e=a[d];if(c.test(e))for(var f=e.replace(c,""),g=0;g<a.length;g+=2)if(a[g]===f)throw new s("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",b))}}function h(a,b,c,d){for(var h=n.inheritedDataKeys(a),i=[],j=0;j<h.length;++j){var k=h[j],l=a[k],m=d===x?!0:x(k,l,a);"function"!=typeof l||e(l)||f(a,k,b)||!d(k,l,a,m)||i.push(k,l)}return g(i,b,c),i}function i(a,d,e,f,g,h){function i(){var e=d;d===m&&(e=this);var f=new b(c);f._captureStackTrace();var g="string"==typeof k&&this!==j?this[k]:a,i=o(f,h);try{g.apply(e,p(arguments,i))}catch(a){f._rejectCallback(q(a),!0,!0)}return f._isFateSealed()||f._setAsyncGuaranteed(),f}var j=function(){return this}(),k=a;return"string"==typeof k&&(a=f),n.notEnumerableProp(i,"__isPromisified__",!0),i}function j(a,b,c,d,e){for(var f=new RegExp(y(b)+"$"),g=h(a,b,f,c),i=0,j=g.length;j>i;i+=2){var k=g[i],l=g[i+1],o=k+b;if(d===z)a[o]=z(k,m,k,l,b,e);else{var p=d(l,function(){return z(k,m,k,l,b,e)});n.notEnumerableProp(p,"__isPromisified__",!0),a[o]=p}}return n.toFastProperties(a),a}function k(a,b,c){return z(a,b,void 0,a,null,c)}var l,m={},n=a("./util"),o=a("./nodeback"),p=n.withAppended,q=n.maybeWrapAsError,r=n.canEvaluate,s=a("./errors").TypeError,t="Async",u={__isPromisified__:!0},v=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],w=new RegExp("^(?:"+v.join("|")+")$"),x=function(a){return n.isIdentifier(a)&&"_"!==a.charAt(0)&&"constructor"!==a},y=function(a){return a.replace(/([$])/,"\\$")},z=r?l:i;b.promisify=function(a,b){if("function"!=typeof a)throw new s("expecting a function but got "+n.classString(a));if(e(a))return a;b=Object(b);var c=void 0===b.context?m:b.context,f=!!b.multiArgs,g=k(a,c,f);return n.copyDescriptors(a,g,d),g},b.promisifyAll=function(a,b){if("function"!=typeof a&&"object"!=typeof a)throw new s("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");b=Object(b);var c=!!b.multiArgs,d=b.suffix;"string"!=typeof d&&(d=t);var e=b.filter;"function"!=typeof e&&(e=x);var f=b.promisifier;if("function"!=typeof f&&(f=z),!n.isIdentifier(d))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var g=n.inheritedDataKeys(a),h=0;h<g.length;++h){var i=a[g[h]];"constructor"!==g[h]&&n.isClass(i)&&(j(i.prototype,d,e,f,c),j(i,d,e,f,c))}return j(a,d,e,f,c)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){function f(a){var b,c=!1;if(void 0!==h&&a instanceof h)b=l(a),c=!0;else{var d=k.keys(a),e=d.length;b=new Array(2*e);for(var f=0;e>f;++f){var g=d[f];b[f]=a[g],b[f+e]=g}}this.constructor$(b),this._isMap=c,this._init$(void 0,-3)}function g(a){var c,g=d(a);return j(g)?(c=g instanceof b?g._then(b.props,void 0,void 0,void 0,void 0):new f(g).promise(),g instanceof b&&c._propagateFrom(g,2),c):e("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var h,i=a("./util"),j=i.isObject,k=a("./es5");"function"==typeof Map&&(h=Map);var l=function(){function a(a,d){this[b]=a,this[b+c]=d,b++}var b=0,c=0;return function(d){c=d.size,b=0;var e=new Array(2*d.size);return d.forEach(a,e),e}}(),m=function(a){for(var b=new h,c=a.length/2|0,d=0;c>d;++d){var e=a[c+d],f=a[d];b.set(e,f)}return b};i.inherits(f,c),f.prototype._init=function(){},f.prototype._promiseFulfilled=function(a,b){this._values[b]=a;var c=++this._totalResolved;if(c>=this._length){var d;if(this._isMap)d=m(this._values);else{d={};for(var e=this.length(),f=0,g=this.length();g>f;++f)d[this._values[f+e]]=this._values[f]}return this._resolve(d),!0}return!1},f.prototype.shouldCopyValues=function(){return!1},f.prototype.getActualLength=function(a){return a>>1},b.prototype.props=function(){return g(this)},b.props=function(a){return g(a)}}},{"./es5":13,"./util":36}],26:[function(a,b,c){"use strict";function d(a,b,c,d,e){for(var f=0;e>f;++f)c[f+d]=a[f+b],a[f+b]=void 0}function e(a){this._capacity=a,this._length=0,this._front=0}e.prototype._willBeOverCapacity=function(a){return this._capacity<a},e.prototype._pushOne=function(a){var b=this.length();this._checkCapacity(b+1);var c=this._front+b&this._capacity-1;this[c]=a,this._length=b+1},e.prototype._unshiftOne=function(a){var b=this._capacity;this._checkCapacity(this.length()+1);var c=this._front,d=(c-1&b-1^b)-b;this[d]=a,this._front=d,this._length=this.length()+1},e.prototype.unshift=function(a,b,c){this._unshiftOne(c),this._unshiftOne(b),this._unshiftOne(a)},e.prototype.push=function(a,b,c){var d=this.length()+3;if(this._willBeOverCapacity(d))return this._pushOne(a),this._pushOne(b),void this._pushOne(c);var e=this._front+d-3;this._checkCapacity(d);var f=this._capacity-1;this[e+0&f]=a,this[e+1&f]=b,this[e+2&f]=c,this._length=d},e.prototype.shift=function(){var a=this._front,b=this[a];return this[a]=void 0,this._front=a+1&this._capacity-1,this._length--,b},e.prototype.length=function(){return this._length},e.prototype._checkCapacity=function(a){this._capacity<a&&this._resizeTo(this._capacity<<1)},e.prototype._resizeTo=function(a){var b=this._capacity;this._capacity=a;var c=this._front,e=this._length,f=c+e&b-1;d(this,0,this,b,f)},b.exports=e},{}],27:[function(a,b,c){"use strict";b.exports=function(b,c,d,e){function f(a,f){var i=d(a);if(i instanceof b)return h(i);if(a=g.asArray(a),null===a)return e("expecting an array or an iterable object but got "+g.classString(a));var j=new b(c);void 0!==f&&j._propagateFrom(f,3);for(var k=j._fulfill,l=j._reject,m=0,n=a.length;n>m;++m){var o=a[m];(void 0!==o||m in a)&&b.cast(o)._then(k,l,void 0,j,null)}return j}var g=a("./util"),h=function(a){return a.then(function(b){return f(b,a)})};b.race=function(a){return f(a,void 0)},b.prototype.race=function(){return f(this,void 0)}}},{"./util":36}],28:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a,c,d,e){this.constructor$(a);var g=m();this._fn=null===g?c:g.bind(c),void 0!==d&&(d=b.resolve(d),d._attachCancellationCallback(this)),this._initialValue=d,this._currentCancellable=null,this._eachValues=e===f?[]:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function i(a,b){this.isFulfilled()?b._resolve(a):b._reject(a)}function j(a,b,c,e){if("function"!=typeof b)return d("expecting a function but got "+n.classString(b));var f=new h(a,b,c,e);return f.promise()}function k(a){this.accum=a,this.array._gotAccum(a);var c=e(this.value,this.array._promise);return c instanceof b?(this.array._currentCancellable=c,c._then(l,void 0,void 0,this,void 0)):l.call(this,c)}function l(a){var c=this.array,d=c._promise,e=o(c._fn);d._pushContext();var f;f=void 0!==c._eachValues?e.call(d._boundValue(),a,this.index,this.length):e.call(d._boundValue(),this.accum,a,this.index,this.length),f instanceof b&&(c._currentCancellable=f);var h=d._popContext();return g.checkForgottenReturns(f,h,void 0!==c._eachValues?"Promise.each":"Promise.reduce",d),f}var m=b._getDomain,n=a("./util"),o=n.tryCatch;n.inherits(h,c),h.prototype._gotAccum=function(a){void 0!==this._eachValues&&a!==f&&this._eachValues.push(a)},h.prototype._eachComplete=function(a){return this._eachValues.push(a),this._eachValues},h.prototype._init=function(){},h.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},h.prototype.shouldCopyValues=function(){return!1},h.prototype._resolve=function(a){this._promise._resolveCallback(a),this._values=null},h.prototype._resultCancelled=function(a){return a===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof b&&this._currentCancellable.cancel(),this._initialValue instanceof b&&this._initialValue.cancel()))},h.prototype._iterate=function(a){this._values=a;var c,d,e=a.length;if(void 0!==this._initialValue?(c=this._initialValue,d=0):(c=b.resolve(a[0]),d=1),this._currentCancellable=c,!c.isRejected())for(;e>d;++d){var f={accum:null,value:a[d],index:d,length:e,array:this};c=c._then(k,void 0,void 0,f,void 0)}void 0!==this._eachValues&&(c=c._then(this._eachComplete,void 0,void 0,this,void 0)),c._then(i,i,void 0,c,this)},b.prototype.reduce=function(a,b){return j(this,a,b,null)},b.reduce=function(a,b,c,d){return j(a,b,c,d)}}},{"./util":36}],29:[function(a,b,c){"use strict";var d,e=a("./util"),f=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")};if(e.isNode&&"undefined"==typeof MutationObserver){var g=global.setImmediate,h=process.nextTick;d=e.isRecentNode?function(a){g.call(global,a)}:function(a){h.call(process,a)}}else d="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?"undefined"!=typeof setImmediate?function(a){setImmediate(a)}:"undefined"!=typeof setTimeout?function(a){setTimeout(a,0)}:f:function(){var a=document.createElement("div"),b={attributes:!0},c=!1,d=document.createElement("div"),e=new MutationObserver(function(){a.classList.toggle("foo"),c=!1});e.observe(d,b);var f=function(){c||(c=!0,d.classList.toggle("foo"))};return function(c){var d=new MutationObserver(function(){d.disconnect(),c()});d.observe(a,b),f()}}();b.exports=d},{"./util":36}],30:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a){this.constructor$(a)}var f=b.PromiseInspection,g=a("./util");g.inherits(e,c),e.prototype._promiseResolved=function(a,b){this._values[a]=b;var c=++this._totalResolved;return c>=this._length?(this._resolve(this._values),!0):!1},e.prototype._promiseFulfilled=function(a,b){var c=new f;return c._bitField=33554432,c._settledValueField=a,this._promiseResolved(b,c)},e.prototype._promiseRejected=function(a,b){var c=new f;return c._bitField=16777216,c._settledValueField=a,this._promiseResolved(b,c)},b.settle=function(a){return d.deprecated(".settle()",".reflect()"),new e(a).promise()},b.prototype.settle=function(){return b.settle(this)}}},{"./util":36}],31:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a){this.constructor$(a),this._howMany=0,this._unwrap=!1,this._initialized=!1}function f(a,b){if((0|b)!==b||0>b)return d("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var c=new e(a),f=c.promise();return c.setHowMany(b),c.init(),f}var g=a("./util"),h=a("./errors").RangeError,i=a("./errors").AggregateError,j=g.isArray,k={};g.inherits(e,c),e.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var a=j(this._values);!this._isResolved()&&a&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},e.prototype.init=function(){this._initialized=!0,this._init()},e.prototype.setUnwrap=function(){this._unwrap=!0},e.prototype.howMany=function(){return this._howMany},e.prototype.setHowMany=function(a){this._howMany=a},e.prototype._promiseFulfilled=function(a){return this._addFulfilled(a),this._fulfilled()===this.howMany()?(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0):!1},e.prototype._promiseRejected=function(a){return this._addRejected(a),this._checkOutcome()},e.prototype._promiseCancelled=function(){return this._values instanceof b||null==this._values?this._cancel():(this._addRejected(k),this._checkOutcome())},e.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var a=new i,b=this.length();b<this._values.length;++b)this._values[b]!==k&&a.push(this._values[b]);return a.length>0?this._reject(a):this._cancel(),!0}return!1},e.prototype._fulfilled=function(){return this._totalResolved},e.prototype._rejected=function(){return this._values.length-this.length()},e.prototype._addRejected=function(a){this._values.push(a)},e.prototype._addFulfilled=function(a){this._values[this._totalResolved++]=a},e.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},e.prototype._getRangeError=function(a){var b="Input array must contain at least "+this._howMany+" items but contains only "+a+" items";return new h(b)},e.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},b.some=function(a,b){return f(a,b)},b.prototype.some=function(a){return f(this,a)},b._SomePromiseArray=e}},{"./errors":12,"./util":36}],32:[function(a,b,c){"use strict";b.exports=function(a){function b(a){void 0!==a?(a=a._target(),this._bitField=a._bitField,this._settledValueField=a._isFateSealed()?a._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}b.prototype._settledValue=function(){return this._settledValueField};var c=b.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},d=b.prototype.error=b.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},e=b.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},f=b.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},g=b.prototype.isPending=function(){return 0===(50397184&this._bitField)},h=b.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};b.prototype.isCancelled=a.prototype._isCancelled=function(){return 65536===(65536&this._bitField)},a.prototype.isCancelled=function(){return this._target()._isCancelled()},a.prototype.isPending=function(){return g.call(this._target())},a.prototype.isRejected=function(){return f.call(this._target())},a.prototype.isFulfilled=function(){return e.call(this._target())},a.prototype.isResolved=function(){return h.call(this._target())},a.prototype.value=function(){return c.call(this._target())},a.prototype.reason=function(){var a=this._target();
return a._unsetRejectionIsUnhandled(),d.call(a)},a.prototype._value=function(){return this._settledValue()},a.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},a.PromiseInspection=b}},{}],33:[function(a,b,c){"use strict";b.exports=function(b,c){function d(a,d){if(k(a)){if(a instanceof b)return a;var e=f(a);if(e===j){d&&d._pushContext();var i=b.reject(e.e);return d&&d._popContext(),i}if("function"==typeof e){if(g(a)){var i=new b(c);return a._then(i._fulfill,i._reject,void 0,i,null),i}return h(a,e,d)}}return a}function e(a){return a.then}function f(a){try{return e(a)}catch(a){return j.e=a,j}}function g(a){return l.call(a,"_promise0")}function h(a,d,e){function f(a){h&&(h._resolveCallback(a),h=null)}function g(a){h&&(h._rejectCallback(a,l,!0),h=null)}var h=new b(c),k=h;e&&e._pushContext(),h._captureStackTrace(),e&&e._popContext();var l=!0,m=i.tryCatch(d).call(a,f,g);return l=!1,h&&m===j&&(h._rejectCallback(m.e,!0,!0),h=null),k}var i=a("./util"),j=i.errorObj,k=i.isObject,l={}.hasOwnProperty;return d}},{"./util":36}],34:[function(a,b,c){"use strict";b.exports=function(b,c,d){function e(a){this.handle=a}function f(a){return clearTimeout(this.handle),a}function g(a){throw clearTimeout(this.handle),a}var h=a("./util"),i=b.TimeoutError;e.prototype._resultCancelled=function(){clearTimeout(this.handle)};var j=function(a){return k(+this).thenReturn(a)},k=b.delay=function(a,f){var g,h;return void 0!==f?(g=b.resolve(f)._then(j,null,null,a,void 0),d.cancellation()&&f instanceof b&&g._setOnCancel(f)):(g=new b(c),h=setTimeout(function(){g._fulfill()},+a),d.cancellation()&&g._setOnCancel(new e(h))),g._setAsyncGuaranteed(),g};b.prototype.delay=function(a){return k(a,this)};var l=function(a,b,c){var d;d="string"!=typeof b?b instanceof Error?b:new i("operation timed out"):new i(b),h.markAsOriginatingFromRejection(d),a._attachExtraTrace(d),a._reject(d),null!=c&&c.cancel()};b.prototype.timeout=function(a,b){a=+a;var c,h,i=new e(setTimeout(function(){c.isPending()&&l(c,b,h)},a));return d.cancellation()?(h=this.then(),c=h._then(f,g,void 0,i,void 0),c._setOnCancel(i)):c=this._then(f,g,void 0,i,void 0),c}}},{"./util":36}],35:[function(a,b,c){"use strict";b.exports=function(b,c,d,e,f,g){function h(a){setTimeout(function(){throw a},0)}function i(a){var b=d(a);return b!==a&&"function"==typeof a._isDisposable&&"function"==typeof a._getDisposer&&a._isDisposable()&&b._setDisposable(a._getDisposer()),b}function j(a,c){function e(){if(g>=j)return k._fulfill();var f=i(a[g++]);if(f instanceof b&&f._isDisposable()){try{f=d(f._getDisposer().tryDispose(c),a.promise)}catch(a){return h(a)}if(f instanceof b)return f._then(e,h,null,null,null)}e()}var g=0,j=a.length,k=new b(f);return e(),k}function k(a,b,c){this._data=a,this._promise=b,this._context=c}function l(a,b,c){this.constructor$(a,b,c)}function m(a){return k.isDisposer(a)?(this.resources[this.index]._setDisposable(a),a.promise()):a}function n(a){this.length=a,this.promise=null,this[a-1]=null}var o=a("./util"),p=a("./errors").TypeError,q=a("./util").inherits,r=o.errorObj,s=o.tryCatch;k.prototype.data=function(){return this._data},k.prototype.promise=function(){return this._promise},k.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},k.prototype.tryDispose=function(a){var b=this.resource(),c=this._context;void 0!==c&&c._pushContext();var d=null!==b?this.doDispose(b,a):null;return void 0!==c&&c._popContext(),this._promise._unsetDisposable(),this._data=null,d},k.isDisposer=function(a){return null!=a&&"function"==typeof a.resource&&"function"==typeof a.tryDispose},q(l,k),l.prototype.doDispose=function(a,b){var c=this.data();return c.call(a,a,b)},n.prototype._resultCancelled=function(){for(var a=this.length,c=0;a>c;++c){var d=this[c];d instanceof b&&d.cancel()}},b.using=function(){var a=arguments.length;if(2>a)return c("you must pass at least 2 arguments to Promise.using");var e=arguments[a-1];if("function"!=typeof e)return c("expecting a function but got "+o.classString(e));var f,h=!0;2===a&&Array.isArray(arguments[0])?(f=arguments[0],a=f.length,h=!1):(f=arguments,a--);for(var i=new n(a),l=0;a>l;++l){var p=f[l];if(k.isDisposer(p)){var q=p;p=p.promise(),p._setDisposable(q)}else{var t=d(p);t instanceof b&&(p=t._then(m,null,null,{resources:i,index:l},void 0))}i[l]=p}for(var u=new Array(i.length),l=0;l<u.length;++l)u[l]=b.resolve(i[l]).reflect();var v=b.all(u).then(function(a){for(var b=0;b<a.length;++b){var c=a[b];if(c.isRejected())return r.e=c.error(),r;if(!c.isFulfilled())return void v.cancel();a[b]=c.value()}w._pushContext(),e=s(e);var d=h?e.apply(void 0,a):e(a),f=w._popContext();return g.checkForgottenReturns(d,f,"Promise.using",w),d}),w=v.lastly(function(){var a=new b.PromiseInspection(v);return j(i,a)});return i.promise=w,w._setOnCancel(i),w},b.prototype._setDisposable=function(a){this._bitField=131072|this._bitField,this._disposer=a},b.prototype._isDisposable=function(){return(131072&this._bitField)>0},b.prototype._getDisposer=function(){return this._disposer},b.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},b.prototype.disposer=function(a){if("function"==typeof a)return new l(a,this,e());throw new p}}},{"./errors":12,"./util":36}],36:[function(a,b,c){"use strict";function d(){try{var a=y;return y=null,a.apply(this,arguments)}catch(a){return B.e=a,B}}function e(a){return y=a,d}function f(a){return null==a||a===!0||a===!1||"string"==typeof a||"number"==typeof a}function g(a){return"function"==typeof a||"object"==typeof a&&null!==a}function h(a){return f(a)?new Error(q(a)):a}function i(a,b){var c,d=a.length,e=new Array(d+1);for(c=0;d>c;++c)e[c]=a[c];return e[c]=b,e}function j(a,b,c){if(!z.isES5)return{}.hasOwnProperty.call(a,b)?a[b]:void 0;var d=Object.getOwnPropertyDescriptor(a,b);return null!=d?null==d.get&&null==d.set?d.value:c:void 0}function k(a,b,c){if(f(a))return a;var d={value:c,configurable:!0,enumerable:!1,writable:!0};return z.defineProperty(a,b,d),a}function l(a){throw a}function m(a){try{if("function"==typeof a){var b=z.names(a.prototype),c=z.isES5&&b.length>1,d=b.length>0&&!(1===b.length&&"constructor"===b[0]),e=F.test(a+"")&&z.names(a).length>0;if(c||d||e)return!0}return!1}catch(a){return!1}}function n(a){function b(){}b.prototype=a;for(var c=8;c--;)new b;return a}function o(a){return G.test(a)}function p(a,b,c){for(var d=new Array(a),e=0;a>e;++e)d[e]=b+e+c;return d}function q(a){try{return a+""}catch(a){return"[no string representation]"}}function r(a){return null!==a&&"object"==typeof a&&"string"==typeof a.message&&"string"==typeof a.name}function s(a){try{k(a,"isOperational",!0)}catch(a){}}function t(a){return null==a?!1:a instanceof Error.__BluebirdErrorTypes__.OperationalError||a.isOperational===!0}function u(a){return r(a)&&z.propertyIsWritable(a,"stack")}function v(a){return{}.toString.call(a)}function w(a,b,c){for(var d=z.names(a),e=0;e<d.length;++e){var f=d[e];if(c(f))try{z.defineProperty(b,f,z.getDescriptor(a,f))}catch(a){}}}function x(a,b){return K?process.env[a]:b}var y,z=a("./es5"),A="undefined"==typeof navigator,B={e:{}},C="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,D=function(a,b){function c(){this.constructor=a,this.constructor$=b;for(var c in b.prototype)d.call(b.prototype,c)&&"$"!==c.charAt(c.length-1)&&(this[c+"$"]=b.prototype[c])}var d={}.hasOwnProperty;return c.prototype=b.prototype,a.prototype=new c,a.prototype},E=function(){var a=[Array.prototype,Object.prototype,Function.prototype],b=function(b){for(var c=0;c<a.length;++c)if(a[c]===b)return!0;return!1};if(z.isES5){var c=Object.getOwnPropertyNames;return function(a){for(var d=[],e=Object.create(null);null!=a&&!b(a);){var f;try{f=c(a)}catch(a){return d}for(var g=0;g<f.length;++g){var h=f[g];if(!e[h]){e[h]=!0;var i=Object.getOwnPropertyDescriptor(a,h);null!=i&&null==i.get&&null==i.set&&d.push(h)}}a=z.getPrototypeOf(a)}return d}}var d={}.hasOwnProperty;return function(c){if(b(c))return[];var e=[];a:for(var f in c)if(d.call(c,f))e.push(f);else{for(var g=0;g<a.length;++g)if(d.call(a[g],f))continue a;e.push(f)}return e}}(),F=/this\s*\.\s*\S+\s*=/,G=/^[a-z$_][a-z$_0-9]*$/i,H=function(){return"stack"in new Error?function(a){return u(a)?a:new Error(q(a))}:function(a){if(u(a))return a;try{throw new Error(q(a))}catch(a){return a}}}(),I=function(a){return z.isArray(a)?a:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var J="function"==typeof Array.from?function(a){return Array.from(a)}:function(a){for(var b,c=[],d=a[Symbol.iterator]();!(b=d.next()).done;)c.push(b.value);return c};I=function(a){return z.isArray(a)?a:null!=a&&"function"==typeof a[Symbol.iterator]?J(a):null}}var K="undefined"!=typeof process&&"[object process]"===v(process).toLowerCase(),L={isClass:m,isIdentifier:o,inheritedDataKeys:E,getDataPropertyOrDefault:j,thrower:l,isArray:z.isArray,asArray:I,notEnumerableProp:k,isPrimitive:f,isObject:g,isError:r,canEvaluate:A,errorObj:B,tryCatch:e,inherits:D,withAppended:i,maybeWrapAsError:h,toFastProperties:n,filledRange:p,toString:q,canAttachTrace:u,ensureErrorObject:H,originatesFromRejection:t,markAsOriginatingFromRejection:s,classString:v,copyDescriptors:w,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:K,env:x,global:C};L.isRecentNode=L.isNode&&function(){var a=process.versions.node.split(".").map(Number);return 0===a[0]&&a[1]>10||a[0]>0}(),L.isNode&&L.toFastProperties(process);try{throw new Error}catch(a){L.lastLineError=a}b.exports=L},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),function(a,b){"use strict";function c(a){return o[n]=d.apply(b,a),n++}function d(a){var c=[].slice.call(arguments,1);return function(){"function"==typeof a?a.apply(b,c):new Function(""+a)()}}function e(a){if(p)setTimeout(d(e,a),0);else{var b=o[a];if(b){p=!0;try{b()}finally{f(a),p=!1}}}}function f(a){delete o[a]}function g(){m=function(){var a=c(arguments);return process.nextTick(d(e,a)),a}}function h(){if(a.postMessage&&!a.importScripts){var b=!0,c=a.onmessage;return a.onmessage=function(){b=!1},a.postMessage("","*"),a.onmessage=c,b}}function i(){var b="setImmediate$"+Math.random()+"$",d=function(c){c.source===a&&"string"==typeof c.data&&0===c.data.indexOf(b)&&e(+c.data.slice(b.length))};a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d),m=function(){var d=c(arguments);return a.postMessage(b+d,"*"),d}}function j(){var a=new MessageChannel;a.port1.onmessage=function(a){var b=a.data;e(b)},m=function(){var b=c(arguments);return a.port2.postMessage(b),b}}function k(){var a=q.documentElement;m=function(){var b=c(arguments),d=q.createElement("script");return d.onreadystatechange=function(){e(b),d.onreadystatechange=null,a.removeChild(d),d=null},a.appendChild(d),b}}function l(){m=function(){var a=c(arguments);return setTimeout(d(e,a),0),a}}if(!a.setImmediate){var m,n=1,o={},p=!1,q=a.document,r=Object.getPrototypeOf&&Object.getPrototypeOf(a);r=r&&r.setTimeout?r:a,"[object process]"==={}.toString.call(a.process)?g():h()?i():a.MessageChannel?j():q&&"onreadystatechange"in q.createElement("script")?k():l(),r.setImmediate=m,r.clearImmediate=f}}(new Function("return this")()),define("components/setImmediate/setImmediate",function(){}),function(){var a=/MSIE (\d+)/,b=a.exec(navigator.userAgent);if(b){var c=parseInt(b[1]);if(8>=c)throw alert("This application does not support IE"+c+".\nPlease upgrade your system to have IE11+ or use an alternate browser (Google Chrome, Firefox)."),new Error("IE"+c+" not supported")}}(),require.config({waitSeconds:0,paths:{jsbarcode:"components/jsbarcode/JsBarcode",numeral:"components/numeral/min/numeral.min",moment:"components/moment/min/moment.min","moment-duration-format":"components/moment-duration-format/lib/moment-duration-format",ace:"components/ace/src",async:"components/async/lib/async",bowser:"components/bowser/bowser.min",chroma:"components/chroma-js/chroma.min",ckeditor:"components/ckeditor/ckeditor",d3:"components/d3/d3.min",fancytree:"components/fancytree/dist/jquery.fancytree-all",forms:"lib/forms","file-saver":"components/file-saver.js/FileSaver",highlightjs:"lib/highlight.js/highlight.pack",jcampconverter:"components/jcampconverter/dist/jcampconverter.min",jqgrid:"components/jqgrid_edit/js/jquery.jqGrid",slickgrid_core:"components/slickgrid/slick.core",slickgrid:"components/slickgrid/slick.grid",jquery:"components/jquery/dist/jquery","jquery-cookie":"components/jquery-cookie/jquery.cookie","jquery-ui":"components/jquery-ui/ui","jquery-tmpl":"components/jquery-tmpl/jquery.tmpl.min",notifyjs:"components/notifyjs/dist/notify-combined.min",jsgraph:"components/jsgraph/dist/jsgraph",jsoneditor:"components/jsoneditor/dist/jsoneditor-minimalist.min",jszip:"components/jszip/dist/jszip.min",loglevel:"components/loglevel/dist/loglevel.min",lodash:"components/lodash/dist/lodash.min","markdown-js":"components/markdown-js/lib/markdown","mime-types":"browserified/mime-types/index",marked:"components/marked/lib/marked",modernizr:"components/modernizr/modernizr",openchemlib:"components/openchemlib/dist",papaparse:"components/papa-parse/papaparse.min",plot:"lib/plot/plot",pouchdb:"components/pouchdb/dist/pouchdb.min",select2:"components/select2/dist/js/select2.full","smart-array-filter":"components/smart-array-filter/dist/smart-array-filter.min",sparkline:"lib/jquery.sparkline/jquery.sparkline.min",sprintf:"components/sprintf/dist/sprintf.min","src/shape.1dnmr":"components/jsNMR/src/shape.1dnmr",superagent:"lib/superagent-promise/index",threejs:"components/threejs/build/three.min",uri:"components/uri.js/src",x2js:"components/x2js/xml2json.min",BiojsFeatureViewer:"lib/biojs-1.0/src/main/javascript/Biojs.FeatureViewer",BiojsCore:"lib/biojs-1.0/src/main/javascript/Biojs",BiojsMyFeatureViewer:"modules/types/bio/feature_viewer/Biojs.MyFeatureViewer",BiojsDasProteinFeatureViewer:"lib/biojs-1.0/src/main/javascript/Biojs.DasProteinFeatureViewer"},shim:{threejs:{exports:"THREE",init:function(){this.THREE.ImageUtils.crossOrigin="anonymous"}},x2js:{exports:"X2JS"},"components/jit/Jit/jit":{exports:"$jit"},ckeditor:{exports:"CKEDITOR"},modernizr:{exports:"Modernizr"},"lib/parser/Parser":{exports:"Parser"},"jquery-cookie":"jquery",select2:["jquery"],jsbarcode:["jquery","components/jsbarcode/CODE39","components/jsbarcode/EAN_UPC","components/jsbarcode/ITF","components/jsbarcode/CODE128","components/jsbarcode/pharmacode"],"lib/threejs/TrackballControls":["threejs"],jqgrid:["jquery","components/jqgrid_edit/js/i18n/grid.locale-en"],"lib/couchdb/jquery.couch":["jquery"],slickgrid_core:["jquery","jquery-ui/core","jquery-ui/sortable","jquery-tmpl"],slickgrid:{deps:["slickgrid_core","components/slickgrid/slick.groupitemmetadataprovider","components/slickgrid/slick.groupitemmetadataprovider","components/slickgrid/slick.dataview","components/slickgrid/lib/jquery.event.drop-2.2","components/slickgrid/lib/jquery.event.drag-2.2","components/slickgrid/plugins/slick.cellrangedecorator","components/slickgrid/plugins/slick.cellrangeselector","components/slickgrid/plugins/slick.cellselectionmodel","components/slickgrid/plugins/slick.rowselectionmodel","components/slickgrid/plugins/slick.rowmovemanager","components/slickgrid/slick.editors","modules/types/edition/slick_grid/slick.editors.custom","modules/types/edition/slick_grid/slick.formatters.custom","components/slickgrid/plugins/slick.checkboxselectcolumn","components/slickgrid/controls/slick.columnpicker","components/slickgrid/examples/slick.compositeeditor"],exports:"Slick"},"libs/jsmol/js/JSmolApplet":["libs/jsmol/JSmol.min.nojq"],"lib/flot/jquery.flot.pie":["jquery","lib/flot/jquery.flot"],"lib/pixastic/pixastic":{deps:["lib/pixastic/pixastic/pixastic.core"],exports:"Pixastic"},fancytree:["jquery-ui/core","jquery-ui/effect-blind","jquery-ui/droppable","jquery-ui/draggable"],"moment-duration-format":["moment"],BiojsCore:{exports:"Biojs"},BiojsMyFeatureViewer:["BiojsFeatureViewer"],BiojsFeatureViewer:["BiojsCore","lib/biojs-1.0/src/main/resources/dependencies/jquery/jquery.tooltip","lib/biojs-1.0/src/main/resources/dependencies/graphics/raphael-2.1.2","lib/biojs-1.0/src/main/resources/dependencies/graphics/canvg","lib/biojs-1.0/src/main/resources/dependencies/graphics/rgbcolor"],BiojsDasProteinFeatureViewer:["BiojsMyFeatureViewer"]},map:{"components/jsNMR/src/nmr":{graph:"jsgraph",assignation:"components/jsNMR/src/assignation","lib/components/VisuMol/src/molecule":"components/jsNMR/lib/components/VisuMol/src/molecule"},"src/shape.1dnmr":{graph:"jsgraph"},"lib/gcms/gcms":{graph:"jsgraph"}}}),window.CKEDITOR_BASEPATH=require.toUrl("components/ckeditor/"),require(["jquery","src/main/datas","src/main/entrypoint","uri/URI.fragmentQuery","components/bluebird/js/browser/bluebird.min","components/setImmediate/setImmediate"],function(a,b,c,d,e){window.Promise=e,a.browser={msie:!1},a(document).ready(function(){var a=new d(window.location.href),b=a.search().length>0?"search":"?"===a.fragment()[0]?"fragment":"search",e=new d(a[b]()).query(!0);c.init(e,b.replace(b[0],b[0].toUpperCase()))})}),define("init",function(){});